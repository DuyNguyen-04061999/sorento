!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(M,t){"use strict";function m(t){return null!=t&&t===t.window}var e=[],n=Object.getPrototypeOf,s=e.slice,g=e.flat?function(t){return e.flat.call(t)}:function(t){return e.concat.apply([],t)},c=e.push,r=e.indexOf,i={},o=i.toString,v=i.hasOwnProperty,a=v.toString,l=a.call(Object),y={},b=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},_=M.document,h={type:!0,src:!0,nonce:!0,noModule:!0};function x(t,e,i){var n,r,o=(i=i||_).createElement("script");if(o.text=t,e)for(n in h)(r=e[n]||e.getAttribute&&e.getAttribute(n))&&o.setAttribute(n,r);i.head.appendChild(o).parentNode.removeChild(o)}function w(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?i[o.call(t)]||"object":typeof t}var u="3.5.1",S=function(t,e){return new S.fn.init(t,e)};function d(t){var e=!!t&&"length"in t&&t.length,i=w(t);return!b(t)&&!m(t)&&("array"===i||0===e||"number"==typeof e&&0<e&&e-1 in t)}S.fn=S.prototype={jquery:u,constructor:S,length:0,toArray:function(){return s.call(this)},get:function(t){return null==t?s.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=S.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return S.each(this,t)},map:function(i){return this.pushStack(S.map(this,function(t,e){return i.call(t,e,t)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,function(t,e){return(e+1)%2}))},odd:function(){return this.pushStack(S.grep(this,function(t,e){return e%2}))},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(0<=i&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:e.sort,splice:e.splice},S.extend=S.fn.extend=function(){var t,e,i,n,r,o,a=arguments[0]||{},s=1,c=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||b(a)||(a={}),s===c&&(a=this,s--);s<c;s++)if(null!=(t=arguments[s]))for(e in t)n=t[e],"__proto__"!==e&&a!==n&&(l&&n&&(S.isPlainObject(n)||(r=Array.isArray(n)))?(i=a[e],o=r&&!Array.isArray(i)?[]:r||S.isPlainObject(i)?i:{},r=!1,a[e]=S.extend(l,o,n)):void 0!==n&&(a[e]=n));return a},S.extend({expando:"jQuery"+(u+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,i;return!(!t||"[object Object]"!==o.call(t)||(e=n(t))&&("function"!=typeof(i=v.call(e,"constructor")&&e.constructor)||a.call(i)!==l))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,i){x(t,{nonce:e&&e.nonce},i)},each:function(t,e){var i,n=0;if(d(t))for(i=t.length;n<i&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},makeArray:function(t,e){var i=e||[];return null!=t&&(d(Object(t))?S.merge(i,"string"==typeof t?[t]:t):c.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:r.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,r=t.length;n<i;n++)t[r++]=e[n];return t.length=r,t},grep:function(t,e,i){for(var n=[],r=0,o=t.length,a=!i;r<o;r++)!e(t[r],r)!=a&&n.push(t[r]);return n},map:function(t,e,i){var n,r,o=0,a=[];if(d(t))for(n=t.length;o<n;o++)null!=(r=e(t[o],o,i))&&a.push(r);else for(o in t)null!=(r=e(t[o],o,i))&&a.push(r);return g(a)},guid:1,support:y}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=e[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){i["[object "+e+"]"]=e.toLowerCase()});var p=function(i){function u(t,e){var i="0x"+t.slice(1)-65536;return e||(i<0?String.fromCharCode(65536+i):String.fromCharCode(i>>10|55296,1023&i|56320))}function r(){E()}var t,p,x,o,a,f,d,m,w,c,l,E,M,s,_,g,h,v,y,S="sizzle"+ +new Date,b=i.document,A=0,n=0,T=ct(),C=ct(),L=ct(),P=ct(),R=function(t,e){return t===e&&(l=!0),0},I={}.hasOwnProperty,e=[],O=e.pop,D=e.push,k=e.push,N=e.slice,z=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},B="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",F="[\\x20\\t\\r\\n\\f]",U="(?:\\\\[\\da-fA-F]{1,6}"+F+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",j="\\["+F+"*("+U+")(?:"+F+"*([*^$|!~]?=)"+F+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+U+"))|)"+F+"*\\]",H=":("+U+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+j+")*)|.*)\\)|)",G=new RegExp(F+"+","g"),V=new RegExp("^"+F+"+|((?:^|[^\\\\])(?:\\\\.)*)"+F+"+$","g"),W=new RegExp("^"+F+"*,"+F+"*"),q=new RegExp("^"+F+"*([>+~]|"+F+")"+F+"*"),X=new RegExp(F+"|>"),Y=new RegExp(H),$=new RegExp("^"+U+"$"),Z={ID:new RegExp("^#("+U+")"),CLASS:new RegExp("^\\.("+U+")"),TAG:new RegExp("^("+U+"|[*])"),ATTR:new RegExp("^"+j),PSEUDO:new RegExp("^"+H),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+F+"*(even|odd|(([+-]|)(\\d*)n|)"+F+"*(?:([+-]|)"+F+"*(\\d+)|))"+F+"*\\)|)","i"),bool:new RegExp("^(?:"+B+")$","i"),needsContext:new RegExp("^"+F+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+F+"*((?:-\\d)?\\d*)"+F+"*\\)|)(?=[^-]|$)","i")},J=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,K=/^h\d$/i,tt=/^[^{]+\{\s*\[native \w/,et=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,it=/[+~]/,nt=new RegExp("\\\\[\\da-fA-F]{1,6}"+F+"?|\\\\([^\\r\\n\\f])","g"),rt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ot=function(t,e){return e?"\0"===t?"ï¿½":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},at=yt(function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{k.apply(e=N.call(b.childNodes),b.childNodes),e[b.childNodes.length].nodeType}catch(t){k={apply:e.length?function(t,e){D.apply(t,N.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}function st(t,e,i,n){var r,o,a,s,c,l,h,u=e&&e.ownerDocument,d=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==d&&9!==d&&11!==d)return i;if(!n&&(E(e),e=e||M,_)){if(11!==d&&(c=et.exec(t)))if(r=c[1]){if(9===d){if(!(a=e.getElementById(r)))return i;if(a.id===r)return i.push(a),i}else if(u&&(a=u.getElementById(r))&&y(e,a)&&a.id===r)return i.push(a),i}else{if(c[2])return k.apply(i,e.getElementsByTagName(t)),i;if((r=c[3])&&p.getElementsByClassName&&e.getElementsByClassName)return k.apply(i,e.getElementsByClassName(r)),i}if(p.qsa&&!P[t+" "]&&(!g||!g.test(t))&&(1!==d||"object"!==e.nodeName.toLowerCase())){if(h=t,u=e,1===d&&(X.test(t)||q.test(t))){for((u=it.test(t)&&mt(e.parentNode)||e)===e&&p.scope||((s=e.getAttribute("id"))?s=s.replace(rt,ot):e.setAttribute("id",s=S)),o=(l=f(t)).length;o--;)l[o]=(s?"#"+s:":scope")+" "+vt(l[o]);h=l.join(",")}try{return k.apply(i,u.querySelectorAll(h)),i}catch(e){P(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return m(t.replace(V,"$1"),e,i,n)}function ct(){var n=[];return function t(e,i){return n.push(e+" ")>x.cacheLength&&delete t[n.shift()],t[e+" "]=i}}function lt(t){return t[S]=!0,t}function ht(t){var e=M.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ut(t,e){for(var i=t.split("|"),n=i.length;n--;)x.attrHandle[i[n]]=e}function dt(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function pt(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&at(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function ft(a){return lt(function(o){return o=+o,lt(function(t,e){for(var i,n=a([],t.length,o),r=n.length;r--;)t[i=n[r]]&&(t[i]=!(e[i]=t[i]))})})}function mt(t){return t&&void 0!==t.getElementsByTagName&&t}for(t in p=st.support={},a=st.isXML=function(t){var e=t.namespaceURI,i=(t.ownerDocument||t).documentElement;return!J.test(e||i&&i.nodeName||"HTML")},E=st.setDocument=function(t){var e,i,n=t?t.ownerDocument||t:b;return n!=M&&9===n.nodeType&&n.documentElement&&(s=(M=n).documentElement,_=!a(M),b!=M&&(i=M.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",r,!1):i.attachEvent&&i.attachEvent("onunload",r)),p.scope=ht(function(t){return s.appendChild(t).appendChild(M.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length}),p.attributes=ht(function(t){return t.className="i",!t.getAttribute("className")}),p.getElementsByTagName=ht(function(t){return t.appendChild(M.createComment("")),!t.getElementsByTagName("*").length}),p.getElementsByClassName=tt.test(M.getElementsByClassName),p.getById=ht(function(t){return s.appendChild(t).id=S,!M.getElementsByName||!M.getElementsByName(S).length}),p.getById?(x.filter.ID=function(t){var e=t.replace(nt,u);return function(t){return t.getAttribute("id")===e}},x.find.ID=function(t,e){if(void 0!==e.getElementById&&_){var i=e.getElementById(t);return i?[i]:[]}}):(x.filter.ID=function(t){var i=t.replace(nt,u);return function(t){var e=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return e&&e.value===i}},x.find.ID=function(t,e){if(void 0!==e.getElementById&&_){var i,n,r,o=e.getElementById(t);if(o){if((i=o.getAttributeNode("id"))&&i.value===t)return[o];for(r=e.getElementsByName(t),n=0;o=r[n++];)if((i=o.getAttributeNode("id"))&&i.value===t)return[o]}return[]}}),x.find.TAG=p.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):p.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],r=0,o=e.getElementsByTagName(t);if("*"!==t)return o;for(;i=o[r++];)1===i.nodeType&&n.push(i);return n},x.find.CLASS=p.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&_)return e.getElementsByClassName(t)},h=[],g=[],(p.qsa=tt.test(M.querySelectorAll))&&(ht(function(t){var e;s.appendChild(t).innerHTML="<a id='"+S+"'></a><select id='"+S+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+F+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||g.push("\\["+F+"*(?:value|"+B+")"),t.querySelectorAll("[id~="+S+"-]").length||g.push("~="),(e=M.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||g.push("\\["+F+"*name"+F+"*="+F+"*(?:''|\"\")"),t.querySelectorAll(":checked").length||g.push(":checked"),t.querySelectorAll("a#"+S+"+*").length||g.push(".#.+[+~]"),t.querySelectorAll("\\\f"),g.push("[\\r\\n\\f]")}),ht(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=M.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&g.push("name"+F+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&g.push(":enabled",":disabled"),s.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&g.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),g.push(",.*:")})),(p.matchesSelector=tt.test(v=s.matches||s.webkitMatchesSelector||s.mozMatchesSelector||s.oMatchesSelector||s.msMatchesSelector))&&ht(function(t){p.disconnectedMatch=v.call(t,"*"),v.call(t,"[s!='']:x"),h.push("!=",H)}),g=g.length&&new RegExp(g.join("|")),h=h.length&&new RegExp(h.join("|")),e=tt.test(s.compareDocumentPosition),y=e||tt.test(s.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},R=e?function(t,e){if(t===e)return l=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!p.sortDetached&&e.compareDocumentPosition(t)===i?t==M||t.ownerDocument==b&&y(b,t)?-1:e==M||e.ownerDocument==b&&y(b,e)?1:c?z(c,t)-z(c,e):0:4&i?-1:1)}:function(t,e){if(t===e)return l=!0,0;var i,n=0,r=t.parentNode,o=e.parentNode,a=[t],s=[e];if(!r||!o)return t==M?-1:e==M?1:r?-1:o?1:c?z(c,t)-z(c,e):0;if(r===o)return dt(t,e);for(i=t;i=i.parentNode;)a.unshift(i);for(i=e;i=i.parentNode;)s.unshift(i);for(;a[n]===s[n];)n++;return n?dt(a[n],s[n]):a[n]==b?-1:s[n]==b?1:0}),M},st.matches=function(t,e){return st(t,null,null,e)},st.matchesSelector=function(t,e){if(E(t),p.matchesSelector&&_&&!P[e+" "]&&(!h||!h.test(e))&&(!g||!g.test(e)))try{var i=v.call(t,e);if(i||p.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){P(e,!0)}return 0<st(e,M,null,[t]).length},st.contains=function(t,e){return(t.ownerDocument||t)!=M&&E(t),y(t,e)},st.attr=function(t,e){(t.ownerDocument||t)!=M&&E(t);var i=x.attrHandle[e.toLowerCase()],n=i&&I.call(x.attrHandle,e.toLowerCase())?i(t,e,!_):void 0;return void 0!==n?n:p.attributes||!_?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},st.escape=function(t){return(t+"").replace(rt,ot)},st.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},st.uniqueSort=function(t){var e,i=[],n=0,r=0;if(l=!p.detectDuplicates,c=!p.sortStable&&t.slice(0),t.sort(R),l){for(;e=t[r++];)e===t[r]&&(n=i.push(r));for(;n--;)t.splice(i[n],1)}return c=null,t},o=st.getText=function(t){var e,i="",n=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=o(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[n++];)i+=o(e);return i},(x=st.selectors={cacheLength:50,createPseudo:lt,match:Z,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(nt,u),t[3]=(t[3]||t[4]||t[5]||"").replace(nt,u),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||st.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&st.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return Z.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&Y.test(i)&&(e=f(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(nt,u).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=T[t+" "];return e||(e=new RegExp("(^|"+F+")"+t+"("+F+"|$)"))&&T(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(i,n,r){return function(t){var e=st.attr(t,i);return null==e?"!="===n:!n||(e+="","="===n?e===r:"!="===n?e!==r:"^="===n?r&&0===e.indexOf(r):"*="===n?r&&-1<e.indexOf(r):"$="===n?r&&e.slice(-r.length)===r:"~="===n?-1<(" "+e.replace(G," ")+" ").indexOf(r):"|="===n&&(e===r||e.slice(0,r.length+1)===r+"-"))}},CHILD:function(f,t,e,m,g){var v="nth"!==f.slice(0,3),y="last"!==f.slice(-4),b="of-type"===t;return 1===m&&0===g?function(t){return!!t.parentNode}:function(t,e,i){var n,r,o,a,s,c,l=v!=y?"nextSibling":"previousSibling",h=t.parentNode,u=b&&t.nodeName.toLowerCase(),d=!i&&!b,p=!1;if(h){if(v){for(;l;){for(a=t;a=a[l];)if(b?a.nodeName.toLowerCase()===u:1===a.nodeType)return!1;c=l="only"===f&&!c&&"nextSibling"}return!0}if(c=[y?h.firstChild:h.lastChild],y&&d){for(p=(s=(n=(r=(o=(a=h)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[f]||[])[0]===A&&n[1])&&n[2],a=s&&h.childNodes[s];a=++s&&a&&a[l]||(p=s=0)||c.pop();)if(1===a.nodeType&&++p&&a===t){r[f]=[A,s,p];break}}else if(d&&(p=s=(n=(r=(o=(a=t)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[f]||[])[0]===A&&n[1]),!1===p)for(;(a=++s&&a&&a[l]||(p=s=0)||c.pop())&&((b?a.nodeName.toLowerCase()!==u:1!==a.nodeType)||!++p||(d&&((r=(o=a[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[f]=[A,p]),a!==t)););return(p-=g)===m||p%m==0&&0<=p/m}}},PSEUDO:function(t,o){var e,a=x.pseudos[t]||x.setFilters[t.toLowerCase()]||st.error("unsupported pseudo: "+t);return a[S]?a(o):1<a.length?(e=[t,t,"",o],x.setFilters.hasOwnProperty(t.toLowerCase())?lt(function(t,e){for(var i,n=a(t,o),r=n.length;r--;)t[i=z(t,n[r])]=!(e[i]=n[r])}):function(t){return a(t,0,e)}):a}},pseudos:{not:lt(function(t){var n=[],r=[],s=d(t.replace(V,"$1"));return s[S]?lt(function(t,e,i,n){for(var r,o=s(t,null,n,[]),a=t.length;a--;)(r=o[a])&&(t[a]=!(e[a]=r))}):function(t,e,i){return n[0]=t,s(n,null,i,r),n[0]=null,!r.pop()}}),has:lt(function(e){return function(t){return 0<st(e,t).length}}),contains:lt(function(e){return e=e.replace(nt,u),function(t){return-1<(t.textContent||o(t)).indexOf(e)}}),lang:lt(function(i){return $.test(i||"")||st.error("unsupported lang: "+i),i=i.replace(nt,u).toLowerCase(),function(t){var e;do{if(e=_?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(e=e.toLowerCase())===i||0===e.indexOf(i+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var e=i.location&&i.location.hash;return e&&e.slice(1)===t.id},root:function(t){return t===s},focus:function(t){return t===M.activeElement&&(!M.hasFocus||M.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:pt(!1),disabled:pt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!x.pseudos.empty(t)},header:function(t){return K.test(t.nodeName)},input:function(t){return Q.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:ft(function(){return[0]}),last:ft(function(t,e){return[e-1]}),eq:ft(function(t,e,i){return[i<0?i+e:i]}),even:ft(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:ft(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:ft(function(t,e,i){for(var n=i<0?i+e:e<i?e:i;0<=--n;)t.push(n);return t}),gt:ft(function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t})}}).pseudos.nth=x.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[t]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(t);for(t in{submit:!0,reset:!0})x.pseudos[t]=function(i){return function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&t.type===i}}(t);function gt(){}function vt(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function yt(s,t,e){var c=t.dir,l=t.next,h=l||c,u=e&&"parentNode"===h,d=n++;return t.first?function(t,e,i){for(;t=t[c];)if(1===t.nodeType||u)return s(t,e,i);return!1}:function(t,e,i){var n,r,o,a=[A,d];if(i){for(;t=t[c];)if((1===t.nodeType||u)&&s(t,e,i))return!0}else for(;t=t[c];)if(1===t.nodeType||u)if(r=(o=t[S]||(t[S]={}))[t.uniqueID]||(o[t.uniqueID]={}),l&&l===t.nodeName.toLowerCase())t=t[c]||t;else{if((n=r[h])&&n[0]===A&&n[1]===d)return a[2]=n[2];if((r[h]=a)[2]=s(t,e,i))return!0}return!1}}function bt(r){return 1<r.length?function(t,e,i){for(var n=r.length;n--;)if(!r[n](t,e,i))return!1;return!0}:r[0]}function xt(t,e,i,n,r){for(var o,a=[],s=0,c=t.length,l=null!=e;s<c;s++)(o=t[s])&&(i&&!i(o,n,r)||(a.push(o),l&&e.push(s)));return a}function wt(t){for(var r,e,i,n=t.length,o=x.relative[t[0].type],a=o||x.relative[" "],s=o?1:0,c=yt(function(t){return t===r},a,!0),l=yt(function(t){return-1<z(r,t)},a,!0),h=[function(t,e,i){var n=!o&&(i||e!==w)||((r=e).nodeType?c:l)(t,e,i);return r=null,n}];s<n;s++)if(e=x.relative[t[s].type])h=[yt(bt(h),e)];else{if((e=x.filter[t[s].type].apply(null,t[s].matches))[S]){for(i=++s;i<n&&!x.relative[t[i].type];i++);return function t(p,f,m,g,v,e){return g&&!g[S]&&(g=t(g)),v&&!v[S]&&(v=t(v,e)),lt(function(t,e,i,n){var r,o,a,s=[],c=[],l=e.length,h=t||function(t,e,i){for(var n=0,r=e.length;n<r;n++)st(t,e[n],i);return i}(f||"*",i.nodeType?[i]:i,[]),u=!p||!t&&f?h:xt(h,s,p,i,n),d=m?v||(t?p:l||g)?[]:e:u;if(m&&m(u,d,i,n),g)for(r=xt(d,c),g(r,[],i,n),o=r.length;o--;)(a=r[o])&&(d[c[o]]=!(u[c[o]]=a));if(t){if(v||p){if(v){for(r=[],o=d.length;o--;)(a=d[o])&&r.push(u[o]=a);v(null,d=[],r,n)}for(o=d.length;o--;)(a=d[o])&&-1<(r=v?z(t,a):s[o])&&(t[r]=!(e[r]=a))}}else d=xt(d===e?d.splice(l,d.length):d),v?v(null,e,d,n):k.apply(e,d)})}(1<s&&bt(h),1<s&&vt(t.slice(0,s-1).concat({value:" "===t[s-2].type?"*":""})).replace(V,"$1"),e,s<i&&wt(t.slice(s,i)),i<n&&wt(t=t.slice(i)),i<n&&vt(t))}h.push(e)}return bt(h)}return gt.prototype=x.filters=x.pseudos,x.setFilters=new gt,f=st.tokenize=function(t,e){var i,n,r,o,a,s,c,l=C[t+" "];if(l)return e?0:l.slice(0);for(a=t,s=[],c=x.preFilter;a;){for(o in i&&!(n=W.exec(a))||(n&&(a=a.slice(n[0].length)||a),s.push(r=[])),i=!1,(n=q.exec(a))&&(i=n.shift(),r.push({value:i,type:n[0].replace(V," ")}),a=a.slice(i.length)),x.filter)!(n=Z[o].exec(a))||c[o]&&!(n=c[o](n))||(i=n.shift(),r.push({value:i,type:o,matches:n}),a=a.slice(i.length));if(!i)break}return e?a.length:a?st.error(t):C(t,s).slice(0)},d=st.compile=function(t,e){var i,g,v,y,b,n,r=[],o=[],a=L[t+" "];if(!a){for(i=(e=e||f(t)).length;i--;)(a=wt(e[i]))[S]?r.push(a):o.push(a);(a=L(t,(g=o,y=0<(v=r).length,b=0<g.length,n=function(t,e,i,n,r){var o,a,s,c=0,l="0",h=t&&[],u=[],d=w,p=t||b&&x.find.TAG("*",r),f=A+=null==d?1:Math.random()||.1,m=p.length;for(r&&(w=e==M||e||r);l!==m&&null!=(o=p[l]);l++){if(b&&o){for(a=0,e||o.ownerDocument==M||(E(o),i=!_);s=g[a++];)if(s(o,e||M,i)){n.push(o);break}r&&(A=f)}y&&((o=!s&&o)&&c--,t&&h.push(o))}if(c+=l,y&&l!==c){for(a=0;s=v[a++];)s(h,u,e,i);if(t){if(0<c)for(;l--;)h[l]||u[l]||(u[l]=O.call(n));u=xt(u)}k.apply(n,u),r&&!t&&0<u.length&&1<c+v.length&&st.uniqueSort(n)}return r&&(A=f,w=d),h},y?lt(n):n))).selector=t}return a},m=st.select=function(t,e,i,n){var r,o,a,s,c,l="function"==typeof t&&t,h=!n&&f(t=l.selector||t);if(i=i||[],1===h.length){if(2<(o=h[0]=h[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===e.nodeType&&_&&x.relative[o[1].type]){if(!(e=(x.find.ID(a.matches[0].replace(nt,u),e)||[])[0]))return i;l&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(r=Z.needsContext.test(t)?0:o.length;r--&&(a=o[r],!x.relative[s=a.type]);)if((c=x.find[s])&&(n=c(a.matches[0].replace(nt,u),it.test(o[0].type)&&mt(e.parentNode)||e))){if(o.splice(r,1),!(t=n.length&&vt(o)))return k.apply(i,n),i;break}}return(l||d(t,h))(n,e,!_,i,!e||it.test(t)&&mt(e.parentNode)||e),i},p.sortStable=S.split("").sort(R).join("")===S,p.detectDuplicates=!!l,E(),p.sortDetached=ht(function(t){return 1&t.compareDocumentPosition(M.createElement("fieldset"))}),ht(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||ut("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),p.attributes&&ht(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||ut("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),ht(function(t){return null==t.getAttribute("disabled")})||ut(B,function(t,e,i){var n;if(!i)return!0===t[e]?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),st}(M);S.find=p,S.expr=p.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=p.uniqueSort,S.text=p.getText,S.isXMLDoc=p.isXML,S.contains=p.contains,S.escapeSelector=p.escape;function f(t,e,i){for(var n=[],r=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&S(t).is(i))break;n.push(t)}return n}function E(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}var A=S.expr.match.needsContext;function T(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var C=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function L(t,i,n){return b(i)?S.grep(t,function(t,e){return!!i.call(t,e,t)!==n}):i.nodeType?S.grep(t,function(t){return t===i!==n}):"string"!=typeof i?S.grep(t,function(t){return-1<r.call(i,t)!==n}):S.filter(i,t,n)}S.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?S.find.matchesSelector(n,t)?[n]:[]:S.find.matches(t,S.grep(e,function(t){return 1===t.nodeType}))},S.fn.extend({find:function(t){var e,i,n=this.length,r=this;if("string"!=typeof t)return this.pushStack(S(t).filter(function(){for(e=0;e<n;e++)if(S.contains(r[e],this))return!0}));for(i=this.pushStack([]),e=0;e<n;e++)S.find(t,r[e],i);return 1<n?S.uniqueSort(i):i},filter:function(t){return this.pushStack(L(this,t||[],!1))},not:function(t){return this.pushStack(L(this,t||[],!0))},is:function(t){return!!L(this,"string"==typeof t&&A.test(t)?S(t):t||[],!1).length}});var P,R=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(t,e,i){var n,r;if(!t)return this;if(i=i||P,"string"!=typeof t)return t.nodeType?(this[0]=t,this.length=1,this):b(t)?void 0!==i.ready?i.ready(t):t(S):S.makeArray(t,this);if(!(n="<"===t[0]&&">"===t[t.length-1]&&3<=t.length?[null,t,null]:R.exec(t))||!n[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof S?e[0]:e,S.merge(this,S.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:_,!0)),C.test(n[1])&&S.isPlainObject(e))for(n in e)b(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return(r=_.getElementById(n[2]))&&(this[0]=r,this.length=1),this}).prototype=S.fn,P=S(_);var I=/^(?:parents|prev(?:Until|All))/,O={children:!0,contents:!0,next:!0,prev:!0};function D(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}S.fn.extend({has:function(t){var e=S(t,this),i=e.length;return this.filter(function(){for(var t=0;t<i;t++)if(S.contains(this,e[t]))return!0})},closest:function(t,e){var i,n=0,r=this.length,o=[],a="string"!=typeof t&&S(t);if(!A.test(t))for(;n<r;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(a?-1<a.index(i):1===i.nodeType&&S.find.matchesSelector(i,t))){o.push(i);break}return this.pushStack(1<o.length?S.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?r.call(S(t),this[0]):r.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),S.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return f(t,"parentNode")},parentsUntil:function(t,e,i){return f(t,"parentNode",i)},next:function(t){return D(t,"nextSibling")},prev:function(t){return D(t,"previousSibling")},nextAll:function(t){return f(t,"nextSibling")},prevAll:function(t){return f(t,"previousSibling")},nextUntil:function(t,e,i){return f(t,"nextSibling",i)},prevUntil:function(t,e,i){return f(t,"previousSibling",i)},siblings:function(t){return E((t.parentNode||{}).firstChild,t)},children:function(t){return E(t.firstChild)},contents:function(t){return null!=t.contentDocument&&n(t.contentDocument)?t.contentDocument:(T(t,"template")&&(t=t.content||t),S.merge([],t.childNodes))}},function(n,r){S.fn[n]=function(t,e){var i=S.map(this,r,t);return"Until"!==n.slice(-5)&&(e=t),e&&"string"==typeof e&&(i=S.filter(e,i)),1<this.length&&(O[n]||S.uniqueSort(i),I.test(n)&&i.reverse()),this.pushStack(i)}});var k=/[^\x20\t\r\n\f]+/g;function N(t){return t}function z(t){throw t}function B(t,e,i,n){var r;try{t&&b(r=t.promise)?r.call(t).done(e).fail(i):t&&b(r=t.then)?r.call(t,e,i):e.apply(void 0,[t].slice(n))}catch(t){i.apply(void 0,[t])}}S.Callbacks=function(n){var i;n="string"==typeof n?(i={},S.each(n.match(k)||[],function(t,e){i[e]=!0}),i):S.extend({},n);function r(){for(a=a||n.once,e=o=!0;c.length;l=-1)for(t=c.shift();++l<s.length;)!1===s[l].apply(t[0],t[1])&&n.stopOnFalse&&(l=s.length,t=!1);n.memory||(t=!1),o=!1,a&&(s=t?[]:"")}var o,t,e,a,s=[],c=[],l=-1,h={add:function(){return s&&(t&&!o&&(l=s.length-1,c.push(t)),function i(t){S.each(t,function(t,e){b(e)?n.unique&&h.has(e)||s.push(e):e&&e.length&&"string"!==w(e)&&i(e)})}(arguments),t&&!o&&r()),this},remove:function(){return S.each(arguments,function(t,e){for(var i;-1<(i=S.inArray(e,s,i));)s.splice(i,1),i<=l&&l--}),this},has:function(t){return t?-1<S.inArray(t,s):0<s.length},empty:function(){return s=s&&[],this},disable:function(){return a=c=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=c=[],t||o||(s=t=""),this},locked:function(){return!!a},fireWith:function(t,e){return a||(e=[t,(e=e||[]).slice?e.slice():e],c.push(e),o||r()),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!e}};return h},S.extend({Deferred:function(t){var o=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],r="pending",a={state:function(){return r},always:function(){return s.done(arguments).fail(arguments),this},catch:function(t){return a.then(null,t)},pipe:function(){var r=arguments;return S.Deferred(function(n){S.each(o,function(t,e){var i=b(r[e[4]])&&r[e[4]];s[e[1]](function(){var t=i&&i.apply(this,arguments);t&&b(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[e[0]+"With"](this,i?[t]:arguments)})}),r=null}).promise()},then:function(e,i,n){var c=0;function l(r,o,a,s){return function(){function t(){var t,e;if(!(r<c)){if((t=a.apply(i,n))===o.promise())throw new TypeError("Thenable self-resolution");e=t&&("object"==typeof t||"function"==typeof t)&&t.then,b(e)?s?e.call(t,l(c,o,N,s),l(c,o,z,s)):(c++,e.call(t,l(c,o,N,s),l(c,o,z,s),l(c,o,N,o.notifyWith))):(a!==N&&(i=void 0,n=[t]),(s||o.resolveWith)(i,n))}}var i=this,n=arguments,e=s?t:function(){try{t()}catch(t){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(t,e.stackTrace),c<=r+1&&(a!==z&&(i=void 0,n=[t]),o.rejectWith(i,n))}};r?e():(S.Deferred.getStackHook&&(e.stackTrace=S.Deferred.getStackHook()),M.setTimeout(e))}}return S.Deferred(function(t){o[0][3].add(l(0,t,b(n)?n:N,t.notifyWith)),o[1][3].add(l(0,t,b(e)?e:N)),o[2][3].add(l(0,t,b(i)?i:z))}).promise()},promise:function(t){return null!=t?S.extend(t,a):a}},s={};return S.each(o,function(t,e){var i=e[2],n=e[5];a[e[1]]=i.add,n&&i.add(function(){r=n},o[3-t][2].disable,o[3-t][3].disable,o[0][2].lock,o[0][3].lock),i.add(e[3].fire),s[e[0]]=function(){return s[e[0]+"With"](this===s?void 0:this,arguments),this},s[e[0]+"With"]=i.fireWith}),a.promise(s),t&&t.call(s,s),s},when:function(t){function e(e){return function(t){r[e]=this,o[e]=1<arguments.length?s.call(arguments):t,--i||a.resolveWith(r,o)}}var i=arguments.length,n=i,r=Array(n),o=s.call(arguments),a=S.Deferred();if(i<=1&&(B(t,a.done(e(n)).resolve,a.reject,!i),"pending"===a.state()||b(o[n]&&o[n].then)))return a.then();for(;n--;)B(o[n],e(n),a.reject);return a.promise()}});var F=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(t,e){M.console&&M.console.warn&&t&&F.test(t.name)&&M.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},S.readyException=function(t){M.setTimeout(function(){throw t})};var U=S.Deferred();function j(){_.removeEventListener("DOMContentLoaded",j),M.removeEventListener("load",j),S.ready()}S.fn.ready=function(t){return U.then(t).catch(function(t){S.readyException(t)}),this},S.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--S.readyWait:S.isReady)||(S.isReady=!0)!==t&&0<--S.readyWait||U.resolveWith(_,[S])}}),S.ready.then=U.then,"complete"===_.readyState||"loading"!==_.readyState&&!_.documentElement.doScroll?M.setTimeout(S.ready):(_.addEventListener("DOMContentLoaded",j),M.addEventListener("load",j));var H=function(t,e,i,n,r,o,a){var s=0,c=t.length,l=null==i;if("object"===w(i))for(s in r=!0,i)H(t,e,s,i[s],!0,o,a);else if(void 0!==n&&(r=!0,b(n)||(a=!0),l&&(e=a?(e.call(t,n),null):(l=e,function(t,e,i){return l.call(S(t),i)})),e))for(;s<c;s++)e(t[s],i,a?n:n.call(t[s],s,e(t[s],i)));return r?t:l?e.call(t):c?e(t[0],i):o},G=/^-ms-/,V=/-([a-z])/g;function W(t,e){return e.toUpperCase()}function q(t){return t.replace(G,"ms-").replace(V,W)}function X(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType}function Y(){this.expando=S.expando+Y.uid++}Y.uid=1,Y.prototype={cache:function(t){var e=t[this.expando];return e||(e={},X(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var n,r=this.cache(t);if("string"==typeof e)r[q(e)]=i;else for(n in e)r[q(n)]=e[n];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][q(e)]},access:function(t,e,i){return void 0===e||e&&"string"==typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n=t[this.expando];if(void 0!==n){if(void 0!==e){i=(e=Array.isArray(e)?e.map(q):(e=q(e))in n?[e]:e.match(k)||[]).length;for(;i--;)delete n[e[i]]}void 0!==e&&!S.isEmptyObject(n)||(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!S.isEmptyObject(e)}};var $=new Y,Z=new Y,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Q=/[A-Z]/g;function K(t,e,i){var n,r;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(Q,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(n))){try{i="true"===(r=i)||"false"!==r&&("null"===r?null:r===+r+""?+r:J.test(r)?JSON.parse(r):r)}catch(t){}Z.set(t,e,i)}else i=void 0;return i}S.extend({hasData:function(t){return Z.hasData(t)||$.hasData(t)},data:function(t,e,i){return Z.access(t,e,i)},removeData:function(t,e){Z.remove(t,e)},_data:function(t,e,i){return $.access(t,e,i)},_removeData:function(t,e){$.remove(t,e)}}),S.fn.extend({data:function(i,t){var e,n,r,o=this[0],a=o&&o.attributes;if(void 0!==i)return"object"==typeof i?this.each(function(){Z.set(this,i)}):H(this,function(t){var e;return o&&void 0===t?void 0!==(e=Z.get(o,i))||void 0!==(e=K(o,i))?e:void 0:void this.each(function(){Z.set(this,i,t)})},null,t,1<arguments.length,null,!0);if(this.length&&(r=Z.get(o),1===o.nodeType&&!$.get(o,"hasDataAttrs"))){for(e=a.length;e--;)a[e]&&0===(n=a[e].name).indexOf("data-")&&(n=q(n.slice(5)),K(o,n,r[n]));$.set(o,"hasDataAttrs",!0)}return r},removeData:function(t){return this.each(function(){Z.remove(this,t)})}}),S.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=$.get(t,e),i&&(!n||Array.isArray(i)?n=$.access(t,e,S.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=S.queue(t,e),n=i.length,r=i.shift(),o=S._queueHooks(t,e);"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete o.stop,r.call(t,function(){S.dequeue(t,e)},o)),!n&&o&&o.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return $.get(t,i)||$.access(t,i,{empty:S.Callbacks("once memory").add(function(){$.remove(t,[e+"queue",i])})})}}),S.fn.extend({queue:function(e,i){var t=2;return"string"!=typeof e&&(i=e,e="fx",t--),arguments.length<t?S.queue(this[0],e):void 0===i?this:this.each(function(){var t=S.queue(this,e,i);S._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&S.dequeue(this,e)})},dequeue:function(t){return this.each(function(){S.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){function i(){--r||o.resolveWith(a,[a])}var n,r=1,o=S.Deferred(),a=this,s=this.length;for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(n=$.get(a[s],t+"queueHooks"))&&n.empty&&(r++,n.empty.add(i));return i(),o.promise(e)}});var tt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,et=new RegExp("^(?:([+-])=|)("+tt+")([a-z%]*)$","i"),it=["Top","Right","Bottom","Left"],nt=_.documentElement,rt=function(t){return S.contains(t.ownerDocument,t)},ot={composed:!0};nt.getRootNode&&(rt=function(t){return S.contains(t.ownerDocument,t)||t.getRootNode(ot)===t.ownerDocument});function at(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&rt(t)&&"none"===S.css(t,"display")}function st(t,e,i,n){var r,o,a=20,s=n?function(){return n.cur()}:function(){return S.css(t,e,"")},c=s(),l=i&&i[3]||(S.cssNumber[e]?"":"px"),h=t.nodeType&&(S.cssNumber[e]||"px"!==l&&+c)&&et.exec(S.css(t,e));if(h&&h[3]!==l){for(c/=2,l=l||h[3],h=+c||1;a--;)S.style(t,e,h+l),(1-o)*(1-(o=s()/c||.5))<=0&&(a=0),h/=o;h*=2,S.style(t,e,h+l),i=i||[]}return i&&(h=+h||+c||0,r=i[1]?h+(i[1]+1)*i[2]:+i[2],n&&(n.unit=l,n.start=h,n.end=r)),r}var ct={};function lt(t,e){for(var i,n,r,o,a,s,c=[],l=0,h=t.length;l<h;l++)(n=t[l]).style&&(i=n.style.display,e?("none"===i&&(c[l]=$.get(n,"display")||null,c[l]||(n.style.display="")),""===n.style.display&&at(n)&&(c[l]=(s=o=r=void 0,o=n.ownerDocument,a=n.nodeName,(s=ct[a])||(r=o.body.appendChild(o.createElement(a)),s=S.css(r,"display"),r.parentNode.removeChild(r),"none"===s&&(s="block"),ct[a]=s)))):"none"!==i&&(c[l]="none",$.set(n,"display",i)));for(l=0;l<h;l++)null!=c[l]&&(t[l].style.display=c[l]);return t}S.fn.extend({show:function(){return lt(this,!0)},hide:function(){return lt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){at(this)?S(this).show():S(this).hide()})}});var ht,ut=/^(?:checkbox|radio)$/i,dt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,pt=/^$|^module$|\/(?:java|ecma)script/i,ft=_.createDocumentFragment().appendChild(_.createElement("div"));(ht=_.createElement("input")).setAttribute("type","radio"),ht.setAttribute("checked","checked"),ht.setAttribute("name","t"),ft.appendChild(ht),y.checkClone=ft.cloneNode(!0).cloneNode(!0).lastChild.checked,ft.innerHTML="<textarea>x</textarea>",y.noCloneChecked=!!ft.cloneNode(!0).lastChild.defaultValue,ft.innerHTML="<option></option>",y.option=!!ft.lastChild;var mt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function gt(t,e){var i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&T(t,e)?S.merge([t],i):i}function vt(t,e){for(var i=0,n=t.length;i<n;i++)$.set(t[i],"globalEval",!e||$.get(e[i],"globalEval"))}mt.tbody=mt.tfoot=mt.colgroup=mt.caption=mt.thead,mt.th=mt.td,y.option||(mt.optgroup=mt.option=[1,"<select multiple='multiple'>","</select>"]);var yt=/<|&#?\w+;/;function bt(t,e,i,n,r){for(var o,a,s,c,l,h,u=e.createDocumentFragment(),d=[],p=0,f=t.length;p<f;p++)if((o=t[p])||0===o)if("object"===w(o))S.merge(d,o.nodeType?[o]:o);else if(yt.test(o)){for(a=a||u.appendChild(e.createElement("div")),s=(dt.exec(o)||["",""])[1].toLowerCase(),c=mt[s]||mt._default,a.innerHTML=c[1]+S.htmlPrefilter(o)+c[2],h=c[0];h--;)a=a.lastChild;S.merge(d,a.childNodes),(a=u.firstChild).textContent=""}else d.push(e.createTextNode(o));for(u.textContent="",p=0;o=d[p++];)if(n&&-1<S.inArray(o,n))r&&r.push(o);else if(l=rt(o),a=gt(u.appendChild(o),"script"),l&&vt(a),i)for(h=0;o=a[h++];)pt.test(o.type||"")&&i.push(o);return u}var xt=/^key/,wt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Et=/^([^.]*)(?:\.(.+)|)/;function Mt(){return!0}function _t(){return!1}function St(t,e){return t===function(){try{return _.activeElement}catch(t){}}()==("focus"===e)}function At(t,e,i,n,r,o){var a,s;if("object"==typeof e){for(s in"string"!=typeof i&&(n=n||i,i=void 0),e)At(t,s,i,n,e[s],o);return t}if(null==n&&null==r?(r=i,n=i=void 0):null==r&&("string"==typeof i?(r=n,n=void 0):(r=n,n=i,i=void 0)),!1===r)r=_t;else if(!r)return t;return 1===o&&(a=r,(r=function(t){return S().off(t),a.apply(this,arguments)}).guid=a.guid||(a.guid=S.guid++)),t.each(function(){S.event.add(this,e,r,n,i)})}function Tt(t,r,o){o?($.set(t,r,!1),S.event.add(t,r,{namespace:!1,handler:function(t){var e,i,n=$.get(this,r);if(1&t.isTrigger&&this[r]){if(n.length)(S.event.special[r]||{}).delegateType&&t.stopPropagation();else if(n=s.call(arguments),$.set(this,r,n),e=o(this,r),this[r](),n!==(i=$.get(this,r))||e?$.set(this,r,!1):i={},n!==i)return t.stopImmediatePropagation(),t.preventDefault(),i.value}else n.length&&($.set(this,r,{value:S.event.trigger(S.extend(n[0],S.Event.prototype),n.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===$.get(t,r)&&S.event.add(t,r,Mt)}S.event={global:{},add:function(e,t,i,n,r){var o,a,s,c,l,h,u,d,p,f,m,g=$.get(e);if(X(e))for(i.handler&&(i=(o=i).handler,r=o.selector),r&&S.find.matchesSelector(nt,r),i.guid||(i.guid=S.guid++),(c=g.events)||(c=g.events=Object.create(null)),(a=g.handle)||(a=g.handle=function(t){return void 0!==S&&S.event.triggered!==t.type?S.event.dispatch.apply(e,arguments):void 0}),l=(t=(t||"").match(k)||[""]).length;l--;)p=m=(s=Et.exec(t[l])||[])[1],f=(s[2]||"").split(".").sort(),p&&(u=S.event.special[p]||{},p=(r?u.delegateType:u.bindType)||p,u=S.event.special[p]||{},h=S.extend({type:p,origType:m,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&S.expr.match.needsContext.test(r),namespace:f.join(".")},o),(d=c[p])||((d=c[p]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(e,n,f,a)||e.addEventListener&&e.addEventListener(p,a)),u.add&&(u.add.call(e,h),h.handler.guid||(h.handler.guid=i.guid)),r?d.splice(d.delegateCount++,0,h):d.push(h),S.event.global[p]=!0)},remove:function(t,e,i,n,r){var o,a,s,c,l,h,u,d,p,f,m,g=$.hasData(t)&&$.get(t);if(g&&(c=g.events)){for(l=(e=(e||"").match(k)||[""]).length;l--;)if(p=m=(s=Et.exec(e[l])||[])[1],f=(s[2]||"").split(".").sort(),p){for(u=S.event.special[p]||{},d=c[p=(n?u.delegateType:u.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=d.length;o--;)h=d[o],!r&&m!==h.origType||i&&i.guid!==h.guid||s&&!s.test(h.namespace)||n&&n!==h.selector&&("**"!==n||!h.selector)||(d.splice(o,1),h.selector&&d.delegateCount--,u.remove&&u.remove.call(t,h));a&&!d.length&&(u.teardown&&!1!==u.teardown.call(t,f,g.handle)||S.removeEvent(t,p,g.handle),delete c[p])}else for(p in c)S.event.remove(t,p+e[l],i,n,!0);S.isEmptyObject(c)&&$.remove(t,"handle events")}},dispatch:function(t){var e,i,n,r,o,a,s=new Array(arguments.length),c=S.event.fix(t),l=($.get(this,"events")||Object.create(null))[c.type]||[],h=S.event.special[c.type]||{};for(s[0]=c,e=1;e<arguments.length;e++)s[e]=arguments[e];if(c.delegateTarget=this,!h.preDispatch||!1!==h.preDispatch.call(this,c)){for(a=S.event.handlers.call(this,c,l),e=0;(r=a[e++])&&!c.isPropagationStopped();)for(c.currentTarget=r.elem,i=0;(o=r.handlers[i++])&&!c.isImmediatePropagationStopped();)c.rnamespace&&!1!==o.namespace&&!c.rnamespace.test(o.namespace)||(c.handleObj=o,c.data=o.data,void 0!==(n=((S.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,s))&&!1===(c.result=n)&&(c.preventDefault(),c.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,c),c.result}},handlers:function(t,e){var i,n,r,o,a,s=[],c=e.delegateCount,l=t.target;if(c&&l.nodeType&&!("click"===t.type&&1<=t.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==t.type||!0!==l.disabled)){for(o=[],a={},i=0;i<c;i++)void 0===a[r=(n=e[i]).selector+" "]&&(a[r]=n.needsContext?-1<S(r,this).index(l):S.find(r,this,null,[l]).length),a[r]&&o.push(n);o.length&&s.push({elem:l,handlers:o})}return l=this,c<e.length&&s.push({elem:l,handlers:e.slice(c)}),s},addProp:function(e,t){Object.defineProperty(S.Event.prototype,e,{enumerable:!0,configurable:!0,get:b(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(t){return t[S.expando]?t:new S.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return ut.test(e.type)&&e.click&&T(e,"input")&&Tt(e,"click",Mt),!1},trigger:function(t){var e=this||t;return ut.test(e.type)&&e.click&&T(e,"input")&&Tt(e,"click"),!0},_default:function(t){var e=t.target;return ut.test(e.type)&&e.click&&T(e,"input")&&$.get(e,"click")||T(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},S.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},S.Event=function(t,e){if(!(this instanceof S.Event))return new S.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Mt:_t,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&S.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:_t,isPropagationStopped:_t,isImmediatePropagationStopped:_t,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=Mt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=Mt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=Mt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&xt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&wt.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},S.event.addProp),S.each({focus:"focusin",blur:"focusout"},function(t,e){S.event.special[t]={setup:function(){return Tt(this,t,St),!1},trigger:function(){return Tt(this,t),!0},delegateType:e}}),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,r){S.event.special[t]={delegateType:r,bindType:r,handle:function(t){var e,i=t.relatedTarget,n=t.handleObj;return i&&(i===this||S.contains(this,i))||(t.type=n.origType,e=n.handler.apply(this,arguments),t.type=r),e}}}),S.fn.extend({on:function(t,e,i,n){return At(this,t,e,i,n)},one:function(t,e,i,n){return At(this,t,e,i,n,1)},off:function(t,e,i){var n,r;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,S(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"!=typeof t)return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=_t),this.each(function(){S.event.remove(this,t,i,e)});for(r in t)this.off(r,e,t[r]);return this}});var Ct=/<script|<style|<link/i,Lt=/checked\s*(?:[^=]|=\s*.checked.)/i,Pt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Rt(t,e){return T(t,"table")&&T(11!==e.nodeType?e:e.firstChild,"tr")&&S(t).children("tbody")[0]||t}function It(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Ot(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Dt(t,e){var i,n,r,o,a,s;if(1===e.nodeType){if($.hasData(t)&&(s=$.get(t).events))for(r in $.remove(e,"handle events"),s)for(i=0,n=s[r].length;i<n;i++)S.event.add(e,r,s[r][i]);Z.hasData(t)&&(o=Z.access(t),a=S.extend({},o),Z.set(e,a))}}function kt(i,n,r,o){n=g(n);var t,e,a,s,c,l,h=0,u=i.length,d=u-1,p=n[0],f=b(p);if(f||1<u&&"string"==typeof p&&!y.checkClone&&Lt.test(p))return i.each(function(t){var e=i.eq(t);f&&(n[0]=p.call(this,t,e.html())),kt(e,n,r,o)});if(u&&(e=(t=bt(n,i[0].ownerDocument,!1,i,o)).firstChild,1===t.childNodes.length&&(t=e),e||o)){for(s=(a=S.map(gt(t,"script"),It)).length;h<u;h++)c=t,h!==d&&(c=S.clone(c,!0,!0),s&&S.merge(a,gt(c,"script"))),r.call(i[h],c,h);if(s)for(l=a[a.length-1].ownerDocument,S.map(a,Ot),h=0;h<s;h++)c=a[h],pt.test(c.type||"")&&!$.access(c,"globalEval")&&S.contains(l,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?S._evalUrl&&!c.noModule&&S._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},l):x(c.textContent.replace(Pt,""),c,l))}return i}function Nt(t,e,i){for(var n,r=e?S.filter(e,t):t,o=0;null!=(n=r[o]);o++)i||1!==n.nodeType||S.cleanData(gt(n)),n.parentNode&&(i&&rt(n)&&vt(gt(n,"script")),n.parentNode.removeChild(n));return t}S.extend({htmlPrefilter:function(t){return t},clone:function(t,e,i){var n,r,o,a,s,c,l,h=t.cloneNode(!0),u=rt(t);if(!(y.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||S.isXMLDoc(t)))for(a=gt(h),n=0,r=(o=gt(t)).length;n<r;n++)s=o[n],"input"===(l=(c=a[n]).nodeName.toLowerCase())&&ut.test(s.type)?c.checked=s.checked:"input"!==l&&"textarea"!==l||(c.defaultValue=s.defaultValue);if(e)if(i)for(o=o||gt(t),a=a||gt(h),n=0,r=o.length;n<r;n++)Dt(o[n],a[n]);else Dt(t,h);return 0<(a=gt(h,"script")).length&&vt(a,!u&&gt(t,"script")),h},cleanData:function(t){for(var e,i,n,r=S.event.special,o=0;void 0!==(i=t[o]);o++)if(X(i)){if(e=i[$.expando]){if(e.events)for(n in e.events)r[n]?S.event.remove(i,n):S.removeEvent(i,n,e.handle);i[$.expando]=void 0}i[Z.expando]&&(i[Z.expando]=void 0)}}}),S.fn.extend({detach:function(t){return Nt(this,t,!0)},remove:function(t){return Nt(this,t)},text:function(t){return H(this,function(t){return void 0===t?S.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return kt(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Rt(this,t).appendChild(t)})},prepend:function(){return kt(this,arguments,function(t){var e;1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(e=Rt(this,t)).insertBefore(t,e.firstChild)})},before:function(){return kt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return kt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(S.cleanData(gt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return S.clone(this,t,e)})},html:function(t){return H(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Ct.test(t)&&!mt[(dt.exec(t)||["",""])[1].toLowerCase()]){t=S.htmlPrefilter(t);try{for(;i<n;i++)1===(e=this[i]||{}).nodeType&&(S.cleanData(gt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var i=[];return kt(this,arguments,function(t){var e=this.parentNode;S.inArray(this,i)<0&&(S.cleanData(gt(this)),e&&e.replaceChild(t,this))},i)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,a){S.fn[t]=function(t){for(var e,i=[],n=S(t),r=n.length-1,o=0;o<=r;o++)e=o===r?this:this.clone(!0),S(n[o])[a](e),c.apply(i,e.get());return this.pushStack(i)}});function zt(t,e,i){var n,r,o={};for(r in e)o[r]=t.style[r],t.style[r]=e[r];for(r in n=i.call(t),e)t.style[r]=o[r];return n}var Bt,Ft,Ut,jt,Ht,Gt,Vt,Wt,qt=new RegExp("^("+tt+")(?!px)[a-z%]+$","i"),Xt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=M),e.getComputedStyle(t)},Yt=new RegExp(it.join("|"),"i");function $t(t,e,i){var n,r,o,a,s=t.style;return(i=i||Xt(t))&&(""!==(a=i.getPropertyValue(e)||i[e])||rt(t)||(a=S.style(t,e)),!y.pixelBoxStyles()&&qt.test(a)&&Yt.test(e)&&(n=s.width,r=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=i.width,s.width=n,s.minWidth=r,s.maxWidth=o)),void 0!==a?a+"":a}function Zt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}function Jt(){var t;Wt&&(Vt.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",Wt.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",nt.appendChild(Vt).appendChild(Wt),t=M.getComputedStyle(Wt),Bt="1%"!==t.top,Gt=12===Qt(t.marginLeft),Wt.style.right="60%",jt=36===Qt(t.right),Ft=36===Qt(t.width),Wt.style.position="absolute",Ut=12===Qt(Wt.offsetWidth/3),nt.removeChild(Vt),Wt=null)}function Qt(t){return Math.round(parseFloat(t))}Vt=_.createElement("div"),(Wt=_.createElement("div")).style&&(Wt.style.backgroundClip="content-box",Wt.cloneNode(!0).style.backgroundClip="",y.clearCloneStyle="content-box"===Wt.style.backgroundClip,S.extend(y,{boxSizingReliable:function(){return Jt(),Ft},pixelBoxStyles:function(){return Jt(),jt},pixelPosition:function(){return Jt(),Bt},reliableMarginLeft:function(){return Jt(),Gt},scrollboxSize:function(){return Jt(),Ut},reliableTrDimensions:function(){var t,e,i,n;return null==Ht&&(t=_.createElement("table"),e=_.createElement("tr"),i=_.createElement("div"),t.style.cssText="position:absolute;left:-11111px",e.style.height="1px",i.style.height="9px",nt.appendChild(t).appendChild(e).appendChild(i),n=M.getComputedStyle(e),Ht=3<parseInt(n.height),nt.removeChild(t)),Ht}}));var Kt=["Webkit","Moz","ms"],te=_.createElement("div").style,ee={};function ie(t){return S.cssProps[t]||ee[t]||(t in te?t:ee[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),i=Kt.length;i--;)if((t=Kt[i]+e)in te)return t}(t)||t)}var ne=/^(none|table(?!-c[ea]).+)/,re=/^--/,oe={position:"absolute",visibility:"hidden",display:"block"},ae={letterSpacing:"0",fontWeight:"400"};function se(t,e,i){var n=et.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function ce(t,e,i,n,r,o){var a="width"===e?1:0,s=0,c=0;if(i===(n?"border":"content"))return 0;for(;a<4;a+=2)"margin"===i&&(c+=S.css(t,i+it[a],!0,r)),n?("content"===i&&(c-=S.css(t,"padding"+it[a],!0,r)),"margin"!==i&&(c-=S.css(t,"border"+it[a]+"Width",!0,r))):(c+=S.css(t,"padding"+it[a],!0,r),"padding"!==i?c+=S.css(t,"border"+it[a]+"Width",!0,r):s+=S.css(t,"border"+it[a]+"Width",!0,r));return!n&&0<=o&&(c+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-o-c-s-.5))||0),c}function le(t,e,i){var n=Xt(t),r=(!y.boxSizingReliable()||i)&&"border-box"===S.css(t,"boxSizing",!1,n),o=r,a=$t(t,e,n),s="offset"+e[0].toUpperCase()+e.slice(1);if(qt.test(a)){if(!i)return a;a="auto"}return(!y.boxSizingReliable()&&r||!y.reliableTrDimensions()&&T(t,"tr")||"auto"===a||!parseFloat(a)&&"inline"===S.css(t,"display",!1,n))&&t.getClientRects().length&&(r="border-box"===S.css(t,"boxSizing",!1,n),(o=s in t)&&(a=t[s])),(a=parseFloat(a)||0)+ce(t,e,i||(r?"border":"content"),o,n,a)+"px"}function he(t,e,i,n,r){return new he.prototype.init(t,e,i,n,r)}S.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=$t(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,a,s=q(e),c=re.test(e),l=t.style;if(c||(e=ie(s)),a=S.cssHooks[e]||S.cssHooks[s],void 0===i)return a&&"get"in a&&void 0!==(r=a.get(t,!1,n))?r:l[e];"string"==(o=typeof i)&&(r=et.exec(i))&&r[1]&&(i=st(t,e,r),o="number"),null!=i&&i==i&&("number"!==o||c||(i+=r&&r[3]||(S.cssNumber[s]?"":"px")),y.clearCloneStyle||""!==i||0!==e.indexOf("background")||(l[e]="inherit"),a&&"set"in a&&void 0===(i=a.set(t,i,n))||(c?l.setProperty(e,i):l[e]=i))}},css:function(t,e,i,n){var r,o,a,s=q(e);return re.test(e)||(e=ie(s)),(a=S.cssHooks[e]||S.cssHooks[s])&&"get"in a&&(r=a.get(t,!0,i)),void 0===r&&(r=$t(t,e,n)),"normal"===r&&e in ae&&(r=ae[e]),""===i||i?(o=parseFloat(r),!0===i||isFinite(o)?o||0:r):r}}),S.each(["height","width"],function(t,c){S.cssHooks[c]={get:function(t,e,i){if(e)return!ne.test(S.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?le(t,c,i):zt(t,oe,function(){return le(t,c,i)})},set:function(t,e,i){var n,r=Xt(t),o=!y.scrollboxSize()&&"absolute"===r.position,a=(o||i)&&"border-box"===S.css(t,"boxSizing",!1,r),s=i?ce(t,c,i,a,r):0;return a&&o&&(s-=Math.ceil(t["offset"+c[0].toUpperCase()+c.slice(1)]-parseFloat(r[c])-ce(t,c,"border",!1,r)-.5)),s&&(n=et.exec(e))&&"px"!==(n[3]||"px")&&(t.style[c]=e,e=S.css(t,c)),se(0,e,s)}}}),S.cssHooks.marginLeft=Zt(y.reliableMarginLeft,function(t,e){if(e)return(parseFloat($t(t,"marginLeft"))||t.getBoundingClientRect().left-zt(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),S.each({margin:"",padding:"",border:"Width"},function(r,o){S.cssHooks[r+o]={expand:function(t){for(var e=0,i={},n="string"==typeof t?t.split(" "):[t];e<4;e++)i[r+it[e]+o]=n[e]||n[e-2]||n[0];return i}},"margin"!==r&&(S.cssHooks[r+o].set=se)}),S.fn.extend({css:function(t,e){return H(this,function(t,e,i){var n,r,o={},a=0;if(Array.isArray(e)){for(n=Xt(t),r=e.length;a<r;a++)o[e[a]]=S.css(t,e[a],!1,n);return o}return void 0!==i?S.style(t,e,i):S.css(t,e)},t,e,1<arguments.length)}}),((S.Tween=he).prototype={constructor:he,init:function(t,e,i,n,r,o){this.elem=t,this.prop=i,this.easing=r||S.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=o||(S.cssNumber[i]?"":"px")},cur:function(){var t=he.propHooks[this.prop];return t&&t.get?t.get(this):he.propHooks._default.get(this)},run:function(t){var e,i=he.propHooks[this.prop];return this.options.duration?this.pos=e=S.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):he.propHooks._default.set(this),this}}).init.prototype=he.prototype,(he.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=S.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){S.fx.step[t.prop]?S.fx.step[t.prop](t):1!==t.elem.nodeType||!S.cssHooks[t.prop]&&null==t.elem.style[ie(t.prop)]?t.elem[t.prop]=t.now:S.style(t.elem,t.prop,t.now+t.unit)}}}).scrollTop=he.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},S.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},S.fx=he.prototype.init,S.fx.step={};var ue,de,pe,fe,me=/^(?:toggle|show|hide)$/,ge=/queueHooks$/;function ve(){de&&(!1===_.hidden&&M.requestAnimationFrame?M.requestAnimationFrame(ve):M.setTimeout(ve,S.fx.interval),S.fx.tick())}function ye(){return M.setTimeout(function(){ue=void 0}),ue=Date.now()}function be(t,e){var i,n=0,r={height:t};for(e=e?1:0;n<4;n+=2-e)r["margin"+(i=it[n])]=r["padding"+i]=t;return e&&(r.opacity=r.width=t),r}function xe(t,e,i){for(var n,r=(we.tweeners[e]||[]).concat(we.tweeners["*"]),o=0,a=r.length;o<a;o++)if(n=r[o].call(i,e,t))return n}function we(o,t,e){var i,a,n=0,r=we.prefilters.length,s=S.Deferred().always(function(){delete c.elem}),c=function(){if(a)return!1;for(var t=ue||ye(),e=Math.max(0,l.startTime+l.duration-t),i=1-(e/l.duration||0),n=0,r=l.tweens.length;n<r;n++)l.tweens[n].run(i);return s.notifyWith(o,[l,i,e]),i<1&&r?e:(r||s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:S.extend({},t),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},e),originalProperties:t,originalOptions:e,startTime:ue||ye(),duration:e.duration,tweens:[],createTween:function(t,e){var i=S.Tween(o,l.opts,t,e,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(i),i},stop:function(t){var e=0,i=t?l.tweens.length:0;if(a)return this;for(a=!0;e<i;e++)l.tweens[e].run(1);return t?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,t])):s.rejectWith(o,[l,t]),this}}),h=l.props;for(function(t,e){var i,n,r,o,a;for(i in t)if(r=e[n=q(i)],o=t[i],Array.isArray(o)&&(r=o[1],o=t[i]=o[0]),i!==n&&(t[n]=o,delete t[i]),(a=S.cssHooks[n])&&"expand"in a)for(i in o=a.expand(o),delete t[n],o)i in t||(t[i]=o[i],e[i]=r);else e[n]=r}(h,l.opts.specialEasing);n<r;n++)if(i=we.prefilters[n].call(l,o,h,l.opts))return b(i.stop)&&(S._queueHooks(l.elem,l.opts.queue).stop=i.stop.bind(i)),i;return S.map(h,xe,l),b(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),S.fx.timer(S.extend(c,{elem:o,anim:l,queue:l.opts.queue})),l}S.Animation=S.extend(we,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return st(i.elem,t,et.exec(e),i),i}]},tweener:function(t,e){for(var i,n=0,r=(t=b(t)?(e=t,["*"]):t.match(k)).length;n<r;n++)i=t[n],we.tweeners[i]=we.tweeners[i]||[],we.tweeners[i].unshift(e)},prefilters:[function(t,e,i){var n,r,o,a,s,c,l,h,u="width"in e||"height"in e,d=this,p={},f=t.style,m=t.nodeType&&at(t),g=$.get(t,"fxshow");for(n in i.queue||(null==(a=S._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,d.always(function(){d.always(function(){a.unqueued--,S.queue(t,"fx").length||a.empty.fire()})})),e)if(r=e[n],me.test(r)){if(delete e[n],o=o||"toggle"===r,r===(m?"hide":"show")){if("show"!==r||!g||void 0===g[n])continue;m=!0}p[n]=g&&g[n]||S.style(t,n)}if((c=!S.isEmptyObject(e))||!S.isEmptyObject(p))for(n in u&&1===t.nodeType&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],null==(l=g&&g.display)&&(l=$.get(t,"display")),"none"===(h=S.css(t,"display"))&&(l?h=l:(lt([t],!0),l=t.style.display||l,h=S.css(t,"display"),lt([t]))),("inline"===h||"inline-block"===h&&null!=l)&&"none"===S.css(t,"float")&&(c||(d.done(function(){f.display=l}),null==l&&(h=f.display,l="none"===h?"":h)),f.display="inline-block")),i.overflow&&(f.overflow="hidden",d.always(function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]})),c=!1,p)c||(g?"hidden"in g&&(m=g.hidden):g=$.access(t,"fxshow",{display:l}),o&&(g.hidden=!m),m&&lt([t],!0),d.done(function(){for(n in m||lt([t]),$.remove(t,"fxshow"),p)S.style(t,n,p[n])})),c=xe(m?g[n]:0,n,d),n in g||(g[n]=c.start,m&&(c.end=c.start,c.start=0))}],prefilter:function(t,e){e?we.prefilters.unshift(t):we.prefilters.push(t)}}),S.speed=function(t,e,i){var n=t&&"object"==typeof t?S.extend({},t):{complete:i||!i&&e||b(t)&&t,duration:t,easing:i&&e||e&&!b(e)&&e};return S.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in S.fx.speeds?n.duration=S.fx.speeds[n.duration]:n.duration=S.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){b(n.old)&&n.old.call(this),n.queue&&S.dequeue(this,n.queue)},n},S.fn.extend({fadeTo:function(t,e,i,n){return this.filter(at).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(e,t,i,n){function r(){var t=we(this,S.extend({},e),a);(o||$.get(this,"finish"))&&t.stop(!0)}var o=S.isEmptyObject(e),a=S.speed(t,i,n);return r.finish=r,o||!1===a.queue?this.each(r):this.queue(a.queue,r)},stop:function(r,t,o){function a(t){var e=t.stop;delete t.stop,e(o)}return"string"!=typeof r&&(o=t,t=r,r=void 0),t&&this.queue(r||"fx",[]),this.each(function(){var t=!0,e=null!=r&&r+"queueHooks",i=S.timers,n=$.get(this);if(e)n[e]&&n[e].stop&&a(n[e]);else for(e in n)n[e]&&n[e].stop&&ge.test(e)&&a(n[e]);for(e=i.length;e--;)i[e].elem!==this||null!=r&&i[e].queue!==r||(i[e].anim.stop(o),t=!1,i.splice(e,1));!t&&o||S.dequeue(this,r)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var t,e=$.get(this),i=e[a+"queue"],n=e[a+"queueHooks"],r=S.timers,o=i?i.length:0;for(e.finish=!0,S.queue(this,a,[]),n&&n.stop&&n.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===a&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;t<o;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete e.finish})}}),S.each(["toggle","show","hide"],function(t,n){var r=S.fn[n];S.fn[n]=function(t,e,i){return null==t||"boolean"==typeof t?r.apply(this,arguments):this.animate(be(n,!0),t,e,i)}}),S.each({slideDown:be("show"),slideUp:be("hide"),slideToggle:be("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,n){S.fn[t]=function(t,e,i){return this.animate(n,t,e,i)}}),S.timers=[],S.fx.tick=function(){var t,e=0,i=S.timers;for(ue=Date.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||S.fx.stop(),ue=void 0},S.fx.timer=function(t){S.timers.push(t),S.fx.start()},S.fx.interval=13,S.fx.start=function(){de||(de=!0,ve())},S.fx.stop=function(){de=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(n,t){return n=S.fx&&S.fx.speeds[n]||n,t=t||"fx",this.queue(t,function(t,e){var i=M.setTimeout(t,n);e.stop=function(){M.clearTimeout(i)}})},pe=_.createElement("input"),fe=_.createElement("select").appendChild(_.createElement("option")),pe.type="checkbox",y.checkOn=""!==pe.value,y.optSelected=fe.selected,(pe=_.createElement("input")).value="t",pe.type="radio",y.radioValue="t"===pe.value;var Ee,Me=S.expr.attrHandle;S.fn.extend({attr:function(t,e){return H(this,S.attr,t,e,1<arguments.length)},removeAttr:function(t){return this.each(function(){S.removeAttr(this,t)})}}),S.extend({attr:function(t,e,i){var n,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?S.prop(t,e,i):(1===o&&S.isXMLDoc(t)||(r=S.attrHooks[e.toLowerCase()]||(S.expr.match.bool.test(e)?Ee:void 0)),void 0!==i?null===i?void S.removeAttr(t,e):r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:(t.setAttribute(e,i+""),i):!(r&&"get"in r&&null!==(n=r.get(t,e)))&&null==(n=S.find.attr(t,e))?void 0:n)},attrHooks:{type:{set:function(t,e){if(!y.radioValue&&"radio"===e&&T(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n=0,r=e&&e.match(k);if(r&&1===t.nodeType)for(;i=r[n++];)t.removeAttribute(i)}}),Ee={set:function(t,e,i){return!1===e?S.removeAttr(t,i):t.setAttribute(i,i),i}},S.each(S.expr.match.bool.source.match(/\w+/g),function(t,e){var a=Me[e]||S.find.attr;Me[e]=function(t,e,i){var n,r,o=e.toLowerCase();return i||(r=Me[o],Me[o]=n,n=null!=a(t,e,i)?o:null,Me[o]=r),n}});var _e=/^(?:input|select|textarea|button)$/i,Se=/^(?:a|area)$/i;function Ae(t){return(t.match(k)||[]).join(" ")}function Te(t){return t.getAttribute&&t.getAttribute("class")||""}function Ce(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(k)||[]}S.fn.extend({prop:function(t,e){return H(this,S.prop,t,e,1<arguments.length)},removeProp:function(t){return this.each(function(){delete this[S.propFix[t]||t]})}}),S.extend({prop:function(t,e,i){var n,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&S.isXMLDoc(t)||(e=S.propFix[e]||e,r=S.propHooks[e]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:t[e]=i:r&&"get"in r&&null!==(n=r.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=S.find.attr(t,"tabindex");return e?parseInt(e,10):_e.test(t.nodeName)||Se.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),y.optSelected||(S.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){S.propFix[this.toLowerCase()]=this}),S.fn.extend({addClass:function(e){var t,i,n,r,o,a,s,c=0;if(b(e))return this.each(function(t){S(this).addClass(e.call(this,t,Te(this)))});if((t=Ce(e)).length)for(;i=this[c++];)if(r=Te(i),n=1===i.nodeType&&" "+Ae(r)+" "){for(a=0;o=t[a++];)n.indexOf(" "+o+" ")<0&&(n+=o+" ");r!==(s=Ae(n))&&i.setAttribute("class",s)}return this},removeClass:function(e){var t,i,n,r,o,a,s,c=0;if(b(e))return this.each(function(t){S(this).removeClass(e.call(this,t,Te(this)))});if(!arguments.length)return this.attr("class","");if((t=Ce(e)).length)for(;i=this[c++];)if(r=Te(i),n=1===i.nodeType&&" "+Ae(r)+" "){for(a=0;o=t[a++];)for(;-1<n.indexOf(" "+o+" ");)n=n.replace(" "+o+" "," ");r!==(s=Ae(n))&&i.setAttribute("class",s)}return this},toggleClass:function(r,e){var o=typeof r,a="string"==o||Array.isArray(r);return"boolean"==typeof e&&a?e?this.addClass(r):this.removeClass(r):b(r)?this.each(function(t){S(this).toggleClass(r.call(this,t,Te(this),e),e)}):this.each(function(){var t,e,i,n;if(a)for(e=0,i=S(this),n=Ce(r);t=n[e++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else void 0!==r&&"boolean"!=o||((t=Te(this))&&$.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",!t&&!1!==r&&$.get(this,"__className__")||""))})},hasClass:function(t){for(var e,i=0,n=" "+t+" ";e=this[i++];)if(1===e.nodeType&&-1<(" "+Ae(Te(e))+" ").indexOf(n))return!0;return!1}});var Le=/\r/g;S.fn.extend({val:function(i){var n,t,r,e=this[0];return arguments.length?(r=b(i),this.each(function(t){var e;1===this.nodeType&&(null==(e=r?i.call(this,t,S(this).val()):i)?e="":"number"==typeof e?e+="":Array.isArray(e)&&(e=S.map(e,function(t){return null==t?"":t+""})),(n=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&void 0!==n.set(this,e,"value")||(this.value=e))})):e?(n=S.valHooks[e.type]||S.valHooks[e.nodeName.toLowerCase()])&&"get"in n&&void 0!==(t=n.get(e,"value"))?t:"string"==typeof(t=e.value)?t.replace(Le,""):null==t?"":t:void 0}}),S.extend({valHooks:{option:{get:function(t){var e=S.find.attr(t,"value");return null!=e?e:Ae(S.text(t))}},select:{get:function(t){for(var e,i,n=t.options,r=t.selectedIndex,o="select-one"===t.type,a=o?null:[],s=o?r+1:n.length,c=r<0?s:o?r:0;c<s;c++)if(((i=n[c]).selected||c===r)&&!i.disabled&&(!i.parentNode.disabled||!T(i.parentNode,"optgroup"))){if(e=S(i).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var i,n,r=t.options,o=S.makeArray(e),a=r.length;a--;)((n=r[a]).selected=-1<S.inArray(S.valHooks.option.get(n),o))&&(i=!0);return i||(t.selectedIndex=-1),o}}}}),S.each(["radio","checkbox"],function(){S.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=-1<S.inArray(S(t).val(),e)}},y.checkOn||(S.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),y.focusin="onfocusin"in M;function Pe(t){t.stopPropagation()}var Re=/^(?:focusinfocus|focusoutblur)$/;S.extend(S.event,{trigger:function(t,e,i,n){var r,o,a,s,c,l,h,u=[i||_],d=v.call(t,"type")?t.type:t,p=v.call(t,"namespace")?t.namespace.split("."):[],f=h=o=i=i||_;if(3!==i.nodeType&&8!==i.nodeType&&!Re.test(d+S.event.triggered)&&(-1<d.indexOf(".")&&(d=(p=d.split(".")).shift(),p.sort()),s=d.indexOf(":")<0&&"on"+d,(t=t[S.expando]?t:new S.Event(d,"object"==typeof t&&t)).isTrigger=n?2:3,t.namespace=p.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:S.makeArray(e,[t]),l=S.event.special[d]||{},n||!l.trigger||!1!==l.trigger.apply(i,e))){if(!n&&!l.noBubble&&!m(i)){for(a=l.delegateType||d,Re.test(a+d)||(f=f.parentNode);f;f=f.parentNode)u.push(f),o=f;o===(i.ownerDocument||_)&&u.push(o.defaultView||o.parentWindow||M)}for(r=0;(f=u[r++])&&!t.isPropagationStopped();)h=f,t.type=1<r?a:l.bindType||d,(c=($.get(f,"events")||Object.create(null))[t.type]&&$.get(f,"handle"))&&c.apply(f,e),(c=s&&f[s])&&c.apply&&X(f)&&(t.result=c.apply(f,e),!1===t.result&&t.preventDefault());return t.type=d,n||t.isDefaultPrevented()||l._default&&!1!==l._default.apply(u.pop(),e)||!X(i)||s&&b(i[d])&&!m(i)&&((o=i[s])&&(i[s]=null),S.event.triggered=d,t.isPropagationStopped()&&h.addEventListener(d,Pe),i[d](),t.isPropagationStopped()&&h.removeEventListener(d,Pe),S.event.triggered=void 0,o&&(i[s]=o)),t.result}},simulate:function(t,e,i){var n=S.extend(new S.Event,i,{type:t,isSimulated:!0});S.event.trigger(n,null,e)}}),S.fn.extend({trigger:function(t,e){return this.each(function(){S.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return S.event.trigger(t,e,i,!0)}}),y.focusin||S.each({focus:"focusin",blur:"focusout"},function(i,n){function r(t){S.event.simulate(n,t.target,S.event.fix(t))}S.event.special[n]={setup:function(){var t=this.ownerDocument||this.document||this,e=$.access(t,n);e||t.addEventListener(i,r,!0),$.access(t,n,(e||0)+1)},teardown:function(){var t=this.ownerDocument||this.document||this,e=$.access(t,n)-1;e?$.access(t,n,e):(t.removeEventListener(i,r,!0),$.remove(t,n))}}});var Ie=M.location,Oe={guid:Date.now()},De=/\?/;S.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new M.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||S.error("Invalid XML: "+t),e};var ke=/\[\]$/,Ne=/\r?\n/g,ze=/^(?:submit|button|image|reset|file)$/i,Be=/^(?:input|select|textarea|keygen)/i;S.param=function(t,e){function i(t,e){var i=b(e)?e():e;r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==i?"":i)}var n,r=[];if(null==t)return"";if(Array.isArray(t)||t.jquery&&!S.isPlainObject(t))S.each(t,function(){i(this.name,this.value)});else for(n in t)!function i(n,t,r,o){var e;if(Array.isArray(t))S.each(t,function(t,e){r||ke.test(n)?o(n,e):i(n+"["+("object"==typeof e&&null!=e?t:"")+"]",e,r,o)});else if(r||"object"!==w(t))o(n,t);else for(e in t)i(n+"["+e+"]",t[e],r,o)}(n,t[n],e,i);return r.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=S.prop(this,"elements");return t?S.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!S(this).is(":disabled")&&Be.test(this.nodeName)&&!ze.test(t)&&(this.checked||!ut.test(t))}).map(function(t,e){var i=S(this).val();return null==i?null:Array.isArray(i)?S.map(i,function(t){return{name:e.name,value:t.replace(Ne,"\r\n")}}):{name:e.name,value:i.replace(Ne,"\r\n")}}).get()}});var Fe=/%20/g,Ue=/#.*$/,je=/([?&])_=[^&]*/,He=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ge=/^(?:GET|HEAD)$/,Ve=/^\/\//,We={},qe={},Xe="*/".concat("*"),Ye=_.createElement("a");function $e(o){return function(t,e){"string"!=typeof t&&(e=t,t="*");var i,n=0,r=t.toLowerCase().match(k)||[];if(b(e))for(;i=r[n++];)"+"===i[0]?(i=i.slice(1)||"*",(o[i]=o[i]||[]).unshift(e)):(o[i]=o[i]||[]).push(e)}}function Ze(e,r,o,a){var s={},c=e===qe;function l(t){var n;return s[t]=!0,S.each(e[t]||[],function(t,e){var i=e(r,o,a);return"string"!=typeof i||c||s[i]?c?!(n=i):void 0:(r.dataTypes.unshift(i),l(i),!1)}),n}return l(r.dataTypes[0])||!s["*"]&&l("*")}function Je(t,e){var i,n,r=S.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((r[i]?t:n=n||{})[i]=e[i]);return n&&S.extend(!0,t,n),t}Ye.href=Ie.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ie.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Ie.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Xe,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Je(Je(t,S.ajaxSettings),e):Je(S.ajaxSettings,t)},ajaxPrefilter:$e(We),ajaxTransport:$e(qe),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var h,u,d,i,p,n,f,m,r,o,g=S.ajaxSetup({},e),v=g.context||g,y=g.context&&(v.nodeType||v.jquery)?S(v):S.event,b=S.Deferred(),x=S.Callbacks("once memory"),w=g.statusCode||{},a={},s={},c="canceled",E={readyState:0,getResponseHeader:function(t){var e;if(f){if(!i)for(i={};e=He.exec(d);)i[e[1].toLowerCase()+" "]=(i[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=i[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return f?d:null},setRequestHeader:function(t,e){return null==f&&(t=s[t.toLowerCase()]=s[t.toLowerCase()]||t,a[t]=e),this},overrideMimeType:function(t){return null==f&&(g.mimeType=t),this},statusCode:function(t){var e;if(t)if(f)E.always(t[E.status]);else for(e in t)w[e]=[w[e],t[e]];return this},abort:function(t){var e=t||c;return h&&h.abort(e),l(0,e),this}};if(b.promise(E),g.url=((t||g.url||Ie.href)+"").replace(Ve,Ie.protocol+"//"),g.type=e.method||e.type||g.method||g.type,g.dataTypes=(g.dataType||"*").toLowerCase().match(k)||[""],null==g.crossDomain){n=_.createElement("a");try{n.href=g.url,n.href=n.href,g.crossDomain=Ye.protocol+"//"+Ye.host!=n.protocol+"//"+n.host}catch(t){g.crossDomain=!0}}if(g.data&&g.processData&&"string"!=typeof g.data&&(g.data=S.param(g.data,g.traditional)),Ze(We,g,e,E),f)return E;for(r in(m=S.event&&g.global)&&0==S.active++&&S.event.trigger("ajaxStart"),g.type=g.type.toUpperCase(),g.hasContent=!Ge.test(g.type),u=g.url.replace(Ue,""),g.hasContent?g.data&&g.processData&&0===(g.contentType||"").indexOf("application/x-www-form-urlencoded")&&(g.data=g.data.replace(Fe,"+")):(o=g.url.slice(u.length),g.data&&(g.processData||"string"==typeof g.data)&&(u+=(De.test(u)?"&":"?")+g.data,delete g.data),!1===g.cache&&(u=u.replace(je,"$1"),o=(De.test(u)?"&":"?")+"_="+Oe.guid+++o),g.url=u+o),g.ifModified&&(S.lastModified[u]&&E.setRequestHeader("If-Modified-Since",S.lastModified[u]),S.etag[u]&&E.setRequestHeader("If-None-Match",S.etag[u])),(g.data&&g.hasContent&&!1!==g.contentType||e.contentType)&&E.setRequestHeader("Content-Type",g.contentType),E.setRequestHeader("Accept",g.dataTypes[0]&&g.accepts[g.dataTypes[0]]?g.accepts[g.dataTypes[0]]+("*"!==g.dataTypes[0]?", "+Xe+"; q=0.01":""):g.accepts["*"]),g.headers)E.setRequestHeader(r,g.headers[r]);if(g.beforeSend&&(!1===g.beforeSend.call(v,E,g)||f))return E.abort();if(c="abort",x.add(g.complete),E.done(g.success),E.fail(g.error),h=Ze(qe,g,e,E)){if(E.readyState=1,m&&y.trigger("ajaxSend",[E,g]),f)return E;g.async&&0<g.timeout&&(p=M.setTimeout(function(){E.abort("timeout")},g.timeout));try{f=!1,h.send(a,l)}catch(t){if(f)throw t;l(-1,t)}}else l(-1,"No Transport");function l(t,e,i,n){var r,o,a,s,c,l=e;f||(f=!0,p&&M.clearTimeout(p),h=void 0,d=n||"",E.readyState=0<t?4:0,r=200<=t&&t<300||304===t,i&&(s=function(t,e,i){for(var n,r,o,a,s=t.contents,c=t.dataTypes;"*"===c[0];)c.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(r in s)if(s[r]&&s[r].test(n)){c.unshift(r);break}if(c[0]in i)o=c[0];else{for(r in i){if(!c[0]||t.converters[r+" "+c[0]]){o=r;break}a=a||r}o=o||a}if(o)return o!==c[0]&&c.unshift(o),i[o]}(g,E,i)),!r&&-1<S.inArray("script",g.dataTypes)&&(g.converters["text script"]=function(){}),s=function(t,e,i,n){var r,o,a,s,c,l={},h=t.dataTypes.slice();if(h[1])for(a in t.converters)l[a.toLowerCase()]=t.converters[a];for(o=h.shift();o;)if(t.responseFields[o]&&(i[t.responseFields[o]]=e),!c&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),c=o,o=h.shift())if("*"===o)o=c;else if("*"!==c&&c!==o){if(!(a=l[c+" "+o]||l["* "+o]))for(r in l)if((s=r.split(" "))[1]===o&&(a=l[c+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[r]:!0!==l[r]&&(o=s[0],h.unshift(s[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+c+" to "+o}}}return{state:"success",data:e}}(g,s,E,r),r?(g.ifModified&&((c=E.getResponseHeader("Last-Modified"))&&(S.lastModified[u]=c),(c=E.getResponseHeader("etag"))&&(S.etag[u]=c)),204===t||"HEAD"===g.type?l="nocontent":304===t?l="notmodified":(l=s.state,o=s.data,r=!(a=s.error))):(a=l,!t&&l||(l="error",t<0&&(t=0))),E.status=t,E.statusText=(e||l)+"",r?b.resolveWith(v,[o,l,E]):b.rejectWith(v,[E,l,a]),E.statusCode(w),w=void 0,m&&y.trigger(r?"ajaxSuccess":"ajaxError",[E,g,r?o:a]),x.fireWith(v,[E,l]),m&&(y.trigger("ajaxComplete",[E,g]),--S.active||S.event.trigger("ajaxStop")))}return E},getJSON:function(t,e,i){return S.get(t,e,i,"json")},getScript:function(t,e){return S.get(t,void 0,e,"script")}}),S.each(["get","post"],function(t,r){S[r]=function(t,e,i,n){return b(e)&&(n=n||i,i=e,e=void 0),S.ajax(S.extend({url:t,type:r,dataType:n,data:e,success:i},S.isPlainObject(t)&&t))}}),S.ajaxPrefilter(function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")}),S._evalUrl=function(t,e,i){return S.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){S.globalEval(t,e,i)}})},S.fn.extend({wrapAll:function(t){var e;return this[0]&&(b(t)&&(t=t.call(this[0])),e=S(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(i){return b(i)?this.each(function(t){S(this).wrapInner(i.call(this,t))}):this.each(function(){var t=S(this),e=t.contents();e.length?e.wrapAll(i):t.append(i)})},wrap:function(e){var i=b(e);return this.each(function(t){S(this).wrapAll(i?e.call(this,t):e)})},unwrap:function(t){return this.parent(t).not("body").each(function(){S(this).replaceWith(this.childNodes)}),this}}),S.expr.pseudos.hidden=function(t){return!S.expr.pseudos.visible(t)},S.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new M.XMLHttpRequest}catch(t){}};var Qe={0:200,1223:204},Ke=S.ajaxSettings.xhr();y.cors=!!Ke&&"withCredentials"in Ke,y.ajax=Ke=!!Ke,S.ajaxTransport(function(r){var o,a;if(y.cors||Ke&&!r.crossDomain)return{send:function(t,e){var i,n=r.xhr();if(n.open(r.type,r.url,r.async,r.username,r.password),r.xhrFields)for(i in r.xhrFields)n[i]=r.xhrFields[i];for(i in r.mimeType&&n.overrideMimeType&&n.overrideMimeType(r.mimeType),r.crossDomain||t["X-Requested-With"]||(t["X-Requested-With"]="XMLHttpRequest"),t)n.setRequestHeader(i,t[i]);o=function(t){return function(){o&&(o=a=n.onload=n.onerror=n.onabort=n.ontimeout=n.onreadystatechange=null,"abort"===t?n.abort():"error"===t?"number"!=typeof n.status?e(0,"error"):e(n.status,n.statusText):e(Qe[n.status]||n.status,n.statusText,"text"!==(n.responseType||"text")||"string"!=typeof n.responseText?{binary:n.response}:{text:n.responseText},n.getAllResponseHeaders()))}},n.onload=o(),a=n.onerror=n.ontimeout=o("error"),void 0!==n.onabort?n.onabort=a:n.onreadystatechange=function(){4===n.readyState&&M.setTimeout(function(){o&&a()})},o=o("abort");try{n.send(r.hasContent&&r.data||null)}catch(t){if(o)throw t}},abort:function(){o&&o()}}}),S.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return S.globalEval(t),t}}}),S.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),S.ajaxTransport("script",function(i){var n,r;if(i.crossDomain||i.scriptAttrs)return{send:function(t,e){n=S("<script>").attr(i.scriptAttrs||{}).prop({charset:i.scriptCharset,src:i.url}).on("load error",r=function(t){n.remove(),r=null,t&&e("error"===t.type?404:200,t.type)}),_.head.appendChild(n[0])},abort:function(){r&&r()}}});var ti,ei=[],ii=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=ei.pop()||S.expando+"_"+Oe.guid++;return this[t]=!0,t}}),S.ajaxPrefilter("json jsonp",function(t,e,i){var n,r,o,a=!1!==t.jsonp&&(ii.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&ii.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return n=t.jsonpCallback=b(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(ii,"$1"+n):!1!==t.jsonp&&(t.url+=(De.test(t.url)?"&":"?")+t.jsonp+"="+n),t.converters["script json"]=function(){return o||S.error(n+" was not called"),o[0]},t.dataTypes[0]="json",r=M[n],M[n]=function(){o=arguments},i.always(function(){void 0===r?S(M).removeProp(n):M[n]=r,t[n]&&(t.jsonpCallback=e.jsonpCallback,ei.push(n)),o&&b(r)&&r(o[0]),o=r=void 0}),"script"}),y.createHTMLDocument=((ti=_.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===ti.childNodes.length),S.parseHTML=function(t,e,i){return"string"!=typeof t?[]:("boolean"==typeof e&&(i=e,e=!1),e||(y.createHTMLDocument?((n=(e=_.implementation.createHTMLDocument("")).createElement("base")).href=_.location.href,e.head.appendChild(n)):e=_),o=!i&&[],(r=C.exec(t))?[e.createElement(r[1])]:(r=bt([t],e,o),o&&o.length&&S(o).remove(),S.merge([],r.childNodes)));var n,r,o},S.fn.load=function(t,e,i){var n,r,o,a=this,s=t.indexOf(" ");return-1<s&&(n=Ae(t.slice(s)),t=t.slice(0,s)),b(e)?(i=e,e=void 0):e&&"object"==typeof e&&(r="POST"),0<a.length&&S.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done(function(t){o=arguments,a.html(n?S("<div>").append(S.parseHTML(t)).find(n):t)}).always(i&&function(t,e){a.each(function(){i.apply(this,o||[t.responseText,e,t])})}),this},S.expr.pseudos.animated=function(e){return S.grep(S.timers,function(t){return e===t.elem}).length},S.offset={setOffset:function(t,e,i){var n,r,o,a,s,c,l=S.css(t,"position"),h=S(t),u={};"static"===l&&(t.style.position="relative"),s=h.offset(),o=S.css(t,"top"),c=S.css(t,"left"),r=("absolute"===l||"fixed"===l)&&-1<(o+c).indexOf("auto")?(a=(n=h.position()).top,n.left):(a=parseFloat(o)||0,parseFloat(c)||0),b(e)&&(e=e.call(t,i,S.extend({},s))),null!=e.top&&(u.top=e.top-s.top+a),null!=e.left&&(u.left=e.left-s.left+r),"using"in e?e.using.call(t,u):("number"==typeof u.top&&(u.top+="px"),"number"==typeof u.left&&(u.left+="px"),h.css(u))}},S.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){S.offset.setOffset(this,e,t)});var t,i,n=this[0];return n?n.getClientRects().length?(t=n.getBoundingClientRect(),i=n.ownerDocument.defaultView,{top:t.top+i.pageYOffset,left:t.left+i.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,i,n=this[0],r={top:0,left:0};if("fixed"===S.css(n,"position"))e=n.getBoundingClientRect();else{for(e=this.offset(),i=n.ownerDocument,t=n.offsetParent||i.documentElement;t&&(t===i.body||t===i.documentElement)&&"static"===S.css(t,"position");)t=t.parentNode;t&&t!==n&&1===t.nodeType&&((r=S(t).offset()).top+=S.css(t,"borderTopWidth",!0),r.left+=S.css(t,"borderLeftWidth",!0))}return{top:e.top-r.top-S.css(n,"marginTop",!0),left:e.left-r.left-S.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===S.css(t,"position");)t=t.offsetParent;return t||nt})}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,r){var o="pageYOffset"===r;S.fn[e]=function(t){return H(this,function(t,e,i){var n;return m(t)?n=t:9===t.nodeType&&(n=t.defaultView),void 0===i?n?n[r]:t[e]:void(n?n.scrollTo(o?n.pageXOffset:i,o?i:n.pageYOffset):t[e]=i)},e,t,arguments.length)}}),S.each(["top","left"],function(t,i){S.cssHooks[i]=Zt(y.pixelPosition,function(t,e){if(e)return e=$t(t,i),qt.test(e)?S(t).position()[i]+"px":e})}),S.each({Height:"height",Width:"width"},function(a,s){S.each({padding:"inner"+a,content:s,"":"outer"+a},function(n,o){S.fn[o]=function(t,e){var i=arguments.length&&(n||"boolean"!=typeof t),r=n||(!0===t||!0===e?"margin":"border");return H(this,function(t,e,i){var n;return m(t)?0===o.indexOf("outer")?t["inner"+a]:t.document.documentElement["client"+a]:9===t.nodeType?(n=t.documentElement,Math.max(t.body["scroll"+a],n["scroll"+a],t.body["offset"+a],n["offset"+a],n["client"+a])):void 0===i?S.css(t,e,r):S.style(t,e,i,r)},s,i?t:void 0,i)}})}),S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){S.fn[e]=function(t){return this.on(e,t)}}),S.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,i){S.fn[i]=function(t,e){return 0<arguments.length?this.on(i,null,t,e):this.trigger(i)}});var ni=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;S.proxy=function(t,e){var i,n,r;if("string"==typeof e&&(i=t[e],e=t,t=i),b(t))return n=s.call(arguments,2),(r=function(){return t.apply(e||this,n.concat(s.call(arguments)))}).guid=t.guid=t.guid||S.guid++,r},S.holdReady=function(t){t?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=T,S.isFunction=b,S.isWindow=m,S.camelCase=q,S.type=w,S.now=Date.now,S.isNumeric=function(t){var e=S.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},S.trim=function(t){return null==t?"":(t+"").replace(ni,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return S});var ri=M.jQuery,oi=M.$;return S.noConflict=function(t){return M.$===S&&(M.$=oi),t&&M.jQuery===S&&(M.jQuery=ri),S},void 0===t&&(M.jQuery=M.$=S),S}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.AOS=e()}(this,function(){"use strict";function y(){return n.Date.now()}var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},b="Expected a function",r=NaN,o="[object Symbol]",a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,l=/^0o[0-7]+$/i,h=parseInt,e="object"==typeof t&&t&&t.Object===Object&&t,i="object"==typeof self&&self&&self.Object===Object&&self,n=e||i||Function("return this")(),u=Object.prototype.toString,x=Math.max,w=Math.min;function d(n,r,t){var o,a,i,s,c,l,h=0,u=!1,d=!1,e=!0;if("function"!=typeof n)throw new TypeError(b);function p(t){var e=o,i=a;return o=a=void 0,h=t,s=n.apply(i,e)}function f(t){var e=t-l;return void 0===l||r<=e||e<0||d&&i<=t-h}function m(){var t,e=y();if(f(e))return g(e);c=setTimeout(m,(t=r-(e-l),d?w(t,i-(e-h)):t))}function g(t){return c=void 0,e&&o?p(t):(o=a=void 0,s)}function v(){var t,e=y(),i=f(e);if(o=arguments,a=this,l=e,i){if(void 0===c)return h=t=l,c=setTimeout(m,r),u?p(t):s;if(d)return c=setTimeout(m,r),p(l)}return void 0===c&&(c=setTimeout(m,r)),s}return r=M(r)||0,E(t)&&(u=!!t.leading,i=(d="maxWait"in t)?x(M(t.maxWait)||0,r):i,e="trailing"in t?!!t.trailing:e),v.cancel=function(){void 0!==c&&clearTimeout(c),o=l=a=c=void(h=0)},v.flush=function(){return void 0===c?s:g(y())},v}function E(t){var e=typeof t;return t&&("object"==e||"function"==e)}function M(t){if("number"==typeof t)return t;if("symbol"==typeof(e=t)||e&&"object"==typeof e&&u.call(e)==o)return r;var e,i;if(E(t)&&(t=E(i="function"==typeof t.valueOf?t.valueOf():t)?i+"":i),"string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var n=c.test(t);return n||l.test(t)?h(t.slice(2),n?2:8):s.test(t)?r:+t}function _(){return T.Date.now()}var p=/^\s+|\s+$/g,f=/^[-+]0x[0-9a-f]+$/i,m=/^0b[01]+$/i,g=/^0o[0-7]+$/i,v=parseInt,S="object"==typeof t&&t&&t.Object===Object&&t,A="object"==typeof self&&self&&self.Object===Object&&self,T=S||A||Function("return this")(),C=Object.prototype.toString,L=Math.max,P=Math.min;function R(t){var e=typeof t;return t&&("object"==e||"function"==e)}function I(t){if("number"==typeof t)return t;if("symbol"==typeof(e=t)||e&&"object"==typeof e&&"[object Symbol]"==C.call(e))return NaN;var e,i;if(R(t)&&(t=R(i="function"==typeof t.valueOf?t.valueOf():t)?i+"":i),"string"!=typeof t)return 0===t?t:+t;t=t.replace(p,"");var n=m.test(t);return n||g.test(t)?v(t.slice(2),n?2:8):f.test(t)?NaN:+t}function O(n,r,t){var o,a,i,s,c,l,h=0,u=!1,d=!1,e=!0;if("function"!=typeof n)throw new TypeError("Expected a function");function p(t){var e=o,i=a;return o=a=void 0,h=t,s=n.apply(i,e)}function f(t){var e=t-l;return void 0===l||r<=e||e<0||d&&i<=t-h}function m(){var t,e=_();if(f(e))return g(e);c=setTimeout(m,(t=r-(e-l),d?P(t,i-(e-h)):t))}function g(t){return c=void 0,e&&o?p(t):(o=a=void 0,s)}function v(){var t,e=_(),i=f(e);if(o=arguments,a=this,l=e,i){if(void 0===c)return h=t=l,c=setTimeout(m,r),u?p(t):s;if(d)return c=setTimeout(m,r),p(l)}return void 0===c&&(c=setTimeout(m,r)),s}return r=I(r)||0,R(t)&&(u=!!t.leading,i=(d="maxWait"in t)?L(I(t.maxWait)||0,r):i,e="trailing"in t?!!t.trailing:e),v.cancel=function(){void 0!==c&&clearTimeout(c),o=l=a=c=void(h=0)},v.flush=function(){return void 0===c?s:g(_())},v}var D=function(){};function k(t){t&&t.forEach(function(t){var e=Array.prototype.slice.call(t.addedNodes),i=Array.prototype.slice.call(t.removedNodes);if(function t(e){for(var i,n=void 0,n=0;n<e.length;n+=1){if((i=e[n]).dataset&&i.dataset.aos)return 1;if(i.children&&t(i.children))return 1}}(e.concat(i)))return D()})}function N(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}var z=function(){return!!N()},B=function(t,e){var i=window.document,n=new(N())(k);D=e,n.observe(i.documentElement,{childList:!0,subtree:!0,removedNodes:!0})},F=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},U=function(t,e,i){return e&&q(t.prototype,e),i&&q(t,i),t},j=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},H=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,G=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,V=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,W=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i;function q(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function X(){return navigator.userAgent||navigator.vendor||window.opera||""}function Y(t,e){var i=void 0;return it.ie11()?(i=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,{detail:e}):i=new CustomEvent(t,{detail:e}),document.dispatchEvent(i)}function $(t){return t.forEach(function(t,e){return i=t,n=window.pageYOffset,a=i.options,s=i.position,c=i.node,i.data,l=function(){var e,t;i.animated&&(e=c,(t=a.animatedClassNames)&&t.forEach(function(t){return e.classList.remove(t)}),Y("aos:out",c),i.options.id&&Y("aos:in:"+i.options.id,c),i.animated=!1)},void(a.mirror&&n>=s.out&&!a.once?l():n>=s.in?i.animated||(r=c,(o=a.animatedClassNames)&&o.forEach(function(t){return r.classList.add(t)}),Y("aos:in",c),i.options.id&&Y("aos:in:"+i.options.id,c),i.animated=!0):i.animated&&!a.once&&l());var i,n,r,o,a,s,c,l})}function Z(t){for(var e=0,i=0;t&&!isNaN(t.offsetLeft)&&!isNaN(t.offsetTop);)e+=t.offsetLeft-("BODY"!=t.tagName?t.scrollLeft:0),i+=t.offsetTop-("BODY"!=t.tagName?t.scrollTop:0),t=t.offsetParent;return{top:i,left:e}}function J(t,e,i){var n=t.getAttribute("data-aos-"+e);if(void 0!==n){if("true"===n)return!0;if("false"===n)return!1}return n||i}function Q(){var t=document.querySelectorAll("[data-aos]");return Array.prototype.map.call(t,function(t){return{node:t}})}function K(){return document.all&&!window.atob}function tt(){var t,s;0<arguments.length&&void 0!==arguments[0]&&arguments[0]&&(rt=!0),rt&&(s=ot,(t=nt).forEach(function(t,e){var i=J(t.node,"mirror",s.mirror),n=J(t.node,"once",s.once),r=J(t.node,"id"),o=s.useClassNames&&t.node.getAttribute("data-aos"),a=[s.animatedClassName].concat(o?o.split(" "):[]).filter(function(t){return"string"==typeof t});s.initClassName&&t.node.classList.add(s.initClassName),t.position={in:function(t,e,i){var n=window.innerHeight,r=J(t,"anchor"),o=J(t,"anchor-placement"),a=Number(J(t,"offset",o?0:e)),s=o||i,c=t;r&&document.querySelectorAll(r)&&(c=document.querySelectorAll(r)[0]);var l=Z(c).top-n;switch(s){case"top-bottom":break;case"center-bottom":l+=c.offsetHeight/2;break;case"bottom-bottom":l+=c.offsetHeight;break;case"top-center":l+=n/2;break;case"center-center":l+=n/2+c.offsetHeight/2;break;case"bottom-center":l+=n/2+c.offsetHeight;break;case"top-top":l+=n;break;case"bottom-top":l+=n+c.offsetHeight;break;case"center-top":l+=n+c.offsetHeight/2}return l+a}(t.node,s.offset,s.anchorPlacement),out:i&&function(t,e){window.innerHeight;var i=J(t,"anchor"),n=J(t,"offset",e),r=t;return i&&document.querySelectorAll(i)&&(r=document.querySelectorAll(i)[0]),Z(r).top+r.offsetHeight-n}(t.node,s.offset)},t.options={once:n,mirror:i,animatedClassNames:a,id:r}}),$(nt=t),window.addEventListener("scroll",function(t,e,i){var n=!0,r=!0;if("function"!=typeof t)throw new TypeError(b);return E(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),d(t,e,{leading:n,maxWait:e,trailing:r})}(function(){$(nt,ot.once)},ot.throttleDelay)))}function et(){if(nt=Q(),st(ot.disable)||K())return at();tt()}var it=(U(ct,[{key:"phone",value:function(){var t=X();return!(!H.test(t)&&!G.test(t.substr(0,4)))}},{key:"mobile",value:function(){var t=X();return!(!V.test(t)&&!W.test(t.substr(0,4)))}},{key:"tablet",value:function(){return this.mobile()&&!this.phone()}},{key:"ie11",value:function(){return"-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style}}]),new ct),nt=[],rt=!1,ot={offset:120,delay:0,easing:"ease",duration:400,disable:!1,once:!1,mirror:!1,anchorPlacement:"top-bottom",startEvent:"DOMContentLoaded",animatedClassName:"aos-animate",initClassName:"aos-init",useClassNames:!1,disableMutationObserver:!1,throttleDelay:99,debounceDelay:50},at=function(){nt.forEach(function(t,e){t.node.removeAttribute("data-aos"),t.node.removeAttribute("data-aos-easing"),t.node.removeAttribute("data-aos-duration"),t.node.removeAttribute("data-aos-delay"),ot.initClassName&&t.node.classList.remove(ot.initClassName),ot.animatedClassName&&t.node.classList.remove(ot.animatedClassName)})},st=function(t){return!0===t||"mobile"===t&&it.mobile()||"phone"===t&&it.phone()||"tablet"===t&&it.tablet()||"function"==typeof t&&!0===t()};function ct(){F(this,ct)}return{init:function(t){return ot=j(ot,t),nt=Q(),ot.disableMutationObserver||z()||(console.info('\n      aos: MutationObserver is not supported on this browser,\n      code mutations observing has been disabled.\n      You may have to call "refreshHard()" by yourself.\n    '),ot.disableMutationObserver=!0),ot.disableMutationObserver||B("[data-aos]",et),st(ot.disable)||K()?at():(document.querySelector("body").setAttribute("data-aos-easing",ot.easing),document.querySelector("body").setAttribute("data-aos-duration",ot.duration),document.querySelector("body").setAttribute("data-aos-delay",ot.delay),-1===["DOMContentLoaded","load"].indexOf(ot.startEvent)?document.addEventListener(ot.startEvent,function(){tt(!0)}):window.addEventListener("load",function(){tt(!0)}),"DOMContentLoaded"===ot.startEvent&&-1<["complete","interactive"].indexOf(document.readyState)&&tt(!0),window.addEventListener("resize",O(tt,ot.debounceDelay,!0)),window.addEventListener("orientationchange",O(tt,ot.debounceDelay,!0)),nt)},refresh:tt,refreshHard:et}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).window=t.window||{})}(this,function(t){"use strict";function e(e,t){var i,n=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)),n}function T(r){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?e(Object(o),!0).forEach(function(t){var e,i,n;e=r,n=o[i=t],i in e?Object.defineProperty(e,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[i]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(o,t))})}return r}function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r(t,e)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(i){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=s(i);return function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,n?(t=s(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:i):r.value}}).apply(this,arguments)}function f(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,r,o=[],a=!0,s=!1;try{for(i=i.call(t);!(a=(n=i.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==i.return||i.return()}finally{if(s)throw r}}return o}}(t,e)||d(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}()||d(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){if(t){if("string"==typeof t)return a(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function E(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=d(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function m(t){return"object"===p(t)&&null!==t&&t.constructor===Object&&"[object Object]"===Object.prototype.toString.call(t)}function C(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e4;return t=parseFloat(t)||0,Math.round((t+Number.EPSILON)*e)/e}function g(t){return!!(t&&"object"===p(t)&&t instanceof Element&&t!==document.body)&&!t.__Panzoom&&(e=t,i=getComputedStyle(e)["overflow-y"],n=getComputedStyle(e)["overflow-x"],r=("scroll"===i||"auto"===i)&&1<Math.abs(e.scrollHeight-e.clientHeight),o=("scroll"===n||"auto"===n)&&1<Math.abs(e.scrollWidth-e.clientWidth),r||o?t:g(t.parentNode));var e,i,n,r,o}function x(t,e){return e?Math.sqrt(Math.pow(e.clientX-t.clientX,2)+Math.pow(e.clientY-t.clientY,2)):0}function w(t,e){return e?{clientX:(t.clientX+e.clientX)/2,clientY:(t.clientY+e.clientY)/2}:t}var v=function t(){for(var e=!1,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];"boolean"==typeof n[0]&&(e=n.shift());var o=n[0];if(!o||"object"!==p(o))throw new Error("extendee must be an object");for(var a=n.slice(1),s=a.length,c=0;c<s;c++){var l,h,u=a[c];for(var d in u){u.hasOwnProperty(d)&&(l=u[d],e&&(Array.isArray(l)||m(l))?(h=Array.isArray(l)?[]:{},o[d]=t(!0,o.hasOwnProperty(d)?o[d]:h,l)):o[d]=l)}}return o},y="undefined"!=typeof window&&window.ResizeObserver||(i(O,[{key:"observe",value:function(e){var t;this.observables.some(function(t){return t.el===e})||(t={el:e,size:{height:e.clientHeight,width:e.clientWidth}},this.observables.push(t))}},{key:"unobserve",value:function(e){this.observables=this.observables.filter(function(t){return t.el!==e})}},{key:"disconnect",value:function(){this.observables=[]}},{key:"check",value:function(){var t=this.observables.filter(function(t){var e=t.el.clientHeight,i=t.el.clientWidth;if(t.size.height!==e||t.size.width!==i)return t.size.height=e,t.size.width=i,!0}).map(function(t){return t.el});0<t.length&&this.callback(t),window.requestAnimationFrame(this.boundCheck)}}]),O),M=i(function t(e){l(this,t),this.id=self.Touch&&e instanceof Touch?e.identifier:-1,this.pageX=e.pageX,this.pageY=e.pageY,this.clientX=e.clientX,this.clientY=e.clientY}),_=function(t){return"changedTouches"in t},S=(i(I,[{key:"stop",value:function(){this._element.removeEventListener("mousedown",this._pointerStart,{passive:!1}),this._element.removeEventListener("touchstart",this._touchStart,{passive:!1}),this._element.removeEventListener("touchmove",this._move,{passive:!1}),this._element.removeEventListener("touchend",this._touchEnd),this._element.removeEventListener("touchcancel",this._touchEnd),window.removeEventListener("mousemove",this._move),window.removeEventListener("mouseup",this._pointerEnd)}},{key:"_triggerPointerStart",value:function(t,e){return!!this._startCallback(t,e)&&(this.currentPointers.push(t),this.startPointers.push(t),!0)}}]),I),A=(i(R,[{key:"option",value:function(t,e){t=String(t);var i,n,r=(i=t,n=this.options,i.split(".").reduce(function(t,e){return t&&t[e]},n));if("function"==typeof r){for(var o=arguments.length,a=new Array(2<o?o-2:0),s=2;s<o;s++)a[s-2]=arguments[s];r=r.call.apply(r,[this,this].concat(a))}return void 0===r?e:r}},{key:"localize",value:function(t){var o=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return(t=String(t).replace(/\{\{(\w+).?(\w+)?\}\}/g,function(t,e,i){var n="";i?n=o.option("".concat(e[0]+e.toLowerCase().substring(1),".l10n.").concat(i)):e&&(n=o.option("l10n.".concat(e))),n=n||t;for(var r=0;r<a.length;r++)n=n.split(a[r][0]).join(a[r][1]);return n})).replace(/\{\{(.*)\}\}/,function(t,e){return e})}},{key:"on",value:function(t,i){var n=this;if(m(t)){for(var e=0,r=Object.entries(t);e<r.length;e++){var o=r[e];this.on.apply(this,b(o))}return this}return String(t).split(" ").forEach(function(t){var e=n.events[t]=n.events[t]||[];-1==e.indexOf(i)&&e.push(i)}),this}},{key:"once",value:function(t,o){var a=this;if(m(t)){for(var e=0,i=Object.entries(t);e<i.length;e++){var n=i[e];this.once.apply(this,b(n))}return this}return String(t).split(" ").forEach(function(n){function r(){a.off(n,r);for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];o.call.apply(o,[a,a].concat(e))}r._=o,a.on(n,r)}),this}},{key:"off",value:function(t,a){var s=this;if(!m(t))return t.split(" ").forEach(function(t){var e=s.events[t];if(!e||!e.length)return s;for(var i=-1,n=0,r=e.length;n<r;n++){var o=e[n];if(o&&(o===a||o._===a)){i=n;break}}-1!=i&&e.splice(i,1)}),this;for(var e=0,i=Object.entries(t);e<i.length;e++){var n=i[e];this.off.apply(this,b(n))}}},{key:"trigger",value:function(t){for(var e=arguments.length,i=new Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];var r,o=E(b(this.events[t]||[]).slice());try{for(o.s();!(r=o.n()).done;){var a=r.value;if(a&&!1===a.call.apply(a,[this,this].concat(i)))return!1}}catch(t){o.e(t)}finally{o.f()}var s,c=E(b(this.events["*"]||[]).slice());try{for(c.s();!(s=c.n()).done;){var l=s.value;if(l&&!1===l.call.apply(l,[this,t,this].concat(i)))return!1}}catch(t){c.e(t)}finally{c.f()}return!0}},{key:"attachPlugins",value:function(t){for(var e={},i=0,n=Object.entries(t||{});i<n.length;i++){var r=f(n[i],2),o=r[0],a=r[1];!1===this.options[o]||this.plugins[o]||(this.options[o]=v({},a.defaults||{},this.options[o]),e[o]=new a(this))}for(var s=0,c=Object.entries(e);s<c.length;s++){var l=f(c[s],2);l[0],l[1].attach(this)}return this.plugins=Object.assign({},this.plugins,e),this}},{key:"detachPlugins",value:function(){for(var t in this.plugins){var e=void 0;(e=this.plugins[t])&&"function"==typeof e.detach&&e.detach(this)}return this.plugins={},this}}]),R),L={touch:!0,zoom:!0,pinchToZoom:!0,panOnlyZoomed:!1,lockAxis:!1,friction:.64,decelFriction:.88,zoomFriction:.74,bounceForce:.2,baseScale:1,minScale:1,maxScale:2,step:.5,textSelection:!1,click:"toggleZoom",wheel:"zoom",wheelFactor:42,wheelLimit:5,draggableClass:"is-draggable",draggingClass:"is-dragging",ratio:1},P=function(){o(s,A);var a=h(s);function s(t){var e,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};l(this,s),(e=a.call(this,v(!0,{},L,i))).state="init",e.$container=t;for(var n=0,r=["onLoad","onWheel","onClick"];n<r.length;n++){var o=r[n];e[o]=e[o].bind(c(e))}return e.initLayout(),e.resetValues(),e.attachPlugins(s.Plugins),e.trigger("init"),e.updateMetrics(),e.attachEvents(),e.trigger("ready"),!1===e.option("centerOnStart")?e.state="ready":e.panTo({friction:0}),t.__Panzoom=c(e),e}return i(s,[{key:"initLayout",value:function(){var t=this.$container;if(!(t instanceof HTMLElement))throw new Error("Panzoom: Container not found");var e=this.option("content")||t.querySelector(".panzoom__content");if(!e)throw new Error("Panzoom: Content not found");this.$content=e;var i=this.option("viewport")||t.querySelector(".panzoom__viewport");i||!1===this.option("wrapInner")||((i=document.createElement("div")).classList.add("panzoom__viewport"),i.append.apply(i,b(t.childNodes)),t.appendChild(i)),this.$viewport=i||e.parentNode}},{key:"resetValues",value:function(){this.updateRate=this.option("updateRate",/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?250:24),this.container={width:0,height:0},this.viewport={width:0,height:0},this.content={origWidth:0,origHeight:0,width:0,height:0,x:this.option("x",0),y:this.option("y",0),scale:this.option("baseScale")},this.transform={x:0,y:0,scale:1},this.resetDragPosition()}},{key:"onLoad",value:function(t){this.updateMetrics(),this.panTo({scale:this.option("baseScale"),friction:0}),this.trigger("load",t)}},{key:"onClick",value:function(t){if(!(t.defaultPrevented||document.activeElement&&document.activeElement.closest("[contenteditable]")))if(!this.option("textSelection")||!window.getSelection().toString().length||t.target&&t.target.hasAttribute("data-fancybox-close")){var e=this.$content.getClientRects()[0];if("ready"!==this.state&&(this.dragPosition.midPoint||1<Math.abs(e.top-this.dragStart.rect.top)||1<Math.abs(e.left-this.dragStart.rect.left)))return t.preventDefault(),void t.stopPropagation();!1!==this.trigger("click",t)&&this.option("zoom")&&"toggleZoom"===this.option("click")&&(t.preventDefault(),t.stopPropagation(),this.zoomWithClick(t))}else t.stopPropagation()}},{key:"onWheel",value:function(t){!1!==this.trigger("wheel",t)&&this.option("zoom")&&this.option("wheel")&&this.zoomWithWheel(t)}},{key:"zoomWithWheel",value:function(t){void 0===this.changedDelta&&(this.changedDelta=0);var e,i,n,r=Math.max(-1,Math.min(1,-t.deltaY||-t.deltaX||t.wheelDelta||-t.detail)),o=this.content.scale,a=o*(100+r*this.option("wheelFactor"))/100,a=r<0&&Math.abs(o-this.option("minScale"))<.01||0<r&&Math.abs(o-this.option("maxScale"))<.01?(this.changedDelta+=Math.abs(r),o):(this.changedDelta=0,Math.max(Math.min(a,this.option("maxScale")),this.option("minScale")));this.changedDelta>this.option("wheelLimit")||(t.preventDefault(),a===o)||(e=this.$content.getBoundingClientRect(),i=t.clientX-e.left,n=t.clientY-e.top,this.zoomTo(a,{x:i,y:n}))}},{key:"zoomWithClick",value:function(t){var e=this.$content.getClientRects()[0],i=t.clientX-e.left,n=t.clientY-e.top;this.toggleZoom({x:i,y:n})}},{key:"attachEvents",value:function(){var y=this;this.$content.addEventListener("load",this.onLoad),this.$container.addEventListener("wheel",this.onWheel,{passive:!1}),this.$container.addEventListener("click",this.onClick,{passive:!1}),this.initObserver();var b=new S(this.$container,{start:function(t,e){if(!y.option("touch"))return!1;if(y.velocity.scale<0)return!1;var s=e.composedPath()[0];if(!b.currentPointers.length){if(-1!==["BUTTON","TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].indexOf(s.nodeName))return!1;if(y.option("textSelection")&&function(t,e){for(var i=s.childNodes,n=document.createRange(),r=0;r<i.length;r++){var o=i[r];if(o.nodeType===Node.TEXT_NODE){n.selectNodeContents(o);var a=n.getBoundingClientRect();if(t>=a.left&&e>=a.top&&t<=a.right&&e<=a.bottom)return o}}}(t.clientX,t.clientY))return!1}return!g(s)&&!1!==y.trigger("touchStart",e)&&("mousedown"===e.type&&e.preventDefault(),y.state="pointerdown",y.resetDragPosition(),y.dragPosition.midPoint=null,y.dragPosition.time=Date.now(),!0)},move:function(t,e,i){if("pointerdown"===y.state)if(!1!==y.trigger("touchMove",i)){if(!(e.length<2&&!0===y.option("panOnlyZoomed")&&y.content.width<=y.viewport.width&&y.content.height<=y.viewport.height&&y.transform.scale<=y.option("baseScale"))&&(!(1<e.length)||y.option("zoom")&&!1!==y.option("pinchToZoom"))){var n=w(t[0],t[1]),r=w(e[0],e[1]),o=r.clientX-n.clientX,a=r.clientY-n.clientY,s=x(t[0],t[1]),c=x(e[0],e[1]),l=s&&c?c/s:1;y.dragOffset.x+=o,y.dragOffset.y+=a,y.dragOffset.scale*=l,y.dragOffset.time=Date.now()-y.dragPosition.time;var h,u,d,p,f,m,g=1===y.dragStart.scale&&y.option("lockAxis");if(g&&!y.lockAxis){if(Math.abs(y.dragOffset.x)<6&&Math.abs(y.dragOffset.y)<6)return void i.preventDefault();var v=Math.abs(180*Math.atan2(y.dragOffset.y,y.dragOffset.x)/Math.PI);y.lockAxis=45<v&&v<135?"y":"x"}"xy"!==g&&"y"===y.lockAxis||(i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation(),y.lockAxis&&(y.dragOffset["x"===y.lockAxis?"y":"x"]=0),y.$container.classList.add(y.option("draggingClass")),y.transform.scale===y.option("baseScale")&&"y"===y.lockAxis||(y.dragPosition.x=y.dragStart.x+y.dragOffset.x),y.transform.scale===y.option("baseScale")&&"x"===y.lockAxis||(y.dragPosition.y=y.dragStart.y+y.dragOffset.y),y.dragPosition.scale=y.dragStart.scale*y.dragOffset.scale,1<e.length?(u=(h=w(b.startPointers[0],b.startPointers[1])).clientX-y.dragStart.rect.x,d=h.clientY-y.dragStart.rect.y,f=(p=y.getZoomDelta(y.content.scale*y.dragOffset.scale,u,d)).deltaX,m=p.deltaY,y.dragPosition.x-=f,y.dragPosition.y-=m,y.dragPosition.midPoint=r):y.setDragResistance(),y.transform={x:y.dragPosition.x,y:y.dragPosition.y,scale:y.dragPosition.scale},y.startAnimation())}}else i.preventDefault()},end:function(t,e){var i,n,r,o;"pointerdown"===y.state&&(y._dragOffset=T({},y.dragOffset),b.currentPointers.length?y.resetDragPosition():(y.state="decel",y.friction=y.option("decelFriction"),y.recalculateTransform(),y.$container.classList.remove(y.option("draggingClass")),!1!==y.trigger("touchEnd",e)&&"decel"===y.state&&(i=y.option("minScale"),y.transform.scale<i?y.zoomTo(i,{friction:.64}):(n=y.option("maxScale"),.01<y.transform.scale-n&&(r=y.dragPosition.midPoint||t,o=y.$content.getClientRects()[0],y.zoomTo(n,{friction:.64,x:r.clientX-o.left,y:r.clientY-o.top}))))))}});this.pointerTracker=b}},{key:"initObserver",value:function(){var e=this;this.resizeObserver||(this.resizeObserver=new y(function(){e.updateTimer||(e.updateTimer=setTimeout(function(){var t=e.$container.getBoundingClientRect();t.width&&t.height&&(1<Math.abs(t.width-e.container.width)||1<Math.abs(t.height-e.container.height))&&(e.isAnimating()&&e.endAnimation(!0),e.updateMetrics(),e.panTo({x:e.content.x,y:e.content.y,scale:e.option("baseScale"),friction:0})),e.updateTimer=null},e.updateRate))}),this.resizeObserver.observe(this.$container))}},{key:"resetDragPosition",value:function(){this.lockAxis=null,this.friction=this.option("friction"),this.velocity={x:0,y:0,scale:0};var t=this.content,e=t.x,i=t.y,n=t.scale;this.dragStart={rect:this.$content.getBoundingClientRect(),x:e,y:i,scale:n},this.dragPosition=T(T({},this.dragPosition),{},{x:e,y:i,scale:n}),this.dragOffset={x:0,y:0,scale:1,time:0}}},{key:"updateMetrics",value:function(t){!0!==t&&this.trigger("beforeUpdate");var e,i,n=this.$container,r=this.$content,o=this.$viewport,a=r instanceof HTMLImageElement,s=this.option("zoom"),c=this.option("resizeParent",s),l=this.option("width"),h=this.option("height"),u=l||(e=r,Math.max(parseFloat(e.naturalWidth||0),parseFloat(e.width&&e.width.baseVal&&e.width.baseVal.value||0),parseFloat(e.offsetWidth||0),parseFloat(e.scrollWidth||0))),d=h||(i=r,Math.max(parseFloat(i.naturalHeight||0),parseFloat(i.height&&i.height.baseVal&&i.height.baseVal.value||0),parseFloat(i.offsetHeight||0),parseFloat(i.scrollHeight||0)));Object.assign(r.style,{width:l?"".concat(l,"px"):"",height:h?"".concat(h,"px"):"",maxWidth:"",maxHeight:""}),c&&Object.assign(o.style,{width:"",height:""});var p=this.option("ratio");l=u=C(u*p),h=d=C(d*p);var f,m,g,v,y,b,x,w=r.getBoundingClientRect(),E=o.getBoundingClientRect(),M=o==n?E:n.getBoundingClientRect(),_=Math.max(o.offsetWidth,C(E.width)),S=Math.max(o.offsetHeight,C(E.height)),A=window.getComputedStyle(o);_-=parseFloat(A.paddingLeft)+parseFloat(A.paddingRight),S-=parseFloat(A.paddingTop)+parseFloat(A.paddingBottom),this.viewport.width=_,this.viewport.height=S,s&&((.1<Math.abs(u-w.width)||.1<Math.abs(d-w.height))&&(m=u,g=d,v=Math.min(u,w.width),y=Math.min(d,w.height),b=Math.min(v/m||0,y/g),l=C((f={width:m*b||0,height:g*b||0}).width),h=C(f.height)),Object.assign(r.style,{width:"".concat(l,"px"),height:"".concat(h,"px"),transform:""})),c&&(Object.assign(o.style,{width:"".concat(l,"px"),height:"".concat(h,"px")}),this.viewport=T(T({},this.viewport),{},{width:l,height:h})),a&&s&&"function"!=typeof this.options.maxScale&&(x=this.option("maxScale"),this.options.maxScale=function(){return 0<this.content.origWidth&&0<this.content.fitWidth?this.content.origWidth/this.content.fitWidth:x}),this.content=T(T({},this.content),{},{origWidth:u,origHeight:d,fitWidth:l,fitHeight:h,width:l,height:h,scale:1,isZoomable:s}),this.container={width:M.width,height:M.height},!0!==t&&this.trigger("afterUpdate")}},{key:"zoomIn",value:function(t){this.zoomTo(this.content.scale+(t||this.option("step")))}},{key:"zoomOut",value:function(t){this.zoomTo(this.content.scale-(t||this.option("step")))}},{key:"toggleZoom",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=this.option("maxScale"),i=this.option("baseScale"),n=this.content.scale>i+.5*(e-i)?i:e;this.zoomTo(n,t)}},{key:"zoomTo",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.option("baseScale"),e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=e.x,n=void 0===i?null:i,r=e.y,o=void 0===r?null:r,t=Math.max(Math.min(t,this.option("maxScale")),this.option("minScale")),a=C(this.content.scale/(this.content.width/this.content.fitWidth),1e7);null===n&&(n=this.content.width*a*.5),null===o&&(o=this.content.height*a*.5);var s=this.getZoomDelta(t,n,o),c=s.deltaX,l=s.deltaY,n=this.content.x-c,o=this.content.y-l;this.panTo({x:n,y:o,scale:t,friction:this.option("zoomFriction")})}},{key:"getZoomDelta",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=this.content.fitWidth*this.content.scale,r=this.content.fitHeight*this.content.scale,o=0<e&&n?e/n:0,a=0<i&&r?i/r:0;return{deltaX:(this.content.fitWidth*t-n)*o,deltaY:(this.content.fitHeight*t-r)*a}}},{key:"panTo",value:function(){var t,e,i,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=n.x,o=void 0===r?this.content.x:r,a=n.y,s=void 0===a?this.content.y:a,c=n.scale,l=n.friction,h=void 0===l?this.option("friction"):l,u=n.ignoreBounds,d=void 0!==u&&u,c=c||this.content.scale||1;d||(e=(t=this.getBounds(c)).boundX,i=t.boundY,e&&(o=Math.max(Math.min(o,e.to),e.from)),i&&(s=Math.max(Math.min(s,i.to),i.from))),this.friction=h,this.transform=T(T({},this.transform),{},{x:o,y:s,scale:c}),h?(this.state="panning",this.velocity={x:(1/this.friction-1)*(o-this.content.x),y:(1/this.friction-1)*(s-this.content.y),scale:(1/this.friction-1)*(c-this.content.scale)},this.startAnimation()):this.endAnimation()}},{key:"startAnimation",value:function(){var t=this;this.rAF?cancelAnimationFrame(this.rAF):this.trigger("startAnimation"),this.rAF=requestAnimationFrame(function(){return t.animate()})}},{key:"animate",value:function(){var t=this;if(this.setEdgeForce(),this.setDragForce(),this.velocity.x*=this.friction,this.velocity.y*=this.friction,this.velocity.scale*=this.friction,this.content.x+=this.velocity.x,this.content.y+=this.velocity.y,this.content.scale+=this.velocity.scale,this.isAnimating())this.setTransform();else if("pointerdown"!==this.state)return void this.endAnimation();this.rAF=requestAnimationFrame(function(){return t.animate()})}},{key:"getBounds",value:function(t){var e=this.boundX,i=this.boundY;if(void 0!==e&&void 0!==i)return{boundX:e,boundY:i};e={from:0,to:0},i={from:0,to:0},t=t||this.transform.scale;var n,r,o=this.content.fitWidth*t,a=this.content.fitHeight*t,s=this.viewport.width,c=this.viewport.height;return o<s?(n=C(.5*(s-o)),e.from=n,e.to=n):e.from=C(s-o),a<c?(r=.5*(c-a),i.from=r,i.to=r):i.from=C(c-a),{boundX:e,boundY:i}}},{key:"setEdgeForce",value:function(){var t,e,i,n,r,o,a,s,c,l,h,u;"decel"===this.state&&(r=this.option("bounceForce"),a=(o=this.getBounds(Math.max(this.transform.scale,this.content.scale))).boundX,s=o.boundY,a&&(t=this.content.x<a.from,e=this.content.x>a.to),s&&(i=this.content.y<s.from,n=this.content.y>s.to),(t||e)&&(c=((t?a.from:a.to)-this.content.x)*r,(l=this.content.x+(this.velocity.x+c)/this.friction)>=a.from&&l<=a.to&&(c+=this.velocity.x),this.velocity.x=c,this.recalculateTransform()),(i||n)&&(h=((i?s.from:s.to)-this.content.y)*r,(u=this.content.y+(h+this.velocity.y)/this.friction)>=s.from&&u<=s.to&&(h+=this.velocity.y),this.velocity.y=h,this.recalculateTransform()))}},{key:"setDragResistance",value:function(){var t,e,i,n,r,o,a,s,c,l,h;"pointerdown"===this.state&&(o=(r=this.getBounds(this.dragPosition.scale)).boundX,a=r.boundY,o&&(t=this.dragPosition.x<o.from,e=this.dragPosition.x>o.to),a&&(i=this.dragPosition.y<a.from,n=this.dragPosition.y>a.to),!t&&!e||t&&e||(c=(s=t?o.from:o.to)-this.dragPosition.x,this.dragPosition.x=s-.3*c),!i&&!n||i&&n||(h=(l=i?a.from:a.to)-this.dragPosition.y,this.dragPosition.y=l-.3*h))}},{key:"setDragForce",value:function(){"pointerdown"===this.state&&(this.velocity.x=this.dragPosition.x-this.content.x,this.velocity.y=this.dragPosition.y-this.content.y,this.velocity.scale=this.dragPosition.scale-this.content.scale)}},{key:"recalculateTransform",value:function(){this.transform.x=this.content.x+this.velocity.x/(1/this.friction-1),this.transform.y=this.content.y+this.velocity.y/(1/this.friction-1),this.transform.scale=this.content.scale+this.velocity.scale/(1/this.friction-1)}},{key:"isAnimating",value:function(){return!(!this.friction||!(.05<Math.abs(this.velocity.x)||.05<Math.abs(this.velocity.y)||.05<Math.abs(this.velocity.scale)))}},{key:"setTransform",value:function(t){var e,i,n,r,o;t?(e=C(this.transform.x),i=C(this.transform.y),n=this.transform.scale,this.content=T(T({},this.content),{},{x:e,y:i,scale:n})):(e=C(this.content.x),i=C(this.content.y),n=this.content.scale/(this.content.width/this.content.fitWidth),this.content=T(T({},this.content),{},{x:e,y:i})),this.trigger("beforeTransform"),e=C(this.content.x),i=C(this.content.y),t&&this.option("zoom")?(r=C(this.content.fitWidth*n),o=C(this.content.fitHeight*n),this.content.width=r,this.content.height=o,this.transform=T(T({},this.transform),{},{width:r,height:o,scale:n}),Object.assign(this.$content.style,{width:"".concat(r,"px"),height:"".concat(o,"px"),maxWidth:"none",maxHeight:"none",transform:"translate3d(".concat(e,"px, ").concat(i,"px, 0) scale(1)")})):this.$content.style.transform="translate3d(".concat(e,"px, ").concat(i,"px, 0) scale(").concat(n,")"),this.trigger("afterTransform")}},{key:"endAnimation",value:function(t){cancelAnimationFrame(this.rAF),this.rAF=null,this.velocity={x:0,y:0,scale:0},this.setTransform(!0),this.state="ready",this.handleCursor(),!0!==t&&this.trigger("endAnimation")}},{key:"handleCursor",value:function(){var t=this.option("draggableClass");t&&this.option("touch")&&(1==this.option("panOnlyZoomed")&&this.content.width<=this.viewport.width&&this.content.height<=this.viewport.height&&this.transform.scale<=this.option("baseScale")?this.$container.classList.remove(t):this.$container.classList.add(t))}},{key:"detachEvents",value:function(){this.$content.removeEventListener("load",this.onLoad),this.$container.removeEventListener("wheel",this.onWheel,{passive:!1}),this.$container.removeEventListener("click",this.onClick,{passive:!1}),this.pointerTracker&&(this.pointerTracker.stop(),this.pointerTracker=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}},{key:"destroy",value:function(){"destroy"!==this.state&&(this.state="destroy",clearTimeout(this.updateTimer),this.updateTimer=null,cancelAnimationFrame(this.rAF),this.rAF=null,this.detachEvents(),this.detachPlugins(),this.resetDragPosition())}}]),s}();function R(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};l(this,R),this.options=v(!0,{},t),this.plugins=[],this.events={};for(var e=0,i=["on","once"];e<i.length;e++)for(var n=i[e],r=0,o=Object.entries(this.options[n]||{});r<o.length;r++){var a=o[r];this[n].apply(this,b(a))}}function I(t){var a=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=e.start,n=void 0===i?function(){return!0}:i,r=e.move,o=void 0===r?function(){}:r,s=e.end,c=void 0===s?function(){}:s;l(this,I),this._element=t,this.startPointers=[],this.currentPointers=[],this._pointerStart=function(t){var e;0<t.buttons&&0!==t.button||(e=new M(t),a.currentPointers.some(function(t){return t.id===e.id})||a._triggerPointerStart(e,t)&&(window.addEventListener("mousemove",a._move),window.addEventListener("mouseup",a._pointerEnd)))},this._touchStart=function(t){for(var e=0,i=Array.from(t.changedTouches||[]);e<i.length;e++){var n=i[e];a._triggerPointerStart(new M(n),t)}},this._move=function(t){var i,e=a.currentPointers.slice(),n=_(t)?Array.from(t.changedTouches).map(function(t){return new M(t)}):[new M(t)],r=[],o=E(n);try{for(o.s();!(i=o.n()).done;)!function(){var e=i.value,t=a.currentPointers.findIndex(function(t){return t.id===e.id});if(t<0)return;r.push(e),a.currentPointers[t]=e}()}catch(t){o.e(t)}finally{o.f()}a._moveCallback(e,a.currentPointers.slice(),t)},this._triggerPointerEnd=function(e,t){var i=a.currentPointers.findIndex(function(t){return t.id===e.id});return!(i<0||(a.currentPointers.splice(i,1),a.startPointers.splice(i,1),a._endCallback(e,t),0))},this._pointerEnd=function(t){0<t.buttons&&0!==t.button||a._triggerPointerEnd(new M(t),t)&&(window.removeEventListener("mousemove",a._move,{passive:!1}),window.removeEventListener("mouseup",a._pointerEnd,{passive:!1}))},this._touchEnd=function(t){for(var e=0,i=Array.from(t.changedTouches||[]);e<i.length;e++){var n=i[e];a._triggerPointerEnd(new M(n),t)}},this._startCallback=n,this._moveCallback=o,this._endCallback=c,this._element.addEventListener("mousedown",this._pointerStart,{passive:!1}),this._element.addEventListener("touchstart",this._touchStart,{passive:!1}),this._element.addEventListener("touchmove",this._move,{passive:!1}),this._element.addEventListener("touchend",this._touchEnd),this._element.addEventListener("touchcancel",this._touchEnd)}function O(t){l(this,O),this.observables=[],this.boundCheck=this.check.bind(this),this.boundCheck(),this.callback=t}P.version="4.0.31",P.Plugins={};var D=function(e,i){var n=0;return function(){var t=(new Date).getTime();if(!(t-n<i))return n=t,e.apply(void 0,arguments)}},k=(i(N,[{key:"option",value:function(t){return this.carousel.option("Navigation.".concat(t))}},{key:"createButton",value:function(e){var t,i=this,n=document.createElement("button");n.setAttribute("title",this.carousel.localize("{{".concat(e.toUpperCase(),"}}")));var r=this.option("classNames.button")+" "+this.option("classNames.".concat(e));return(t=n.classList).add.apply(t,b(r.split(" "))),n.setAttribute("tabindex","0"),n.innerHTML=this.carousel.localize(this.option("".concat(e,"Tpl"))),n.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),i.carousel["slide".concat("next"===e?"Next":"Prev")]()}),n}},{key:"build",value:function(){var t;this.$container||(this.$container=document.createElement("div"),(t=this.$container.classList).add.apply(t,b(this.option("classNames.main").split(" "))),this.carousel.$container.appendChild(this.$container)),this.$next||(this.$next=this.createButton("next"),this.$container.appendChild(this.$next)),this.$prev||(this.$prev=this.createButton("prev"),this.$container.appendChild(this.$prev))}},{key:"onRefresh",value:function(){var t=this.carousel.pages.length;t<=1||1<t&&this.carousel.elemDimWidth<this.carousel.wrapDimWidth&&!Number.isInteger(this.carousel.option("slidesPerPage"))?this.cleanup():(this.build(),this.$prev.removeAttribute("disabled"),this.$next.removeAttribute("disabled"),this.carousel.option("infiniteX",this.carousel.option("infinite"))||(this.carousel.page<=0&&this.$prev.setAttribute("disabled",""),this.carousel.page>=t-1&&this.$next.setAttribute("disabled","")))}},{key:"cleanup",value:function(){this.$prev&&this.$prev.remove(),this.$prev=null,this.$next&&this.$next.remove(),this.$next=null,this.$container&&this.$container.remove(),this.$container=null}},{key:"attach",value:function(){this.carousel.on("refresh change",this.onRefresh)}},{key:"detach",value:function(){this.carousel.off("refresh change",this.onRefresh),this.cleanup()}}]),N);function N(t){l(this,N),this.$container=null,this.$prev=null,this.$next=null,this.carousel=t,this.onRefresh=this.onRefresh.bind(this)}k.defaults={prevTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M15 3l-9 9 9 9"/></svg>',nextTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M9 3l9 9-9 9"/></svg>',classNames:{main:"carousel__nav",button:"carousel__button",next:"is-next",prev:"is-prev"}};var z=(i(U,[{key:"buildList",value:function(){var n=this;if(!(this.carousel.pages.length<this.carousel.option("Dots.minSlideCount"))){var t=document.createElement("ol");return t.classList.add("carousel__dots"),t.addEventListener("click",function(t){var e,i;"page"in t.target.dataset&&(t.preventDefault(),t.stopPropagation(),(e=parseInt(t.target.dataset.page,10))!==(i=n.carousel).page&&(i.pages.length<3&&i.option("infinite")?i[0==e?"slidePrev":"slideNext"]():i.slideTo(e)))}),this.$list=t,this.carousel.$container.appendChild(t),this.carousel.$container.classList.add("has-dots"),t}}},{key:"removeList",value:function(){this.$list&&(this.$list.parentNode.removeChild(this.$list),this.$list=null),this.carousel.$container.classList.remove("has-dots")}},{key:"rebuildDots",value:function(){var e=this,t=this.$list,i=!!t,n=this.carousel.pages.length;if(n<2)i&&this.removeList();else{i||this.buildList();var r=this.$list.children.length;if(n<r)for(var o=n;o<r;o++)this.$list.removeChild(this.$list.lastChild);else{for(var a=r;a<n;a++)!function(t){var n=document.createElement("li");n.classList.add("carousel__dot"),n.dataset.page=t,n.setAttribute("role","button"),n.setAttribute("tabindex","0"),n.setAttribute("title",e.carousel.localize("{{GOTO}}",[["%d",t+1]])),n.addEventListener("keydown",function(t){var e,i=t.code;"Enter"===i||"NumpadEnter"===i?e=n:"ArrowRight"===i?e=n.nextSibling:"ArrowLeft"===i&&(e=n.previousSibling),e&&e.click()}),e.$list.appendChild(n)}(a);this.setActiveDot()}}}},{key:"setActiveDot",value:function(){var t;this.$list&&(this.$list.childNodes.forEach(function(t){t.classList.remove("is-selected")}),(t=this.$list.childNodes[this.carousel.page])&&t.classList.add("is-selected"))}},{key:"onChange",value:function(){this.setActiveDot()}},{key:"onRefresh",value:function(){this.rebuildDots()}},{key:"attach",value:function(){this.carousel.on(this.events)}},{key:"detach",value:function(){this.removeList(),this.carousel.off(this.events),this.carousel=null}}]),U),B=(i(F,[{key:"addAsTargetFor",value:function(t){this.target=this.carousel,this.nav=t,this.attachEvents()}},{key:"addAsNavFor",value:function(t){this.target=t,this.nav=this.carousel,this.attachEvents()}},{key:"attachEvents",value:function(){this.nav.options.initialSlide=this.target.options.initialPage,this.nav.on("ready",this.onNavReady),this.nav.on("createSlide",this.onNavCreateSlide),this.nav.on("Panzoom.click",this.onNavClick),this.target.on("change",this.onTargetChange),this.target.on("Panzoom.afterUpdate",this.onTargetChange)}},{key:"onNavReady",value:function(){this.onTargetChange(!0)}},{key:"onNavClick",value:function(t,e,i){var n,r,o=i.target.closest(".carousel__slide");o&&(i.stopPropagation(),n=parseInt(o.dataset.index,10),r=this.target.findPageForSlide(n),this.target.page!==r&&this.target.slideTo(r,{friction:this.friction}),this.markSelectedSlide(n))}},{key:"onNavCreateSlide",value:function(t,e){e.index===this.selectedIndex&&this.markSelectedSlide(e.index)}},{key:"onTargetChange",value:function(){var t=this.target.pages[this.target.page].indexes[0],e=this.nav.findPageForSlide(t);this.nav.slideTo(e),this.markSelectedSlide(t)}},{key:"markSelectedSlide",value:function(t){this.selectedIndex=t,b(this.nav.slides).filter(function(t){return t.$el&&t.$el.classList.remove("is-nav-selected")});var e=this.nav.slides[t];e&&e.$el&&e.$el.classList.add("is-nav-selected")}},{key:"attach",value:function(t){var e=t.options.Sync;(e.target||e.nav)&&(e.target?this.addAsNavFor(e.target):e.nav&&this.addAsTargetFor(e.nav),this.friction=e.friction)}},{key:"detach",value:function(){this.nav&&(this.nav.off("ready",this.onNavReady),this.nav.off("Panzoom.click",this.onNavClick),this.nav.off("createSlide",this.onNavCreateSlide)),this.target&&(this.target.off("Panzoom.afterUpdate",this.onTargetChange),this.target.off("change",this.onTargetChange))}}]),F);function F(t){l(this,F),this.carousel=t,this.selectedIndex=null,this.friction=0,this.onNavReady=this.onNavReady.bind(this),this.onNavClick=this.onNavClick.bind(this),this.onNavCreateSlide=this.onNavCreateSlide.bind(this),this.onTargetChange=this.onTargetChange.bind(this)}function U(t){l(this,U),this.carousel=t,this.$list=null,this.events={change:this.onChange.bind(this),refresh:this.onRefresh.bind(this)}}B.defaults={friction:.92};var j={Navigation:k,Dots:z,Sync:B},H={slides:[],preload:0,slidesPerPage:"auto",initialPage:null,initialSlide:null,friction:.92,center:!0,infinite:!0,fill:!0,dragFree:!1,prefix:"",classNames:{viewport:"carousel__viewport",track:"carousel__track",slide:"carousel__slide",slideSelected:"is-selected"},l10n:{NEXT:"Next slide",PREV:"Previous slide",GOTO:"Go to slide #%d"}},G=function(){o(r,A);var n=h(r);function r(t){var e,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(l(this,r),i=v(!0,{},H,i),(e=n.call(this,i)).state="init",e.$container=t,!(e.$container instanceof HTMLElement))throw new Error("No root element provided");return e.slideNext=D(e.slideNext.bind(c(e)),250),e.slidePrev=D(e.slidePrev.bind(c(e)),250),e.init(),t.__Carousel=c(e),e}return i(r,[{key:"init",value:function(){this.pages=[],this.page=this.pageIndex=null,this.prevPage=this.prevPageIndex=null,this.attachPlugins(r.Plugins),this.trigger("init"),this.initLayout(),this.initSlides(),this.updateMetrics(),this.$track&&this.pages.length&&(this.$track.style.transform="translate3d(".concat(-1*this.pages[this.page].left,"px, 0px, 0) scale(1)")),this.manageSlideVisiblity(),this.initPanzoom(),this.state="ready",this.trigger("ready")}},{key:"initLayout",value:function(){var t,e,i,n,r=this.option("prefix"),o=this.option("classNames");this.$viewport=this.option("viewport")||this.$container.querySelector(".".concat(r).concat(o.viewport)),this.$viewport||(this.$viewport=document.createElement("div"),(t=this.$viewport.classList).add.apply(t,b((r+o.viewport).split(" "))),(e=this.$viewport).append.apply(e,b(this.$container.childNodes)),this.$container.appendChild(this.$viewport)),this.$track=this.option("track")||this.$container.querySelector(".".concat(r).concat(o.track)),this.$track||(this.$track=document.createElement("div"),(i=this.$track.classList).add.apply(i,b((r+o.track).split(" "))),(n=this.$track).append.apply(n,b(this.$viewport.childNodes)),this.$viewport.appendChild(this.$track))}},{key:"initSlides",value:function(){var i=this;this.slides=[],this.$viewport.querySelectorAll(".".concat(this.option("prefix")).concat(this.option("classNames.slide"))).forEach(function(t){var e={$el:t,isDom:!0};i.slides.push(e),i.trigger("createSlide",e,i.slides.length)}),Array.isArray(this.options.slides)&&(this.slides=v(!0,b(this.slides),this.options.slides))}},{key:"updateMetrics",value:function(){var r,o=this,a=0,s=[];this.slides.forEach(function(t,e){var i=t.$el,n=t.isDom||!r?o.getSlideMetrics(i):r;t.index=e,t.width=n,t.left=a,a+=r=n,s.push(e)});var i=Math.max(this.$track.offsetWidth,C(this.$track.getBoundingClientRect().width)),t=getComputedStyle(this.$track);i-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),this.contentWidth=a,this.viewportWidth=i;var e=[],n=this.option("slidesPerPage");if(Number.isInteger(n)&&i<a)for(var c=0;c<this.slides.length;c+=n)e.push({indexes:s.slice(c,c+n),slides:this.slides.slice(c,c+n)});else for(var l=0,h=0,u=0;u<this.slides.length;u+=1){var d=this.slides[u];(!e.length||h+d.width>i)&&(e.push({indexes:[],slides:[]}),l=e.length-1,h=0),h+=d.width,e[l].indexes.push(u),e[l].slides.push(d)}var p=this.option("center"),f=this.option("fill");e.forEach(function(t,e){t.index=e,t.width=t.slides.reduce(function(t,e){return t+e.width},0),t.left=t.slides[0].left,p&&(t.left+=.5*(i-t.width)*-1),f&&!o.option("infiniteX",o.option("infinite"))&&i<a&&(t.left=Math.max(t.left,0),t.left=Math.min(t.left,a-i))});var m,g=[];e.forEach(function(t){var e=T({},t);m&&e.left===m.left?(m.width+=e.width,m.slides=[].concat(b(m.slides),b(e.slides)),m.indexes=[].concat(b(m.indexes),b(e.indexes))):(e.index=g.length,m=e,g.push(e))}),this.pages=g;var v,y=this.page;null===y&&(y=null!==(v=this.option("initialSlide"))?this.findPageForSlide(v):parseInt(this.option("initialPage",0),10)||0,g[y]||(y=g.length&&y>g.length?g[g.length-1].index:0),this.page=y,this.pageIndex=y),this.updatePanzoom(),this.trigger("refresh")}},{key:"getSlideMetrics",value:function(t){var e,i,n;t||(n=this.slides[0],(t=document.createElement("div")).dataset.isTestEl=1,t.style.visibility="hidden",(e=t.classList).add.apply(e,b((this.option("prefix")+this.option("classNames.slide")).split(" "))),n.customClass&&(i=t.classList).add.apply(i,b(n.customClass.split(" "))),this.$track.prepend(t));var r=Math.max(t.offsetWidth,C(t.getBoundingClientRect().width)),o=t.currentStyle||window.getComputedStyle(t),r=r+(parseFloat(o.marginLeft)||0)+(parseFloat(o.marginRight)||0);return t.dataset.isTestEl&&t.remove(),r}},{key:"findPageForSlide",value:function(e){e=parseInt(e,10)||0;var t=this.pages.find(function(t){return-1<t.indexes.indexOf(e)});return t?t.index:null}},{key:"slideNext",value:function(){this.slideTo(this.pageIndex+1)}},{key:"slidePrev",value:function(){this.slideTo(this.pageIndex-1)}},{key:"slideTo",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=e.x,n=void 0===i?-1*this.setPage(t,!0):i,r=e.y,o=void 0===r?0:r,a=e.friction,s=void 0===a?this.option("friction"):a;this.Panzoom.content.x===n&&!this.Panzoom.velocity.x&&s||(this.Panzoom.panTo({x:n,y:o,friction:s,ignoreBounds:!0}),"ready"===this.state&&"ready"===this.Panzoom.state&&this.trigger("settle"))}},{key:"initPanzoom",value:function(){var r=this;this.Panzoom&&this.Panzoom.destroy();var t=v(!0,{},{content:this.$track,wrapInner:!1,resizeParent:!1,zoom:!1,click:!1,lockAxis:"x",x:this.pages.length?-1*this.pages[this.page].left:0,centerOnStart:!1,textSelection:function(){return r.option("textSelection",!1)},panOnlyZoomed:function(){return this.content.width<=this.viewport.width}},this.option("Panzoom"));this.Panzoom=new P(this.$container,t),this.Panzoom.on({"*":function(t){for(var e=arguments.length,i=new Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return r.trigger.apply(r,["Panzoom.".concat(t)].concat(i))},afterUpdate:function(){r.updatePage()},beforeTransform:this.onBeforeTransform.bind(this),touchEnd:this.onTouchEnd.bind(this),endAnimation:function(){r.trigger("settle")}}),this.updateMetrics(),this.manageSlideVisiblity()}},{key:"updatePanzoom",value:function(){this.Panzoom&&(this.Panzoom.content=T(T({},this.Panzoom.content),{},{fitWidth:this.contentWidth,origWidth:this.contentWidth,width:this.contentWidth}),1<this.pages.length&&this.option("infiniteX",this.option("infinite"))?this.Panzoom.boundX=null:this.pages.length&&(this.Panzoom.boundX={from:-1*this.pages[this.pages.length-1].left,to:-1*this.pages[0].left}),this.option("infiniteY",this.option("infinite"))?this.Panzoom.boundY=null:this.Panzoom.boundY={from:0,to:0},this.Panzoom.handleCursor())}},{key:"manageSlideVisiblity",value:function(){var s=this,c=this.contentWidth,l=this.viewportWidth,h=this.Panzoom?-1*this.Panzoom.content.x:this.pages.length?this.pages[this.page].left:0,u=this.option("preload"),d=this.option("infiniteX",this.option("infinite")),p=parseFloat(getComputedStyle(this.$viewport,null).getPropertyValue("padding-left")),f=parseFloat(getComputedStyle(this.$viewport,null).getPropertyValue("padding-right"));this.slides.forEach(function(t){var e=0,i=h-p,n=h+l+f;i-=u*(l+p+f),n+=u*(l+p+f);var r=t.left+t.width>i&&t.left<n;i=h+c-p,n=h+c+l+f,i-=u*(l+p+f);var o=d&&t.left+t.width>i&&t.left<n;i=h-c-p,n=h-c+l+f,i-=u*(l+p+f);var a=d&&t.left+t.width>i&&t.left<n;o||r||a?(s.createSlideEl(t),r&&(e=0),o&&(e=-1),a&&(e=1),t.left+t.width>h&&t.left<=h+l+f&&(e=0)):s.removeSlideEl(t),t.hasDiff=e});var n=0,r=0;this.slides.forEach(function(t,e){var i=0;t.$el?(e!==n||t.hasDiff?i=r+t.hasDiff*c:r=0,t.$el.style.left=.1<Math.abs(i)?"".concat(r+t.hasDiff*c,"px"):"",n++):r+=t.width}),this.markSelectedSlides()}},{key:"createSlideEl",value:function(t){var e;if(t){if(!t.$el){var i,n=document.createElement("div");n.dataset.index=t.index,(e=n.classList).add.apply(e,b((this.option("prefix")+this.option("classNames.slide")).split(" "))),t.customClass&&(i=n.classList).add.apply(i,b(t.customClass.split(" "))),t.html&&(n.innerHTML=t.html);var r=[];this.slides.forEach(function(t,e){t.$el&&r.push(e)});var o,a=t.index,s=null;return r.length&&(o=r.reduce(function(t,e){return Math.abs(e-a)<Math.abs(t-a)?e:t}),s=this.slides[o]),this.$track.insertBefore(n,s&&s.$el?s.index<t.index?s.$el.nextSibling:s.$el:null),t.$el=n,this.trigger("createSlide",t,a),t}var c,l=t.$el.dataset.index;l&&parseInt(l,10)===t.index||(t.$el.dataset.index=t.index,t.$el.querySelectorAll("[data-lazy-srcset]").forEach(function(t){t.srcset=t.dataset.lazySrcset}),t.$el.querySelectorAll("[data-lazy-src]").forEach(function(t){var e=t.dataset.lazySrc;t instanceof HTMLImageElement?t.src=e:t.style.backgroundImage="url('".concat(e,"')")}),(c=t.$el.dataset.lazySrc)&&(t.$el.style.backgroundImage="url('".concat(c,"')")),t.state="ready")}}},{key:"removeSlideEl",value:function(t){t.$el&&!t.isDom&&(this.trigger("removeSlide",t),t.$el.remove(),t.$el=null)}},{key:"markSelectedSlides",value:function(){var r=this,o=this.option("classNames.slideSelected"),a="aria-hidden";this.slides.forEach(function(t,e){var i,n=t.$el;n&&((i=r.pages[r.page])&&i.indexes&&-1<i.indexes.indexOf(e)?(o&&!n.classList.contains(o)&&(n.classList.add(o),r.trigger("selectSlide",t)),n.removeAttribute(a)):(o&&n.classList.contains(o)&&(n.classList.remove(o),r.trigger("unselectSlide",t)),n.setAttribute(a,!0)))})}},{key:"updatePage",value:function(){this.updateMetrics(),this.slideTo(this.page,{friction:0})}},{key:"onBeforeTransform",value:function(){this.option("infiniteX",this.option("infinite"))&&this.manageInfiniteTrack(),this.manageSlideVisiblity()}},{key:"manageInfiniteTrack",value:function(){var t=this.contentWidth,e=this.viewportWidth;if(!(!this.option("infiniteX",this.option("infinite"))||this.pages.length<2||t<e)){var i=this.Panzoom,n=!1;return i.content.x<-1*(t-e)&&(i.content.x+=t,this.pageIndex=this.pageIndex-this.pages.length,n=!0),i.content.x>e&&(i.content.x-=t,this.pageIndex=this.pageIndex+this.pages.length,n=!0),n&&"pointerdown"===i.state&&i.resetDragPosition(),n}}},{key:"onTouchEnd",value:function(t,e){var i,n=this.option("dragFree");!n&&1<this.pages.length&&t.dragOffset.time<350&&Math.abs(t.dragOffset.y)<1&&5<Math.abs(t.dragOffset.x)?this[t.dragOffset.x<0?"slideNext":"slidePrev"]():n?(i=f(this.getPageFromPosition(-1*t.transform.x),2)[1],this.setPage(i)):this.slideToClosest()}},{key:"slideToClosest",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=f(this.getPageFromPosition(-1*this.Panzoom.content.x),2)[1];this.slideTo(e,t)}},{key:"getPageFromPosition",value:function(e){var t=this.pages.length;this.option("center")&&(e+=.5*this.viewportWidth);var i=Math.floor(e/this.contentWidth);e-=i*this.contentWidth;var n=this.slides.find(function(t){return t.left<=e&&t.left+t.width>e});if(n){var r=this.findPageForSlide(n.index);return[r,r+i*t]}return[0,0]}},{key:"setPage",value:function(t,e){var i,n,r,o,a,s,c,l=0,h=parseInt(t,10)||0,u=this.page,d=this.pageIndex,p=this.pages.length,f=this.contentWidth,m=this.viewportWidth;return t=(h%p+p)%p,this.option("infiniteX",this.option("infinite"))&&m<f?(i=Math.floor(h/p)||0,l=this.pages[t].left+i*f,!0===e&&2<p&&(n=-1*this.Panzoom.content.x,r=l-f,o=l+f,a=Math.abs(n-l),s=Math.abs(n-r),(c=Math.abs(n-o))<a&&c<=s?(l=o,h+=p):s<a&&s<c&&(l=r,h-=p))):(t=h=Math.max(0,Math.min(h,p-1)),l=this.pages.length?this.pages[t].left:0),this.page=t,this.pageIndex=h,null!==u&&t!==u&&(this.prevPage=u,this.prevPageIndex=d,this.trigger("change",t,u)),l}},{key:"destroy",value:function(){var e=this;this.state="destroy",this.slides.forEach(function(t){e.removeSlideEl(t)}),this.slides=[],this.Panzoom.destroy(),this.detachPlugins()}}]),r}();G.version="4.0.31",G.Plugins=j;function V(t){if(t&&W){null===q&&document.createElement("div").focus({get preventScroll(){return!(q=!0)}});try{var e,i;t.setActive?t.setActive():q?t.focus({preventScroll:!0}):(e=window.pageXOffset||document.body.scrollTop,i=window.pageYOffset||document.body.scrollLeft,t.focus(),document.body.scrollTo({top:e,left:i,behavior:"auto"}))}catch(t){}}}var W=!("undefined"==typeof window||!window.document||!window.document.createElement),q=null,X=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","video","audio","[contenteditable]",'[tabindex]:not([tabindex^="-"]):not([disabled]):not([aria-hidden])'],Y=(i(J,[{key:"onReady",value:function(){var t=window.visualViewport;t&&(this.viewport=t,this.startY=0,t.addEventListener("resize",this.onResize),this.updateViewport()),window.addEventListener("touchstart",this.onTouchstart,{passive:!1}),window.addEventListener("touchmove",this.onTouchmove,{passive:!1}),window.addEventListener("wheel",this.onWheel,{passive:!1})}},{key:"onResize",value:function(){this.updateViewport()}},{key:"updateViewport",value:function(){var t,e,i,n=this.fancybox,r=this.viewport,o=r.scale||1,a=n.$container;a&&(i=e=t="",.1<o-1&&(t="".concat(r.width*o,"px"),e="".concat(r.height*o,"px"),i="translate3d(".concat(r.offsetLeft,"px, ").concat(r.offsetTop,"px, 0) scale(").concat(1/o,")")),a.style.width=t,a.style.height=e,a.style.transform=i)}},{key:"onTouchstart",value:function(t){this.startY=t.touches?t.touches[0].screenY:t.screenY}},{key:"onTouchmove",value:function(t){var e,i,n,r,o,a,s=this.startY,c=window.innerWidth/window.document.documentElement.clientWidth;t.cancelable&&!(1<t.touches.length||1!=c)&&((e=g(t.composedPath()[0]))?(i=window.getComputedStyle(e),n=parseInt(i.getPropertyValue("height"),10),o=s<=(r=t.touches?t.touches[0].screenY:t.screenY)&&0===e.scrollTop,a=r<=s&&e.scrollHeight-e.scrollTop===n,(o||a)&&t.preventDefault()):t.preventDefault())}},{key:"onWheel",value:function(t){g(t.composedPath()[0])||t.preventDefault()}},{key:"cleanup",value:function(){this.pendingUpdate&&(cancelAnimationFrame(this.pendingUpdate),this.pendingUpdate=null);var t=this.viewport;t&&(t.removeEventListener("resize",this.onResize),this.viewport=null),window.removeEventListener("touchstart",this.onTouchstart,!1),window.removeEventListener("touchmove",this.onTouchmove,!1),window.removeEventListener("wheel",this.onWheel,{passive:!1})}},{key:"attach",value:function(){this.fancybox.on("initLayout",this.onReady)}},{key:"detach",value:function(){this.fancybox.off("initLayout",this.onReady),this.cleanup()}}]),J),$=(i(Z,[{key:"onPrepare",value:function(){this.getSlides().length<this.fancybox.option("Thumbs.minSlideCount")?this.state="disabled":!0===this.fancybox.option("Thumbs.autoStart")&&this.fancybox.Carousel.Panzoom.content.height>=this.fancybox.option("Thumbs.minScreenHeight")&&this.build()}},{key:"onClosing",value:function(){this.Carousel&&this.Carousel.Panzoom.detachEvents()}},{key:"onKeydown",value:function(t,e){e===t.option("Thumbs.key")&&this.toggle()}},{key:"build",value:function(){var t,i=this;this.$container||((t=document.createElement("div")).classList.add("fancybox__thumbs"),this.fancybox.$carousel.parentNode.insertBefore(t,this.fancybox.$carousel.nextSibling),this.Carousel=new G(t,v(!0,{Dots:!1,Navigation:!1,Sync:{friction:0},infinite:!1,center:!0,fill:!0,dragFree:!0,slidesPerPage:1,preload:1},this.fancybox.option("Thumbs.Carousel"),{Sync:{target:this.fancybox.Carousel},slides:this.getSlides()})),this.Carousel.Panzoom.on("wheel",function(t,e){e.preventDefault(),i.fancybox[e.deltaY<0?"prev":"next"]()}),this.$container=t,this.state="visible")}},{key:"getSlides",value:function(){var t,e=[],i=E(this.fancybox.items);try{for(i.s();!(t=i.n()).done;){var n=t.value,r=n.thumb;r&&e.push({html:this.fancybox.option("Thumbs.tpl").replace(/\{\{src\}\}/gi,r),customClass:"has-thumb has-".concat(n.type||"image")})}}catch(t){i.e(t)}finally{i.f()}return e}},{key:"toggle",value:function(){"visible"===this.state?this.hide():"hidden"===this.state?this.show():this.build()}},{key:"show",value:function(){"hidden"===this.state&&(this.$container.style.display="",this.Carousel.Panzoom.attachEvents(),this.state="visible")}},{key:"hide",value:function(){"visible"===this.state&&(this.Carousel.Panzoom.detachEvents(),this.$container.style.display="none",this.state="hidden")}},{key:"cleanup",value:function(){this.Carousel&&(this.Carousel.destroy(),this.Carousel=null),this.$container&&(this.$container.remove(),this.$container=null),this.state="init"}},{key:"attach",value:function(){this.fancybox.on(this.events)}},{key:"detach",value:function(){this.fancybox.off(this.events),this.cleanup()}}]),Z);function Z(t){l(this,Z),this.fancybox=t,this.$container=null,this.state="init";for(var e=0,i=["onPrepare","onClosing","onKeydown"];e<i.length;e++){var n=i[e];this[n]=this[n].bind(this)}this.events={prepare:this.onPrepare,closing:this.onClosing,keydown:this.onKeydown}}function J(t){l(this,J),this.fancybox=t,this.viewport=null,this.pendingUpdate=null;for(var e=0,i=["onReady","onResize","onTouchstart","onTouchmove"];e<i.length;e++){var n=i[e];this[n]=this[n].bind(this)}}$.defaults={minSlideCount:2,minScreenHeight:500,autoStart:!0,key:"t",Carousel:{},tpl:'<div class="fancybox__thumb" style="background-image:url(\'{{src}}\')"></div>'};function Q(t,e){for(var i=new URL(t),n=new URLSearchParams(i.search),r=new URLSearchParams,o=0,a=[].concat(b(n),b(Object.entries(e)));o<a.length;o++){var s=f(a[o],2),c=s[0],l=s[1];"t"===c?r.set("start",parseInt(l)):r.set(c,l)}r=r.toString();var h=t.match(/#t=((.*)?\d+s)/);return h&&(r+="#t=".concat(h[1])),r}var K={video:{autoplay:!0,ratio:16/9},youtube:{autohide:1,fs:1,rel:0,hd:1,wmode:"transparent",enablejsapi:1,html5:1},vimeo:{hd:1,show_title:1,show_byline:1,show_portrait:0,fullscreen:1},html5video:{tpl:'<video class="fancybox__html5video" playsinline controls controlsList="nodownload" poster="{{poster}}">\n  <source src="{{src}}" type="{{format}}" />Sorry, your browser doesn\'t support embedded videos.</video>',format:""}},tt=(i(et,[{key:"onInit",value:function(){var t,e=E(this.fancybox.items);try{for(e.s();!(t=e.n()).done;){var i=t.value;this.processType(i)}}catch(t){e.e(t)}finally{e.f()}}},{key:"processType",value:function(t){if(t.html)return t.src=t.html,t.type="html",void delete t.html;var e,i,n,r,o=t.src||"",a=t.type||this.fancybox.options.type,s=null;o&&"string"!=typeof o||((s=o.match(/(?:youtube\.com|youtu\.be|youtube\-nocookie\.com)\/(?:watch\?(?:.*&)?v=|v\/|u\/|embed\/?)?(videoseries\?list=(?:.*)|[\w-]{11}|\?listType=(?:.*)&list=(?:.*))(?:.*)/i))?(e=Q(o,this.fancybox.option("Html.youtube")),i=encodeURIComponent(s[1]),t.videoId=i,t.src="https://www.youtube-nocookie.com/embed/".concat(i,"?").concat(e),t.thumb=t.thumb||"https://i.ytimg.com/vi/".concat(i,"/mqdefault.jpg"),t.vendor="youtube",a="video"):(s=o.match(/^.+vimeo.com\/(?:\/)?([\d]+)(.*)?/))?(n=Q(o,this.fancybox.option("Html.vimeo")),r=encodeURIComponent(s[1]),t.videoId=r,t.src="https://player.vimeo.com/video/".concat(r,"?").concat(n),t.vendor="vimeo",a="video"):(s=o.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:(?:(?:maps\/(?:place\/(?:.*)\/)?\@(.*),(\d+.?\d+?)z))|(?:\?ll=))(.*)?/i))?(t.src="//maps.google.".concat(s[1],"/?ll=").concat((s[2]?s[2]+"&z="+Math.floor(s[3])+(s[4]?s[4].replace(/^\//,"&"):""):s[4]+"").replace(/\?/,"&"),"&output=").concat(s[4]&&0<s[4].indexOf("layer=c")?"svembed":"embed"),a="map"):(s=o.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:maps\/search\/)(.*)/i))&&(t.src="//maps.google.".concat(s[1],"/maps?q=").concat(s[2].replace("query=","q=").replace("api=1",""),"&output=embed"),a="map"),a||("#"===o.charAt(0)?a="inline":(s=o.match(/\.(mp4|mov|ogv|webm)((\?|#).*)?$/i))?(a="html5video",t.format=t.format||"video/"+("ogv"===s[1]?"ogg":s[1])):o.match(/(^data:image\/[a-z0-9+\/=]*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\?|#).*)?$)/i)?a="image":o.match(/\.(pdf)((\?|#).*)?$/i)&&(a="pdf")),t.type=a||this.fancybox.option("defaultType","image"),"html5video"!==a&&"video"!==a||(t.video=v({},this.fancybox.option("Html.video"),t.video),t._width&&t._height?t.ratio=parseFloat(t._width)/parseFloat(t._height):t.ratio=t.ratio||t.video.ratio||K.video.ratio))}},{key:"onReady",value:function(){var e=this;this.fancybox.Carousel.slides.forEach(function(t){t.$el&&(e.setContent(t),t.index===e.fancybox.getSlide().index&&e.playVideo(t))})}},{key:"onCreateSlide",value:function(t,e,i){"ready"===this.fancybox.state&&this.setContent(i)}},{key:"loadInlineContent",value:function(t){var e,i,n,r,o;t.src instanceof HTMLElement?n=t.src:"string"==typeof t.src&&(i=2===(e=t.src.split("#",2)).length&&""===e[0]?e[1]:e[0],n=document.getElementById(i)),n?("clone"===t.type||n.$placeHolder?(r=(r=(n=n.cloneNode(!0)).getAttribute("id"))?"".concat(r,"--clone"):"clone-".concat(this.fancybox.id,"-").concat(t.index),n.setAttribute("id",r)):((o=document.createElement("div")).classList.add("fancybox-placeholder"),n.parentNode.insertBefore(o,n),n.$placeHolder=o),this.fancybox.setContent(t,n)):this.fancybox.setError(t,"{{ELEMENT_NOT_FOUND}}")}},{key:"loadAjaxContent",value:function(t){var e=this.fancybox,i=new XMLHttpRequest;e.showLoading(t),i.onreadystatechange=function(){i.readyState===XMLHttpRequest.DONE&&"ready"===e.state&&(e.hideLoading(t),200===i.status?e.setContent(t,i.responseText):e.setError(t,404===i.status?"{{AJAX_NOT_FOUND}}":"{{AJAX_FORBIDDEN}}"))};var n=t.ajax||null;i.open(n?"POST":"GET",t.src),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.send(n),t.xhr=i}},{key:"loadIframeContent",value:function(e){var i=this,n=this.fancybox,r=document.createElement("iframe");if(r.className="fancybox__iframe",r.setAttribute("id","fancybox__iframe_".concat(n.id,"_").concat(e.index)),r.setAttribute("allow","autoplay; fullscreen"),r.setAttribute("scrolling","auto"),e.$iframe=r,"iframe"!==e.type||!1===e.preload)return r.setAttribute("src",e.src),this.fancybox.setContent(e,r),void this.resizeIframe(e);n.showLoading(e);var t=document.createElement("div");t.style.visibility="hidden",this.fancybox.setContent(e,t),t.appendChild(r),r.onerror=function(){n.setError(e,"{{IFRAME_ERROR}}")},r.onload=function(){n.hideLoading(e);var t=!1;r.isReady||(t=r.isReady=!0),r.src.length&&(r.parentNode.style.visibility="",i.resizeIframe(e),t&&n.revealContent(e))},r.setAttribute("src",e.src)}},{key:"setAspectRatio",value:function(t){var e,i,n,r,o,a=t.$content,s=t.ratio;a&&(e=t._width,o=t._height,(s||e&&o)&&(Object.assign(a.style,{width:e&&o?"100%":"",height:e&&o?"100%":"",maxWidth:"",maxHeight:""}),i=a.offsetWidth,n=a.offsetHeight,o=o||n,((e=e||i)>i||n<o)&&(e*=r=Math.min(i/e,n/o),o*=r),.01<Math.abs(e/o-s)&&(s<e/o?e=o*s:o=e/s),Object.assign(a.style,{width:"".concat(e,"px"),height:"".concat(o,"px")})))}},{key:"resizeIframe",value:function(t){var e=t.$iframe;if(e){var i=t._width||0,n=t._height||0;i&&n&&(t.autoSize=!1);var r,o=e.parentNode,a=o&&o.style;if(!1!==t.preload&&!1!==t.autoSize&&a)try{var s=window.getComputedStyle(o),c=parseFloat(s.paddingLeft)+parseFloat(s.paddingRight),l=parseFloat(s.paddingTop)+parseFloat(s.paddingBottom),h=e.contentWindow.document,u=h.getElementsByTagName("html")[0],d=h.body;a.width="",d.style.overflow="hidden",i=i||u.scrollWidth+c,a.width="".concat(i,"px"),d.style.overflow="",a.flex="0 0 auto",a.height="".concat(d.scrollHeight,"px"),n=u.scrollHeight+l}catch(t){}(i||n)&&(r={flex:"0 1 auto"},i&&(r.width="".concat(i,"px")),n&&(r.height="".concat(n,"px")),Object.assign(a,r))}}},{key:"onRefresh",value:function(t,e){var i=this;e.slides.forEach(function(t){t.$el&&(t.$iframe&&i.resizeIframe(t),t.ratio&&i.setAspectRatio(t))})}},{key:"setContent",value:function(t){if(t&&!t.isDom){switch(t.type){case"html":this.fancybox.setContent(t,t.src);break;case"html5video":this.fancybox.setContent(t,this.fancybox.option("Html.html5video.tpl").replace(/\{\{src\}\}/gi,t.src).replace("{{format}}",t.format||t.html5video&&t.html5video.format||"").replace("{{poster}}",t.poster||t.thumb||""));break;case"inline":case"clone":this.loadInlineContent(t);break;case"ajax":this.loadAjaxContent(t);break;case"pdf":case"video":case"map":t.preload=!1;case"iframe":this.loadIframeContent(t)}t.ratio&&this.setAspectRatio(t)}}},{key:"onSelectSlide",value:function(t,e,i){"ready"===t.state&&this.playVideo(i)}},{key:"playVideo",value:function(i){if("html5video"===i.type&&i.video.autoplay)try{var t,e=i.$el.querySelector("video");!e||void 0!==(t=e.play())&&t.then(function(){}).catch(function(t){e.muted=!0,e.play()})}catch(i){}"video"===i.type&&i.$iframe&&i.$iframe.contentWindow&&!function t(){if("done"===i.state&&i.$iframe&&i.$iframe.contentWindow){var e;if(i.$iframe.isReady)return i.video&&i.video.autoplay&&(e="youtube"==i.vendor?{event:"command",func:"playVideo"}:{method:"play",value:"true"}),void(e&&i.$iframe.contentWindow.postMessage(JSON.stringify(e),"*"));"youtube"===i.vendor&&(e={event:"listening",id:i.$iframe.getAttribute("id")},i.$iframe.contentWindow.postMessage(JSON.stringify(e),"*"))}i.poller=setTimeout(t,250)}()}},{key:"onUnselectSlide",value:function(t,e,i){if("html5video"!==i.type){var n=!1;"vimeo"==i.vendor?n={method:"pause",value:"true"}:"youtube"===i.vendor&&(n={event:"command",func:"pauseVideo"}),n&&i.$iframe&&i.$iframe.contentWindow&&i.$iframe.contentWindow.postMessage(JSON.stringify(n),"*"),clearTimeout(i.poller)}else try{i.$el.querySelector("video").pause()}catch(t){}}},{key:"onRemoveSlide",value:function(t,e,i){i.xhr&&(i.xhr.abort(),i.xhr=null),i.$iframe&&(i.$iframe.onload=i.$iframe.onerror=null,i.$iframe.src="//about:blank",i.$iframe=null);var n=i.$content;"inline"===i.type&&n&&(n.classList.remove("fancybox__content"),"none"!==n.style.display&&(n.style.display="none")),i.$closeButton&&(i.$closeButton.remove(),i.$closeButton=null);var r=n&&n.$placeHolder;r&&(r.parentNode.insertBefore(n,r),r.remove(),n.$placeHolder=null)}},{key:"onMessage",value:function(t){try{var e=JSON.parse(t.data);if("https://player.vimeo.com"===t.origin){if("ready"===e.event){var i,n=E(document.getElementsByClassName("fancybox__iframe"));try{for(n.s();!(i=n.n()).done;){var r=i.value;r.contentWindow===t.source&&(r.isReady=1)}}catch(t){n.e(t)}finally{n.f()}}}else"https://www.youtube-nocookie.com"===t.origin&&"onReady"===e.event&&(document.getElementById(e.id).isReady=1)}catch(t){}}},{key:"attach",value:function(){this.fancybox.on(this.events),window.addEventListener("message",this.onMessage,!1)}},{key:"detach",value:function(){this.fancybox.off(this.events),window.removeEventListener("message",this.onMessage,!1)}}]),et);function et(t){l(this,et),this.fancybox=t;for(var e=0,i=["onInit","onReady","onCreateSlide","onRemoveSlide","onSelectSlide","onUnselectSlide","onRefresh","onMessage"];e<i.length;e++){var n=i[e];this[n]=this[n].bind(this)}this.events={init:this.onInit,ready:this.onReady,"Carousel.createSlide":this.onCreateSlide,"Carousel.removeSlide":this.onRemoveSlide,"Carousel.selectSlide":this.onSelectSlide,"Carousel.unselectSlide":this.onUnselectSlide,"Carousel.refresh":this.onRefresh}}tt.defaults=K;var it=(i(nt,[{key:"onReady",value:function(){var e=this;this.fancybox.Carousel.slides.forEach(function(t){t.$el&&e.setContent(t)})}},{key:"onDone",value:function(t,e){this.handleCursor(e)}},{key:"onClosing",value:function(t){clearTimeout(this.clickTimer),this.clickTimer=null,t.Carousel.slides.forEach(function(t){t.$image&&(t.state="destroy"),t.Panzoom&&t.Panzoom.detachEvents()}),"closing"===this.fancybox.state&&this.canZoom(t.getSlide())&&this.zoomOut()}},{key:"onCreateSlide",value:function(t,e,i){"ready"===this.fancybox.state&&this.setContent(i)}},{key:"onRemoveSlide",value:function(t,e,i){i.$image&&(i.$el.classList.remove(t.option("Image.canZoomInClass")),i.$image.remove(),i.$image=null),i.Panzoom&&(i.Panzoom.destroy(),i.Panzoom=null),i.$el&&i.$el.dataset&&delete i.$el.dataset.imageFit}},{key:"setContent",value:function(e){var t,i,n,r,o=this;e.isDom||e.html||e.type&&"image"!==e.type||e.$image||(e.type="image",e.state="loading",(t=document.createElement("div")).style.visibility="hidden",(i=document.createElement("img")).addEventListener("load",function(t){t.stopImmediatePropagation(),o.onImageStatusChange(e)}),i.addEventListener("error",function(){o.onImageStatusChange(e)}),i.src=e.src,i.alt="",i.draggable=!1,i.classList.add("fancybox__image"),e.srcset&&i.setAttribute("srcset",e.srcset),e.sizes&&i.setAttribute("sizes",e.sizes),e.$image=i,(n=this.fancybox.option("Image.wrap"))?((r=document.createElement("div")).classList.add("string"==typeof n?n:"fancybox__image-wrap"),r.appendChild(i),t.appendChild(r),e.$wrap=r):t.appendChild(i),e.$el.dataset.imageFit=this.fancybox.option("Image.fit"),this.fancybox.setContent(e,t),i.complete||i.error?this.onImageStatusChange(e):this.fancybox.showLoading(e))}},{key:"onImageStatusChange",value:function(e){var i=this,t=e.$image;t&&"loading"===e.state&&(t.complete&&t.naturalWidth&&t.naturalHeight?(this.fancybox.hideLoading(e),"contain"===this.fancybox.option("Image.fit")&&this.initSlidePanzoom(e),e.$el.addEventListener("wheel",function(t){return i.onWheel(e,t)},{passive:!1}),e.$content.addEventListener("click",function(t){return i.onClick(e,t)},{passive:!1}),this.revealContent(e)):this.fancybox.setError(e,"{{IMAGE_ERROR}}"))}},{key:"initSlidePanzoom",value:function(t){var e=this;t.Panzoom||(t.Panzoom=new P(t.$el,v(!0,this.fancybox.option("Image.Panzoom",{}),{viewport:t.$wrap,content:t.$image,width:t._width,height:t._height,wrapInner:!1,textSelection:!0,touch:this.fancybox.option("Image.touch"),panOnlyZoomed:!0,click:!1,wheel:!1})),t.Panzoom.on("startAnimation",function(){e.fancybox.trigger("Image.startAnimation",t)}),t.Panzoom.on("endAnimation",function(){"zoomIn"===t.state&&e.fancybox.done(t),e.handleCursor(t),e.fancybox.trigger("Image.endAnimation",t)}),t.Panzoom.on("afterUpdate",function(){e.handleCursor(t),e.fancybox.trigger("Image.afterUpdate",t)}))}},{key:"revealContent",value:function(t){null===this.fancybox.Carousel.prevPage&&t.index===this.fancybox.options.startIndex&&this.canZoom(t)?this.zoomIn():this.fancybox.revealContent(t)}},{key:"getZoomInfo",value:function(t){var e=t.$thumb.getBoundingClientRect(),i=e.width,n=e.height,r=t.$content.getBoundingClientRect(),o=r.width,a=r.height,s=r.top-e.top,c=r.left-e.left,l=this.fancybox.option("Image.zoomOpacity");return"auto"===l&&(l=.1<Math.abs(i/n-o/a)),{top:s,left:c,scale:o&&i?i/o:1,opacity:l}}},{key:"canZoom",value:function(t){var e=this.fancybox,i=e.$container;if(window.visualViewport&&1!==window.visualViewport.scale)return!1;if(t.Panzoom&&!t.Panzoom.content.width)return!1;if(!e.option("Image.zoom")||"contain"!==e.option("Image.fit"))return!1;var n=t.$thumb;if(!n||"loading"===t.state)return!1;i.classList.add("fancybox__no-click");var r,o,a,s=n.getBoundingClientRect();return a=this.fancybox.option("Image.ignoreCoveredThumbnail")?(r=document.elementFromPoint(s.left+1,s.top+1)===n,o=document.elementFromPoint(s.right-1,s.bottom-1)===n,r&&o):document.elementFromPoint(s.left+.5*s.width,s.top+.5*s.height)===n,i.classList.remove("fancybox__no-click"),a}},{key:"zoomIn",value:function(){var t=this.fancybox,e=t.getSlide(),i=e.Panzoom,n=this.getZoomInfo(e),r=n.top,o=n.left,a=n.scale,s=n.opacity;t.trigger("reveal",e),i.panTo({x:-1*o,y:-1*r,scale:a,friction:0,ignoreBounds:!0}),e.$content.style.visibility="",e.state="zoomIn",!0===s&&i.on("afterTransform",function(t){"zoomIn"!==e.state&&"zoomOut"!==e.state||(t.$content.style.opacity=Math.min(1,1-(1-t.content.scale)/(1-a)))}),i.panTo({x:0,y:0,scale:1,friction:this.fancybox.option("Image.zoomFriction")})}},{key:"zoomOut",value:function(){var a,t,s=this,e=this.fancybox,c=e.getSlide(),l=c.Panzoom;l&&(c.state="zoomOut",e.state="customClosing",c.$caption&&(c.$caption.style.visibility="hidden"),a=this.fancybox.option("Image.zoomFriction"),t=function(t){var e=s.getZoomInfo(c),i=e.top,n=e.left,r=e.scale,o=e.opacity;t||o||(a*=.82),l.panTo({x:-1*n,y:-1*i,scale:r,friction:a,ignoreBounds:!0}),a*=.98},window.addEventListener("scroll",t),l.once("endAnimation",function(){window.removeEventListener("scroll",t),e.destroy()}),t())}},{key:"handleCursor",value:function(t){var e,i,n,r,o,a;"image"===t.type&&t.$el&&(e=t.Panzoom,i=this.fancybox.option("Image.click",!1,t),n=this.fancybox.option("Image.touch"),r=t.$el.classList,o=this.fancybox.option("Image.canZoomInClass"),a=this.fancybox.option("Image.canZoomOutClass"),r.remove(a),r.remove(o),e&&"toggleZoom"===i?e&&1===e.content.scale&&.01<e.option("maxScale")-e.content.scale?r.add(o):1<e.content.scale&&!n&&r.add(a):"close"===i&&r.add(a))}},{key:"onWheel",value:function(t,e){if("ready"===this.fancybox.state&&!1!==this.fancybox.trigger("Image.wheel",e))switch(this.fancybox.option("Image.wheel")){case"zoom":"done"===t.state&&t.Panzoom&&t.Panzoom.zoomWithWheel(e);break;case"close":this.fancybox.close();break;case"slide":this.fancybox[e.deltaY<0?"prev":"next"]()}}},{key:"onClick",value:function(e,i){var n=this;if("ready"===this.fancybox.state){var t=e.Panzoom;if(!t||!t.dragPosition.midPoint&&0===t.dragOffset.x&&0===t.dragOffset.y&&1===t.dragOffset.scale){if(this.fancybox.Carousel.Panzoom.lockAxis)return!1;var r=function(t){switch(t){case"toggleZoom":i.stopPropagation(),e.Panzoom&&e.Panzoom.zoomWithClick(i);break;case"close":n.fancybox.close();break;case"next":i.stopPropagation(),n.fancybox.next()}},o=this.fancybox.option("Image.click"),a=this.fancybox.option("Image.doubleClick");a?this.clickTimer?(clearTimeout(this.clickTimer),this.clickTimer=null,r(a)):this.clickTimer=setTimeout(function(){n.clickTimer=null,r(o)},300):r(o)}}}},{key:"onPageChange",value:function(t,e){var i=t.getSlide();e.slides.forEach(function(t){t.Panzoom&&"done"===t.state&&t.index!==i.index&&t.Panzoom.panTo({x:0,y:0,scale:1,friction:.8})})}},{key:"attach",value:function(){this.fancybox.on(this.events)}},{key:"detach",value:function(){this.fancybox.off(this.events)}}]),nt);function nt(t){l(this,nt),this.fancybox=t;for(var e=0,i=["onReady","onClosing","onDone","onPageChange","onCreateSlide","onRemoveSlide","onImageStatusChange"];e<i.length;e++){var n=i[e];this[n]=this[n].bind(this)}this.events={ready:this.onReady,closing:this.onClosing,done:this.onDone,"Carousel.change":this.onPageChange,"Carousel.createSlide":this.onCreateSlide,"Carousel.removeSlide":this.onRemoveSlide}}it.defaults={canZoomInClass:"can-zoom_in",canZoomOutClass:"can-zoom_out",zoom:!0,zoomOpacity:"auto",zoomFriction:.82,ignoreCoveredThumbnail:!1,touch:!0,click:"toggleZoom",doubleClick:null,wheel:"zoom",fit:"contain",wrap:!1,Panzoom:{ratio:1}};var rt=(i(ut,[{key:"onChange",value:function(t){var e=this,i=t.Carousel;this.timer&&clearTimeout(this.timer);var n,r,o=null===i.prevPage,a=t.getSlide(),s=new URL(document.URL).hash,c=!1;a.slug?c="#"+a.slug:(n=a.$trigger&&a.$trigger.dataset,(r=t.option("slug")||n&&n.fancybox)&&r.length&&"true"!==r&&(c="#"+r+(1<i.slides.length?"-"+(a.index+1):""))),o&&(this.origHash=s!==c?s:""),c&&s!==c&&(this.timer=setTimeout(function(){try{window.history[o?"pushState":"replaceState"]({},document.title,window.location.pathname+window.location.search+c),o&&(e.hasCreatedHistory=!0)}catch(t){}},300))}},{key:"onClosing",value:function(){if(this.timer&&clearTimeout(this.timer),!0!==this.hasSilentClose)try{return void window.history.replaceState({},document.title,window.location.pathname+window.location.search+(this.origHash||""))}catch(t){}}},{key:"attach",value:function(t){t.on(this.events)}},{key:"detach",value:function(t){t.off(this.events)}}],[{key:"startFromUrl",value:function(){var t,e,i,n,r,o,a=ut.Fancybox;a&&!a.getInstance()&&!1!==a.defaults.Hash&&(e=(t=ut.getParsedURL()).hash,i=t.slug,n=t.index,i&&((r=document.querySelector('[data-slug="'.concat(e,'"]')))&&r.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})),a.getInstance()||(o=document.querySelectorAll('[data-fancybox="'.concat(i,'"]'))).length&&(null===n&&1===o.length?r=o[0]:n&&(r=o[n-1]),r&&r.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})))))}},{key:"onHashChange",value:function(){var t=ut.getParsedURL(),e=t.slug,i=t.index,n=ut.Fancybox,r=n&&n.getInstance();if(r&&r.plugins.Hash){if(e){var o=r.Carousel;if(e===r.option("slug"))return o.slideTo(i-1);var a,s=E(o.slides);try{for(s.s();!(a=s.n()).done;){var c=a.value;if(c.slug&&c.slug===e)return o.slideTo(c.index)}}catch(t){s.e(t)}finally{s.f()}var l=r.getSlide(),h=l.$trigger&&l.$trigger.dataset;if(h&&h.fancybox===e)return o.slideTo(i-1)}r.plugins.Hash.hasSilentClose=!0,r.close()}ut.startFromUrl()}},{key:"create",value:function(t){function e(){window.addEventListener("hashchange",ut.onHashChange,!1),ut.startFromUrl()}ut.Fancybox=t,W&&window.requestAnimationFrame(function(){/complete|interactive|loaded/.test(document.readyState)?e():document.addEventListener("DOMContentLoaded",e)})}},{key:"destroy",value:function(){window.removeEventListener("hashchange",ut.onHashChange,!1)}},{key:"getParsedURL",value:function(){var t=window.location.hash.substr(1),e=t.split("-"),i=1<e.length&&/^\+?\d+$/.test(e[e.length-1])&&parseInt(e.pop(-1),10)||null;return{hash:t,slug:e.join("-"),index:i}}}]),ut),ot={pageXOffset:0,pageYOffset:0,element:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement},activate:function(t){ot.pageXOffset=window.pageXOffset,ot.pageYOffset=window.pageYOffset,t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()},deactivate:function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}},at=(i(ht,[{key:"isActive",value:function(){return this.active}},{key:"setTimer",value:function(){var t,e,i=this;this.active&&!this.timer&&(t=this.fancybox.option("slideshow.delay",3e3),this.timer=setTimeout(function(){i.timer=null,i.fancybox.option("infinite")||i.fancybox.getSlide().index!==i.fancybox.Carousel.slides.length-1?i.fancybox.next():i.fancybox.jumpTo(0,{friction:0})},t),(e=this.$progress)||((e=document.createElement("div")).classList.add("fancybox__progress"),this.fancybox.$carousel.parentNode.insertBefore(e,this.fancybox.$carousel),(this.$progress=e).offsetHeight),e.style.transitionDuration="".concat(t,"ms"),e.style.transform="scaleX(1)")}},{key:"clearTimer",value:function(){clearTimeout(this.timer),this.timer=null,this.$progress&&(this.$progress.style.transitionDuration="",this.$progress.style.transform="",this.$progress.offsetHeight)}},{key:"activate",value:function(){this.active||(this.active=!0,this.fancybox.$container.classList.add("has-slideshow"),"done"===this.fancybox.getSlide().state&&this.setTimer(),document.addEventListener("visibilitychange",this.handleVisibilityChange,!1))}},{key:"handleVisibilityChange",value:function(){this.deactivate()}},{key:"deactivate",value:function(){this.active=!1,this.clearTimer(),this.fancybox.$container.classList.remove("has-slideshow"),document.removeEventListener("visibilitychange",this.handleVisibilityChange,!1)}},{key:"toggle",value:function(){this.active?this.deactivate():1<this.fancybox.Carousel.slides.length&&this.activate()}}]),ht),st={display:["counter","zoom","slideshow","fullscreen","thumbs","close"],autoEnable:!0,items:{counter:{position:"left",type:"div",class:"fancybox__counter",html:'<span data-fancybox-index=""></span>&nbsp;/&nbsp;<span data-fancybox-count=""></span>',attr:{tabindex:-1}},prev:{type:"button",class:"fancybox__button--prev",label:"PREV",html:'<svg viewBox="0 0 24 24"><path d="M15 4l-8 8 8 8"/></svg>',attr:{"data-fancybox-prev":""}},next:{type:"button",class:"fancybox__button--next",label:"NEXT",html:'<svg viewBox="0 0 24 24"><path d="M8 4l8 8-8 8"/></svg>',attr:{"data-fancybox-next":""}},fullscreen:{type:"button",class:"fancybox__button--fullscreen",label:"TOGGLE_FULLSCREEN",html:'<svg viewBox="0 0 24 24">\n                <g><path d="M3 8 V3h5"></path><path d="M21 8V3h-5"></path><path d="M8 21H3v-5"></path><path d="M16 21h5v-5"></path></g>\n                <g><path d="M7 2v5H2M17 2v5h5M2 17h5v5M22 17h-5v5"/></g>\n            </svg>',click:function(t){t.preventDefault(),ot.element()?ot.deactivate():ot.activate(this.fancybox.$container)}},slideshow:{type:"button",class:"fancybox__button--slideshow",label:"TOGGLE_SLIDESHOW",html:'<svg viewBox="0 0 24 24">\n                <g><path d="M6 4v16"/><path d="M20 12L6 20"/><path d="M20 12L6 4"/></g>\n                <g><path d="M7 4v15M17 4v15"/></g>\n            </svg>',click:function(t){t.preventDefault(),this.Slideshow.toggle()}},zoom:{type:"button",class:"fancybox__button--zoom",label:"TOGGLE_ZOOM",html:'<svg viewBox="0 0 24 24"><circle cx="10" cy="10" r="7"></circle><path d="M16 16 L21 21"></svg>',click:function(t){t.preventDefault();var e=this.fancybox.getSlide().Panzoom;e&&e.toggleZoom()}},download:{type:"link",label:"DOWNLOAD",class:"fancybox__button--download",html:'<svg viewBox="0 0 24 24"><path d="M12 15V3m0 12l-4-4m4 4l4-4M2 17l.62 2.48A2 2 0 004.56 21h14.88a2 2 0 001.94-1.51L22 17"/></svg>',click:function(t){t.stopPropagation()}},thumbs:{type:"button",label:"TOGGLE_THUMBS",class:"fancybox__button--thumbs",html:'<svg viewBox="0 0 24 24"><circle cx="4" cy="4" r="1" /><circle cx="12" cy="4" r="1" transform="rotate(90 12 4)"/><circle cx="20" cy="4" r="1" transform="rotate(90 20 4)"/><circle cx="4" cy="12" r="1" transform="rotate(90 4 12)"/><circle cx="12" cy="12" r="1" transform="rotate(90 12 12)"/><circle cx="20" cy="12" r="1" transform="rotate(90 20 12)"/><circle cx="4" cy="20" r="1" transform="rotate(90 4 20)"/><circle cx="12" cy="20" r="1" transform="rotate(90 12 20)"/><circle cx="20" cy="20" r="1" transform="rotate(90 20 20)"/></svg>',click:function(t){t.stopPropagation();var e=this.fancybox.plugins.Thumbs;e&&e.toggle()}},close:{type:"button",label:"CLOSE",class:"fancybox__button--close",html:'<svg viewBox="0 0 24 24"><path d="M20 20L4 4m16 0L4 20"></path></svg>',attr:{"data-fancybox-close":"",tabindex:0}}}},ct=(i(lt,[{key:"onInit",value:function(){if(this.fancybox.option("Toolbar.autoEnable")){var t,e=!1,i=E(this.fancybox.items);try{for(i.s();!(t=i.n()).done;)if("image"===t.value.type){e=!0;break}}catch(t){i.e(t)}finally{i.f()}if(!e)return void(this.state="disabled")}var n,r=E(this.fancybox.option("Toolbar.display"));try{for(r.s();!(n=r.n()).done;){var o=n.value;if("close"===(m(o)?o.id:o)){this.fancybox.options.closeButton=!1;break}}}catch(t){r.e(t)}finally{r.f()}}},{key:"onPrepare",value:function(){var t=this.fancybox;if("init"===this.state&&(this.build(),this.update(),this.Slideshow=new at(t),!t.Carousel.prevPage&&(t.option("slideshow.autoStart")&&this.Slideshow.activate(),t.option("fullscreen.autoStart")&&!ot.element())))try{ot.activate(t.$container)}catch(t){}}},{key:"onFsChange",value:function(){window.scrollTo(ot.pageXOffset,ot.pageYOffset)}},{key:"onSettle",value:function(){var t=this.fancybox,e=this.Slideshow;e&&e.isActive()&&(t.getSlide().index!==t.Carousel.slides.length-1||t.option("infinite")?"done"===t.getSlide().state&&e.setTimer():e.deactivate())}},{key:"onChange",value:function(){this.update(),this.Slideshow&&this.Slideshow.isActive()&&this.Slideshow.clearTimer()}},{key:"onDone",value:function(t,e){var i=this.Slideshow;e.index===t.getSlide().index&&(this.update(),i&&i.isActive()&&(t.option("infinite")||e.index!==t.Carousel.slides.length-1?i.setTimer():i.deactivate()))}},{key:"onRefresh",value:function(t){t&&t.index!==this.fancybox.getSlide().index||(this.update(),!this.Slideshow||!this.Slideshow.isActive()||t&&"done"!==t.state||this.Slideshow.deactivate())}},{key:"onKeydown",value:function(t,e,i){" "===e&&this.Slideshow&&(this.Slideshow.toggle(),i.preventDefault())}},{key:"onClosing",value:function(){this.Slideshow&&this.Slideshow.deactivate(),document.removeEventListener("fullscreenchange",this.onFsChange)}},{key:"createElement",value:function(t){var e,i;for(var n in"div"===t.type?e=document.createElement("div"):(e=document.createElement("link"===t.type?"a":"button")).classList.add("carousel__button"),e.innerHTML=t.html,e.setAttribute("tabindex",t.tabindex||0),t.class&&(i=e.classList).add.apply(i,b(t.class.split(" "))),t.attr)e.setAttribute(n,t.attr[n]);t.label&&e.setAttribute("title",this.fancybox.localize("{{".concat(t.label,"}}"))),t.click&&e.addEventListener("click",t.click.bind(this)),"prev"===t.id&&e.setAttribute("data-fancybox-prev",""),"next"===t.id&&e.setAttribute("data-fancybox-next","");var r=e.querySelector("svg");return r&&(r.setAttribute("role","img"),r.setAttribute("tabindex","-1"),r.setAttribute("xmlns","http://www.w3.org/2000/svg")),e}},{key:"build",value:function(){var o=this;this.cleanup();var a,s=this.fancybox.option("Toolbar.items"),c=[{position:"left",items:[]},{position:"center",items:[]},{position:"right",items:[]}],l=this.fancybox.plugins.Thumbs,t=E(this.fancybox.option("Toolbar.display"));try{for(t.s();!(a=t.n()).done;)!function(){var t=a.value,e=void 0,i=void 0,i=m(t)?(e=t.id,v({},s[e],t)):s[e=t];if(["counter","next","prev","slideshow"].includes(e)&&o.fancybox.items.length<2)return;if("fullscreen"===e){if(!document.fullscreenEnabled||window.fullScreen)return;document.addEventListener("fullscreenchange",o.onFsChange)}if("thumbs"===e&&(!l||"disabled"===l.state))return;if(!i)return;var n=i.position||"right",r=c.find(function(t){return t.position===n});r&&r.items.push(i)}()}catch(o){t.e(o)}finally{t.f()}var e=document.createElement("div");e.classList.add("fancybox__toolbar");for(var i=0,n=c;i<n.length;i++){var r=n[i];if(r.items.length){var h=document.createElement("div");h.classList.add("fancybox__toolbar__items"),h.classList.add("fancybox__toolbar__items--".concat(r.position));var u,d=E(r.items);try{for(d.s();!(u=d.n()).done;){var p=u.value;h.appendChild(this.createElement(p))}}catch(o){d.e(o)}finally{d.f()}e.appendChild(h)}}this.fancybox.$carousel.parentNode.insertBefore(e,this.fancybox.$carousel),this.$container=e}},{key:"update",value:function(){var t,e=this.fancybox.getSlide(),i=e.index,n=this.fancybox.items.length,r=e.downloadSrc||("image"!==e.type||e.error?null:e.src),o=E(this.fancybox.$container.querySelectorAll("a.fancybox__button--download"));try{for(o.s();!(t=o.n()).done;){var a=t.value;r?(a.removeAttribute("disabled"),a.removeAttribute("tabindex"),a.setAttribute("href",r),a.setAttribute("download",r),a.setAttribute("target","_blank")):(a.setAttribute("disabled",""),a.setAttribute("tabindex",-1),a.removeAttribute("href"),a.removeAttribute("download"))}}catch(t){o.e(t)}finally{o.f()}var s,c=e.Panzoom,l=c&&c.option("maxScale")>c.option("baseScale"),h=E(this.fancybox.$container.querySelectorAll(".fancybox__button--zoom"));try{for(h.s();!(s=h.n()).done;){var u=s.value;l?u.removeAttribute("disabled"):u.setAttribute("disabled","")}}catch(t){h.e(t)}finally{h.f()}var d,p=E(this.fancybox.$container.querySelectorAll("[data-fancybox-index]"));try{for(p.s();!(d=p.n()).done;)d.value.innerHTML=e.index+1}catch(t){p.e(t)}finally{p.f()}var f,m=E(this.fancybox.$container.querySelectorAll("[data-fancybox-count]"));try{for(m.s();!(f=m.n()).done;)f.value.innerHTML=n}catch(t){m.e(t)}finally{m.f()}if(!this.fancybox.option("infinite")){var g,v=E(this.fancybox.$container.querySelectorAll("[data-fancybox-prev]"));try{for(v.s();!(g=v.n()).done;){var y=g.value;0===i?y.setAttribute("disabled",""):y.removeAttribute("disabled")}}catch(t){v.e(t)}finally{v.f()}var b,x=E(this.fancybox.$container.querySelectorAll("[data-fancybox-next]"));try{for(x.s();!(b=x.n()).done;){var w=b.value;i===n-1?w.setAttribute("disabled",""):w.removeAttribute("disabled")}}catch(t){x.e(t)}finally{x.f()}}}},{key:"cleanup",value:function(){this.Slideshow&&this.Slideshow.isActive()&&this.Slideshow.clearTimer(),this.$container&&this.$container.remove(),this.$container=null}},{key:"attach",value:function(){this.fancybox.on(this.events)}},{key:"detach",value:function(){this.fancybox.off(this.events),this.cleanup()}}]),lt);function lt(t){var i=this;l(this,lt),this.fancybox=t,this.$container=null,this.state="init";for(var e=0,n=["onInit","onPrepare","onDone","onKeydown","onClosing","onChange","onSettle","onRefresh"];e<n.length;e++){var r=n[e];this[r]=this[r].bind(this)}this.events={init:this.onInit,prepare:this.onPrepare,done:this.onDone,keydown:this.onKeydown,closing:this.onClosing,"Carousel.change":this.onChange,"Carousel.settle":this.onSettle,"Carousel.Panzoom.touchStart":function(){return i.onRefresh()},"Image.startAnimation":function(t,e){return i.onRefresh(e)},"Image.afterUpdate":function(t,e){return i.onRefresh(e)}}}function ht(t){l(this,ht),this.fancybox=t,this.active=!1,this.handleVisibilityChange=this.handleVisibilityChange.bind(this)}function ut(t){l(this,ut),this.fancybox=t;for(var e=0,i=["onChange","onClosing"];e<i.length;e++){var n=i[e];this[n]=this[n].bind(this)}this.events={initCarousel:this.onChange,"Carousel.change":this.onChange,closing:this.onClosing},this.hasCreatedHistory=!1,this.origHash="",this.timer=null}ct.defaults=st;var dt={ScrollLock:Y,Thumbs:$,Html:tt,Toolbar:ct,Image:it,Hash:rt},pt={startIndex:0,preload:1,infinite:!0,showClass:"fancybox-zoomInUp",hideClass:"fancybox-fadeOut",animated:!0,hideScrollbar:!0,parentEl:null,mainClass:null,autoFocus:!0,trapFocus:!0,placeFocusBack:!0,click:"close",closeButton:"inside",dragToClose:!0,keyboard:{Escape:"close",Delete:"close",Backspace:"close",PageUp:"next",PageDown:"prev",ArrowUp:"next",ArrowDown:"prev",ArrowRight:"next",ArrowLeft:"prev"},template:{closeButton:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M20 20L4 4m16 0L4 20"/></svg>',spinner:'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="25 25 50 50" tabindex="-1"><circle cx="50" cy="50" r="20"/></svg>',main:null},l10n:{CLOSE:"Close",NEXT:"Next",PREV:"Previous",MODAL:"You can close this modal content with the ESC key",ERROR:"Something Went Wrong, Please Try Again Later",IMAGE_ERROR:"Image Not Found",ELEMENT_NOT_FOUND:"HTML Element Not Found",AJAX_NOT_FOUND:"Error Loading AJAX : Not Found",AJAX_FORBIDDEN:"Error Loading AJAX : Forbidden",IFRAME_ERROR:"Error Loading Page",TOGGLE_ZOOM:"Toggle zoom level",TOGGLE_THUMBS:"Toggle thumbnails",TOGGLE_SLIDESHOW:"Toggle slideshow",TOGGLE_FULLSCREEN:"Toggle full-screen mode",DOWNLOAD:"Download"}},ft=new Map,mt=0,gt=function(){o(d,A);var n=h(d);function d(t){var e,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return l(this,d),t=t.map(function(t){return t.width&&(t._width=t.width),t.height&&(t._height=t.height),t}),(e=n.call(this,v(!0,{},pt,i))).bindHandlers(),e.state="init",e.setItems(t),e.attachPlugins(d.Plugins),e.trigger("init"),!0===e.option("hideScrollbar")&&e.hideScrollbar(),e.initLayout(),e.initCarousel(),e.attachEvents(),ft.set(e.id,c(e)),e.trigger("prepare"),e.state="ready",e.trigger("ready"),e.$container.setAttribute("aria-hidden","false"),e.option("trapFocus")&&e.focus(),e}return i(d,[{key:"option",value:function(t){for(var e,i=this.getSlide(),n=i?i[t]:void 0,r=arguments.length,o=new Array(1<r?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];return void 0===n?(e=u(s(d.prototype),"option",this)).call.apply(e,[this,t].concat(o)):("function"==typeof n&&(n=n.call.apply(n,[this,this].concat(o))),n)}},{key:"bindHandlers",value:function(){for(var t=0,e=["onMousedown","onKeydown","onClick","onFocus","onCreateSlide","onSettle","onTouchMove","onTouchEnd","onTransform"];t<e.length;t++){var i=e[t];this[i]=this[i].bind(this)}}},{key:"attachEvents",value:function(){document.addEventListener("mousedown",this.onMousedown),document.addEventListener("keydown",this.onKeydown,!0),this.option("trapFocus")&&document.addEventListener("focus",this.onFocus,!0),this.$container.addEventListener("click",this.onClick)}},{key:"detachEvents",value:function(){document.removeEventListener("mousedown",this.onMousedown),document.removeEventListener("keydown",this.onKeydown,!0),document.removeEventListener("focus",this.onFocus,!0),this.$container.removeEventListener("click",this.onClick)}},{key:"initLayout",value:function(){var i=this;this.$root=this.option("parentEl")||document.body;var t=this.option("template.main");t&&(this.$root.insertAdjacentHTML("beforeend",this.localize(t)),this.$container=this.$root.querySelector(".fancybox__container")),this.$container||(this.$container=document.createElement("div"),this.$root.appendChild(this.$container)),this.$container.onscroll=function(){return i.$container.scrollLeft=0,!1},Object.entries({class:"fancybox__container",role:"dialog",tabIndex:"-1","aria-modal":"true","aria-hidden":"true","aria-label":this.localize("{{MODAL}}")}).forEach(function(t){var e;return(e=i.$container).setAttribute.apply(e,b(t))}),this.option("animated")&&this.$container.classList.add("is-animated"),this.$backdrop=this.$container.querySelector(".fancybox__backdrop"),this.$backdrop||(this.$backdrop=document.createElement("div"),this.$backdrop.classList.add("fancybox__backdrop"),this.$container.appendChild(this.$backdrop)),this.$carousel=this.$container.querySelector(".fancybox__carousel"),this.$carousel||(this.$carousel=document.createElement("div"),this.$carousel.classList.add("fancybox__carousel"),this.$container.appendChild(this.$carousel)),(this.$container.Fancybox=this).id=this.$container.getAttribute("id"),this.id||(this.id=this.options.id||++mt,this.$container.setAttribute("id","fancybox-"+this.id));var e,n=this.option("mainClass");return n&&(e=this.$container.classList).add.apply(e,b(n.split(" "))),document.documentElement.classList.add("with-fancybox"),this.trigger("initLayout"),this}},{key:"setItems",value:function(t){var e,i=[],n=E(t);try{for(n.s();!(e=n.n()).done;){var r,o=e.value,a=o.$trigger;a&&(r=a.dataset||{},o.src=r.src||a.getAttribute("href")||o.src,o.type=r.type||o.type,!o.src&&a instanceof HTMLImageElement&&(o.src=a.currentSrc||o.$trigger.src));var s,c=o.$thumb;c||((s=o.$trigger&&o.$trigger.origTarget)&&(c=s instanceof HTMLImageElement?s:s.querySelector("img:not([aria-hidden])")),!c&&o.$trigger&&(c=o.$trigger instanceof HTMLImageElement?o.$trigger:o.$trigger.querySelector("img:not([aria-hidden])"))),o.$thumb=c||null;var l=o.thumb;!l&&c&&!(l=c.currentSrc||c.src)&&c.dataset&&(l=c.dataset.lazySrc||c.dataset.src),l||"image"!==o.type||(l=o.src),o.thumb=l||null,o.caption=o.caption||"",i.push(o)}}catch(t){n.e(t)}finally{n.f()}this.items=i}},{key:"initCarousel",value:function(){var r=this;return this.Carousel=new G(this.$carousel,v(!0,{},{prefix:"",classNames:{viewport:"fancybox__viewport",track:"fancybox__track",slide:"fancybox__slide"},textSelection:!0,preload:this.option("preload"),friction:.88,slides:this.items,initialPage:this.options.startIndex,slidesPerPage:1,infiniteX:this.option("infinite"),infiniteY:!0,l10n:this.option("l10n"),Dots:!1,Navigation:{classNames:{main:"fancybox__nav",button:"carousel__button",next:"is-next",prev:"is-prev"}},Panzoom:{textSelection:!0,panOnlyZoomed:function(){return r.Carousel&&r.Carousel.pages&&r.Carousel.pages.length<2&&!r.option("dragToClose")},lockAxis:function(){if(r.Carousel){var t="x";return r.option("dragToClose")&&(t+="y"),t}}},on:{"*":function(t){for(var e=arguments.length,i=new Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return r.trigger.apply(r,["Carousel.".concat(t)].concat(i))},init:function(t){return r.Carousel=t},createSlide:this.onCreateSlide,settle:this.onSettle}},this.option("Carousel"))),this.option("dragToClose")&&this.Carousel.Panzoom.on({touchMove:this.onTouchMove,afterTransform:this.onTransform,touchEnd:this.onTouchEnd}),this.trigger("initCarousel"),this}},{key:"onCreateSlide",value:function(t,e){var i,n,r=e.caption||"";"function"==typeof this.options.caption&&(r=this.options.caption.call(this,this,this.Carousel,e)),"string"==typeof r&&r.length&&(i=document.createElement("div"),n="fancybox__caption_".concat(this.id,"_").concat(e.index),i.className="fancybox__caption",i.innerHTML=r,i.setAttribute("id",n),e.$caption=e.$el.appendChild(i),e.$el.classList.add("has-caption"),e.$el.setAttribute("aria-labelledby",n))}},{key:"onSettle",value:function(){this.option("autoFocus")&&this.focus()}},{key:"onFocus",value:function(t){this.isTopmost()&&this.focus(t)}},{key:"onClick",value:function(t){if(!t.defaultPrevented){var e=t.composedPath()[0];if(e.matches("[data-fancybox-close]"))return t.preventDefault(),void d.close(!1,t);if(e.matches("[data-fancybox-next]"))return t.preventDefault(),void d.next();if(e.matches("[data-fancybox-prev]"))return t.preventDefault(),void d.prev();var i=document.activeElement;if(i){if(i.closest("[contenteditable]"))return;e.matches(X)||i.blur()}if(!e.closest(".fancybox__content")&&!getSelection().toString().length&&!1!==this.trigger("click",t))switch(this.option("click")){case"close":this.close();break;case"next":this.next()}}}},{key:"onTouchMove",value:function(){var t=this.getSlide().Panzoom;return!t||1===t.content.scale}},{key:"onTouchEnd",value:function(t){var e=t.dragOffset.y;150<=Math.abs(e)||35<=Math.abs(e)&&t.dragOffset.time<350?(this.option("hideClass")&&(this.getSlide().hideClass="fancybox-throwOut".concat(t.content.y<0?"Up":"Down")),this.close()):"y"===t.lockAxis&&t.panTo({y:0})}},{key:"onTransform",value:function(t){var e,i;this.$backdrop&&(i=(e=Math.abs(t.content.y))<1?"":Math.max(.33,Math.min(1,1-e/t.content.fitHeight*1.5)),this.$container.style.setProperty("--fancybox-ts",i?"0s":""),this.$container.style.setProperty("--fancybox-opacity",i))}},{key:"onMousedown",value:function(){"ready"===this.state&&document.body.classList.add("is-using-mouse")}},{key:"onKeydown",value:function(t){if(this.isTopmost()){document.body.classList.remove("is-using-mouse");var e=t.key,i=this.option("keyboard");if(i&&!t.ctrlKey&&!t.altKey&&!t.shiftKey){var n,r=t.composedPath()[0],o=document.activeElement&&document.activeElement.classList,a=o&&o.contains("carousel__button");if("Escape"!==e&&!a&&(t.target.isContentEditable||-1!==["BUTTON","TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].indexOf(r.nodeName)))return;!1===this.trigger("keydown",e,t)||"function"==typeof this[n=i[e]]&&this[n]()}}}},{key:"getSlide",value:function(){var t=this.Carousel;if(!t)return null;var e=null===t.page?t.option("initialPage"):t.page,i=t.pages||[];return i.length&&i[e]?i[e].slides[0]:null}},{key:"focus",value:function(t){if(!(d.ignoreFocusChange||-1<["init","closing","customClosing","destroy"].indexOf(this.state))){var e=this.$container,i=this.getSlide(),n="done"===i.state?i.$el:null;if(!n||!n.contains(document.activeElement)){t&&t.preventDefault(),d.ignoreFocusChange=!0;for(var r,o=[],a=0,s=Array.from(e.querySelectorAll(X));a<s.length;a++){var c=s[a],l=c.offsetParent,h=n&&n.contains(c),u=!this.Carousel.$viewport.contains(c);l&&(h||u)?(o.push(c),void 0!==c.dataset.origTabindex&&(c.tabIndex=c.dataset.origTabindex,c.removeAttribute("data-orig-tabindex")),(c.hasAttribute("autoFocus")||!r&&h&&!c.classList.contains("carousel__button"))&&(r=c)):(c.dataset.origTabindex=void 0===c.dataset.origTabindex?c.getAttribute("tabindex"):c.dataset.origTabindex,c.tabIndex=-1)}t?-1<o.indexOf(t.target)?this.lastFocus=t.target:this.lastFocus===e?V(o[o.length-1]):V(e):this.option("autoFocus")&&r?V(r):o.indexOf(document.activeElement)<0&&V(e),this.lastFocus=document.activeElement,d.ignoreFocusChange=!1}}}},{key:"hideScrollbar",value:function(){var t,e,i;W&&(t=window.innerWidth-document.documentElement.getBoundingClientRect().width,e="fancybox-style-noscroll",(i=document.getElementById(e))||0<t&&((i=document.createElement("style")).id=e,i.type="text/css",i.innerHTML=".compensate-for-scrollbar {padding-right: ".concat(t,"px;}"),document.getElementsByTagName("head")[0].appendChild(i),document.body.classList.add("compensate-for-scrollbar")))}},{key:"revealScrollbar",value:function(){document.body.classList.remove("compensate-for-scrollbar");var t=document.getElementById("fancybox-style-noscroll");t&&t.remove()}},{key:"clearContent",value:function(t){this.Carousel.trigger("removeSlide",t),t.$content&&(t.$content.remove(),t.$content=null),t.$closeButton&&(t.$closeButton.remove(),t.$closeButton=null),t._className&&t.$el.classList.remove(t._className)}},{key:"setContent",value:function(t,e){var i,n,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=t.$el;if(e instanceof HTMLElement?-1<["img","iframe","video","audio"].indexOf(e.nodeName.toLowerCase())?(i=document.createElement("div")).appendChild(e):i=e:(n=document.createRange().createContextualFragment(e),(i=document.createElement("div")).appendChild(n)),t.filter&&!t.error&&(i=i.querySelector(t.filter)),i instanceof Element)return t._className="has-".concat(r.suffix||t.type||"unknown"),o.classList.add(t._className),i.classList.add("fancybox__content"),"none"!==i.style.display&&"none"!==getComputedStyle(i).getPropertyValue("display")||(i.style.display=t.display||this.option("defaultDisplay")||"flex"),t.id&&i.setAttribute("id",t.id),t.$content=i,o.prepend(i),this.manageCloseButton(t),"loading"!==t.state&&this.revealContent(t),i;this.setError(t,"{{ELEMENT_NOT_FOUND}}")}},{key:"manageCloseButton",value:function(t){var e,i=this,n=void 0===t.closeButton?this.option("closeButton"):t.closeButton;!n||"top"===n&&this.$closeButton||((e=document.createElement("button")).classList.add("carousel__button","is-close"),e.setAttribute("title",this.options.l10n.CLOSE),e.innerHTML=this.option("template.closeButton"),e.addEventListener("click",function(t){return i.close(t)}),"inside"===n?(t.$closeButton&&t.$closeButton.remove(),t.$closeButton=t.$content.appendChild(e)):this.$closeButton=this.$container.insertBefore(e,this.$container.firstChild))}},{key:"revealContent",value:function(t){var e=this;this.trigger("reveal",t),t.$content.style.visibility="";var i=!1;t.error||"loading"===t.state||null!==this.Carousel.prevPage||t.index!==this.options.startIndex||(i=void 0===t.showClass?this.option("showClass"):t.showClass),i?(t.state="animating",this.animateCSS(t.$content,i,function(){e.done(t)})):this.done(t)}},{key:"animateCSS",value:function(i,n,r){i&&i.dispatchEvent(new CustomEvent("animationend",{bubbles:!0,cancelable:!0})),i&&n?(i.addEventListener("animationend",function t(e){e.currentTarget===this&&(i.removeEventListener("animationend",t),r&&r(),i.classList.remove(n))}),i.classList.add(n)):"function"==typeof r&&r()}},{key:"done",value:function(t){t.state="done",this.trigger("done",t);var e=this.getSlide();e&&t.index===e.index&&this.option("autoFocus")&&this.focus()}},{key:"setError",value:function(t,e){t.error=e,this.hideLoading(t),this.clearContent(t);var i=document.createElement("div");i.classList.add("fancybox-error"),i.innerHTML=this.localize(e||"<p>{{ERROR}}</p>"),this.setContent(t,i,{suffix:"error"})}},{key:"showLoading",value:function(t){var e=this;t.state="loading",t.$el.classList.add("is-loading");var i=t.$el.querySelector(".fancybox__spinner");i||((i=document.createElement("div")).classList.add("fancybox__spinner"),i.innerHTML=this.option("template.spinner"),i.addEventListener("click",function(){e.Carousel.Panzoom.velocity||e.close()}),t.$el.prepend(i))}},{key:"hideLoading",value:function(t){var e=t.$el&&t.$el.querySelector(".fancybox__spinner");e&&(e.remove(),t.$el.classList.remove("is-loading")),"loading"===t.state&&(this.trigger("load",t),t.state="ready")}},{key:"next",value:function(){var t=this.Carousel;t&&1<t.pages.length&&t.slideNext()}},{key:"prev",value:function(){var t=this.Carousel;t&&1<t.pages.length&&t.slidePrev()}},{key:"jumpTo",value:function(){var t;this.Carousel&&(t=this.Carousel).slideTo.apply(t,arguments)}},{key:"isClosing",value:function(){return["closing","customClosing","destroy"].includes(this.state)}},{key:"isTopmost",value:function(){return d.getInstance().id==this.id}},{key:"close",value:function(t){var e,i,n=this;t&&t.preventDefault(),this.isClosing()||!1===this.trigger("shouldClose",t)||(this.state="closing",this.Carousel.Panzoom.destroy(),this.detachEvents(),this.trigger("closing",t),"destroy"===this.state)||(this.$container.setAttribute("aria-hidden","true"),this.$container.classList.add("is-closing"),e=this.getSlide(),this.Carousel.slides.forEach(function(t){t.$content&&t.index!==e.index&&n.Carousel.trigger("removeSlide",t)}),"closing"===this.state&&(i=void 0===e.hideClass?this.option("hideClass"):e.hideClass,this.animateCSS(e.$content,i,function(){n.destroy()},!0)))}},{key:"destroy",value:function(){var t,e;"destroy"!==this.state&&(this.state="destroy",this.trigger("destroy"),t=this.option("placeFocusBack")?this.option("triggerTarget",this.getSlide().$trigger):null,this.Carousel.destroy(),this.detachPlugins(),this.Carousel=null,this.options={},this.events={},this.$container.remove(),this.$container=this.$backdrop=this.$carousel=null,t&&V(t),ft.delete(this.id),(e=d.getInstance())?e.focus():(document.documentElement.classList.remove("with-fancybox"),document.body.classList.remove("is-using-mouse"),this.revealScrollbar()))}}],[{key:"show",value:function(t){return new d(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})}},{key:"fromEvent",value:function(i){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!i.defaultPrevented&&!(i.button&&0!==i.button||i.ctrlKey||i.metaKey||i.shiftKey)){var e,n,r,o,a,s=i.composedPath()[0],c=s;(c.matches("[data-fancybox-trigger]")||(c=c.closest("[data-fancybox-trigger]")))&&(e=(t.triggerTarget=c)&&c.dataset&&c.dataset.fancyboxTrigger),e&&(o=document.querySelectorAll('[data-fancybox="'.concat(e,'"]')),a=parseInt(c.dataset.fancyboxIndex,10)||0,c=o.length?o[a]:c),Array.from(d.openers.keys()).reverse().some(function(t){r=c||s;var e=!1;try{r instanceof Element&&("string"==typeof t||t instanceof String)&&(e=r.matches(t)||(r=r.closest(t)))}catch(t){}return!!e&&(i.preventDefault(),n=t,!0)});var l,h=!1;return n&&(t.event=i,(t.target=r).origTarget=s,h=d.fromOpener(n,t),(l=d.getInstance())&&"ready"===l.state&&i.detail&&document.body.classList.add("is-using-mouse")),h}}},{key:"fromOpener",value:function(t){var e,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=[],r=i.startIndex||0,o=i.target||null,a=void 0!==(i=v({},i,d.openers.get(t))).groupAll&&i.groupAll,s=void 0===i.groupAttr?"data-fancybox":i.groupAttr,c=s&&o?o.getAttribute("".concat(s)):"";if(o&&!c&&!a||(e=i.root||(o?o.getRootNode():document.body),n=[].slice.call(e.querySelectorAll(t))),o&&!a&&(n=c?n.filter(function(t){return t.getAttribute("".concat(s))===c}):[o]),!n.length)return!1;var l=d.getInstance();return!(l&&-1<n.indexOf(l.options.$trigger))&&(r=o?n.indexOf(o):r,new d(n=n.map(function(t){for(var e=["false","0","no","null","undefined"],i=["true","1","yes"],n=Object.assign({},t.dataset),r={},o=0,a=Object.entries(n);o<a.length;o++){var s=f(a[o],2),c=s[0],l=s[1];if("fancybox"!==c)if("width"===c||"height"===c)r["_".concat(c)]=l;else if("string"==typeof l||l instanceof String)if(-1<e.indexOf(l))r[c]=!1;else if(-1<i.indexOf(r[c]))r[c]=!0;else try{r[c]=JSON.parse(l)}catch(t){r[c]=l}else r[c]=l}return t instanceof Element&&(r.$trigger=t),r}),v({},i,{startIndex:r,$trigger:o})))}},{key:"bind",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};function i(){document.body.addEventListener("click",d.fromEvent,!1)}W&&(d.openers.size||(/complete|interactive|loaded/.test(document.readyState)?i():document.addEventListener("DOMContentLoaded",i)),d.openers.set(t,e))}},{key:"unbind",value:function(t){d.openers.delete(t),d.openers.size||d.destroy()}},{key:"destroy",value:function(){for(var t;t=d.getInstance();)t.destroy();d.openers=new Map,document.body.removeEventListener("click",d.fromEvent,!1)}},{key:"getInstance",value:function(t){return t?ft.get(t):Array.from(ft.values()).reverse().find(function(t){return!t.isClosing()&&t})||null}},{key:"close",value:function(){var t=1<arguments.length?arguments[1]:void 0;if(!(0<arguments.length&&void 0!==arguments[0])||arguments[0]){var e,i=E(ft.values());try{for(i.s();!(e=i.n()).done;){e.value.close(t)}}catch(t){i.e(t)}finally{i.f()}}else{var n=d.getInstance();n&&n.close(t)}}},{key:"next",value:function(){var t=d.getInstance();t&&t.next()}},{key:"prev",value:function(){var t=d.getInstance();t&&t.prev()}}]),d}();gt.version="4.0.31",gt.defaults=pt,gt.openers=new Map,gt.Plugins=dt,gt.bind("[data-fancybox]");for(var vt=0,yt=Object.entries(gt.Plugins||{});vt<yt.length;vt++){var bt=f(yt[vt],2);bt[0];var xt=bt[1];"function"==typeof xt.create&&xt.create(gt)}t.Carousel=G,t.Fancybox=gt,t.Panzoom=P}),function(e,i){"function"==typeof define&&define.amd?define("jquery-bridget/jquery-bridget",["jquery"],function(t){return i(e,t)}):"object"==typeof module&&module.exports?module.exports=i(e,require("jquery")):e.jQueryBridget=i(e,e.jQuery)}(window,function(t,e){"use strict";var u=Array.prototype.slice,i=t.console,d=void 0===i?function(){}:function(t){i.error(t)};function n(l,r,h){(h=h||e||t.jQuery)&&(r.prototype.option||(r.prototype.option=function(t){h.isPlainObject(t)&&(this.options=h.extend(!0,this.options,t))}),h.fn[l]=function(t){if("string"!=typeof t)return n=t,this.each(function(t,e){var i=h.data(e,l);i?(i.option(n),i._init()):(i=new r(e,n),h.data(e,l,i))}),this;var e,o,a,s,c,n,i=u.call(arguments,1);return a=i,c="$()."+l+'("'+(o=t)+'")',(e=this).each(function(t,e){var i,n,r=h.data(e,l);r?(i=r[o])&&"_"!=o.charAt(0)?(n=i.apply(r,a),s=void 0===s?n:s):d(c+" is not a valid method"):d(l+" not initialized. Cannot call methods, i.e. "+c)}),void 0!==s?s:e},o(h))}function o(t){!t||t&&t.bridget||(t.bridget=n)}return o(e||t.jQuery),n}),function(t,e){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",e):"object"==typeof module&&module.exports?module.exports=e():t.EvEmitter=e()}("undefined"!=typeof window?window:this,function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return-1==n.indexOf(e)&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{};return(i[t]=i[t]||{})[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return-1!=n&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){i=i.slice(0),e=e||[];for(var n=this._onceEvents&&this._onceEvents[t],r=0;r<i.length;r++){var o=i[r];n&&n[o]&&(this.off(t,o),delete n[o]),o.apply(this,e)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t}),function(t,e){"function"==typeof define&&define.amd?define("get-size/get-size",e):"object"==typeof module&&module.exports?module.exports=e():t.getSize=e()}(window,function(){"use strict";function x(t){var e=parseFloat(t);return-1==t.indexOf("%")&&!isNaN(e)&&e}var i="undefined"==typeof console?function(){}:function(t){console.error(t)},w=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],E=w.length;function M(t){var e=getComputedStyle(t);return e||i("Style returned "+e+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),e}var _,S=!1;function A(t){var e,i,n;if(S||(S=!0,(e=document.createElement("div")).style.width="200px",e.style.padding="1px 2px 3px 4px",e.style.borderStyle="solid",e.style.borderWidth="1px 2px 3px 4px",e.style.boxSizing="border-box",(i=document.body||document.documentElement).appendChild(e),n=M(e),_=200==Math.round(x(n.width)),A.isBoxSizeOuter=_,i.removeChild(e)),"string"==typeof t&&(t=document.querySelector(t)),t&&"object"==typeof t&&t.nodeType){var r=M(t);if("none"==r.display)return function(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;e<E;e++){t[w[e]]=0}return t}();var o={};o.width=t.offsetWidth,o.height=t.offsetHeight;for(var a=o.isBorderBox="border-box"==r.boxSizing,s=0;s<E;s++){var c=w[s],l=r[c],h=parseFloat(l);o[c]=isNaN(h)?0:h}var u=o.paddingLeft+o.paddingRight,d=o.paddingTop+o.paddingBottom,p=o.marginLeft+o.marginRight,f=o.marginTop+o.marginBottom,m=o.borderLeftWidth+o.borderRightWidth,g=o.borderTopWidth+o.borderBottomWidth,v=a&&_,y=x(r.width);!1!==y&&(o.width=y+(v?0:u+m));var b=x(r.height);return!1!==b&&(o.height=b+(v?0:d+g)),o.innerWidth=o.width-(u+m),o.innerHeight=o.height-(d+g),o.outerWidth=o.width+p,o.outerHeight=o.height+f,o}}return A}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("desandro-matches-selector/matches-selector",e):"object"==typeof module&&module.exports?module.exports=e():t.matchesSelector=e()}(window,function(){"use strict";var i=function(){var t=window.Element.prototype;if(t.matches)return"matches";if(t.matchesSelector)return"matchesSelector";for(var e=["webkit","moz","ms","o"],i=0;i<e.length;i++){var n=e[i]+"MatchesSelector";if(t[n])return n}}();return function(t,e){return t[i](e)}}),function(e,i){"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["desandro-matches-selector/matches-selector"],function(t){return i(e,t)}):"object"==typeof module&&module.exports?module.exports=i(e,require("desandro-matches-selector")):e.fizzyUIUtils=i(e,e.matchesSelector)}(window,function(l,o){var h={extend:function(t,e){for(var i in e)t[i]=e[i];return t},modulo:function(t,e){return(t%e+e)%e}},e=Array.prototype.slice;h.makeArray=function(t){return Array.isArray(t)?t:null==t?[]:"object"==typeof t&&"number"==typeof t.length?e.call(t):[t]},h.removeFrom=function(t,e){var i=t.indexOf(e);-1!=i&&t.splice(i,1)},h.getParent=function(t,e){for(;t.parentNode&&t!=document.body;)if(t=t.parentNode,o(t,e))return t},h.getQueryElement=function(t){return"string"==typeof t?document.querySelector(t):t},h.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},h.filterFindElements=function(t,n){t=h.makeArray(t);var r=[];return t.forEach(function(t){if(t instanceof HTMLElement)if(n){o(t,n)&&r.push(t);for(var e=t.querySelectorAll(n),i=0;i<e.length;i++)r.push(e[i])}else r.push(t)}),r},h.debounceMethod=function(t,e,n){n=n||100;var r=t.prototype[e],o=e+"Timeout";t.prototype[e]=function(){var t=this[o];clearTimeout(t);var e=arguments,i=this;this[o]=setTimeout(function(){r.apply(i,e),delete i[o]},n)}},h.docReady=function(t){var e=document.readyState;"complete"==e||"interactive"==e?setTimeout(t):document.addEventListener("DOMContentLoaded",t)},h.toDashed=function(t){return t.replace(/(.)([A-Z])/g,function(t,e,i){return e+"-"+i}).toLowerCase()};var u=l.console;return h.htmlInit=function(s,c){h.docReady(function(){var t=h.toDashed(c),r="data-"+t,e=document.querySelectorAll("["+r+"]"),i=document.querySelectorAll(".js-"+t),n=h.makeArray(e).concat(h.makeArray(i)),o=r+"-options",a=l.jQuery;n.forEach(function(e){var t,i=e.getAttribute(r)||e.getAttribute(o);try{t=i&&JSON.parse(i)}catch(t){return void(u&&u.error("Error parsing "+r+" on "+e.className+": "+t))}var n=new s(e,t);a&&a.data(e,c,n)})})},h}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/cell",["get-size/get-size"],function(t){return e(0,t)}):"object"==typeof module&&module.exports?module.exports=e(0,require("get-size")):(t.Flickity=t.Flickity||{},t.Flickity.Cell=e(0,t.getSize))}(window,function(t,e){function i(t,e){this.element=t,this.parent=e,this.create()}var n=i.prototype;return n.create=function(){this.element.style.position="absolute",this.element.setAttribute("aria-hidden","true"),this.x=0,this.shift=0,this.element.style[this.parent.originSide]=0},n.destroy=function(){this.unselect(),this.element.style.position="";var t=this.parent.originSide;this.element.style[t]="",this.element.style.transform="",this.element.removeAttribute("aria-hidden")},n.getSize=function(){this.size=e(this.element)},n.setPosition=function(t){this.x=t,this.updateTarget(),this.renderPosition(t)},n.updateTarget=n.setDefaultTarget=function(){var t="left"==this.parent.originSide?"marginLeft":"marginRight";this.target=this.x+this.size[t]+this.size.width*this.parent.cellAlign},n.renderPosition=function(t){var e="left"===this.parent.originSide?1:-1,i=this.parent.options.percentPosition?t*e*(this.parent.size.innerWidth/this.size.width):t*e;this.element.style.transform="translateX("+this.parent.getPositionValue(i)+")"},n.select=function(){this.element.classList.add("is-selected"),this.element.removeAttribute("aria-hidden")},n.unselect=function(){this.element.classList.remove("is-selected"),this.element.setAttribute("aria-hidden","true")},n.wrapShift=function(t){this.shift=t,this.renderPosition(this.x+this.parent.slideableWidth*t)},n.remove=function(){this.element.parentNode.removeChild(this.element)},i}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/slide",e):"object"==typeof module&&module.exports?module.exports=e():(t.Flickity=t.Flickity||{},t.Flickity.Slide=e())}(window,function(){"use strict";function t(t){this.parent=t,this.isOriginLeft="left"==t.originSide,this.cells=[],this.outerWidth=0,this.height=0}var e=t.prototype;return e.addCell=function(t){var e;this.cells.push(t),this.outerWidth+=t.size.outerWidth,this.height=Math.max(t.size.outerHeight,this.height),1==this.cells.length&&(this.x=t.x,e=this.isOriginLeft?"marginLeft":"marginRight",this.firstMargin=t.size[e])},e.updateTarget=function(){var t=this.isOriginLeft?"marginRight":"marginLeft",e=this.getLastCell(),i=e?e.size[t]:0,n=this.outerWidth-(this.firstMargin+i);this.target=this.x+this.firstMargin+n*this.parent.cellAlign},e.getLastCell=function(){return this.cells[this.cells.length-1]},e.select=function(){this.cells.forEach(function(t){t.select()})},e.unselect=function(){this.cells.forEach(function(t){t.unselect()})},e.getCellElements=function(){return this.cells.map(function(t){return t.element})},t}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/animate",["fizzy-ui-utils/utils"],function(t){return e(0,t)}):"object"==typeof module&&module.exports?module.exports=e(0,require("fizzy-ui-utils")):(t.Flickity=t.Flickity||{},t.Flickity.animatePrototype=e(0,t.fizzyUIUtils))}(window,function(t,e){var i={startAnimation:function(){this.isAnimating||(this.isAnimating=!0,this.restingFrames=0,this.animate())},animate:function(){this.applyDragForce(),this.applySelectedAttraction();var t,e=this.x;this.integratePhysics(),this.positionSlider(),this.settle(e),this.isAnimating&&(t=this,requestAnimationFrame(function(){t.animate()}))},positionSlider:function(){var t=this.x;this.options.wrapAround&&1<this.cells.length&&(t=e.modulo(t,this.slideableWidth),t-=this.slideableWidth,this.shiftWrapCells(t)),this.setTranslateX(t,this.isAnimating),this.dispatchScrollEvent()},setTranslateX:function(t,e){t+=this.cursorPosition,t=this.options.rightToLeft?-t:t;var i=this.getPositionValue(t);this.slider.style.transform=e?"translate3d("+i+",0,0)":"translateX("+i+")"},dispatchScrollEvent:function(){var t,e,i=this.slides[0];i&&(e=(t=-this.x-i.target)/this.slidesWidth,this.dispatchEvent("scroll",null,[e,t]))},positionSliderAtSelected:function(){this.cells.length&&(this.x=-this.selectedSlide.target,this.velocity=0,this.positionSlider())},getPositionValue:function(t){return this.options.percentPosition?.01*Math.round(t/this.size.innerWidth*1e4)+"%":Math.round(t)+"px"},settle:function(t){this.isPointerDown||Math.round(100*this.x)!=Math.round(100*t)||this.restingFrames++,2<this.restingFrames&&(this.isAnimating=!1,delete this.isFreeScrolling,this.positionSlider(),this.dispatchEvent("settle",null,[this.selectedIndex]))},shiftWrapCells:function(t){var e=this.cursorPosition+t;this._shiftCells(this.beforeShiftCells,e,-1);var i=this.size.innerWidth-(t+this.slideableWidth+this.cursorPosition);this._shiftCells(this.afterShiftCells,i,1)},_shiftCells:function(t,e,i){for(var n=0;n<t.length;n++){var r=t[n],o=0<e?i:0;r.wrapShift(o),e-=r.size.outerWidth}},_unshiftCells:function(t){if(t&&t.length)for(var e=0;e<t.length;e++)t[e].wrapShift(0)},integratePhysics:function(){this.x+=this.velocity,this.velocity*=this.getFrictionFactor()},applyForce:function(t){this.velocity+=t},getFrictionFactor:function(){return 1-this.options[this.isFreeScrolling?"freeScrollFriction":"friction"]},getRestingPosition:function(){return this.x+this.velocity/(1-this.getFrictionFactor())},applyDragForce:function(){var t;this.isDraggable&&this.isPointerDown&&(t=this.dragX-this.x-this.velocity,this.applyForce(t))},applySelectedAttraction:function(){var t;this.isDraggable&&this.isPointerDown||this.isFreeScrolling||!this.slides.length||(t=(-1*this.selectedSlide.target-this.x)*this.options.selectedAttraction,this.applyForce(t))}};return i}),function(a,s){var t;"function"==typeof define&&define.amd?define("flickity/js/flickity",["ev-emitter/ev-emitter","get-size/get-size","fizzy-ui-utils/utils","./cell","./slide","./animate"],function(t,e,i,n,r,o){return s(a,t,e,i,n,r,o)}):"object"==typeof module&&module.exports?module.exports=s(a,require("ev-emitter"),require("get-size"),require("fizzy-ui-utils"),require("./cell"),require("./slide"),require("./animate")):(t=a.Flickity,a.Flickity=s(a,a.EvEmitter,a.getSize,a.fizzyUIUtils,t.Cell,t.Slide,t.animatePrototype))}(window,function(n,t,e,s,i,a,r){var c=n.jQuery,o=n.getComputedStyle,l=n.console;function h(t,e){for(t=s.makeArray(t);t.length;)e.appendChild(t.shift())}var u=0,d={};function p(t,e){var i=s.getQueryElement(t);if(i){if(this.element=i,this.element.flickityGUID){var n=d[this.element.flickityGUID];return n&&n.option(e),n}c&&(this.$element=c(this.element)),this.options=s.extend({},this.constructor.defaults),this.option(e),this._create()}else l&&l.error("Bad element for Flickity: "+(i||t))}p.defaults={accessibility:!0,cellAlign:"center",freeScrollFriction:.075,friction:.28,namespaceJQueryEvents:!0,percentPosition:!0,resize:!0,selectedAttraction:.025,setGallerySize:!0},p.createMethods=[];var f=p.prototype;s.extend(f,t.prototype),f._create=function(){var t=this.guid=++u;for(var e in this.element.flickityGUID=t,(d[t]=this).selectedIndex=0,this.restingFrames=0,this.x=0,this.velocity=0,this.originSide=this.options.rightToLeft?"right":"left",this.viewport=document.createElement("div"),this.viewport.className="flickity-viewport",this._createSlider(),(this.options.resize||this.options.watchCSS)&&n.addEventListener("resize",this),this.options.on){var i=this.options.on[e];this.on(e,i)}p.createMethods.forEach(function(t){this[t]()},this),this.options.watchCSS?this.watchCSS():this.activate()},f.option=function(t){s.extend(this.options,t)},f.activate=function(){this.isActive||(this.isActive=!0,this.element.classList.add("flickity-enabled"),this.options.rightToLeft&&this.element.classList.add("flickity-rtl"),this.getSize(),h(this._filterFindCellElements(this.element.children),this.slider),this.viewport.appendChild(this.slider),this.element.appendChild(this.viewport),this.reloadCells(),this.options.accessibility&&(this.element.tabIndex=0,this.element.addEventListener("keydown",this)),this.emitEvent("activate"),this.selectInitialIndex(),this.isInitActivated=!0,this.dispatchEvent("ready"))},f._createSlider=function(){var t=document.createElement("div");t.className="flickity-slider",t.style[this.originSide]=0,this.slider=t},f._filterFindCellElements=function(t){return s.filterFindElements(t,this.options.cellSelector)},f.reloadCells=function(){this.cells=this._makeCells(this.slider.children),this.positionCells(),this._getWrapShiftCells(),this.setGallerySize()},f._makeCells=function(t){return this._filterFindCellElements(t).map(function(t){return new i(t,this)},this)},f.getLastCell=function(){return this.cells[this.cells.length-1]},f.getLastSlide=function(){return this.slides[this.slides.length-1]},f.positionCells=function(){this._sizeCells(this.cells),this._positionCells(0)},f._positionCells=function(t){t=t||0,this.maxCellHeight=t&&this.maxCellHeight||0;var e,i=0;0<t&&(i=(e=this.cells[t-1]).x+e.size.outerWidth);for(var n=this.cells.length,r=t;r<n;r++){var o=this.cells[r];o.setPosition(i),i+=o.size.outerWidth,this.maxCellHeight=Math.max(o.size.outerHeight,this.maxCellHeight)}this.slideableWidth=i,this.updateSlides(),this._containSlides(),this.slidesWidth=n?this.getLastSlide().target-this.slides[0].target:0},f._sizeCells=function(t){t.forEach(function(t){t.getSize()})},f.updateSlides=function(){var n,r,o;this.slides=[],this.cells.length&&(n=new a(this),this.slides.push(n),r="left"==this.originSide?"marginRight":"marginLeft",o=this._getCanCellFit(),this.cells.forEach(function(t,e){var i;n.cells.length&&(i=n.outerWidth-n.firstMargin+(t.size.outerWidth-t.size[r]),o.call(this,e,i)||(n.updateTarget(),n=new a(this),this.slides.push(n))),n.addCell(t)},this),n.updateTarget(),this.updateSelectedSlide())},f._getCanCellFit=function(){var t=this.options.groupCells;if(!t)return function(){return!1};if("number"==typeof t){var e=parseInt(t,10);return function(t){return t%e!=0}}var i="string"==typeof t&&t.match(/^(\d+)%$/),n=i?parseInt(i[1],10)/100:1;return function(t,e){return e<=(this.size.innerWidth+1)*n}},f._init=f.reposition=function(){this.positionCells(),this.positionSliderAtSelected()},f.getSize=function(){this.size=e(this.element),this.setCellAlign(),this.cursorPosition=this.size.innerWidth*this.cellAlign};var m={center:{left:.5,right:.5},left:{left:0,right:1},right:{right:0,left:1}};return f.setCellAlign=function(){var t=m[this.options.cellAlign];this.cellAlign=t?t[this.originSide]:this.options.cellAlign},f.setGallerySize=function(){var t;this.options.setGallerySize&&(t=this.options.adaptiveHeight&&this.selectedSlide?this.selectedSlide.height:this.maxCellHeight,this.viewport.style.height=t+"px")},f._getWrapShiftCells=function(){var t,e;this.options.wrapAround&&(this._unshiftCells(this.beforeShiftCells),this._unshiftCells(this.afterShiftCells),t=this.cursorPosition,e=this.cells.length-1,this.beforeShiftCells=this._getGapCells(t,e,-1),t=this.size.innerWidth-this.cursorPosition,this.afterShiftCells=this._getGapCells(t,0,1))},f._getGapCells=function(t,e,i){for(var n=[];0<t;){var r=this.cells[e];if(!r)break;n.push(r),e+=i,t-=r.size.outerWidth}return n},f._containSlides=function(){var t,e,i,n,r,o,a;this.options.contain&&!this.options.wrapAround&&this.cells.length&&(e=(t=this.options.rightToLeft)?"marginRight":"marginLeft",i=t?"marginLeft":"marginRight",n=this.slideableWidth-this.getLastCell().size[i],r=n<this.size.innerWidth,o=this.cursorPosition+this.cells[0].size[e],a=n-this.size.innerWidth*(1-this.cellAlign),this.slides.forEach(function(t){r?t.target=n*this.cellAlign:(t.target=Math.max(t.target,o),t.target=Math.min(t.target,a))},this))},f.dispatchEvent=function(t,e,i){var n,r,o=e?[e].concat(i):i;this.emitEvent(t,o),c&&this.$element&&(n=t+=this.options.namespaceJQueryEvents?".flickity":"",e&&((r=new c.Event(e)).type=t,n=r),this.$element.trigger(n,i))},f.select=function(t,e,i){var n;this.isActive&&(t=parseInt(t,10),this._wrapSelect(t),(this.options.wrapAround||e)&&(t=s.modulo(t,this.slides.length)),this.slides[t]&&(n=this.selectedIndex,this.selectedIndex=t,this.updateSelectedSlide(),i?this.positionSliderAtSelected():this.startAnimation(),this.options.adaptiveHeight&&this.setGallerySize(),this.dispatchEvent("select",null,[t]),t!=n&&this.dispatchEvent("change",null,[t]),this.dispatchEvent("cellSelect")))},f._wrapSelect=function(t){var e=this.slides.length;if(!(this.options.wrapAround&&1<e))return t;var i=s.modulo(t,e),n=Math.abs(i-this.selectedIndex),r=Math.abs(i+e-this.selectedIndex),o=Math.abs(i-e-this.selectedIndex);!this.isDragSelect&&r<n?t+=e:!this.isDragSelect&&o<n&&(t-=e),t<0?this.x-=this.slideableWidth:e<=t&&(this.x+=this.slideableWidth)},f.previous=function(t,e){this.select(this.selectedIndex-1,t,e)},f.next=function(t,e){this.select(this.selectedIndex+1,t,e)},f.updateSelectedSlide=function(){var t=this.slides[this.selectedIndex];t&&(this.unselectSelectedSlide(),(this.selectedSlide=t).select(),this.selectedCells=t.cells,this.selectedElements=t.getCellElements(),this.selectedCell=t.cells[0],this.selectedElement=this.selectedElements[0])},f.unselectSelectedSlide=function(){this.selectedSlide&&this.selectedSlide.unselect()},f.selectInitialIndex=function(){var t=this.options.initialIndex;if(this.isInitActivated)this.select(this.selectedIndex,!1,!0);else{if(t&&"string"==typeof t)if(this.queryCell(t))return void this.selectCell(t,!1,!0);var e=0;t&&this.slides[t]&&(e=t),this.select(e,!1,!0)}},f.selectCell=function(t,e,i){var n,r=this.queryCell(t);r&&(n=this.getCellSlideIndex(r),this.select(n,e,i))},f.getCellSlideIndex=function(t){for(var e=0;e<this.slides.length;e++){if(-1!=this.slides[e].cells.indexOf(t))return e}},f.getCell=function(t){for(var e=0;e<this.cells.length;e++){var i=this.cells[e];if(i.element==t)return i}},f.getCells=function(t){t=s.makeArray(t);var i=[];return t.forEach(function(t){var e=this.getCell(t);e&&i.push(e)},this),i},f.getCellElements=function(){return this.cells.map(function(t){return t.element})},f.getParentCell=function(t){var e=this.getCell(t);return e||(t=s.getParent(t,".flickity-slider > *"),this.getCell(t))},f.getAdjacentCellElements=function(t,e){if(!t)return this.selectedSlide.getCellElements();e=void 0===e?this.selectedIndex:e;var i=this.slides.length;if(i<=1+2*t)return this.getCellElements();for(var n=[],r=e-t;r<=e+t;r++){var o=this.options.wrapAround?s.modulo(r,i):r,a=this.slides[o];a&&(n=n.concat(a.getCellElements()))}return n},f.queryCell=function(t){if("number"==typeof t)return this.cells[t];if("string"==typeof t){if(t.match(/^[#.]?[\d/]/))return;t=this.element.querySelector(t)}return this.getCell(t)},f.uiChange=function(){this.emitEvent("uiChange")},f.childUIPointerDown=function(t){"touchstart"!=t.type&&t.preventDefault(),this.focus()},f.onresize=function(){this.watchCSS(),this.resize()},s.debounceMethod(p,"onresize",150),f.resize=function(){var t;!this.isActive||this.isAnimating||this.isDragging||(this.getSize(),this.options.wrapAround&&(this.x=s.modulo(this.x,this.slideableWidth)),this.positionCells(),this._getWrapShiftCells(),this.setGallerySize(),this.emitEvent("resize"),t=this.selectedElements&&this.selectedElements[0],this.selectCell(t,!1,!0))},f.watchCSS=function(){this.options.watchCSS&&(-1!=o(this.element,":after").content.indexOf("flickity")?this.activate():this.deactivate())},f.onkeydown=function(t){var e,i=document.activeElement&&document.activeElement!=this.element;!this.options.accessibility||i||(e=p.keyboardHandlers[t.keyCode])&&e.call(this)},p.keyboardHandlers={37:function(){var t=this.options.rightToLeft?"next":"previous";this.uiChange(),this[t]()},39:function(){var t=this.options.rightToLeft?"previous":"next";this.uiChange(),this[t]()}},f.focus=function(){var t=n.pageYOffset;this.element.focus({preventScroll:!0}),n.pageYOffset!=t&&n.scrollTo(n.pageXOffset,t)},f.deactivate=function(){this.isActive&&(this.element.classList.remove("flickity-enabled"),this.element.classList.remove("flickity-rtl"),this.unselectSelectedSlide(),this.cells.forEach(function(t){t.destroy()}),this.element.removeChild(this.viewport),h(this.slider.children,this.element),this.options.accessibility&&(this.element.removeAttribute("tabIndex"),this.element.removeEventListener("keydown",this)),this.isActive=!1,this.emitEvent("deactivate"))},f.destroy=function(){this.deactivate(),n.removeEventListener("resize",this),this.allOff(),this.emitEvent("destroy"),c&&this.$element&&c.removeData(this.element,"flickity"),delete this.element.flickityGUID,delete d[this.guid]},s.extend(f,r),p.data=function(t){var e=(t=s.getQueryElement(t))&&t.flickityGUID;return e&&d[e]},s.htmlInit(p,"flickity"),c&&c.bridget&&c.bridget("flickity",p),p.setJQuery=function(t){c=t},p.Cell=i,p.Slide=a,p}),function(e,i){"function"==typeof define&&define.amd?define("unipointer/unipointer",["ev-emitter/ev-emitter"],function(t){return i(e,t)}):"object"==typeof module&&module.exports?module.exports=i(e,require("ev-emitter")):e.Unipointer=i(e,e.EvEmitter)}(window,function(r,t){function e(){}var i=e.prototype=Object.create(t.prototype);i.bindStartEvent=function(t){this._bindStartEvent(t,!0)},i.unbindStartEvent=function(t){this._bindStartEvent(t,!1)},i._bindStartEvent=function(t,e){var i=(e=void 0===e||e)?"addEventListener":"removeEventListener",n="mousedown";"ontouchstart"in r?n="touchstart":r.PointerEvent&&(n="pointerdown"),t[i](n,this)},i.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},i.getTouch=function(t){for(var e=0;e<t.length;e++){var i=t[e];if(i.identifier==this.pointerIdentifier)return i}},i.onmousedown=function(t){var e=t.button;e&&0!==e&&1!==e||this._pointerDown(t,t)},i.ontouchstart=function(t){this._pointerDown(t,t.changedTouches[0])},i.onpointerdown=function(t){this._pointerDown(t,t)},i._pointerDown=function(t,e){t.button||this.isPointerDown||(this.isPointerDown=!0,this.pointerIdentifier=void 0!==e.pointerId?e.pointerId:e.identifier,this.pointerDown(t,e))},i.pointerDown=function(t,e){this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e])};var n={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]};return i._bindPostStartEvents=function(t){var e;t&&((e=n[t.type]).forEach(function(t){r.addEventListener(t,this)},this),this._boundPointerEvents=e)},i._unbindPostStartEvents=function(){this._boundPointerEvents&&(this._boundPointerEvents.forEach(function(t){r.removeEventListener(t,this)},this),delete this._boundPointerEvents)},i.onmousemove=function(t){this._pointerMove(t,t)},i.onpointermove=function(t){t.pointerId==this.pointerIdentifier&&this._pointerMove(t,t)},i.ontouchmove=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerMove(t,e)},i._pointerMove=function(t,e){this.pointerMove(t,e)},i.pointerMove=function(t,e){this.emitEvent("pointerMove",[t,e])},i.onmouseup=function(t){this._pointerUp(t,t)},i.onpointerup=function(t){t.pointerId==this.pointerIdentifier&&this._pointerUp(t,t)},i.ontouchend=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerUp(t,e)},i._pointerUp=function(t,e){this._pointerDone(),this.pointerUp(t,e)},i.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e])},i._pointerDone=function(){this._pointerReset(),this._unbindPostStartEvents(),this.pointerDone()},i._pointerReset=function(){this.isPointerDown=!1,delete this.pointerIdentifier},i.pointerDone=function(){},i.onpointercancel=function(t){t.pointerId==this.pointerIdentifier&&this._pointerCancel(t,t)},i.ontouchcancel=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerCancel(t,e)},i._pointerCancel=function(t,e){this._pointerDone(),this.pointerCancel(t,e)},i.pointerCancel=function(t,e){this.emitEvent("pointerCancel",[t,e])},e.getPointerPoint=function(t){return{x:t.pageX,y:t.pageY}},e}),function(e,i){"function"==typeof define&&define.amd?define("unidragger/unidragger",["unipointer/unipointer"],function(t){return i(e,t)}):"object"==typeof module&&module.exports?module.exports=i(e,require("unipointer")):e.Unidragger=i(e,e.Unipointer)}(window,function(o,t){function e(){}var i=e.prototype=Object.create(t.prototype);i.bindHandles=function(){this._bindHandles(!0)},i.unbindHandles=function(){this._bindHandles(!1)},i._bindHandles=function(t){for(var e=(t=void 0===t||t)?"addEventListener":"removeEventListener",i=t?this._touchActionValue:"",n=0;n<this.handles.length;n++){var r=this.handles[n];this._bindStartEvent(r,t),r[e]("click",this),o.PointerEvent&&(r.style.touchAction=i)}},i._touchActionValue="none",i.pointerDown=function(t,e){this.okayPointerDown(t)&&(this.pointerDownPointer={pageX:e.pageX,pageY:e.pageY},t.preventDefault(),this.pointerDownBlur(),this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e]))};var r={TEXTAREA:!0,INPUT:!0,SELECT:!0,OPTION:!0},a={radio:!0,checkbox:!0,button:!0,submit:!0,image:!0,file:!0};return i.okayPointerDown=function(t){var e=r[t.target.nodeName],i=a[t.target.type],n=!e||i;return n||this._pointerReset(),n},i.pointerDownBlur=function(){var t=document.activeElement;t&&t.blur&&t!=document.body&&t.blur()},i.pointerMove=function(t,e){var i=this._dragPointerMove(t,e);this.emitEvent("pointerMove",[t,e,i]),this._dragMove(t,e,i)},i._dragPointerMove=function(t,e){var i={x:e.pageX-this.pointerDownPointer.pageX,y:e.pageY-this.pointerDownPointer.pageY};return!this.isDragging&&this.hasDragStarted(i)&&this._dragStart(t,e),i},i.hasDragStarted=function(t){return 3<Math.abs(t.x)||3<Math.abs(t.y)},i.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e]),this._dragPointerUp(t,e)},i._dragPointerUp=function(t,e){this.isDragging?this._dragEnd(t,e):this._staticClick(t,e)},i._dragStart=function(t,e){this.isDragging=!0,this.isPreventingClicks=!0,this.dragStart(t,e)},i.dragStart=function(t,e){this.emitEvent("dragStart",[t,e])},i._dragMove=function(t,e,i){this.isDragging&&this.dragMove(t,e,i)},i.dragMove=function(t,e,i){t.preventDefault(),this.emitEvent("dragMove",[t,e,i])},i._dragEnd=function(t,e){this.isDragging=!1,setTimeout(function(){delete this.isPreventingClicks}.bind(this)),this.dragEnd(t,e)},i.dragEnd=function(t,e){this.emitEvent("dragEnd",[t,e])},i.onclick=function(t){this.isPreventingClicks&&t.preventDefault()},i._staticClick=function(t,e){this.isIgnoringMouseUp&&"mouseup"==t.type||(this.staticClick(t,e),"mouseup"!=t.type&&(this.isIgnoringMouseUp=!0,setTimeout(function(){delete this.isIgnoringMouseUp}.bind(this),400)))},i.staticClick=function(t,e){this.emitEvent("staticClick",[t,e])},e.getPointerPoint=t.getPointerPoint,e}),function(n,r){"function"==typeof define&&define.amd?define("flickity/js/drag",["./flickity","unidragger/unidragger","fizzy-ui-utils/utils"],function(t,e,i){return r(n,t,e,i)}):"object"==typeof module&&module.exports?module.exports=r(n,require("./flickity"),require("unidragger"),require("fizzy-ui-utils")):n.Flickity=r(n,n.Flickity,n.Unidragger,n.fizzyUIUtils)}(window,function(i,t,e,s){s.extend(t.defaults,{draggable:">1",dragThreshold:3}),t.createMethods.push("_createDrag");var n=t.prototype;s.extend(n,e.prototype),n._touchActionValue="pan-y",n._createDrag=function(){this.on("activate",this.onActivateDrag),this.on("uiChange",this._uiChangeDrag),this.on("deactivate",this.onDeactivateDrag),this.on("cellChange",this.updateDraggable)},n.onActivateDrag=function(){this.handles=[this.viewport],this.bindHandles(),this.updateDraggable()},n.onDeactivateDrag=function(){this.unbindHandles(),this.element.classList.remove("is-draggable")},n.updateDraggable=function(){">1"==this.options.draggable?this.isDraggable=1<this.slides.length:this.isDraggable=this.options.draggable,this.isDraggable?this.element.classList.add("is-draggable"):this.element.classList.remove("is-draggable")},n.bindDrag=function(){this.options.draggable=!0,this.updateDraggable()},n.unbindDrag=function(){this.options.draggable=!1,this.updateDraggable()},n._uiChangeDrag=function(){delete this.isFreeScrolling},n.pointerDown=function(t,e){this.isDraggable?this.okayPointerDown(t)&&(this._pointerDownPreventDefault(t),this.pointerDownFocus(t),document.activeElement!=this.element&&this.pointerDownBlur(),this.dragX=this.x,this.viewport.classList.add("is-pointer-down"),this.pointerDownScroll=o(),i.addEventListener("scroll",this),this._pointerDownDefault(t,e)):this._pointerDownDefault(t,e)},n._pointerDownDefault=function(t,e){this.pointerDownPointer={pageX:e.pageX,pageY:e.pageY},this._bindPostStartEvents(t),this.dispatchEvent("pointerDown",t,[e])};var r={INPUT:!0,TEXTAREA:!0,SELECT:!0};function o(){return{x:i.pageXOffset,y:i.pageYOffset}}return n.pointerDownFocus=function(t){r[t.target.nodeName]||this.focus()},n._pointerDownPreventDefault=function(t){var e="touchstart"==t.type,i="touch"==t.pointerType,n=r[t.target.nodeName];e||i||n||t.preventDefault()},n.hasDragStarted=function(t){return Math.abs(t.x)>this.options.dragThreshold},n.pointerUp=function(t,e){delete this.isTouchScrolling,this.viewport.classList.remove("is-pointer-down"),this.dispatchEvent("pointerUp",t,[e]),this._dragPointerUp(t,e)},n.pointerDone=function(){i.removeEventListener("scroll",this),delete this.pointerDownScroll},n.dragStart=function(t,e){this.isDraggable&&(this.dragStartPosition=this.x,this.startAnimation(),i.removeEventListener("scroll",this),this.dispatchEvent("dragStart",t,[e]))},n.pointerMove=function(t,e){var i=this._dragPointerMove(t,e);this.dispatchEvent("pointerMove",t,[e,i]),this._dragMove(t,e,i)},n.dragMove=function(t,e,i){var n,r,o,a;this.isDraggable&&(t.preventDefault(),this.previousDragX=this.dragX,n=this.options.rightToLeft?-1:1,this.options.wrapAround&&(i.x%=this.slideableWidth),o=this.dragStartPosition+i.x*n,!this.options.wrapAround&&this.slides.length&&(o=(o=(r=Math.max(-this.slides[0].target,this.dragStartPosition))<o?.5*(o+r):o)<(a=Math.min(-this.getLastSlide().target,this.dragStartPosition))?.5*(o+a):o),this.dragX=o,this.dragMoveTime=new Date,this.dispatchEvent("dragMove",t,[e,i]))},n.dragEnd=function(t,e){var i,n;this.isDraggable&&(this.options.freeScroll&&(this.isFreeScrolling=!0),i=this.dragEndRestingSelect(),this.options.freeScroll&&!this.options.wrapAround?(n=this.getRestingPosition(),this.isFreeScrolling=-n>this.slides[0].target&&-n<this.getLastSlide().target):this.options.freeScroll||i!=this.selectedIndex||(i+=this.dragEndBoostSelect()),delete this.previousDragX,this.isDragSelect=this.options.wrapAround,this.select(i),delete this.isDragSelect,this.dispatchEvent("dragEnd",t,[e]))},n.dragEndRestingSelect=function(){var t=this.getRestingPosition(),e=Math.abs(this.getSlideDistance(-t,this.selectedIndex)),i=this._getClosestResting(t,e,1),n=this._getClosestResting(t,e,-1);return i.distance<n.distance?i.index:n.index},n._getClosestResting=function(t,e,i){for(var n=this.selectedIndex,r=1/0,o=this.options.contain&&!this.options.wrapAround?function(t,e){return t<=e}:function(t,e){return t<e};o(e,r)&&(n+=i,r=e,null!==(e=this.getSlideDistance(-t,n)));)e=Math.abs(e);return{distance:r,index:n-i}},n.getSlideDistance=function(t,e){var i=this.slides.length,n=this.options.wrapAround&&1<i,r=n?s.modulo(e,i):e,o=this.slides[r];if(!o)return null;var a=n?this.slideableWidth*Math.floor(e/i):0;return t-(o.target+a)},n.dragEndBoostSelect=function(){if(void 0===this.previousDragX||!this.dragMoveTime||100<new Date-this.dragMoveTime)return 0;var t=this.getSlideDistance(-this.dragX,this.selectedIndex),e=this.previousDragX-this.dragX;return 0<t&&0<e?1:t<0&&e<0?-1:0},n.staticClick=function(t,e){var i=this.getParentCell(t.target),n=i&&i.element,r=i&&this.cells.indexOf(i);this.dispatchEvent("staticClick",t,[e,n,r])},n.onscroll=function(){var t=o(),e=this.pointerDownScroll.x-t.x,i=this.pointerDownScroll.y-t.y;(3<Math.abs(e)||3<Math.abs(i))&&this._pointerDone()},t}),function(t,n){"function"==typeof define&&define.amd?define("flickity/js/prev-next-button",["./flickity","unipointer/unipointer","fizzy-ui-utils/utils"],function(t,e,i){return n(0,t,e,i)}):"object"==typeof module&&module.exports?module.exports=n(0,require("./flickity"),require("unipointer"),require("fizzy-ui-utils")):n(0,t.Flickity,t.Unipointer,t.fizzyUIUtils)}(window,function(t,e,i,n){"use strict";var r="http://www.w3.org/2000/svg";function o(t,e){this.direction=t,this.parent=e,this._create()}(o.prototype=Object.create(i.prototype))._create=function(){this.isEnabled=!0,this.isPrevious=-1==this.direction;var t=this.parent.options.rightToLeft?1:-1;this.isLeft=this.direction==t;var e=this.element=document.createElement("button");e.className="flickity-button flickity-prev-next-button",e.className+=this.isPrevious?" previous":" next",e.setAttribute("type","button"),this.disable(),e.setAttribute("aria-label",this.isPrevious?"Previous":"Next");var i=this.createSVG();e.appendChild(i),this.parent.on("select",this.update.bind(this)),this.on("pointerDown",this.parent.childUIPointerDown.bind(this.parent))},o.prototype.activate=function(){this.bindStartEvent(this.element),this.element.addEventListener("click",this),this.parent.element.appendChild(this.element)},o.prototype.deactivate=function(){this.parent.element.removeChild(this.element),this.unbindStartEvent(this.element),this.element.removeEventListener("click",this)},o.prototype.createSVG=function(){var t=document.createElementNS(r,"svg");t.setAttribute("class","flickity-button-icon"),t.setAttribute("viewBox","0 0 100 100");var e,i=document.createElementNS(r,"path"),n="string"!=typeof(e=this.parent.options.arrowShape)?"M "+e.x0+",50 L "+e.x1+","+(e.y1+50)+" L "+e.x2+","+(e.y2+50)+" L "+e.x3+",50  L "+e.x2+","+(50-e.y2)+" L "+e.x1+","+(50-e.y1)+" Z":e;return i.setAttribute("d",n),i.setAttribute("class","arrow"),this.isLeft||i.setAttribute("transform","translate(100, 100) rotate(180) "),t.appendChild(i),t},o.prototype.handleEvent=n.handleEvent,o.prototype.onclick=function(){var t;this.isEnabled&&(this.parent.uiChange(),t=this.isPrevious?"previous":"next",this.parent[t]())},o.prototype.enable=function(){this.isEnabled||(this.element.disabled=!1,this.isEnabled=!0)},o.prototype.disable=function(){this.isEnabled&&(this.element.disabled=!0,this.isEnabled=!1)},o.prototype.update=function(){var t,e,i=this.parent.slides;this.parent.options.wrapAround&&1<i.length?this.enable():(t=i.length?i.length-1:0,e=this.isPrevious?0:t,this[this.parent.selectedIndex==e?"disable":"enable"]())},o.prototype.destroy=function(){this.deactivate(),this.allOff()},n.extend(e.defaults,{prevNextButtons:!0,arrowShape:{x0:10,x1:60,y1:50,x2:70,y2:40,x3:30}}),e.createMethods.push("_createPrevNextButtons");var a=e.prototype;return a._createPrevNextButtons=function(){this.options.prevNextButtons&&(this.prevButton=new o(-1,this),this.nextButton=new o(1,this),this.on("activate",this.activatePrevNextButtons))},a.activatePrevNextButtons=function(){this.prevButton.activate(),this.nextButton.activate(),this.on("deactivate",this.deactivatePrevNextButtons)},a.deactivatePrevNextButtons=function(){this.prevButton.deactivate(),this.nextButton.deactivate(),this.off("deactivate",this.deactivatePrevNextButtons)},e.PrevNextButton=o,e}),function(t,n){"function"==typeof define&&define.amd?define("flickity/js/page-dots",["./flickity","unipointer/unipointer","fizzy-ui-utils/utils"],function(t,e,i){return n(0,t,e,i)}):"object"==typeof module&&module.exports?module.exports=n(0,require("./flickity"),require("unipointer"),require("fizzy-ui-utils")):n(0,t.Flickity,t.Unipointer,t.fizzyUIUtils)}(window,function(t,e,i,n){function r(t){this.parent=t,this._create()}(r.prototype=Object.create(i.prototype))._create=function(){this.holder=document.createElement("ol"),this.holder.className="flickity-page-dots",this.dots=[],this.handleClick=this.onClick.bind(this),this.on("pointerDown",this.parent.childUIPointerDown.bind(this.parent))},r.prototype.activate=function(){this.setDots(),this.holder.addEventListener("click",this.handleClick),this.bindStartEvent(this.holder),this.parent.element.appendChild(this.holder)},r.prototype.deactivate=function(){this.holder.removeEventListener("click",this.handleClick),this.unbindStartEvent(this.holder),this.parent.element.removeChild(this.holder)},r.prototype.setDots=function(){var t=this.parent.slides.length-this.dots.length;0<t?this.addDots(t):t<0&&this.removeDots(-t)},r.prototype.addDots=function(t){for(var e=document.createDocumentFragment(),i=[],n=this.dots.length,r=n+t,o=n;o<r;o++){var a=document.createElement("li");a.className="dot",a.setAttribute("aria-label","Page dot "+(o+1)),e.appendChild(a),i.push(a)}this.holder.appendChild(e),this.dots=this.dots.concat(i)},r.prototype.removeDots=function(t){this.dots.splice(this.dots.length-t,t).forEach(function(t){this.holder.removeChild(t)},this)},r.prototype.updateSelected=function(){this.selectedDot&&(this.selectedDot.className="dot",this.selectedDot.removeAttribute("aria-current")),this.dots.length&&(this.selectedDot=this.dots[this.parent.selectedIndex],this.selectedDot.className="dot is-selected",this.selectedDot.setAttribute("aria-current","step"))},r.prototype.onTap=r.prototype.onClick=function(t){var e,i=t.target;"LI"==i.nodeName&&(this.parent.uiChange(),e=this.dots.indexOf(i),this.parent.select(e))},r.prototype.destroy=function(){this.deactivate(),this.allOff()},e.PageDots=r,n.extend(e.defaults,{pageDots:!0}),e.createMethods.push("_createPageDots");var o=e.prototype;return o._createPageDots=function(){this.options.pageDots&&(this.pageDots=new r(this),this.on("activate",this.activatePageDots),this.on("select",this.updateSelectedPageDots),this.on("cellChange",this.updatePageDots),this.on("resize",this.updatePageDots),this.on("deactivate",this.deactivatePageDots))},o.activatePageDots=function(){this.pageDots.activate()},o.updateSelectedPageDots=function(){this.pageDots.updateSelected()},o.updatePageDots=function(){this.pageDots.setDots()},o.deactivatePageDots=function(){this.pageDots.deactivate()},e.PageDots=r,e}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/player",["ev-emitter/ev-emitter","fizzy-ui-utils/utils","./flickity"],e):"object"==typeof module&&module.exports?module.exports=e(require("ev-emitter"),require("fizzy-ui-utils"),require("./flickity")):e(t.EvEmitter,t.fizzyUIUtils,t.Flickity)}(window,function(t,e,i){function n(t){this.parent=t,this.state="stopped",this.onVisibilityChange=this.visibilityChange.bind(this),this.onVisibilityPlay=this.visibilityPlay.bind(this)}(n.prototype=Object.create(t.prototype)).play=function(){"playing"!=this.state&&(document.hidden?document.addEventListener("visibilitychange",this.onVisibilityPlay):(this.state="playing",document.addEventListener("visibilitychange",this.onVisibilityChange),this.tick()))},n.prototype.tick=function(){var t,e;"playing"==this.state&&(t="number"==typeof(t=this.parent.options.autoPlay)?t:3e3,(e=this).clear(),this.timeout=setTimeout(function(){e.parent.next(!0),e.tick()},t))},n.prototype.stop=function(){this.state="stopped",this.clear(),document.removeEventListener("visibilitychange",this.onVisibilityChange)},n.prototype.clear=function(){clearTimeout(this.timeout)},n.prototype.pause=function(){"playing"==this.state&&(this.state="paused",this.clear())},n.prototype.unpause=function(){"paused"==this.state&&this.play()},n.prototype.visibilityChange=function(){this[document.hidden?"pause":"unpause"]()},n.prototype.visibilityPlay=function(){this.play(),document.removeEventListener("visibilitychange",this.onVisibilityPlay)},e.extend(i.defaults,{pauseAutoPlayOnHover:!0}),i.createMethods.push("_createPlayer");var r=i.prototype;return r._createPlayer=function(){this.player=new n(this),this.on("activate",this.activatePlayer),this.on("uiChange",this.stopPlayer),this.on("pointerDown",this.stopPlayer),this.on("deactivate",this.deactivatePlayer)},r.activatePlayer=function(){this.options.autoPlay&&(this.player.play(),this.element.addEventListener("mouseenter",this))},r.playPlayer=function(){this.player.play()},r.stopPlayer=function(){this.player.stop()},r.pausePlayer=function(){this.player.pause()},r.unpausePlayer=function(){this.player.unpause()},r.deactivatePlayer=function(){this.player.stop(),this.element.removeEventListener("mouseenter",this)},r.onmouseenter=function(){this.options.pauseAutoPlayOnHover&&(this.player.pause(),this.element.addEventListener("mouseleave",this))},r.onmouseleave=function(){this.player.unpause(),this.element.removeEventListener("mouseleave",this)},i.Player=n,i}),function(t,i){"function"==typeof define&&define.amd?define("flickity/js/add-remove-cell",["./flickity","fizzy-ui-utils/utils"],function(t,e){return i(0,t,e)}):"object"==typeof module&&module.exports?module.exports=i(0,require("./flickity"),require("fizzy-ui-utils")):i(0,t.Flickity,t.fizzyUIUtils)}(window,function(t,e,n){var i=e.prototype;return i.insert=function(t,e){var i,n,r,o,a,s,c,l=this._makeCells(t);l&&l.length&&(i=this.cells.length,e=void 0===e?i:e,r=l,o=document.createDocumentFragment(),r.forEach(function(t){o.appendChild(t.element)}),n=o,(a=e==i)?this.slider.appendChild(n):(s=this.cells[e].element,this.slider.insertBefore(n,s)),0===e?this.cells=l.concat(this.cells):a?this.cells=this.cells.concat(l):(c=this.cells.splice(e,i-e),this.cells=this.cells.concat(l).concat(c)),this._sizeCells(l),this.cellChange(e,!0))},i.append=function(t){this.insert(t,this.cells.length)},i.prepend=function(t){this.insert(t,0)},i.remove=function(t){var i,e=this.getCells(t);e&&e.length&&(i=this.cells.length-1,e.forEach(function(t){t.remove();var e=this.cells.indexOf(t);i=Math.min(e,i),n.removeFrom(this.cells,t)},this),this.cellChange(i,!0))},i.cellSizeChange=function(t){var e,i=this.getCell(t);i&&(i.getSize(),e=this.cells.indexOf(i),this.cellChange(e))},i.cellChange=function(t,e){var i=this.selectedElement;this._positionCells(t),this._getWrapShiftCells(),this.setGallerySize();var n=this.getCell(i);n&&(this.selectedIndex=this.getCellSlideIndex(n)),this.selectedIndex=Math.min(this.slides.length-1,this.selectedIndex),this.emitEvent("cellChange",[t]),this.select(this.selectedIndex),e&&this.positionSliderAtSelected()},e}),function(t,i){"function"==typeof define&&define.amd?define("flickity/js/lazyload",["./flickity","fizzy-ui-utils/utils"],function(t,e){return i(0,t,e)}):"object"==typeof module&&module.exports?module.exports=i(0,require("./flickity"),require("fizzy-ui-utils")):i(0,t.Flickity,t.fizzyUIUtils)}(window,function(t,e,o){"use strict";e.createMethods.push("_createLazyload");var i=e.prototype;function r(t,e){this.img=t,this.flickity=e,this.load()}return i._createLazyload=function(){this.on("select",this.lazyLoad)},i.lazyLoad=function(){var t,e,i,n=this.options.lazyLoad;n&&(t="number"==typeof n?n:0,e=this.getAdjacentCellElements(t),i=[],e.forEach(function(t){var e=function(t){if("IMG"==t.nodeName){var e=t.getAttribute("data-flickity-lazyload"),i=t.getAttribute("data-flickity-lazyload-src"),n=t.getAttribute("data-flickity-lazyload-srcset");if(e||i||n)return[t]}var r=t.querySelectorAll("img[data-flickity-lazyload], img[data-flickity-lazyload-src], img[data-flickity-lazyload-srcset]");return o.makeArray(r)}(t);i=i.concat(e)}),i.forEach(function(t){new r(t,this)},this))},r.prototype.handleEvent=o.handleEvent,r.prototype.load=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this);var t=this.img.getAttribute("data-flickity-lazyload")||this.img.getAttribute("data-flickity-lazyload-src"),e=this.img.getAttribute("data-flickity-lazyload-srcset");this.img.src=t,e&&this.img.setAttribute("srcset",e),this.img.removeAttribute("data-flickity-lazyload"),this.img.removeAttribute("data-flickity-lazyload-src"),this.img.removeAttribute("data-flickity-lazyload-srcset")},r.prototype.onload=function(t){this.complete(t,"flickity-lazyloaded")},r.prototype.onerror=function(t){this.complete(t,"flickity-lazyerror")},r.prototype.complete=function(t,e){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this);var i=this.flickity.getParentCell(this.img),n=i&&i.element;this.flickity.cellSizeChange(n),this.img.classList.add(e),this.flickity.dispatchEvent("lazyLoad",t,n)},e.LazyLoader=r,e}),function(t){"function"==typeof define&&define.amd?define("flickity/js/index",["./flickity","./drag","./prev-next-button","./page-dots","./player","./add-remove-cell","./lazyload"],t):"object"==typeof module&&module.exports&&(module.exports=t(require("./flickity"),require("./drag"),require("./prev-next-button"),require("./page-dots"),require("./player"),require("./add-remove-cell"),require("./lazyload")))}((window,function(t){return t})),function(t,e){"function"==typeof define&&define.amd?define("flickity-as-nav-for/as-nav-for",["flickity/js/index","fizzy-ui-utils/utils"],e):"object"==typeof module&&module.exports?module.exports=e(require("flickity"),require("fizzy-ui-utils")):t.Flickity=e(t.Flickity,t.fizzyUIUtils)}(window,function(n,r){n.createMethods.push("_createAsNavFor");var t=n.prototype;return t._createAsNavFor=function(){this.on("activate",this.activateAsNavFor),this.on("deactivate",this.deactivateAsNavFor),this.on("destroy",this.destroyAsNavFor);var t,e=this.options.asNavFor;e&&(t=this,setTimeout(function(){t.setNavCompanion(e)}))},t.setNavCompanion=function(t){t=r.getQueryElement(t);var e,i=n.data(t);i&&i!=this&&(this.navCompanion=i,(e=this).onNavCompanionSelect=function(){e.navCompanionSelect()},i.on("select",this.onNavCompanionSelect),this.on("staticClick",this.onNavStaticClick),this.navCompanionSelect(!0))},t.navCompanionSelect=function(t){var e,i,n,r,o,a,s,c,l=this.navCompanion&&this.navCompanion.selectedCells;l&&(e=l[0],n=(i=this.navCompanion.cells.indexOf(e))+l.length-1,r=Math.floor((o=i,a=n,s=this.navCompanion.cellAlign,(a-o)*s+o)),this.selectCell(r,!1,t),this.removeNavSelectedElements(),r>=this.cells.length||(c=this.cells.slice(i,1+n),this.navSelectedElements=c.map(function(t){return t.element}),this.changeNavSelectedClass("add")))},t.changeNavSelectedClass=function(e){this.navSelectedElements.forEach(function(t){t.classList[e]("is-nav-selected")})},t.activateAsNavFor=function(){this.navCompanionSelect(!0)},t.removeNavSelectedElements=function(){this.navSelectedElements&&(this.changeNavSelectedClass("remove"),delete this.navSelectedElements)},t.onNavStaticClick=function(t,e,i,n){"number"==typeof n&&this.navCompanion.selectCell(n)},t.deactivateAsNavFor=function(){this.removeNavSelectedElements()},t.destroyAsNavFor=function(){this.navCompanion&&(this.navCompanion.off("select",this.onNavCompanionSelect),this.off("staticClick",this.onNavStaticClick),delete this.navCompanion)},n}),function(e,i){"use strict";"function"==typeof define&&define.amd?define("imagesloaded/imagesloaded",["ev-emitter/ev-emitter"],function(t){return i(e,t)}):"object"==typeof module&&module.exports?module.exports=i(e,require("ev-emitter")):e.imagesLoaded=i(e,e.EvEmitter)}("undefined"!=typeof window?window:this,function(e,t){var o=e.jQuery,a=e.console;function s(t,e){for(var i in e)t[i]=e[i];return t}var c=Array.prototype.slice;function l(t,e,i){if(!(this instanceof l))return new l(t,e,i);var n,r=t;"string"==typeof t&&(r=document.querySelectorAll(t)),r?(this.elements=(n=r,Array.isArray(n)?n:"object"==typeof n&&"number"==typeof n.length?c.call(n):[n]),this.options=s({},this.options),"function"==typeof e?i=e:s(this.options,e),i&&this.on("always",i),this.getImages(),o&&(this.jqDeferred=new o.Deferred),setTimeout(this.check.bind(this))):a.error("Bad element for imagesLoaded "+(r||t))}(l.prototype=Object.create(t.prototype)).options={},l.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},l.prototype.addElementImages=function(t){"IMG"==t.nodeName&&this.addImage(t),!0===this.options.background&&this.addElementBackgroundImages(t);var e=t.nodeType;if(e&&h[e]){for(var i=t.querySelectorAll("img"),n=0;n<i.length;n++){var r=i[n];this.addImage(r)}if("string"==typeof this.options.background)for(var o=t.querySelectorAll(this.options.background),n=0;n<o.length;n++){var a=o[n];this.addElementBackgroundImages(a)}}};var h={1:!0,9:!0,11:!0};function i(t){this.img=t}function n(t,e){this.url=t,this.element=e,this.img=new Image}return l.prototype.addElementBackgroundImages=function(t){var e=getComputedStyle(t);if(e)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(e.backgroundImage);null!==n;){var r=n&&n[2];r&&this.addBackground(r,t),n=i.exec(e.backgroundImage)}},l.prototype.addImage=function(t){var e=new i(t);this.images.push(e)},l.prototype.addBackground=function(t,e){var i=new n(t,e);this.images.push(i)},l.prototype.check=function(){var n=this;function e(t,e,i){setTimeout(function(){n.progress(t,e,i)})}this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?this.images.forEach(function(t){t.once("progress",e),t.check()}):this.complete()},l.prototype.progress=function(t,e,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded,this.emitEvent("progress",[this,t,e]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,t),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&a&&a.log("progress: "+i,t,e)},l.prototype.complete=function(){var t,e=this.hasAnyBroken?"fail":"done";this.isComplete=!0,this.emitEvent(e,[this]),this.emitEvent("always",[this]),this.jqDeferred&&(t=this.hasAnyBroken?"reject":"resolve",this.jqDeferred[t](this))},(i.prototype=Object.create(t.prototype)).check=function(){this.getIsImageComplete()?this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.proxyImage.src=this.img.src)},i.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},i.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.img,e])},i.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},i.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},i.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},i.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},(n.prototype=Object.create(i.prototype)).check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url,this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},n.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},n.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.element,e])},(l.makeJQueryPlugin=function(t){(t=t||e.jQuery)&&((o=t).fn.imagesLoaded=function(t,e){return new l(this,t,e).jqDeferred.promise(o(this))})})(),l}),function(t,i){"function"==typeof define&&define.amd?define(["flickity/js/index","imagesloaded/imagesloaded"],function(t,e){return i(0,t,e)}):"object"==typeof module&&module.exports?module.exports=i(0,require("flickity"),require("imagesloaded")):t.Flickity=i(0,t.Flickity,t.imagesLoaded)}(window,function(t,e,i){"use strict";e.createMethods.push("_createImagesLoaded");var n=e.prototype;return n._createImagesLoaded=function(){this.on("activate",this.imagesLoaded)},n.imagesLoaded=function(){var n;this.options.imagesLoaded&&i((n=this).slider).on("progress",function(t,e){var i=n.getParentCell(e.img);n.cellSizeChange(i&&i.element),n.options.freeScroll||n.positionSliderAtSelected()})},e}),function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Parallax=t()}(function(){return function o(a,s,c){function l(e,t){if(!s[e]){if(!a[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(h)return h(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var r=s[e]={exports:{}};a[e][0].call(r.exports,function(t){return l(a[e][1][t]||t)},r,r.exports,o,a,s,c)}return s[e].exports}for(var h="function"==typeof require&&require,t=0;t<c.length;t++)l(c[t]);return l}({1:[function(t,e,i){"use strict";var c=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return}}()?Object.assign:function(t,e){for(var i,n,r=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),o=1;o<arguments.length;o++){for(var a in i=Object(arguments[o]))l.call(i,a)&&(r[a]=i[a]);if(c){n=c(i);for(var s=0;s<n.length;s++)h.call(i,n[s])&&(r[n[s]]=i[n[s]])}}return r}},{}],2:[function(t,s,e){(function(a){(function(){var t,e,i,n,r,o;"undefined"!=typeof performance&&null!==performance&&performance.now?s.exports=function(){return performance.now()}:null!=a&&a.hrtime?(s.exports=function(){return(t()-r)/1e6},e=a.hrtime,n=(t=function(){var t;return 1e9*(t=e())[0]+t[1]})(),o=1e9*a.uptime(),r=n-o):i=Date.now?(s.exports=function(){return Date.now()-i},Date.now()):(s.exports=function(){return(new Date).getTime()-i},(new Date).getTime())}).call(this)}).call(this,t("_process"))},{_process:3}],3:[function(t,e,i){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(h===setTimeout)return setTimeout(e,0);if((h===n||!h)&&setTimeout)return h=setTimeout,setTimeout(e,0);try{return h(e,0)}catch(t){try{return h.call(null,e,0)}catch(t){return h.call(this,e,0)}}}function a(){m&&p&&(m=!1,p.length?f=p.concat(f):g=-1,f.length&&s())}function s(){if(!m){var t=o(a);m=!0;for(var e=f.length;e;){for(p=f,f=[];++g<e;)p&&p[g].run();g=-1,e=f.length}p=null,m=!1,function(e){if(u===clearTimeout)return clearTimeout(e);if((u===r||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(e);try{u(e)}catch(t){try{return u.call(null,e)}catch(t){return u.call(this,e)}}}(t)}}function c(t,e){this.fun=t,this.array=e}function l(){}var h,u,d=e.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:n}catch(t){h=n}try{u="function"==typeof clearTimeout?clearTimeout:r}catch(t){u=r}}();var p,f=[],m=!1,g=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];f.push(new c(t,e)),1!==f.length||m||o(s)},c.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=l,d.addListener=l,d.once=l,d.off=l,d.removeListener=l,d.removeAllListeners=l,d.emit=l,d.prependListener=l,d.prependOnceListener=l,d.listeners=function(t){return[]},d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],4:[function(u,d,t){(function(t){for(var n,r,o,a=u("performance-now"),e="undefined"==typeof window?t:window,i=["moz","webkit"],s="AnimationFrame",c=e["request"+s],l=e["cancel"+s]||e["cancelRequest"+s],h=0;!c&&h<i.length;h++)c=e[i[h]+"Request"+s],l=e[i[h]+"Cancel"+s]||e[i[h]+"CancelRequest"+s];c&&l||(r=n=0,o=[],c=function(t){var e,i;return 0===o.length&&(e=a(),i=Math.max(0,1e3/60-(e-n)),n=i+e,setTimeout(function(){for(var t=o.slice(0),e=o.length=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(n)}catch(t){setTimeout(function(){throw t},0)}},Math.round(i))),o.push({handle:++r,callback:t,cancelled:!1}),r},l=function(t){for(var e=0;e<o.length;e++)o[e].handle===t&&(o[e].cancelled=!0)}),d.exports=function(t){return c.call(e,t)},d.exports.cancel=function(){l.apply(e,arguments)},d.exports.polyfill=function(){e.requestAnimationFrame=c,e.cancelAnimationFrame=l}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"performance-now":2}],5:[function(t,e,i){"use strict";var n=function(t,e,i){return e&&l(t.prototype,e),i&&l(t,i),t},c=t("raf"),r=t("object-assign"),p={propertyCache:{},vendors:[null,["-webkit-","webkit"],["-moz-","Moz"],["-o-","O"],["-ms-","ms"]],clamp:function(t,e,i){return e<i?t<e?e:i<t?i:t:t<i?i:e<t?e:t},data:function(t,e){return p.deserialize(t.getAttribute("data-"+e))},deserialize:function(t){return"true"===t||"false"!==t&&("null"===t?null:!isNaN(parseFloat(t))&&isFinite(t)?parseFloat(t):t)},camelCase:function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},accelerate:function(t){p.css(t,"transform","translate3d(0,0,0) rotate(0.0001deg)"),p.css(t,"transform-style","preserve-3d"),p.css(t,"backface-visibility","hidden")},transformSupport:function(t){for(var e,i,n,r,o,a=document.createElement("div"),s=!1,c=!1,l=null,h=null,u=0,d=p.vendors.length;u<d;u++)if(h=null!==p.vendors[u]?(l=p.vendors[u][0]+"transform",p.vendors[u][1]+"Transform"):l="transform",void 0!==a.style[h]){s=!0;break}switch(t){case"2D":c=s;break;case"3D":s&&(i=document.body||document.createElement("body"),r=(n=document.documentElement).style.overflow,o=!1,document.body||(o=!0,n.style.overflow="hidden",n.appendChild(i),i.style.overflow="hidden",i.style.background=""),i.appendChild(a),a.style[h]="translate3d(1px,1px,1px)",c=void 0!==(e=window.getComputedStyle(a).getPropertyValue(l))&&0<e.length&&"none"!==e,n.style.overflow=r,i.removeChild(a),o&&(i.removeAttribute("style"),i.parentNode.removeChild(i)))}return c},css:function(t,e,i){var n=p.propertyCache[e];if(!n)for(var r=0,o=p.vendors.length;r<o;r++)if(n=null!==p.vendors[r]?p.camelCase(p.vendors[r][1]+"-"+e):e,void 0!==t.style[n]){p.propertyCache[e]=n;break}t.style[n]=i}},o={relativeInput:!1,clipRelativeInput:!1,inputElement:null,hoverOnly:!1,calibrationThreshold:100,calibrationDelay:500,supportDelay:500,calibrateX:!1,calibrateY:!0,invertX:!0,invertY:!0,limitX:!1,limitY:!1,scalarX:10,scalarY:10,frictionX:.1,frictionY:.1,originX:.5,originY:.5,pointerEvents:!1,precision:1,onReady:null,selector:null},a=(n(s,[{key:"initialise",value:function(){void 0===this.transform2DSupport&&(this.transform2DSupport=p.transformSupport("2D"),this.transform3DSupport=p.transformSupport("3D")),this.transform3DSupport&&p.accelerate(this.element),"static"===window.getComputedStyle(this.element).getPropertyValue("position")&&(this.element.style.position="relative"),this.pointerEvents||(this.element.style.pointerEvents="none"),this.updateLayers(),this.updateDimensions(),this.enable(),this.queueCalibration(this.calibrationDelay)}},{key:"doReadyCallback",value:function(){this.onReady&&this.onReady()}},{key:"updateLayers",value:function(){this.selector?this.layers=this.element.querySelectorAll(this.selector):this.layers=this.element.children,this.layers.length||console.warn("ParallaxJS: Your scene does not have any layers."),this.depthsX=[],this.depthsY=[];for(var t=0;t<this.layers.length;t++){var e=this.layers[t];this.transform3DSupport&&p.accelerate(e),e.style.position=t?"absolute":"relative",e.style.display="block",e.style.left=0,e.style.top=0;var i=p.data(e,"depth")||0;this.depthsX.push(p.data(e,"depth-x")||i),this.depthsY.push(p.data(e,"depth-y")||i)}}},{key:"updateDimensions",value:function(){this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,this.windowCenterX=this.windowWidth*this.originX,this.windowCenterY=this.windowHeight*this.originY,this.windowRadiusX=Math.max(this.windowCenterX,this.windowWidth-this.windowCenterX),this.windowRadiusY=Math.max(this.windowCenterY,this.windowHeight-this.windowCenterY)}},{key:"updateBounds",value:function(){this.bounds=this.inputElement.getBoundingClientRect(),this.elementPositionX=this.bounds.left,this.elementPositionY=this.bounds.top,this.elementWidth=this.bounds.width,this.elementHeight=this.bounds.height,this.elementCenterX=this.elementWidth*this.originX,this.elementCenterY=this.elementHeight*this.originY,this.elementRangeX=Math.max(this.elementCenterX,this.elementWidth-this.elementCenterX),this.elementRangeY=Math.max(this.elementCenterY,this.elementHeight-this.elementCenterY)}},{key:"queueCalibration",value:function(t){clearTimeout(this.calibrationTimer),this.calibrationTimer=setTimeout(this.onCalibrationTimer,t)}},{key:"enable",value:function(){this.enabled||(this.enabled=!0,this.orientationSupport?(this.portrait=!1,window.addEventListener("deviceorientation",this.onDeviceOrientation),this.detectionTimer=setTimeout(this.onOrientationTimer,this.supportDelay)):this.motionSupport?(this.portrait=!1,window.addEventListener("devicemotion",this.onDeviceMotion),this.detectionTimer=setTimeout(this.onMotionTimer,this.supportDelay)):(this.calibrationX=0,this.calibrationY=0,this.portrait=!1,window.addEventListener("mousemove",this.onMouseMove),this.doReadyCallback()),window.addEventListener("resize",this.onWindowResize),this.raf=c(this.onAnimationFrame))}},{key:"disable",value:function(){this.enabled&&(this.enabled=!1,this.orientationSupport?window.removeEventListener("deviceorientation",this.onDeviceOrientation):this.motionSupport?window.removeEventListener("devicemotion",this.onDeviceMotion):window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("resize",this.onWindowResize),c.cancel(this.raf))}},{key:"calibrate",value:function(t,e){this.calibrateX=void 0===t?this.calibrateX:t,this.calibrateY=void 0===e?this.calibrateY:e}},{key:"invert",value:function(t,e){this.invertX=void 0===t?this.invertX:t,this.invertY=void 0===e?this.invertY:e}},{key:"friction",value:function(t,e){this.frictionX=void 0===t?this.frictionX:t,this.frictionY=void 0===e?this.frictionY:e}},{key:"scalar",value:function(t,e){this.scalarX=void 0===t?this.scalarX:t,this.scalarY=void 0===e?this.scalarY:e}},{key:"limit",value:function(t,e){this.limitX=void 0===t?this.limitX:t,this.limitY=void 0===e?this.limitY:e}},{key:"origin",value:function(t,e){this.originX=void 0===t?this.originX:t,this.originY=void 0===e?this.originY:e}},{key:"setInputElement",value:function(t){this.inputElement=t,this.updateDimensions()}},{key:"setPosition",value:function(t,e,i){e=e.toFixed(this.precision)+"px",i=i.toFixed(this.precision)+"px",this.transform3DSupport?p.css(t,"transform","translate3d("+e+","+i+",0)"):this.transform2DSupport?p.css(t,"transform","translate("+e+","+i+")"):(t.style.left=e,t.style.top=i)}},{key:"onOrientationTimer",value:function(){this.orientationSupport&&0===this.orientationStatus?(this.disable(),this.orientationSupport=!1,this.enable()):this.doReadyCallback()}},{key:"onMotionTimer",value:function(){this.motionSupport&&0===this.motionStatus?(this.disable(),this.motionSupport=!1,this.enable()):this.doReadyCallback()}},{key:"onCalibrationTimer",value:function(){this.calibrationFlag=!0}},{key:"onWindowResize",value:function(){this.updateDimensions()}},{key:"onAnimationFrame",value:function(){this.updateBounds();var t=this.inputX-this.calibrationX,e=this.inputY-this.calibrationY;(Math.abs(t)>this.calibrationThreshold||Math.abs(e)>this.calibrationThreshold)&&this.queueCalibration(0),this.portrait?(this.motionX=this.calibrateX?e:this.inputY,this.motionY=this.calibrateY?t:this.inputX):(this.motionX=this.calibrateX?t:this.inputX,this.motionY=this.calibrateY?e:this.inputY),this.motionX*=this.elementWidth*(this.scalarX/100),this.motionY*=this.elementHeight*(this.scalarY/100),isNaN(parseFloat(this.limitX))||(this.motionX=p.clamp(this.motionX,-this.limitX,this.limitX)),isNaN(parseFloat(this.limitY))||(this.motionY=p.clamp(this.motionY,-this.limitY,this.limitY)),this.velocityX+=(this.motionX-this.velocityX)*this.frictionX,this.velocityY+=(this.motionY-this.velocityY)*this.frictionY;for(var i=0;i<this.layers.length;i++){var n=this.layers[i],r=this.depthsX[i],o=this.depthsY[i],a=this.velocityX*(r*(this.invertX?-1:1)),s=this.velocityY*(o*(this.invertY?-1:1));this.setPosition(n,a,s)}this.raf=c(this.onAnimationFrame)}},{key:"rotate",value:function(t,e){var i=(t||0)/30,n=(e||0)/30,r=this.windowHeight>this.windowWidth;this.portrait!==r&&(this.portrait=r,this.calibrationFlag=!0),this.calibrationFlag&&(this.calibrationFlag=!1,this.calibrationX=i,this.calibrationY=n),this.inputX=i,this.inputY=n}},{key:"onDeviceOrientation",value:function(t){var e=t.beta,i=t.gamma;null!==e&&null!==i&&(this.orientationStatus=1,this.rotate(e,i))}},{key:"onDeviceMotion",value:function(t){var e=t.rotationRate.beta,i=t.rotationRate.gamma;null!==e&&null!==i&&(this.motionStatus=1,this.rotate(e,i))}},{key:"onMouseMove",value:function(t){var e=t.clientX,i=t.clientY;if(this.hoverOnly&&(e<this.elementPositionX||e>this.elementPositionX+this.elementWidth||i<this.elementPositionY||i>this.elementPositionY+this.elementHeight))return this.inputX=0,void(this.inputY=0);this.relativeInput?(this.clipRelativeInput&&(e=Math.max(e,this.elementPositionX),e=Math.min(e,this.elementPositionX+this.elementWidth),i=Math.max(i,this.elementPositionY),i=Math.min(i,this.elementPositionY+this.elementHeight)),this.elementRangeX&&this.elementRangeY&&(this.inputX=(e-this.elementPositionX-this.elementCenterX)/this.elementRangeX,this.inputY=(i-this.elementPositionY-this.elementCenterY)/this.elementRangeY)):this.windowRadiusX&&this.windowRadiusY&&(this.inputX=(e-this.windowCenterX)/this.windowRadiusX,this.inputY=(i-this.windowCenterY)/this.windowRadiusY)}},{key:"destroy",value:function(){this.disable(),clearTimeout(this.calibrationTimer),clearTimeout(this.detectionTimer),this.element.removeAttribute("style");for(var t=0;t<this.layers.length;t++)this.layers[t].removeAttribute("style");delete this.element,delete this.layers}},{key:"version",value:function(){return"3.1.0"}}]),s);function s(t,e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,s),this.element=t;var i={calibrateX:p.data(this.element,"calibrate-x"),calibrateY:p.data(this.element,"calibrate-y"),invertX:p.data(this.element,"invert-x"),invertY:p.data(this.element,"invert-y"),limitX:p.data(this.element,"limit-x"),limitY:p.data(this.element,"limit-y"),scalarX:p.data(this.element,"scalar-x"),scalarY:p.data(this.element,"scalar-y"),frictionX:p.data(this.element,"friction-x"),frictionY:p.data(this.element,"friction-y"),originX:p.data(this.element,"origin-x"),originY:p.data(this.element,"origin-y"),pointerEvents:p.data(this.element,"pointer-events"),precision:p.data(this.element,"precision"),relativeInput:p.data(this.element,"relative-input"),clipRelativeInput:p.data(this.element,"clip-relative-input"),hoverOnly:p.data(this.element,"hover-only"),inputElement:document.querySelector(p.data(this.element,"input-element")),selector:p.data(this.element,"selector")};for(var n in i)null===i[n]&&delete i[n];r(this,o,i,e),this.inputElement||(this.inputElement=this.element),this.calibrationTimer=null,this.calibrationFlag=!0,this.enabled=!1,this.depthsX=[],this.depthsY=[],this.raf=null,this.bounds=null,this.elementPositionX=0,this.elementPositionY=0,this.elementWidth=0,this.elementHeight=0,this.elementCenterX=0,this.elementCenterY=0,this.elementRangeX=0,this.elementRangeY=0,this.calibrationX=0,this.calibrationY=0,this.inputX=0,this.inputY=0,this.motionX=0,this.motionY=0,this.velocityX=0,this.velocityY=0,this.onMouseMove=this.onMouseMove.bind(this),this.onDeviceOrientation=this.onDeviceOrientation.bind(this),this.onDeviceMotion=this.onDeviceMotion.bind(this),this.onOrientationTimer=this.onOrientationTimer.bind(this),this.onMotionTimer=this.onMotionTimer.bind(this),this.onCalibrationTimer=this.onCalibrationTimer.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this),this.onWindowResize=this.onWindowResize.bind(this),this.windowWidth=null,this.windowHeight=null,this.windowCenterX=null,this.windowCenterY=null,this.windowRadiusX=null,this.windowRadiusY=null,this.portrait=!1,this.desktop=!navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|BB10|mobi|tablet|opera mini|nexus 7)/i),this.motionSupport=!!window.DeviceMotionEvent&&!this.desktop,this.orientationSupport=!!window.DeviceOrientationEvent&&!this.desktop,this.orientationStatus=0,this.motionStatus=0,this.initialise()}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}e.exports=a},{"object-assign":1,raf:4}]},{},[5])(5)}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).THREE={})}(this,function(t){function e(){}function wt(t,e){this.x=t||0,this.y=e||0}function S(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==n?n:1}function Et(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0}function g(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function d(t,e,i,n,r,o,a,s,c,l){Object.defineProperty(this,"id",{value:ta++}),this.uuid=uo.generateUUID(),this.name="",this.image=void 0!==t?t:d.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:d.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:1001,this.wrapT=void 0!==n?n:1001,this.magFilter=void 0!==r?r:1006,this.minFilter=void 0!==o?o:1008,this.anisotropy=void 0!==c?c:1,this.format=void 0!==a?a:1023,this.type=void 0!==s?s:1009,this.offset=new wt(0,0),this.repeat=new wt(1,1),this.center=new wt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new g,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:3e3,this.version=0,this.onUpdate=null}function Mt(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==n?n:1}function C(t,e,i){this.width=t,this.height=e,this.scissor=new Mt(0,0,t,e),this.scissorTest=!1,this.viewport=new Mt(0,0,t,e),i=i||{},this.texture=new d(void 0,void 0,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:1006,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0===i.stencilBuffer||i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null}function i(t,e,i){C.call(this,t,e,i),this.samples=4}function r(t,e,i){C.call(this,t,e,i)}function _t(t,e,i,n,r,o,a,s,c,l,h,u){d.call(this,null,o,a,s,c,l,n,r,h,u),this.image={data:t,width:e,height:i},this.magFilter=void 0!==c?c:1003,this.minFilter=void 0!==l?l:1003,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1}function n(t,e){this.min=void 0!==t?t:new Et(1/0,1/0,1/0),this.max=void 0!==e?e:new Et(-1/0,-1/0,-1/0)}function h(t,e){this.center=void 0!==t?t:new Et,this.radius=void 0!==e?e:0}function v(t,e){this.normal=void 0!==t?t:new Et(1,0,0),this.constant=void 0!==e?e:0}function St(t,e,i,n,r,o){this.planes=[void 0!==t?t:new v,void 0!==e?e:new v,void 0!==i?i:new v,void 0!==n?n:new v,void 0!==r?r:new v,void 0!==o?o:new v]}function At(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Tt(t){var e,i={};for(e in t)for(var n in i[e]={},t[e]){var r=t[e][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?i[e][n]=r.clone():Array.isArray(r)?i[e][n]=r.slice():i[e][n]=r}return i}function o(t){for(var e={},i=0;i<t.length;i++){var n,r=Tt(t[i]);for(n in r)e[n]=r[n]}return e}function p(t,e,i){return void 0===e&&void 0===i?this.set(t):this.setRGB(t,e,i)}function Ct(){function i(t,e){!1!==r&&(o(t,e),n.requestAnimationFrame(i))}var n=null,r=!1,o=null;return{start:function(){!0!==r&&null!==o&&(n.requestAnimationFrame(i),r=!0)},stop:function(){r=!1},setAnimationLoop:function(t){o=t},setContext:function(t){n=t}}}function Lt(u){var d=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),d.get(t)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var e=d.get(t);e&&(u.deleteBuffer(e.buffer),d.delete(t))},update:function(t,e){t.isInterleavedBufferAttribute&&(t=t.data);var i,n,r,o,a,s,c,l,h=d.get(t);void 0===h?d.set(t,(a=e,s=(o=t).array,c=o.dynamic?35048:35044,l=u.createBuffer(),u.bindBuffer(a,l),u.bufferData(a,s,c),o.onUploadCallback(),a=5126,s instanceof Float32Array?a=5126:s instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):s instanceof Uint16Array?a=5123:s instanceof Int16Array?a=5122:s instanceof Uint32Array?a=5125:s instanceof Int32Array?a=5124:s instanceof Int8Array?a=5120:s instanceof Uint8Array&&(a=5121),{buffer:l,type:a,bytesPerElement:s.BYTES_PER_ELEMENT,version:o.version})):h.version<t.version&&(n=(i=t).array,r=i.updateRange,u.bindBuffer(e,h.buffer),!1===i.dynamic?u.bufferData(e,n,35044):-1===r.count?u.bufferSubData(e,0,n):0===r.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(u.bufferSubData(e,r.offset*n.BYTES_PER_ELEMENT,n.subarray(r.offset,r.offset+r.count)),r.count=-1),h.version=t.version)}}}function y(t,e,i,n,r,o){this.a=t,this.b=e,this.c=i,this.normal=n&&n.isVector3?n:new Et,this.vertexNormals=Array.isArray(n)?n:[],this.color=r&&r.isColor?r:new p,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==o?o:0}function a(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._order=n||a.DefaultOrder}function s(){this.mask=1}function u(){Object.defineProperty(this,"id",{value:ka++}),this.uuid=uo.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=u.DefaultUp.clone();var t=new Et,e=new a,i=new S,n=new Et(1,1,1);e.onChange(function(){i.setFromEuler(e,!1)}),i.onChange(function(){e.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new At},normalMatrix:{value:new g}}),this.matrix=new At,this.matrixWorld=new At,this.matrixAutoUpdate=u.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new s,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function f(){Object.defineProperty(this,"id",{value:Ga+=2}),this.uuid=uo.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function m(t,e,i){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===i,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function c(t,e,i){m.call(this,new Int8Array(t),e,i)}function l(t,e,i){m.call(this,new Uint8Array(t),e,i)}function b(t,e,i){m.call(this,new Uint8ClampedArray(t),e,i)}function x(t,e,i){m.call(this,new Int16Array(t),e,i)}function w(t,e,i){m.call(this,new Uint16Array(t),e,i)}function E(t,e,i){m.call(this,new Int32Array(t),e,i)}function M(t,e,i){m.call(this,new Uint32Array(t),e,i)}function L(t,e,i){m.call(this,new Float32Array(t),e,i)}function _(t,e,i){m.call(this,new Float64Array(t),e,i)}function A(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function T(t){if(0===t.length)return-1/0;for(var e=t[0],i=1,n=t.length;i<n;++i)t[i]>e&&(e=t[i]);return e}function P(){Object.defineProperty(this,"id",{value:is+=2}),this.uuid=uo.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0},this.userData={}}function R(t,e,i,n,r,o){f.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:o},this.fromBufferGeometry(new I(t,e,i,n,r,o)),this.mergeVertices()}function I(t,e,i,n,r,o){function a(t,e,i,n,r,o,a,s,c,l,h){var u=o/c,d=a/l,p=o/2,f=a/2,m=s/2;a=c+1;for(var g=l+1,v=o=0,y=new Et,b=0;b<g;b++)for(var x=b*d-f,w=0;w<a;w++)y[t]=(w*u-p)*n,y[e]=x*r,y[i]=m,_.push(y.x,y.y,y.z),y[t]=0,y[e]=0,y[i]=0<s?1:-1,S.push(y.x,y.y,y.z),A.push(w/c),A.push(1-b/l),o+=1;for(b=0;b<l;b++)for(w=0;w<c;w++)t=T+w+a*(b+1),e=T+(w+1)+a*(b+1),i=T+(w+1)+a*b,M.push(T+w+a*b,t,i),M.push(t,e,i),v+=6;E.addGroup(C,v,h),C+=v,T+=o}P.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:o};var E=this;t=t||1,e=e||1,i=i||1,n=Math.floor(n)||1,r=Math.floor(r)||1,o=Math.floor(o)||1;var M=[],_=[],S=[],A=[],T=0,C=0;a("z","y","x",-1,-1,i,e,t,o,r,0),a("z","y","x",1,-1,i,e,-t,o,r,1),a("x","z","y",1,1,t,i,e,n,o,2),a("x","z","y",1,-1,t,i,-e,n,o,3),a("x","y","z",1,-1,t,e,i,n,r,4),a("x","y","z",-1,-1,t,e,-i,n,r,5),this.setIndex(M),this.addAttribute("position",new L(_,3)),this.addAttribute("normal",new L(S,3)),this.addAttribute("uv",new L(A,2))}function O(t,e,i,n){f.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n},this.fromBufferGeometry(new D(t,e,i,n)),this.mergeVertices()}function D(t,e,i,n){P.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n};var r=(t=t||1)/2,o=(e=e||1)/2,a=(i=Math.floor(i)||1)+1,s=(n=Math.floor(n)||1)+1,c=t/i,l=e/n,h=[],u=[],d=[],p=[];for(t=0;t<s;t++){var f=t*l-o;for(e=0;e<a;e++)u.push(e*c-r,-f,0),d.push(0,0,1),p.push(e/i),p.push(1-t/n)}for(t=0;t<n;t++)for(e=0;e<i;e++)r=e+a*(t+1),o=e+1+a*(t+1),s=e+1+a*t,h.push(e+a*t,r,s),h.push(r,o,s);this.setIndex(h),this.addAttribute("position",new L(u,3)),this.addAttribute("normal",new L(d,3)),this.addAttribute("uv",new L(p,2))}function k(){Object.defineProperty(this,"id",{value:Xs++}),this.uuid=uo.generateUUID(),this.name="",this.type="Material",this.lights=this.fog=!0,this.blending=1,this.side=0,this.vertexTangents=this.flatShading=!1,this.vertexColors=0,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.userData={},this.needsUpdate=!0}function N(t){k.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function z(t,e){this.origin=void 0!==t?t:new Et,this.direction=void 0!==e?e:new Et}function B(t,e,i){this.a=void 0!==t?t:new Et,this.b=void 0!==e?e:new Et,this.c=void 0!==i?i:new Et}function F(t){k.call(this),this.type="MeshBasicMaterial",this.color=new p(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.lights=this.morphTargets=this.skinning=!1,this.setValues(t)}function U(t,e){u.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new P,this.material=void 0!==e?e:new F({color:16777215*Math.random()}),this.drawMode=0,this.updateMorphTargets()}function Pt(r,i,o,n){function a(t,e){i.buffers.color.setClear(t.r,t.g,t.b,e,n)}var s,c,l=new p(0),h=0,u=null,d=0;return{getClearColor:function(){return l},setClearColor:function(t,e){l.set(t),a(l,h=void 0!==e?e:1)},getClearAlpha:function(){return h},setClearAlpha:function(t){a(l,h=t)},render:function(t,e,i,n){e=e.background,(i=(i=r.vr).getSession&&i.getSession())&&"additive"===i.environmentBlendMode&&(e=null),null===e?(a(l,h),u=null,d=0):e&&e.isColor&&(a(e,1),n=!0,u=null,d=0),(r.autoClear||n)&&r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil),e&&(e.isCubeTexture||e.isWebGLRenderTargetCube)?(void 0===c&&((c=new U(new I(1,1,1),new N({type:"BackgroundCubeMaterial",uniforms:Tt(ma.cube.uniforms),vertexShader:ma.cube.vertexShader,fragmentShader:ma.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),c.geometry.removeAttribute("uv"),c.onBeforeRender=function(t,e,i){this.matrixWorld.copyPosition(i.matrixWorld)},Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.tCube.value}}),o.update(c)),n=e.isWebGLRenderTargetCube?e.texture:e,c.material.uniforms.tCube.value=n,c.material.uniforms.tFlip.value=e.isWebGLRenderTargetCube?1:-1,u===e&&d===n.version||(c.material.needsUpdate=!0,u=e,d=n.version),t.unshift(c,c.geometry,c.material,0,0,null)):e&&e.isTexture&&(void 0===s&&((s=new U(new D(2,2),new N({type:"BackgroundMaterial",uniforms:Tt(ma.background.uniforms),vertexShader:ma.background.vertexShader,fragmentShader:ma.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),o.update(s)),!0===(s.material.uniforms.t2D.value=e).matrixAutoUpdate&&e.updateMatrix(),s.material.uniforms.uvTransform.value.copy(e.matrix),u===e&&d===e.version||(s.material.needsUpdate=!0,d=(u=e).version),t.unshift(s,s.geometry,s.material,0,0,null))}}}function Rt(r,o,a,s){var c;this.setMode=function(t){c=t},this.render=function(t,e){r.drawArrays(c,t,e),a.update(e,c)},this.renderInstances=function(t,e,i){if(s.isWebGL2)var n=r;else if(null===(n=o.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");n[s.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](c,e,i,t.maxInstancedCount),a.update(i,c,t.maxInstancedCount)}}function It(e,i,t){function n(t){if("highp"===t){if(0<e.getShaderPrecisionFormat(35633,36338).precision&&0<e.getShaderPrecisionFormat(35632,36338).precision)return"highp";t="mediump"}return"mediump"===t&&0<e.getShaderPrecisionFormat(35633,36337).precision&&0<e.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var r,o="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext,a=void 0!==t.precision?t.precision:"highp",s=n(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s),t=!0===t.logarithmicDepthBuffer,s=e.getParameter(34930);var c=e.getParameter(35660),l=e.getParameter(3379),h=e.getParameter(34076),u=e.getParameter(34921),d=e.getParameter(36347),p=e.getParameter(36348),f=e.getParameter(36349),m=0<c,g=o||!!i.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==r)return r;var t=i.get("EXT_texture_filter_anisotropic");return r=null!==t?e.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:n,precision:a,logarithmicDepthBuffer:t,maxTextures:s,maxVertexTextures:c,maxTextureSize:l,maxCubemapSize:h,maxAttributes:u,maxVertexUniforms:d,maxVaryings:p,maxFragmentUniforms:f,vertexTextures:m,floatFragmentTextures:g,floatVertexTextures:m&&g,maxSamples:o?e.getParameter(36183):0}}function Ot(){function c(){m.value!==h&&(m.value=h,m.needsUpdate=0<u),a.numPlanes=u,a.numIntersection=0}function l(t,e,i,n){var r=null!==t?t.length:0,o=null;if(0!==r){if(o=m.value,!0!==n||null===o)for(n=i+4*r,e=e.matrixWorldInverse,f.getNormalMatrix(e),(null===o||o.length<n)&&(o=new Float32Array(n)),n=0;n!==r;++n,i+=4)s.copy(t[n]).applyMatrix4(e,f),s.normal.toArray(o,i),o[i+3]=s.constant;m.value=o,m.needsUpdate=!0}return a.numPlanes=r,o}var a=this,h=null,u=0,d=!1,p=!1,s=new v,f=new g,m={value:null,needsUpdate:!1};this.uniform=m,this.numIntersection=this.numPlanes=0,this.init=function(t,e,i){var n=0!==t.length||e||0!==u||d;return d=e,h=l(t,i,0),u=t.length,n},this.beginShadows=function(){p=!0,l(null)},this.endShadows=function(){p=!1,c()},this.setState=function(t,e,i,n,r,o){if(!d||null===t||0===t.length||p&&!i)p?l(null):c();else{var a=4*(i=p?0:u),s=r.clippingState||null;for(m.value=s,s=l(t,n,a,o),t=0;t!==a;++t)s[t]=h[t];r.clippingState=s,this.numIntersection=e?this.numPlanes:0,this.numPlanes+=i}}}function Dt(i){var n={};return{get:function(t){if(void 0!==n[t])return n[t];switch(t){case"WEBGL_depth_texture":var e=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":e=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":e=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":e=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:e=i.getExtension(t)}return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),n[t]=e}}}function kt(t,c,n){function r(t){var e=t.target;for(var i in null!==(t=o[e.id]).index&&c.remove(t.index),t.attributes)c.remove(t.attributes[i]);e.removeEventListener("dispose",r),delete o[e.id],(i=l[t.id])&&(c.remove(i),delete l[t.id]),n.memory.geometries--}var o={},l={};return{get:function(t,e){var i=o[e.id];return i||(e.addEventListener("dispose",r),e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new P).setFromObject(t)),i=e._bufferGeometry),o[e.id]=i,n.memory.geometries++,i)},update:function(t){var e=t.index,i=t.attributes;for(var n in null!==e&&c.update(e,34963),i)c.update(i[n],34962);for(n in t=t.morphAttributes){i=0;for(var r=(e=t[n]).length;i<r;i++)c.update(e[i],34962)}},getWireframeAttribute:function(t){var e=l[t.id];if(e)return e;e=[];var i=t.index,n=t.attributes;if(null!==i){n=0;for(var r=(i=i.array).length;n<r;n+=3){var o=i[n+0],a=i[n+1],s=i[n+2];e.push(o,a,a,s,s,o)}}else for(i=n.position.array,n=0,r=i.length/3-1;n<r;n+=3)o=n+0,a=n+1,s=n+2,e.push(o,a,a,s,s,o);return e=new(65535<T(e)?M:w)(e,1),c.update(e,34963),l[t.id]=e}}}function Nt(r,o,a,s){var c,l,h;this.setMode=function(t){c=t},this.setIndex=function(t){l=t.type,h=t.bytesPerElement},this.render=function(t,e){r.drawElements(c,e,l,t*h),a.update(e,c)},this.renderInstances=function(t,e,i){if(s.isWebGL2)var n=r;else if(null===(n=o.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");n[s.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](c,i,l,e*h,t.maxInstancedCount),a.update(i,c,t.maxInstancedCount)}}function zt(t){var n={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:n,programs:null,autoReset:!0,reset:function(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0},update:function(t,e,i){switch(i=i||1,n.calls++,e){case 4:n.triangles+=t/3*i;break;case 5:case 6:n.triangles+=i*(t-2);break;case 1:n.lines+=t/2*i;break;case 3:n.lines+=i*(t-1);break;case 2:n.lines+=i*t;break;case 0:n.points+=i*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",e)}}}}function j(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Bt(l){var h={},u=new Float32Array(8);return{update:function(t,e,i,n){var r=t.morphTargetInfluences,o=r.length;if(void 0===(t=h[e.id])){t=[];for(var a=0;a<o;a++)t[a]=[a,0];h[e.id]=t}var s=i.morphTargets&&e.morphAttributes.position;for(i=i.morphNormals&&e.morphAttributes.normal,a=0;a<o;a++){var c=t[a];0!==c[1]&&(s&&e.removeAttribute("morphTarget"+a),i&&e.removeAttribute("morphNormal"+a))}for(a=0;a<o;a++)(c=t[a])[0]=a,c[1]=r[a];for(t.sort(j),a=0;a<8;a++)(c=t[a])&&(r=c[0],o=c[1])?(s&&e.addAttribute("morphTarget"+a,s[r]),i&&e.addAttribute("morphNormal"+a,i[r]),u[a]=o):u[a]=0;n.getUniforms().setValue(l,"morphTargetInfluences",u)}}}function Ft(r,o){var a={};return{update:function(t){var e=o.render.frame,i=t.geometry,n=r.get(t,i);return a[n.id]!==e&&(i.isGeometry&&n.updateFromObject(t),r.update(n),a[n.id]=e),n},dispose:function(){a={}}}}function H(t,e,i,n,r,o,a,s,c,l){d.call(this,t=void 0!==t?t:[],void 0!==e?e:301,i,n,r,o,void 0!==a?a:1022,s,c,l),this.flipY=!1}function G(t,e,i,n){d.call(this,null),this.image={data:t,width:e,height:i,depth:n},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1}function V(t,e,i,n){d.call(this,null),this.image={data:t,width:e,height:i,depth:n},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1}function W(t,e,i){var n=t[0];if(n<=0||0<n)return t;var r=e*i,o=tc[r];if(void 0===o&&(o=new Float32Array(r),tc[r]=o),0!==e)for(n.toArray(o,0),n=1,r=0;n!==e;++n)r+=i,t[n].toArray(o,r);return o}function q(t,e){if(t.length===e.length){for(var i=0,n=t.length;i<n;i++)if(t[i]!==e[i])return;return 1}}function X(t,e){for(var i=0,n=e.length;i<n;i++)t[i]=e[i]}function Y(t,e){var i=ec[e];void 0===i&&(i=new Int32Array(e),ec[e]=i);for(var n=0;n!==e;++n)i[n]=t.allocateTextureUnit();return i}function $(t,e){var i=this.cache;i[0]!==e&&(t.uniform1f(this.addr,e),i[0]=e)}function Z(t,e){var i=this.cache;void 0!==e.x?i[0]===e.x&&i[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y):q(i,e)||(t.uniform2fv(this.addr,e),X(i,e))}function J(t,e){var i=this.cache;void 0!==e.x?i[0]===e.x&&i[1]===e.y&&i[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z):void 0!==e.r?i[0]===e.r&&i[1]===e.g&&i[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b):q(i,e)||(t.uniform3fv(this.addr,e),X(i,e))}function Q(t,e){var i=this.cache;void 0!==e.x?i[0]===e.x&&i[1]===e.y&&i[2]===e.z&&i[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w):q(i,e)||(t.uniform4fv(this.addr,e),X(i,e))}function K(t,e){var i=this.cache,n=e.elements;void 0===n?q(i,e)||(t.uniformMatrix2fv(this.addr,!1,e),X(i,e)):q(i,n)||(rc.set(n),t.uniformMatrix2fv(this.addr,!1,rc),X(i,n))}function tt(t,e){var i=this.cache,n=e.elements;void 0===n?q(i,e)||(t.uniformMatrix3fv(this.addr,!1,e),X(i,e)):q(i,n)||(nc.set(n),t.uniformMatrix3fv(this.addr,!1,nc),X(i,n))}function et(t,e){var i=this.cache,n=e.elements;void 0===n?q(i,e)||(t.uniformMatrix4fv(this.addr,!1,e),X(i,e)):q(i,n)||(ic.set(n),t.uniformMatrix4fv(this.addr,!1,ic),X(i,n))}function it(t,e,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.safeSetTexture2D(e||Zs,r)}function nt(t,e,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(e||Js,r)}function rt(t,e,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(e||Qs,r)}function ot(t,e,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.safeSetTextureCube(e||Ks,r)}function at(t,e){var i=this.cache;i[0]!==e&&(t.uniform1i(this.addr,e),i[0]=e)}function st(t,e){var i=this.cache;q(i,e)||(t.uniform2iv(this.addr,e),X(i,e))}function ct(t,e){var i=this.cache;q(i,e)||(t.uniform3iv(this.addr,e),X(i,e))}function lt(t,e){var i=this.cache;q(i,e)||(t.uniform4iv(this.addr,e),X(i,e))}function ht(t,e){t.uniform1fv(this.addr,e)}function ut(t,e){t.uniform1iv(this.addr,e)}function dt(t,e){t.uniform2iv(this.addr,e)}function pt(t,e){t.uniform3iv(this.addr,e)}function ft(t,e){t.uniform4iv(this.addr,e)}function mt(t,e){e=W(e,this.size,2),t.uniform2fv(this.addr,e)}function gt(t,e){e=W(e,this.size,3),t.uniform3fv(this.addr,e)}function vt(t,e){e=W(e,this.size,4),t.uniform4fv(this.addr,e)}function yt(t,e){e=W(e,this.size,4),t.uniformMatrix2fv(this.addr,!1,e)}function bt(t,e){e=W(e,this.size,9),t.uniformMatrix3fv(this.addr,!1,e)}function xt(t,e){e=W(e,this.size,16),t.uniformMatrix4fv(this.addr,!1,e)}function Ut(t,e,i){var n=e.length,r=Y(i,n);for(t.uniform1iv(this.addr,r),t=0;t!==n;++t)i.safeSetTexture2D(e[t]||Zs,r[t])}function jt(t,e,i){var n=e.length,r=Y(i,n);for(t.uniform1iv(this.addr,r),t=0;t!==n;++t)i.safeSetTextureCube(e[t]||Ks,r[t])}function Ht(t,e,i){this.id=t,this.addr=i,this.cache=[],this.setValue=function(t){switch(t){case 5126:return $;case 35664:return Z;case 35665:return J;case 35666:return Q;case 35674:return K;case 35675:return tt;case 35676:return et;case 35678:case 36198:return it;case 35679:return rt;case 35680:return ot;case 36289:return nt;case 5124:case 35670:return at;case 35667:case 35671:return st;case 35668:case 35672:return ct;case 35669:case 35673:return lt}}(e.type)}function Gt(t,e,i){this.id=t,this.addr=i,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return ht;case 35664:return mt;case 35665:return gt;case 35666:return vt;case 35674:return yt;case 35675:return bt;case 35676:return xt;case 35678:return Ut;case 35680:return jt;case 5124:case 35670:return ut;case 35667:case 35671:return dt;case 35668:case 35672:return pt;case 35669:case 35673:return ft}}(e.type)}function Vt(t){this.id=t,this.seq=[],this.map={}}function Wt(t,e){this.seq=[],this.map={};for(var i=t.getProgramParameter(e,35718),n=0;n<i;++n){var r=t.getActiveUniform(e,n),o=t.getUniformLocation(e,r.name),a=this,s=r.name,c=s.length;for(oc.lastIndex=0;;){var l=oc.exec(s),h=oc.lastIndex,u=l[1],d=l[3];if("]"===l[2]&&(u|=0),void 0===d||"["===d&&h+2===c){s=a,r=new(void 0===d?Ht:Gt)(u,r,o),s.seq.push(r),s.map[r.id]=r;break}void 0===(d=a.map[u])&&(d=new Vt(u),u=a,a=d,u.seq.push(a),u.map[a.id]=a),a=d}}}function qt(t,e,i,n){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),!0===n&&(!1===t.getShaderParameter(r,35713)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",35633===e?"vertex":"fragment",t.getShaderInfoLog(r),function(t){t=t.split("\n");for(var e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}(i))),r}function Xt(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+t)}}function Yt(t,e){return"vec4 "+t+"( vec4 value ) { return "+(e=Xt(e))[0]+"ToLinear"+e[1]+"; }"}function $t(t){return""!==t}function Zt(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function Jt(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function Qt(t){return t.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,function(t,e){if(void 0===(t=aa[e]))throw Error("Can not resolve #include <"+e+">");return Qt(t)})}function Kt(t){return t.replace(/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(t,e,i,n){for(t="",e=parseInt(e);e<parseInt(i);e++)t+=n.replace(/\[ i \]/g,"[ "+e+" ]");return t})}function te(t,e,i,n,r,o,a,s){var c=t.context,l=n.defines,h=r.vertexShader,u=r.fragmentShader,d="SHADOWMAP_TYPE_BASIC";1===o.shadowMapType?d="SHADOWMAP_TYPE_PCF":2===o.shadowMapType&&(d="SHADOWMAP_TYPE_PCF_SOFT");var p="ENVMAP_TYPE_CUBE",f="ENVMAP_MODE_REFLECTION",m="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(n.envMap.mapping){case 301:case 302:p="ENVMAP_TYPE_CUBE";break;case 306:case 307:p="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:p="ENVMAP_TYPE_EQUIREC";break;case 305:p="ENVMAP_TYPE_SPHERE"}switch(n.envMap.mapping){case 302:case 304:f="ENVMAP_MODE_REFRACTION"}switch(n.combine){case 0:m="ENVMAP_BLENDING_MULTIPLY";break;case 1:m="ENVMAP_BLENDING_MIX";break;case 2:m="ENVMAP_BLENDING_ADD"}}var g,v,y,b,x,w,E,M=0<t.gammaFactor?t.gammaFactor:1,_=a.isWebGL2?"":(g=n.extensions,v=o,y=e,[(g=g||{}).derivatives||v.envMapCubeUV||v.bumpMap||v.normalMap&&!v.objectSpaceNormalMap||v.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(g.fragDepth||v.logarithmicDepthBuffer)&&y.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",g.drawBuffers&&y.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(g.shaderTextureLOD||v.envMap)&&y.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter($t).join("\n")),S=function(t){var e,i=[];for(e in t){var n=t[e];!1!==n&&i.push("#define "+e+" "+n)}return i.join("\n")}(l),A=c.createProgram();return n.isRawShaderMaterial?(0<(l=[S].filter($t).join("\n")).length&&(l+="\n"),0<(e=[_,S].filter($t).join("\n")).length&&(e+="\n")):(l=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+r.name,S,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+M,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+f:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexTangents?"#define USE_TANGENT":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+d:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||e.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter($t).join("\n"),e=[_,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+r.name,S,o.alphaTest?"#define ALPHATEST "+o.alphaTest+(o.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+M,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.matcap?"#define USE_MATCAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+p:"",o.envMap?"#define "+f:"",o.envMap?"#define "+m:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexTangents?"#define USE_TANGENT":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+d:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||e.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&(a.isWebGL2||e.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",0!==o.toneMapping?"#define TONE_MAPPING":"",0!==o.toneMapping?aa.tonemapping_pars_fragment:"",0!==o.toneMapping?function(t,e){switch(e){case 1:e="Linear";break;case 2:e="Reinhard";break;case 3:e="Uncharted2";break;case 4:e="OptimizedCineon";break;case 5:e="ACESFilmic";break;default:throw Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+e+"ToneMapping( color ); }"}("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.matcapEncoding||o.envMapEncoding||o.emissiveMapEncoding?aa.encodings_pars_fragment:"",o.mapEncoding?Yt("mapTexelToLinear",o.mapEncoding):"",o.matcapEncoding?Yt("matcapTexelToLinear",o.matcapEncoding):"",o.envMapEncoding?Yt("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?Yt("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?(b="linearToOutputTexel",x=o.outputEncoding,"vec4 "+b+"( vec4 value ) { return LinearTo"+(x=Xt(x))[0]+x[1]+"; }"):"",o.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter($t).join("\n")),h=Jt(h=Zt(h=Qt(h),o),o),u=Jt(u=Zt(u=Qt(u),o),o),h=Kt(h),u=Kt(u),a.isWebGL2&&!n.isRawShaderMaterial&&(a=!1,d=/^\s*#version\s+300\s+es\s*\n/,n.isShaderMaterial&&null!==h.match(d)&&null!==u.match(d)&&(a=!0,h=h.replace(d,""),u=u.replace(d,"")),l="#version 300 es\n\n#define attribute in\n#define varying out\n#define texture2D texture\n"+l,e=["#version 300 es\n\n#define varying in",a?"":"out highp vec4 pc_fragColor;",a?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+e),u=e+u,h=qt(c,35633,l+h,t.debug.checkShaderErrors),u=qt(c,35632,u,t.debug.checkShaderErrors),c.attachShader(A,h),c.attachShader(A,u),void 0!==n.index0AttributeName?c.bindAttribLocation(A,0,n.index0AttributeName):!0===o.morphTargets&&c.bindAttribLocation(A,0,"position"),c.linkProgram(A),t.debug.checkShaderErrors&&(t=c.getProgramInfoLog(A).trim(),o=c.getShaderInfoLog(h).trim(),a=c.getShaderInfoLog(u).trim(),!(p=d=!0)===c.getProgramParameter(A,35714)?(d=!1,console.error("THREE.WebGLProgram: shader error: ",c.getError(),"35715",c.getProgramParameter(A,35715),"gl.getProgramInfoLog",t,o,a)):""!==t?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",t):""!==o&&""!==a||(p=!1),p&&(this.diagnostics={runnable:d,material:n,programLog:t,vertexShader:{log:o,prefix:l},fragmentShader:{log:a,prefix:e}})),c.deleteShader(h),c.deleteShader(u),this.getUniforms=function(){return void 0===w&&(w=new Wt(c,A)),w},this.getAttributes=function(){if(void 0===E){for(var t={},e=c.getProgramParameter(A,35721),i=0;i<e;i++){var n=c.getActiveAttrib(A,i).name;t[n]=c.getAttribLocation(A,n)}E=t}return E},this.destroy=function(){c.deleteProgram(A),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=r.name,this.id=ac++,this.code=i,this.usedTimes=1,this.program=A,this.vertexShader=h,this.fragmentShader=u,this}function ee(u,c,d,l){function p(t,e){var i;return t?t.isTexture?i=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),i=t.texture.encoding):i=3e3,3e3===i&&e&&(i=3007),i}var h=[],f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},r="precision supportsVertexTextures map mapEncoding matcap matcapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors vertexTangents fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering".split(" ");this.getParameters=function(t,e,i,n,r,o,a){var s,c,l=f[t.type];c=a.isSkinnedMesh?(c=a.skeleton.bones,d.floatVertexTextures?1024:(s=Math.min(Math.floor((d.maxVertexUniforms-20)/4),c.length))<c.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+c.length+" bones. This GPU supports "+s+"."),0):s):0,s=d.precision,null===t.precision||(s=d.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",s,"instead.");var h=u.getRenderTarget();return{shaderID:l,precision:s,supportsVertexTextures:d.vertexTextures,outputEncoding:p(h?h.texture:null,u.gammaOutput),map:!!t.map,mapEncoding:p(t.map,u.gammaInput),matcap:!!t.matcap,matcapEncoding:p(t.matcap,u.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:p(t.envMap,u.gammaInput),envMapCubeUV:!!t.envMap&&(306===t.envMap.mapping||307===t.envMap.mapping),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:p(t.emissiveMap,u.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,objectSpaceNormalMap:1===t.normalMapType,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexTangents:t.normalMap&&t.vertexTangents,vertexColors:t.vertexColors,fog:!!n,useFog:t.fog,fogExp:n&&n.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:d.logarithmicDepthBuffer,skinning:t.skinning&&0<c,maxBones:c,useVertexTexture:d.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:u.maxMorphTargets,maxMorphNormals:u.maxMorphNormals,numDirLights:e.directional.length,numPointLights:e.point.length,numSpotLights:e.spot.length,numRectAreaLights:e.rectArea.length,numHemiLights:e.hemi.length,numClippingPlanes:r,numClipIntersection:o,dithering:t.dithering,shadowMapEnabled:u.shadowMap.enabled&&a.receiveShadow&&0<i.length,shadowMapType:u.shadowMap.type,toneMapping:u.toneMapping,physicallyCorrectLights:u.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:2===t.side,flipSided:1===t.side,depthPacking:void 0!==t.depthPacking&&t.depthPacking}},this.getProgramCode=function(t,e){var i=[];if(e.shaderID?i.push(e.shaderID):(i.push(t.fragmentShader),i.push(t.vertexShader)),void 0!==t.defines)for(var n in t.defines)i.push(n),i.push(t.defines[n]);for(n=0;n<r.length;n++)i.push(e[r[n]]);return i.push(t.onBeforeCompile.toString()),i.push(u.gammaOutput),i.push(u.gammaFactor),i.join()},this.acquireProgram=function(t,e,i,n){for(var r,o=0,a=h.length;o<a;o++){var s=h[o];if(s.code===n){++(r=s).usedTimes;break}}return void 0===r&&(r=new te(u,c,n,t,e,i,d,l),h.push(r)),r},this.releaseProgram=function(t){var e;0==--t.usedTimes&&(e=h.indexOf(t),h[e]=h[h.length-1],h.pop(),t.destroy())},this.programs=h}function ie(){var n=new WeakMap;return{get:function(t){var e=n.get(t);return void 0===e&&(e={},n.set(t,e)),e},remove:function(t){n.delete(t)},update:function(t,e,i){n.get(t)[e]=i},dispose:function(){n=new WeakMap}}}function ne(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function re(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function oe(){function a(t,e,i,n,r,o){var a=s[c];return void 0===a?(a={id:t.id,object:t,geometry:e,material:i,program:i.program||u,groupOrder:n,renderOrder:t.renderOrder,z:r,group:o},s[c]=a):(a.id=t.id,a.object=t,a.geometry=e,a.material=i,a.program=i.program||u,a.groupOrder=n,a.renderOrder=t.renderOrder,a.z=r,a.group=o),c++,a}var s=[],c=0,l=[],h=[],u={id:-1};return{opaque:l,transparent:h,init:function(){c=0,l.length=0,h.length=0},push:function(t,e,i,n,r,o){t=a(t,e,i,n,r,o),(!0===i.transparent?h:l).push(t)},unshift:function(t,e,i,n,r,o){t=a(t,e,i,n,r,o),(!0===i.transparent?h:l).unshift(t)},sort:function(){1<l.length&&l.sort(ne),1<h.length&&h.sort(re)}}}function ae(){function r(t){(t=t.target).removeEventListener("dispose",r),delete o[t.id]}var o={};return{get:function(t,e){var i,n=o[t.id];return void 0===n?(i=new oe,o[t.id]={},o[t.id][e.id]=i,t.addEventListener("dispose",r)):void 0===(i=n[e.id])&&(i=new oe,n[e.id]=i),i},dispose:function(){o={}}}}function se(){var i={};return{get:function(t){if(void 0!==i[t.id])return i[t.id];switch(t.type){case"DirectionalLight":var e={direction:new Et,color:new p,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new wt};break;case"SpotLight":e={position:new Et,direction:new Et,color:new p,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new wt};break;case"PointLight":e={position:new Et,color:new p,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new wt,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":e={direction:new Et,skyColor:new p,groundColor:new p};break;case"RectAreaLight":e={color:new p,position:new Et,halfWidth:new Et,halfHeight:new Et}}return i[t.id]=e}}}function ce(){for(var b=new se,x={id:sc++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},t=0;t<9;t++)x.probe.push(new Et);var w=new Et,E=new At,M=new At;return{setup:function(t,e,i){for(var n=0,r=0,o=0,a=0;a<9;a++)x.probe[a].set(0,0,0);var s=0,c=0,l=0,h=0,u=0;i=i.matrixWorldInverse,a=0;for(var d=t.length;a<d;a++){var p,f=t[a],m=f.color,g=f.intensity,v=f.distance,y=f.shadow&&f.shadow.map?f.shadow.map.texture:null;if(f.isAmbientLight)n+=m.r*g,r+=m.g*g,o+=m.b*g;else if(f.isLightProbe)for(y=0;y<9;y++)x.probe[y].addScaledVector(f.sh.coefficients[y],g);else{f.isDirectionalLight?((p=b.get(f)).color.copy(f.color).multiplyScalar(f.intensity),p.direction.setFromMatrixPosition(f.matrixWorld),w.setFromMatrixPosition(f.target.matrixWorld),p.direction.sub(w),p.direction.transformDirection(i),(p.shadow=f.castShadow)&&(g=f.shadow,p.shadowBias=g.bias,p.shadowRadius=g.radius,p.shadowMapSize=g.mapSize),x.directionalShadowMap[s]=y,x.directionalShadowMatrix[s]=f.shadow.matrix,x.directional[s]=p,s++):f.isSpotLight?((p=b.get(f)).position.setFromMatrixPosition(f.matrixWorld),p.position.applyMatrix4(i),p.color.copy(m).multiplyScalar(g),p.distance=v,p.direction.setFromMatrixPosition(f.matrixWorld),w.setFromMatrixPosition(f.target.matrixWorld),p.direction.sub(w),p.direction.transformDirection(i),p.coneCos=Math.cos(f.angle),p.penumbraCos=Math.cos(f.angle*(1-f.penumbra)),p.decay=f.decay,(p.shadow=f.castShadow)&&(g=f.shadow,p.shadowBias=g.bias,p.shadowRadius=g.radius,p.shadowMapSize=g.mapSize),x.spotShadowMap[l]=y,x.spotShadowMatrix[l]=f.shadow.matrix,x.spot[l]=p,l++):f.isRectAreaLight?((p=b.get(f)).color.copy(m).multiplyScalar(g),p.position.setFromMatrixPosition(f.matrixWorld),p.position.applyMatrix4(i),M.identity(),E.copy(f.matrixWorld),E.premultiply(i),M.extractRotation(E),p.halfWidth.set(.5*f.width,0,0),p.halfHeight.set(0,.5*f.height,0),p.halfWidth.applyMatrix4(M),p.halfHeight.applyMatrix4(M),x.rectArea[h]=p,h++):f.isPointLight?((p=b.get(f)).position.setFromMatrixPosition(f.matrixWorld),p.position.applyMatrix4(i),p.color.copy(f.color).multiplyScalar(f.intensity),p.distance=f.distance,p.decay=f.decay,(p.shadow=f.castShadow)&&(g=f.shadow,p.shadowBias=g.bias,p.shadowRadius=g.radius,p.shadowMapSize=g.mapSize,p.shadowCameraNear=g.camera.near,p.shadowCameraFar=g.camera.far),x.pointShadowMap[c]=y,x.pointShadowMatrix[c]=f.shadow.matrix,x.point[c]=p,c++):f.isHemisphereLight&&((p=b.get(f)).direction.setFromMatrixPosition(f.matrixWorld),p.direction.transformDirection(i),p.direction.normalize(),p.skyColor.copy(f.color).multiplyScalar(g),p.groundColor.copy(f.groundColor).multiplyScalar(g),x.hemi[u]=p,u++)}}x.ambient[0]=n,x.ambient[1]=r,x.ambient[2]=o,x.directional.length=s,x.spot.length=l,x.rectArea.length=h,x.point.length=c,x.hemi.length=u,x.hash.stateID=x.id,x.hash.directionalLength=s,x.hash.pointLength=c,x.hash.spotLength=l,x.hash.rectAreaLength=h,x.hash.hemiLength=u,x.hash.shadowsLength=e.length},state:x}}function le(){var e=new ce,i=[],n=[];return{init:function(){i.length=0,n.length=0},state:{lightsArray:i,shadowsArray:n,lights:e},setupLights:function(t){e.setup(i,n,t)},pushLight:function(t){i.push(t)},pushShadow:function(t){n.push(t)}}}function he(){function n(t){(t=t.target).removeEventListener("dispose",n),delete r[t.id]}var r={};return{get:function(t,e){var i;return void 0===r[t.id]?(i=new le,r[t.id]={},r[t.id][e.id]=i,t.addEventListener("dispose",n)):void 0===r[t.id][e.id]?(i=new le,r[t.id][e.id]=i):i=r[t.id][e.id],i},dispose:function(){r={}}}}function ue(t){k.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.lights=this.fog=!1,this.setValues(t)}function de(t){k.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Et,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.lights=this.fog=!1,this.setValues(t)}function pe(m,g,t){function v(t,e,i,n,r,o){var a=t.geometry,s=l,c=t.customDepthMaterial;return i&&(s=h,c=t.customDistanceMaterial),s=c||(c=!1,e.morphTargets&&(a&&a.isBufferGeometry?c=a.morphAttributes&&a.morphAttributes.position&&0<a.morphAttributes.position.length:a&&a.isGeometry&&(c=a.morphTargets&&0<a.morphTargets.length)),t.isSkinnedMesh&&!1===e.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t),a=0,c&&(a|=1),(t=t.isSkinnedMesh&&e.skinning)&&(a|=2),s[a]),m.localClippingEnabled&&!0===e.clipShadows&&0!==e.clippingPlanes.length&&(a=s.uuid,c=e.uuid,void 0===(t=u[a])&&(t={},u[a]=t),void 0===(a=t[c])&&(a=s.clone(),t[c]=a),s=a),s.visible=e.visible,s.wireframe=e.wireframe,s.side=null!=e.shadowSide?e.shadowSide:d[e.side],s.clipShadows=e.clipShadows,s.clippingPlanes=e.clippingPlanes,s.clipIntersection=e.clipIntersection,s.wireframeLinewidth=e.wireframeLinewidth,s.linewidth=e.linewidth,i&&s.isMeshDistanceMaterial&&(s.referencePosition.copy(n),s.nearDistance=r,s.farDistance=o),s}var y=new St,b=new At,x=new wt,w=new wt(t,t),E=new Et,M=new Et,l=Array(4),h=Array(4),u={},d={0:1,1:0,2:2},_=[new Et(1,0,0),new Et(-1,0,0),new Et(0,0,1),new Et(0,0,-1),new Et(0,1,0),new Et(0,-1,0)],S=[new Et(0,1,0),new Et(0,1,0),new Et(0,1,0),new Et(0,1,0),new Et(0,0,1),new Et(0,0,-1)],A=[new Mt,new Mt,new Mt,new Mt,new Mt,new Mt];for(t=0;4!==t;++t){var e=0!=(1&t),i=0!=(2&t),n=new ue({depthPacking:3201,morphTargets:e,skinning:i});l[t]=n,e=new de({morphTargets:e,skinning:i}),h[t]=e}var T=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,e,i){if(!1!==T.enabled&&(!1!==T.autoUpdate||!1!==T.needsUpdate)&&0!==t.length){var n=m.getRenderTarget(),r=m.getActiveCubeFace(),o=m.getActiveMipMapLevel(),a=m.state;a.setBlending(0),a.buffers.color.setClear(1,1,1,1),a.buffers.depth.setTest(!0),a.setScissorTest(!1);for(var s=0,c=t.length;s<c;s++){var l=t[s],h=l.shadow,u=l&&l.isPointLight;if(void 0===h)console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");else{var d,p,f=h.camera;for(x.copy(h.mapSize),x.min(w),u&&(d=x.x,p=x.y,A[0].set(2*d,p,d,p),A[1].set(0,p,d,p),A[2].set(3*d,p,d,p),A[3].set(d,p,d,p),A[4].set(3*d,0,d,p),A[5].set(d,0,d,p),x.x*=4,x.y*=2),null===h.map&&(h.map=new C(x.x,x.y,{minFilter:1003,magFilter:1003,format:1023}),h.map.texture.name=l.name+".shadowMap",f.updateProjectionMatrix()),h.isSpotLightShadow&&h.update(l),d=h.map,p=h.matrix,M.setFromMatrixPosition(l.matrixWorld),f.position.copy(M),u?(h=6,p.makeTranslation(-M.x,-M.y,-M.z)):(h=1,E.setFromMatrixPosition(l.target.matrixWorld),f.lookAt(E),f.updateMatrixWorld(),p.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),p.multiply(f.projectionMatrix),p.multiply(f.matrixWorldInverse)),m.setRenderTarget(d),m.clear(),l=0;l<h;l++)u&&(E.copy(f.position),E.add(_[l]),f.up.copy(S[l]),f.lookAt(E),f.updateMatrixWorld(),a.viewport(A[l])),b.multiplyMatrices(f.projectionMatrix,f.matrixWorldInverse),y.setFromMatrix(b),function t(e,i,n,r){if(!1!==e.visible){if(e.layers.test(i.layers)&&(e.isMesh||e.isLine||e.isPoints)&&e.castShadow&&(!e.frustumCulled||y.intersectsObject(e))){e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld);var o=g.update(e),a=e.material;if(Array.isArray(a))for(var s=o.groups,c=0,l=s.length;c<l;c++){var h=s[c],u=a[h.materialIndex];u&&u.visible&&(u=v(e,u,r,M,n.near,n.far),m.renderBufferDirect(n,null,o,u,e,h))}else a.visible&&(u=v(e,a,r,M,n.near,n.far),m.renderBufferDirect(n,null,o,u,e,null))}for(o=0,a=(e=e.children).length;o<a;o++)t(e[o],i,n,r)}}(e,i,f,u)}}T.needsUpdate=!1,m.setRenderTarget(n,r,o)}}}function fe(h,i,c,n){function t(t,e,i){var n=new Uint8Array(4),r=h.createTexture();for(h.bindTexture(t,r),h.texParameteri(t,10241,9728),h.texParameteri(t,10240,9728),t=0;t<i;t++)h.texImage2D(e+t,0,6408,1,1,0,6408,5121,n);return r}function e(t,e){v[t]=1,0===y[t]&&(h.enableVertexAttribArray(t),y[t]=1),b[t]!==e&&((n.isWebGL2?h:i.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](t,e),b[t]=e)}function u(t){!0!==x[t]&&(h.enable(t),x[t]=!0)}function d(t){!1!==x[t]&&(h.disable(t),x[t]=!1)}function r(t,e,i,n,r,o,a,s){if(0===t)M&&(d(3042),M=!1);else if(M||(u(3042),M=!0),5!==t){if(t!==_||s!==R){if(100===S&&100===C||(h.blendEquation(32774),C=S=100),s)switch(t){case 1:h.blendFuncSeparate(1,771,1,771);break;case 2:h.blendFunc(1,1);break;case 3:h.blendFuncSeparate(0,0,769,771);break;case 4:h.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:h.blendFuncSeparate(770,771,1,771);break;case 2:h.blendFunc(770,1);break;case 3:h.blendFunc(0,769);break;case 4:h.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}P=L=T=A=null,_=t,R=s}}else r=r||e,o=o||i,a=a||n,e===S&&r===C||(h.blendEquationSeparate(c.convert(e),c.convert(r)),S=e,C=r),i===A&&n===T&&o===L&&a===P||(h.blendFuncSeparate(c.convert(i),c.convert(n),c.convert(o),c.convert(a)),A=i,T=n,L=o,P=a),_=t,R=null}function o(t){I!==t&&(t?h.frontFace(2304):h.frontFace(2305),I=t)}function a(t){0!==t?(u(2884),t!==O&&(1===t?h.cullFace(1029):2===t?h.cullFace(1028):h.cullFace(1032))):d(2884),O=t}function s(t,e,i){t?(u(32823),k===e&&N===i||(h.polygonOffset(e,i),k=e,N=i)):d(32823)}function l(t){void 0===t&&(t=33984+z-1),F!==t&&(h.activeTexture(t),F=t)}var p=new function(){var e=!1,o=new Mt,i=null,a=new Mt(0,0,0,0);return{setMask:function(t){i===t||e||(h.colorMask(t,t,t,t),i=t)},setLocked:function(t){e=t},setClear:function(t,e,i,n,r){!0===r&&(t*=n,e*=n,i*=n),o.set(t,e,i,n),!1===a.equals(o)&&(h.clearColor(t,e,i,n),a.copy(o))},reset:function(){e=!1,i=null,a.set(-1,0,0,0)}}},f=new function(){var e=!1,i=null,n=null,r=null;return{setTest:function(t){(t?u:d)(2929)},setMask:function(t){i===t||e||(h.depthMask(t),i=t)},setFunc:function(t){if(n!==t){if(t)switch(t){case 0:h.depthFunc(512);break;case 1:h.depthFunc(519);break;case 2:h.depthFunc(513);break;case 3:h.depthFunc(515);break;case 4:h.depthFunc(514);break;case 5:h.depthFunc(518);break;case 6:h.depthFunc(516);break;case 7:h.depthFunc(517);break;default:h.depthFunc(515)}else h.depthFunc(515);n=t}},setLocked:function(t){e=t},setClear:function(t){r!==t&&(h.clearDepth(t),r=t)},reset:function(){e=!1,r=n=i=null}}},m=new function(){var e=!1,i=null,n=null,r=null,o=null,a=null,s=null,c=null,l=null;return{setTest:function(t){(t?u:d)(2960)},setMask:function(t){i===t||e||(h.stencilMask(t),i=t)},setFunc:function(t,e,i){n===t&&r===e&&o===i||(h.stencilFunc(t,e,i),n=t,r=e,o=i)},setOp:function(t,e,i){a===t&&s===e&&c===i||(h.stencilOp(t,e,i),a=t,s=e,c=i)},setLocked:function(t){e=t},setClear:function(t){l!==t&&(h.clearStencil(t),l=t)},reset:function(){e=!1,l=c=s=a=o=r=n=i=null}}},g=h.getParameter(34921),v=new Uint8Array(g),y=new Uint8Array(g),b=new Uint8Array(g),x={},w=null,E=null,M=null,_=null,S=null,A=null,T=null,C=null,L=null,P=null,R=!1,I=null,O=null,D=null,k=null,N=null,z=h.getParameter(35661),B=!1,g=0;-1!==(g=h.getParameter(7938)).indexOf("WebGL")?(g=parseFloat(/^WebGL ([0-9])/.exec(g)[1]),B=1<=g):-1!==g.indexOf("OpenGL ES")&&(g=parseFloat(/^OpenGL ES ([0-9])/.exec(g)[1]),B=2<=g);var F=null,U={},j=new Mt,H=new Mt,G={};return G[3553]=t(3553,3553,1),G[34067]=t(34067,34069,6),p.setClear(0,0,0,1),f.setClear(1),m.setClear(0),u(2929),f.setFunc(3),o(!1),a(1),u(2884),r(0),{buffers:{color:p,depth:f,stencil:m},initAttributes:function(){for(var t=0,e=v.length;t<e;t++)v[t]=0},enableAttribute:function(t){e(t,0)},enableAttributeAndDivisor:e,disableUnusedAttributes:function(){for(var t=0,e=y.length;t!==e;++t)y[t]!==v[t]&&(h.disableVertexAttribArray(t),y[t]=0)},enable:u,disable:d,getCompressedTextureFormats:function(){if(null===w&&(w=[],i.get("WEBGL_compressed_texture_pvrtc")||i.get("WEBGL_compressed_texture_s3tc")||i.get("WEBGL_compressed_texture_etc1")||i.get("WEBGL_compressed_texture_astc")))for(var t=h.getParameter(34467),e=0;e<t.length;e++)w.push(t[e]);return w},useProgram:function(t){return E!==t&&(h.useProgram(t),E=t,!0)},setBlending:r,setMaterial:function(t,e){(2===t.side?d:u)(2884);var i=1===t.side;e&&(i=!i),o(i),1===t.blending&&!1===t.transparent?r(0):r(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),f.setFunc(t.depthFunc),f.setTest(t.depthTest),f.setMask(t.depthWrite),p.setMask(t.colorWrite),s(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:o,setCullFace:a,setLineWidth:function(t){t!==D&&(B&&h.lineWidth(t),D=t)},setPolygonOffset:s,setScissorTest:function(t){(t?u:d)(3089)},activeTexture:l,bindTexture:function(t,e){null===F&&l();var i=U[F];void 0===i&&(i={type:void 0,texture:void 0},U[F]=i),i.type===t&&i.texture===e||(h.bindTexture(t,e||G[t]),i.type=t,i.texture=e)},compressedTexImage2D:function(){try{h.compressedTexImage2D.apply(h,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{h.texImage2D.apply(h,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{h.texImage3D.apply(h,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===j.equals(t)&&(h.scissor(t.x,t.y,t.z,t.w),j.copy(t))},viewport:function(t){!1===H.equals(t)&&(h.viewport(t.x,t.y,t.z,t.w),H.copy(t))},reset:function(){for(var t=0;t<y.length;t++)1===y[t]&&(h.disableVertexAttribArray(t),y[t]=0);x={},F=w=null,U={},O=I=_=E=null,p.reset(),f.reset(),m.reset()}}}function me(m,n,g,v,y,b,s){function o(t,e){return L?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function x(t,e,i,n){var r=1;if((t.width>n||t.height>n)&&(r=n/Math.max(t.width,t.height)),r<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap)return e=(n=e?uo.floorPowerOfTwo:Math.floor)(r*t.width),r=n(r*t.height),void 0===T&&(T=o(e,r)),(i=i?o(e,r):T).width=e,i.height=r,i.getContext("2d").drawImage(t,0,0,e,r),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+e+"x"+r+")."),i;"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+").")}return t}function w(t){return uo.isPowerOfTwo(t.width)&&uo.isPowerOfTwo(t.height)}function E(t,e){return t.generateMipmaps&&e&&1003!==t.minFilter&&1006!==t.minFilter}function M(t,e,i,n){m.generateMipmap(t),v.get(e).__maxMipLevel=Math.log(Math.max(i,n))*Math.LOG2E}function _(t,e){if(!y.isWebGL2)return t;var i=t;return 6403===t&&(5126===e&&(i=33326),5131===e&&(i=33325),5121===e&&(i=33321)),6407===t&&(5126===e&&(i=34837),5131===e&&(i=34843),5121===e&&(i=32849)),6408===t&&(5126===e&&(i=34836),5131===e&&(i=34842),5121===e&&(i=32856)),33325===i||33326===i||34842===i||34836===i?n.get("EXT_color_buffer_float"):34843!==i&&34837!==i||console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),i}function r(t){return 1003===t||1004===t||1005===t?9728:9729}function i(t){(t=t.target).removeEventListener("dispose",i);var e=v.get(t);void 0!==e.__webglInit&&(m.deleteTexture(e.__webglTexture),v.remove(t)),t.isVideoTexture&&delete C[t.id],s.memory.textures--}function c(t){(t=t.target).removeEventListener("dispose",c);var e=v.get(t),i=v.get(t.texture);if(t){if(void 0!==i.__webglTexture&&m.deleteTexture(i.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLRenderTargetCube)for(i=0;i<6;i++)m.deleteFramebuffer(e.__webglFramebuffer[i]),e.__webglDepthbuffer&&m.deleteRenderbuffer(e.__webglDepthbuffer[i]);else m.deleteFramebuffer(e.__webglFramebuffer),e.__webglDepthbuffer&&m.deleteRenderbuffer(e.__webglDepthbuffer);v.remove(t.texture),v.remove(t)}s.memory.textures--}function l(t,e){var i,n,r=v.get(t);if(t.isVideoTexture&&(i=t.id,n=s.render.frame,C[i]!==n&&(C[i]=n,t.update())),0<t.version&&r.__version!==t.version)if(void 0===(i=t.image))console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==i.complete)return void u(r,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}g.activeTexture(33984+e),g.bindTexture(3553,r.__webglTexture)}function a(t,e){var i=v.get(t);if(6===t.image.length)if(0<t.version&&i.__version!==t.version){A(i,t),g.activeTexture(33984+e),g.bindTexture(34067,i.__webglTexture),m.pixelStorei(37440,t.flipY),e=t&&t.isCompressedTexture;for(var n=t.image[0]&&t.image[0].isDataTexture,r=[],o=0;o<6;o++)r[o]=e||n?n?t.image[o].image:t.image[o]:x(t.image[o],!1,!0,y.maxCubemapSize);var a=r[0],s=w(a)||y.isWebGL2,c=b.convert(t.format),l=b.convert(t.type),h=_(c,l);for(S(34067,t,s),o=0;o<6;o++)if(e)for(var u,d=r[o].mipmaps,p=0,f=d.length;p<f;p++)u=d[p],1023!==t.format&&1022!==t.format?-1<g.getCompressedTextureFormats().indexOf(c)?g.compressedTexImage2D(34069+o,p,h,u.width,u.height,0,u.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):g.texImage2D(34069+o,p,h,u.width,u.height,0,c,l,u.data);else n?g.texImage2D(34069+o,0,h,r[o].width,r[o].height,0,c,l,r[o].data):g.texImage2D(34069+o,0,h,c,l,r[o]);i.__maxMipLevel=e?d.length-1:0,E(t,s)&&M(34067,t,a.width,a.height),i.__version=t.version,t.onUpdate&&t.onUpdate(t)}else g.activeTexture(33984+e),g.bindTexture(34067,i.__webglTexture)}function h(t,e){g.activeTexture(33984+e),g.bindTexture(34067,v.get(t).__webglTexture)}function S(t,e,i){i?(m.texParameteri(t,10242,b.convert(e.wrapS)),m.texParameteri(t,10243,b.convert(e.wrapT)),32879!==t&&35866!==t||m.texParameteri(t,32882,b.convert(e.wrapR)),m.texParameteri(t,10240,b.convert(e.magFilter)),m.texParameteri(t,10241,b.convert(e.minFilter))):(m.texParameteri(t,10242,33071),m.texParameteri(t,10243,33071),32879!==t&&35866!==t||m.texParameteri(t,32882,33071),1001===e.wrapS&&1001===e.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),m.texParameteri(t,10240,r(e.magFilter)),m.texParameteri(t,10241,r(e.minFilter)),1003!==e.minFilter&&1006!==e.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!(i=n.get("EXT_texture_filter_anisotropic"))||1015===e.type&&null===n.get("OES_texture_float_linear")||1016===e.type&&null===(y.isWebGL2||n.get("OES_texture_half_float_linear"))||!(1<e.anisotropy||v.get(e).__currentAnisotropy)||(m.texParameterf(t,i.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.anisotropy,y.getMaxAnisotropy())),v.get(e).__currentAnisotropy=e.anisotropy)}function A(t,e){void 0===t.__webglInit&&(t.__webglInit=!0,e.addEventListener("dispose",i),t.__webglTexture=m.createTexture(),s.memory.textures++)}function u(t,e,i){var n=3553;e.isDataTexture2DArray&&(n=35866),e.isDataTexture3D&&(n=32879),A(t,e),g.activeTexture(33984+i),g.bindTexture(n,t.__webglTexture),m.pixelStorei(37440,e.flipY),m.pixelStorei(37441,e.premultiplyAlpha),m.pixelStorei(3317,e.unpackAlignment),i=(i=!y.isWebGL2&&(1001!==e.wrapS||1001!==e.wrapT||1003!==e.minFilter&&1006!==e.minFilter))&&!1===w(e.image);var r=w(i=x(e.image,i,!1,y.maxTextureSize))||y.isWebGL2,o=b.convert(e.format),a=b.convert(e.type),s=_(o,a);S(n,e,r);var c=e.mipmaps;if(e.isDepthTexture){if(s=6402,1015===e.type){if(!y.isWebGL2)throw Error("Float Depth Texture only supported in WebGL2.0");s=36012}else y.isWebGL2&&(s=33189);1026===e.format&&6402===s&&1012!==e.type&&1014!==e.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),e.type=1012,a=b.convert(e.type)),1027===e.format&&(s=34041,1020!==e.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),e.type=1020,a=b.convert(e.type))),g.texImage2D(3553,0,s,i.width,i.height,0,o,a,null)}else if(e.isDataTexture)if(0<c.length&&r){for(var l=0,h=c.length;l<h;l++)n=c[l],g.texImage2D(3553,l,s,n.width,n.height,0,o,a,n.data);e.generateMipmaps=!1,t.__maxMipLevel=c.length-1}else g.texImage2D(3553,0,s,i.width,i.height,0,o,a,i.data),t.__maxMipLevel=0;else if(e.isCompressedTexture){for(l=0,h=c.length;l<h;l++)n=c[l],1023!==e.format&&1022!==e.format?-1<g.getCompressedTextureFormats().indexOf(o)?g.compressedTexImage2D(3553,l,s,n.width,n.height,0,n.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):g.texImage2D(3553,l,s,n.width,n.height,0,o,a,n.data);t.__maxMipLevel=c.length-1}else if(e.isDataTexture2DArray)g.texImage3D(35866,0,s,i.width,i.height,i.depth,0,o,a,i.data),t.__maxMipLevel=0;else if(e.isDataTexture3D)g.texImage3D(32879,0,s,i.width,i.height,i.depth,0,o,a,i.data),t.__maxMipLevel=0;else if(0<c.length&&r){for(l=0,h=c.length;l<h;l++)n=c[l],g.texImage2D(3553,l,s,o,a,n);e.generateMipmaps=!1,t.__maxMipLevel=c.length-1}else g.texImage2D(3553,0,s,o,a,i),t.__maxMipLevel=0;E(e,r)&&M(3553,e,i.width,i.height),t.__version=e.version,e.onUpdate&&e.onUpdate(e)}function d(t,e,i,n){var r=b.convert(e.texture.format),o=b.convert(e.texture.type),a=_(r,o);g.texImage2D(n,0,a,e.width,e.height,0,r,o,null),m.bindFramebuffer(36160,t),m.framebufferTexture2D(36160,i,n,v.get(e.texture).__webglTexture,0),m.bindFramebuffer(36160,null)}function p(t,e,i){m.bindRenderbuffer(36161,t),e.depthBuffer&&!e.stencilBuffer?(i?(i=f(e),m.renderbufferStorageMultisample(36161,i,33189,e.width,e.height)):m.renderbufferStorage(36161,33189,e.width,e.height),m.framebufferRenderbuffer(36160,36096,36161,t)):e.depthBuffer&&e.stencilBuffer?(i?(i=f(e),m.renderbufferStorageMultisample(36161,i,34041,e.width,e.height)):m.renderbufferStorage(36161,34041,e.width,e.height),m.framebufferRenderbuffer(36160,33306,36161,t)):(t=_(t=b.convert(e.texture.format),b.convert(e.texture.type)),i?(i=f(e),m.renderbufferStorageMultisample(36161,i,t,e.width,e.height)):m.renderbufferStorage(36161,t,e.width,e.height)),m.bindRenderbuffer(36161,null)}function f(t){return y.isWebGL2&&t.isWebGLMultisampleRenderTarget?Math.min(y.maxSamples,t.samples):0}var T,C={},L="undefined"!=typeof OffscreenCanvas,e=0,P=!1,R=!1;this.allocateTextureUnit=function(){var t=e;return t>=y.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+y.maxTextures),e+=1,t},this.resetTextureUnits=function(){e=0},this.setTexture2D=l,this.setTexture2DArray=function(t,e){var i=v.get(t);0<t.version&&i.__version!==t.version?u(i,t,e):(g.activeTexture(33984+e),g.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(t,e){var i=v.get(t);0<t.version&&i.__version!==t.version?u(i,t,e):(g.activeTexture(33984+e),g.bindTexture(32879,i.__webglTexture))},this.setTextureCube=a,this.setTextureCubeDynamic=h,this.setupRenderTarget=function(t){var e=v.get(t),i=v.get(t.texture);t.addEventListener("dispose",c),i.__webglTexture=m.createTexture(),s.memory.textures++;var n,r=!0===t.isWebGLRenderTargetCube,o=!0===t.isWebGLMultisampleRenderTarget,a=w(t)||y.isWebGL2;if(r)for(e.__webglFramebuffer=[],o=0;o<6;o++)e.__webglFramebuffer[o]=m.createFramebuffer();else e.__webglFramebuffer=m.createFramebuffer(),o&&(y.isWebGL2?(e.__webglMultisampledFramebuffer=m.createFramebuffer(),e.__webglColorRenderbuffer=m.createRenderbuffer(),m.bindRenderbuffer(36161,e.__webglColorRenderbuffer),o=_(o=b.convert(t.texture.format),n=b.convert(t.texture.type)),n=f(t),m.renderbufferStorageMultisample(36161,n,o,t.width,t.height),m.bindFramebuffer(36160,e.__webglMultisampledFramebuffer),m.framebufferRenderbuffer(36160,36064,36161,e.__webglColorRenderbuffer),m.bindRenderbuffer(36161,null),t.depthBuffer&&(e.__webglDepthRenderbuffer=m.createRenderbuffer(),p(e.__webglDepthRenderbuffer,t,!0)),m.bindFramebuffer(36160,null)):console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2."));if(r){for(g.bindTexture(34067,i.__webglTexture),S(34067,t.texture,a),o=0;o<6;o++)d(e.__webglFramebuffer[o],t,36064,34069+o);E(t.texture,a)&&M(34067,t.texture,t.width,t.height),g.bindTexture(34067,null)}else g.bindTexture(3553,i.__webglTexture),S(3553,t.texture,a),d(e.__webglFramebuffer,t,36064,3553),E(t.texture,a)&&M(3553,t.texture,t.width,t.height),g.bindTexture(3553,null);if(t.depthBuffer){if(e=v.get(t),i=!0===t.isWebGLRenderTargetCube,t.depthTexture){if(i)throw Error("target.depthTexture not supported in Cube render targets");if(t&&t.isWebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported");if(m.bindFramebuffer(36160,e.__webglFramebuffer),!t.depthTexture||!t.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(v.get(t.depthTexture).__webglTexture&&t.depthTexture.image.width===t.width&&t.depthTexture.image.height===t.height||(t.depthTexture.image.width=t.width,t.depthTexture.image.height=t.height,t.depthTexture.needsUpdate=!0),l(t.depthTexture,0),e=v.get(t.depthTexture).__webglTexture,1026===t.depthTexture.format)m.framebufferTexture2D(36160,36096,3553,e,0);else{if(1027!==t.depthTexture.format)throw Error("Unknown depthTexture format");m.framebufferTexture2D(36160,33306,3553,e,0)}}else if(i)for(e.__webglDepthbuffer=[],i=0;i<6;i++)m.bindFramebuffer(36160,e.__webglFramebuffer[i]),e.__webglDepthbuffer[i]=m.createRenderbuffer(),p(e.__webglDepthbuffer[i],t);else m.bindFramebuffer(36160,e.__webglFramebuffer),e.__webglDepthbuffer=m.createRenderbuffer(),p(e.__webglDepthbuffer,t);m.bindFramebuffer(36160,null)}},this.updateRenderTargetMipmap=function(t){var e,i=t.texture,n=w(t)||y.isWebGL2;E(i,n)&&(n=t.isWebGLRenderTargetCube?34067:3553,e=v.get(i).__webglTexture,g.bindTexture(n,e),M(n,i,t.width,t.height),g.bindTexture(n,null))},this.updateMultisampleRenderTarget=function(t){var e,i,n;t.isWebGLMultisampleRenderTarget&&(y.isWebGL2?(e=v.get(t),m.bindFramebuffer(36008,e.__webglMultisampledFramebuffer),m.bindFramebuffer(36009,e.__webglFramebuffer),e=t.width,i=t.height,n=16384,t.depthBuffer&&(n|=256),t.stencilBuffer&&(n|=1024),m.blitFramebuffer(0,0,e,i,0,0,e,i,n,9728)):console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2."))},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===P&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),P=!0),t=t.texture),l(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLRenderTargetCube&&(!1===R&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),R=!0),t=t.texture),(t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?a:h)(t,e)}}function ge(t,i,n){return{convert:function(t){if(1e3===t)return 10497;if(1001===t)return 33071;if(1002===t)return 33648;if(1003===t)return 9728;if(1004===t)return 9984;if(1005===t)return 9986;if(1006===t)return 9729;if(1007===t)return 9985;if(1008===t)return 9987;if(1009===t)return 5121;if(1017===t)return 32819;if(1018===t)return 32820;if(1019===t)return 33635;if(1010===t)return 5120;if(1011===t)return 5122;if(1012===t)return 5123;if(1013===t)return 5124;if(1014===t)return 5125;if(1015===t)return 5126;if(1016===t){if(n.isWebGL2)return 5131;var e=i.get("OES_texture_half_float");if(null!==e)return e.HALF_FLOAT_OES}if(1021===t)return 6406;if(1022===t)return 6407;if(1023===t)return 6408;if(1024===t)return 6409;if(1025===t)return 6410;if(1026===t)return 6402;if(1027===t)return 34041;if(1028===t)return 6403;if(100===t)return 32774;if(101===t)return 32778;if(102===t)return 32779;if(200===t)return 0;if(201===t)return 1;if(202===t)return 768;if(203===t)return 769;if(204===t)return 770;if(205===t)return 771;if(206===t)return 772;if(207===t)return 773;if(208===t)return 774;if(209===t)return 775;if(210===t)return 776;if((33776===t||33777===t||33778===t||33779===t)&&null!==(e=i.get("WEBGL_compressed_texture_s3tc"))){if(33776===t)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===t)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===t)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===t)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((35840===t||35841===t||35842===t||35843===t)&&null!==(e=i.get("WEBGL_compressed_texture_pvrtc"))){if(35840===t)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===t)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===t)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===t)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===t&&null!==(e=i.get("WEBGL_compressed_texture_etc1")))return e.COMPRESSED_RGB_ETC1_WEBGL;if((37808===t||37809===t||37810===t||37811===t||37812===t||37813===t||37814===t||37815===t||37816===t||37817===t||37818===t||37819===t||37820===t||37821===t)&&null!==(e=i.get("WEBGL_compressed_texture_astc")))return t;if(103===t||104===t){if(n.isWebGL2){if(103===t)return 32775;if(104===t)return 32776}if(null!==(e=i.get("EXT_blend_minmax"))){if(103===t)return e.MIN_EXT;if(104===t)return e.MAX_EXT}}if(1020===t){if(n.isWebGL2)return 34042;if(null!==(e=i.get("WEBGL_depth_texture")))return e.UNSIGNED_INT_24_8_WEBGL}return 0}}}function ve(){u.call(this),this.type="Group"}function ye(){u.call(this),this.type="Camera",this.matrixWorldInverse=new At,this.projectionMatrix=new At,this.projectionMatrixInverse=new At}function be(t,e,i,n){ye.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function xe(t){be.call(this),this.cameras=t||[]}function we(t,e,i){Nc.setFromMatrixPosition(e.matrixWorld),zc.setFromMatrixPosition(i.matrixWorld);var n=Nc.distanceTo(zc),r=e.projectionMatrix.elements,o=i.projectionMatrix.elements,a=r[14]/(r[10]-1);i=r[14]/(r[10]+1);var s=(r[9]+1)/r[5],c=(r[9]-1)/r[5],l=(r[8]-1)/r[0],h=(o[8]+1)/o[0],r=a*l,o=a*h,l=(h=n/(h-l))*-l;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(l),t.translateZ(h),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.getInverse(t.matrixWorld),e=a+h,a=i+h,t.projectionMatrix.makePerspective(r-l,n-l+o,s*i/a*e,c*i/a*e,e,a)}function Ee(e){function c(){return null!==h&&!0===h.isPresenting}function t(){var t;c()?(t=h.getEyeParameters("left"),i=2*t.renderWidth*o,n=t.renderHeight*o,a=e.getPixelRatio(),e.getSize(s),e.setDrawingBufferSize(i,n,1),x.viewport.set(0,0,i/2,n),w.viewport.set(i/2,0,i/2,n),_.start()):(r.enabled&&e.setDrawingBufferSize(s.width,s.height,a),_.stop())}function l(t,e){null!==e&&4===e.length&&t.set(e[0]*i,e[1]*n,e[2]*i,e[3]*n)}var i,n,r=this,h=null,u=null,d=null,p=[],f=new At,m=new At,o=1,g="local-floor";"undefined"!=typeof window&&"VRFrameData"in window&&(u=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",t,!1));var v=new At,y=new S,b=new Et,x=new be;x.viewport=new Mt,x.layers.enable(1);var w=new be;w.viewport=new Mt,w.layers.enable(2);var E=new xe([x,w]);E.layers.enable(1),E.layers.enable(2);var a,s=new wt,M=[];this.enabled=!1,this.getController=function(t){var e=p[t];return void 0===e&&((e=new ve).matrixAutoUpdate=!1,e.visible=!1,p[t]=e),e},this.getDevice=function(){return h},this.setDevice=function(t){void 0!==t&&(h=t),_.setContext(t)},this.setFramebufferScaleFactor=function(t){o=t},this.setReferenceSpaceType=function(t){g=t},this.setPoseTarget=function(t){void 0!==t&&(d=t)},this.getCamera=function(t){var e,i="local-floor"===g?1.6:0;if(!1===c())return t.position.set(0,i,0),t.rotation.set(0,0,0),t;h.depthNear=t.near,h.depthFar=t.far,h.getFrameData(u),"local-floor"===g&&((e=h.stageParameters)?f.fromArray(e.sittingToStandingTransform):f.makeTranslation(0,i,0)),i=u.pose,(e=null!==d?d:t).matrix.copy(f),e.matrix.decompose(e.position,e.quaternion,e.scale),null!==i.orientation&&(y.fromArray(i.orientation),e.quaternion.multiply(y)),null!==i.position&&(y.setFromRotationMatrix(f),b.fromArray(i.position),b.applyQuaternion(y),e.position.add(b)),e.updateMatrixWorld(),x.near=t.near,w.near=t.near,x.far=t.far,w.far=t.far,x.matrixWorldInverse.fromArray(u.leftViewMatrix),w.matrixWorldInverse.fromArray(u.rightViewMatrix),m.getInverse(f),"local-floor"===g&&(x.matrixWorldInverse.multiply(m),w.matrixWorldInverse.multiply(m)),null!==(t=e.parent)&&(v.getInverse(t.matrixWorld),x.matrixWorldInverse.multiply(v),w.matrixWorldInverse.multiply(v)),x.matrixWorld.getInverse(x.matrixWorldInverse),w.matrixWorld.getInverse(w.matrixWorldInverse),x.projectionMatrix.fromArray(u.leftProjectionMatrix),w.projectionMatrix.fromArray(u.rightProjectionMatrix),we(E,x,w),(t=h.getLayers()).length&&(t=t[0],l(x.viewport,t.leftBounds),l(w.viewport,t.rightBounds));t:for(t=0;t<p.length;t++){i=p[t];e:{e=t;for(var n=navigator.getGamepads&&navigator.getGamepads(),r=0,o=0,a=n.length;r<a;r++){var s=n[r];if(s&&("Daydream Controller"===s.id||"Gear VR Controller"===s.id||"Oculus Go Controller"===s.id||"OpenVR Gamepad"===s.id||s.id.startsWith("Oculus Touch")||s.id.startsWith("Spatial Controller"))){if(o===e){e=s;break e}o++}}e=void 0}if(void 0!==e&&void 0!==e.pose){if(null===e.pose)break t;!1===(n=e.pose).hasPosition&&i.position.set(.2,-.6,-.05),null!==n.position&&i.position.fromArray(n.position),null!==n.orientation&&i.quaternion.fromArray(n.orientation),i.matrix.compose(i.position,i.quaternion,i.scale),i.matrix.premultiply(f),i.matrix.decompose(i.position,i.quaternion,i.scale),i.matrixWorldNeedsUpdate=!0,i.visible=!0,n="Daydream Controller"===e.id?0:1,void 0===M[t]&&(M[t]=!1),M[t]!==e.buttons[n].pressed&&(M[t]=e.buttons[n].pressed,!0===M[t]?i.dispatchEvent({type:"selectstart"}):(i.dispatchEvent({type:"selectend"}),i.dispatchEvent({type:"select"})))}else i.visible=!1}return E},this.getStandingMatrix=function(){return f},this.isPresenting=c;var _=new Ct;this.setAnimationLoop=function(t){_.setAnimationLoop(t),c()&&_.start()},this.submitFrame=function(){c()&&h.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",t)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}function Me(c){function r(){return null!==h&&null!==u}function e(t){for(var e=0;e<d.length;e++)p[e]===t.inputSource&&d[e].dispatchEvent({type:t.type})}function i(){c.setFramebuffer(null),c.setRenderTarget(c.getRenderTarget()),y.stop()}function n(t){u=t,y.setContext(h),y.start()}function o(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.getInverse(t.matrixWorld)}var l,a=c.context,h=null,u=null,s="local-floor",d=[],p=[],f=new be;f.layers.enable(1),f.viewport=new Mt;var m=new be;m.layers.enable(2),m.viewport=new Mt;var g=new xe([f,m]);g.layers.enable(1),g.layers.enable(2),this.enabled=!1,this.getController=function(t){var e=d[t];return void 0===e&&((e=new ve).matrixAutoUpdate=!1,e.visible=!1,d[t]=e),e},this.setFramebufferScaleFactor=function(t){},this.setReferenceSpaceType=function(t){s=t},this.getSession=function(){return h},this.setSession=function(t){null!==(h=t)&&(h.addEventListener("select",e),h.addEventListener("selectstart",e),h.addEventListener("selectend",e),h.addEventListener("end",i),h.updateRenderState({baseLayer:new XRWebGLLayer(h,a)}),h.requestReferenceSpace(s).then(n),p=h.inputSources,h.addEventListener("inputsourceschange",function(){p=h.inputSources,console.log(p);for(var t=0;t<d.length;t++)d[t].userData.inputSource=p[t]}))},this.getCamera=function(t){if(r()){var e=t.parent,i=g.cameras;o(g,e);for(var n=0;n<i.length;n++)o(i[n],e);for(t.matrixWorld.copy(g.matrixWorld),n=0,e=(t=t.children).length;n<e;n++)t[n].updateMatrixWorld(!0);return we(g,f,m),g}return t},this.isPresenting=r;var v=null,y=new Ct;y.setAnimationLoop(function(t,e){if(null!==(l=e.getViewerPose(u))){var i=l.views,n=h.renderState.baseLayer;c.setFramebuffer(n.framebuffer);for(var r=0;r<i.length;r++){var o=i[r],a=n.getViewport(o),s=g.cameras[r];s.matrix.fromArray(o.transform.inverse.matrix).getInverse(s.matrix),s.projectionMatrix.fromArray(o.projectionMatrix),s.viewport.set(a.x,a.y,a.width,a.height),0===r&&g.matrix.copy(s.matrix)}}for(r=0;r<d.length;r++)i=d[r],(n=p[r])&&null!==(n=e.getPose(n.targetRaySpace,u))?(i.matrix.fromArray(n.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.visible=!0):i.visible=!1;v&&v(t)}),this.setAnimationLoop=function(t){v=t},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new At},this.getDevice=function(){console.warn("THREE.WebXRManager: getDevice() has been deprecated.")},this.setDevice=function(){console.warn("THREE.WebXRManager: setDevice() has been deprecated.")},this.setFrameOfReferenceType=function(){console.warn("THREE.WebXRManager: setFrameOfReferenceType() has been deprecated.")},this.submitFrame=function(){}}function _e(t){var E;function e(){A=new Dt(gt),(T=new It(gt,A,t)).isWebGL2||(A.get("WEBGL_depth_texture"),A.get("OES_texture_float"),A.get("OES_texture_half_float"),A.get("OES_texture_half_float_linear"),A.get("OES_standard_derivatives"),A.get("OES_element_index_uint"),A.get("ANGLE_instanced_arrays")),A.get("OES_texture_float_linear"),H=new ge(0,A,T),(C=new fe(gt,A,H,T)).scissor(it.copy(ct).multiplyScalar(at)),C.viewport(et.copy(st).multiplyScalar(at)),L=new zt,P=new ie,R=new me(gt,A,C,P,T,H,L),I=new Lt(gt),O=new kt(0,I,L),D=new Ft(O,L),F=new Bt(gt),k=new ee(G,A,T,R),N=new ae,z=new he,B=new Pt(G,C,D,y),U=new Rt(gt,A,L,T),j=new Nt(gt,A,L,T),L.programs=k.programs,G.context=gt,G.capabilities=T,G.extensions=A,G.properties=P,G.renderLists=N,G.state=C,G.info=L}function i(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),V=!0}function n(){console.log("THREE.WebGLRenderer: Context Restored."),V=!1,e()}function h(t){(t=t.target).removeEventListener("dispose",h),u(t),P.remove(t)}function u(t){var e=P.get(t).program;(t.program=void 0)!==e&&k.releaseProgram(e)}function a(t,e,i,n){for(var r=0,o=t.length;r<o;r++){var a=(l=t[r]).object,s=l.geometry,c=void 0===n?l.material:n,l=l.group;if(i.isArrayCamera)for(var h=(tt=i).cameras,u=0,d=h.length;u<d;u++){var p=h[u];a.layers.test(p.layers)&&(C.viewport(et.copy(p.viewport)),S.setupLights(p),f(a,e,p,s,c,l))}else tt=null,f(a,e,i,s,c,l)}}function f(t,e,i,n,r,o){var a,s;t.onBeforeRender(G,e,i,n,r,o),S=z.get(e,tt||i),t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject?(C.setMaterial(r),a=M(i,e.fog,r,t),J=E=null,Q=!1,s=a,t.render(function(t){G.renderBufferImmediate(t,s)})):G.renderBufferDirect(i,e.fog,n,r,t,o),t.onAfterRender(G,e,i,n,r,o),S=z.get(e,tt||i)}function p(t,e,i){var n=P.get(t),r=S.state.lights,o=n.lightsHash,a=r.state.hash;i=k.getParameters(t,r.state,S.state.shadowsArray,e,ut.numPlanes,ut.numIntersection,i);var s=k.getProgramCode(t,i),c=n.program,l=!0;if(void 0===c)t.addEventListener("dispose",h);else if(c.code!==s)u(t);else{if(o.stateID!==a.stateID||o.directionalLength!==a.directionalLength||o.pointLength!==a.pointLength||o.spotLength!==a.spotLength||o.rectAreaLength!==a.rectAreaLength||o.hemiLength!==a.hemiLength||o.shadowsLength!==a.shadowsLength)o.stateID=a.stateID,o.directionalLength=a.directionalLength,o.pointLength=a.pointLength,o.spotLength=a.spotLength,o.rectAreaLength=a.rectAreaLength,o.hemiLength=a.hemiLength,o.shadowsLength=a.shadowsLength;else if(void 0!==i.shaderID)return;l=!1}if(l&&(i.shaderID?(s=ma[i.shaderID],n.shader={name:t.type,uniforms:Tt(s.uniforms),vertexShader:s.vertexShader,fragmentShader:s.fragmentShader}):n.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader},t.onBeforeCompile(n.shader,G),s=k.getProgramCode(t,i),c=k.acquireProgram(t,n.shader,i,s),n.program=c,t.program=c),i=c.getAttributes(),t.morphTargets)for(s=t.numSupportedMorphTargets=0;s<G.maxMorphTargets;s++)0<=i["morphTarget"+s]&&t.numSupportedMorphTargets++;if(t.morphNormals)for(s=t.numSupportedMorphNormals=0;s<G.maxMorphNormals;s++)0<=i["morphNormal"+s]&&t.numSupportedMorphNormals++;i=n.shader.uniforms,(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(n.numClippingPlanes=ut.numPlanes,n.numIntersection=ut.numIntersection,i.clippingPlanes=ut.uniform),n.fog=e,void 0===o&&(n.lightsHash=o={}),o.stateID=a.stateID,o.directionalLength=a.directionalLength,o.pointLength=a.pointLength,o.spotLength=a.spotLength,o.rectAreaLength=a.rectAreaLength,o.hemiLength=a.hemiLength,o.shadowsLength=a.shadowsLength,t.lights&&(i.ambientLightColor.value=r.state.ambient,i.lightProbe.value=r.state.probe,i.directionalLights.value=r.state.directional,i.spotLights.value=r.state.spot,i.rectAreaLights.value=r.state.rectArea,i.pointLights.value=r.state.point,i.hemisphereLights.value=r.state.hemi,i.directionalShadowMap.value=r.state.directionalShadowMap,i.directionalShadowMatrix.value=r.state.directionalShadowMatrix,i.spotShadowMap.value=r.state.spotShadowMap,i.spotShadowMatrix.value=r.state.spotShadowMatrix,i.pointShadowMap.value=r.state.pointShadowMap,i.pointShadowMatrix.value=r.state.pointShadowMatrix),t=n.program.getUniforms(),t=Wt.seqWithValue(t.seq,i),n.uniformsList=t}function M(t,e,i,n){R.resetTextureUnits();var r=P.get(i),o=r.lightsHash,a=S.state.lights.state.hash;dt&&(pt||t!==K)&&ut.setState(i.clippingPlanes,i.clipIntersection,i.clipShadows,t,r,t===K&&i.id===Z),!1!==i.needsUpdate||(void 0===r.program||i.fog&&r.fog!==e||i.lights&&(o.stateID!==a.stateID||o.directionalLength!==a.directionalLength||o.pointLength!==a.pointLength||o.spotLength!==a.spotLength||o.rectAreaLength!==a.rectAreaLength||o.hemiLength!==a.hemiLength||o.shadowsLength!==a.shadowsLength)||void 0!==r.numClippingPlanes&&(r.numClippingPlanes!==ut.numPlanes||r.numIntersection!==ut.numIntersection))&&(i.needsUpdate=!0),i.needsUpdate&&(p(i,e,n),i.needsUpdate=!1);var s,c,l=!1,h=!1,u=!1,a=(o=r.program).getUniforms(),d=r.shader.uniforms;return C.useProgram(o.program)&&(u=h=l=!0),i.id!==Z&&(Z=i.id,h=!0),!l&&K===t||(a.setValue(gt,"projectionMatrix",t.projectionMatrix),T.logarithmicDepthBuffer&&a.setValue(gt,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),K!==t&&(K=t,u=h=!0),!(i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.envMap)||void 0!==(l=a.map.cameraPosition)&&l.setValue(gt,mt.setFromMatrixPosition(t.matrixWorld)),(i.isMeshPhongMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.skinning)&&a.setValue(gt,"viewMatrix",t.matrixWorldInverse)),i.skinning&&(a.setOptional(gt,n,"bindMatrix"),a.setOptional(gt,n,"bindMatrixInverse"),t=n.skeleton)&&(l=t.bones,T.floatVertexTextures?(void 0===t.boneTexture&&(l=Math.sqrt(4*l.length),l=uo.ceilPowerOfTwo(l),l=Math.max(l,4),(s=new Float32Array(l*l*4)).set(t.boneMatrices),(c=new _t(s,l,l,1023,1015)).needsUpdate=!0,t.boneMatrices=s,t.boneTexture=c,t.boneTextureSize=l),a.setValue(gt,"boneTexture",t.boneTexture,R),a.setValue(gt,"boneTextureSize",t.boneTextureSize)):a.setOptional(gt,t,"boneMatrices")),h&&(a.setValue(gt,"toneMappingExposure",G.toneMappingExposure),a.setValue(gt,"toneMappingWhitePoint",G.toneMappingWhitePoint),i.lights&&(h=u,d.ambientLightColor.needsUpdate=h,d.lightProbe.needsUpdate=h,d.directionalLights.needsUpdate=h,d.pointLights.needsUpdate=h,d.spotLights.needsUpdate=h,d.rectAreaLights.needsUpdate=h,d.hemisphereLights.needsUpdate=h),e&&i.fog&&(d.fogColor.value.copy(e.color),e.isFog?(d.fogNear.value=e.near,d.fogFar.value=e.far):e.isFogExp2&&(d.fogDensity.value=e.density)),i.isMeshBasicMaterial?m(d,i):i.isMeshLambertMaterial?(m(d,i),i.emissiveMap&&(d.emissiveMap.value=i.emissiveMap)):i.isMeshPhongMaterial?(m(d,i),i.isMeshToonMaterial?(g(d,i),i.gradientMap&&(d.gradientMap.value=i.gradientMap)):g(d,i)):i.isMeshStandardMaterial?(m(d,i),i.isMeshPhysicalMaterial?(v(d,i),d.reflectivity.value=i.reflectivity,d.clearCoat.value=i.clearCoat,d.clearCoatRoughness.value=i.clearCoatRoughness):v(d,i)):i.isMeshMatcapMaterial?(m(d,i),i.matcap&&(d.matcap.value=i.matcap),i.bumpMap&&(d.bumpMap.value=i.bumpMap,d.bumpScale.value=i.bumpScale,1===i.side&&(d.bumpScale.value*=-1)),i.normalMap&&(d.normalMap.value=i.normalMap,d.normalScale.value.copy(i.normalScale),1===i.side&&d.normalScale.value.negate()),i.displacementMap&&(d.displacementMap.value=i.displacementMap,d.displacementScale.value=i.displacementScale,d.displacementBias.value=i.displacementBias)):i.isMeshDepthMaterial?(m(d,i),i.displacementMap&&(d.displacementMap.value=i.displacementMap,d.displacementScale.value=i.displacementScale,d.displacementBias.value=i.displacementBias)):i.isMeshDistanceMaterial?(m(d,i),i.displacementMap&&(d.displacementMap.value=i.displacementMap,d.displacementScale.value=i.displacementScale,d.displacementBias.value=i.displacementBias),d.referencePosition.value.copy(i.referencePosition),d.nearDistance.value=i.nearDistance,d.farDistance.value=i.farDistance):i.isMeshNormalMaterial?(m(d,i),i.bumpMap&&(d.bumpMap.value=i.bumpMap,d.bumpScale.value=i.bumpScale,1===i.side&&(d.bumpScale.value*=-1)),i.normalMap&&(d.normalMap.value=i.normalMap,d.normalScale.value.copy(i.normalScale),1===i.side&&d.normalScale.value.negate()),i.displacementMap&&(d.displacementMap.value=i.displacementMap,d.displacementScale.value=i.displacementScale,d.displacementBias.value=i.displacementBias)):i.isLineBasicMaterial?(d.diffuse.value.copy(i.color),d.opacity.value=i.opacity,i.isLineDashedMaterial&&(d.dashSize.value=i.dashSize,d.totalSize.value=i.dashSize+i.gapSize,d.scale.value=i.scale)):i.isPointsMaterial?(d.diffuse.value.copy(i.color),d.opacity.value=i.opacity,d.size.value=i.size*at,d.scale.value=.5*ot,d.map.value=i.map,null!==i.map&&(!0===i.map.matrixAutoUpdate&&i.map.updateMatrix(),d.uvTransform.value.copy(i.map.matrix))):i.isSpriteMaterial?(d.diffuse.value.copy(i.color),d.opacity.value=i.opacity,d.rotation.value=i.rotation,d.map.value=i.map,null!==i.map&&(!0===i.map.matrixAutoUpdate&&i.map.updateMatrix(),d.uvTransform.value.copy(i.map.matrix))):i.isShadowMaterial&&(d.color.value.copy(i.color),d.opacity.value=i.opacity),void 0!==d.ltc_1&&(d.ltc_1.value=fa.LTC_1),void 0!==d.ltc_2&&(d.ltc_2.value=fa.LTC_2),Wt.upload(gt,r.uniformsList,d,R)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(Wt.upload(gt,r.uniformsList,d,R),i.uniformsNeedUpdate=!1),i.isSpriteMaterial&&a.setValue(gt,"center",n.center),a.setValue(gt,"modelViewMatrix",n.modelViewMatrix),a.setValue(gt,"normalMatrix",n.normalMatrix),a.setValue(gt,"modelMatrix",n.matrixWorld),o}function m(t,e){var i;t.opacity.value=e.opacity,e.color&&t.diffuse.value.copy(e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),e.envMap&&(t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=P.get(e.envMap).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?i=e.map:e.specularMap?i=e.specularMap:e.displacementMap?i=e.displacementMap:e.normalMap?i=e.normalMap:e.bumpMap?i=e.bumpMap:e.roughnessMap?i=e.roughnessMap:e.metalnessMap?i=e.metalnessMap:e.alphaMap?i=e.alphaMap:e.emissiveMap&&(i=e.emissiveMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix))}function g(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function v(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}console.log("THREE.WebGLRenderer","105");var r=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),o=void 0!==t.context?t.context:null,s=void 0!==t.alpha&&t.alpha,c=void 0===t.depth||t.depth,l=void 0===t.stencil||t.stencil,d=void 0!==t.antialias&&t.antialias,y=void 0===t.premultipliedAlpha||t.premultipliedAlpha,b=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,x=void 0!==t.powerPreference?t.powerPreference:"default",w=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat,_=null,S=null;this.domElement=r,this.context=null,this.debug={checkShaderErrors:!0},this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1,this.toneMappingWhitePoint=this.toneMappingExposure=this.toneMapping=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var A,T,C,L,P,R,I,O,D,k,N,z,B,F,U,j,H,G=this,V=!1,W=null,q=0,X=0,Y=null,$=null,Z=-1,J=E=null,Q=!1,K=null,tt=null,et=new Mt,it=new Mt,nt=null,rt=r.width,ot=r.height,at=1,st=new Mt(0,0,rt,ot),ct=new Mt(0,0,rt,ot),lt=!1,ht=new St,ut=new Ot,dt=!1,pt=!1,ft=new At,mt=new Et;try{s={alpha:s,depth:c,stencil:l,antialias:d,premultipliedAlpha:y,preserveDrawingBuffer:b,powerPreference:x,failIfMajorPerformanceCaveat:w,xrCompatible:!0},r.addEventListener("webglcontextlost",i,!1),r.addEventListener("webglcontextrestored",n,!1);var gt=o||r.getContext("webgl",s)||r.getContext("experimental-webgl",s);if(null===gt){if(null!==r.getContext("webgl"))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.")}void 0===gt.getShaderPrecisionFormat&&(gt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}e();var vt=new("undefined"!=typeof navigator&&"xr"in navigator&&"supportsSession"in navigator.xr?Me:Ee)(G);this.vr=vt;var yt=new pe(G,D,T.maxTextureSize);this.shadowMap=yt,this.getContext=function(){return gt},this.getContextAttributes=function(){return gt.getContextAttributes()},this.forceContextLoss=function(){var t=A.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=A.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return at},this.setPixelRatio=function(t){void 0!==t&&(at=t,this.setSize(rt,ot,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new wt),t.set(rt,ot)},this.setSize=function(t,e,i){vt.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(rt=t,ot=e,r.width=t*at,r.height=e*at,!1!==i&&(r.style.width=t+"px",r.style.height=e+"px"),this.setViewport(0,0,t,e))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new wt),t.set(rt*at,ot*at)},this.setDrawingBufferSize=function(t,e,i){rt=t,ot=e,at=i,r.width=t*i,r.height=e*i,this.setViewport(0,0,t,e)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new Mt),t.copy(et)},this.getViewport=function(t){return t.copy(st)},this.setViewport=function(t,e,i,n){t.isVector4?st.set(t.x,t.y,t.z,t.w):st.set(t,e,i,n),C.viewport(et.copy(st).multiplyScalar(at))},this.getScissor=function(t){return t.copy(ct)},this.setScissor=function(t,e,i,n){t.isVector4?ct.set(t.x,t.y,t.z,t.w):ct.set(t,e,i,n),C.scissor(it.copy(ct).multiplyScalar(at))},this.getScissorTest=function(){return lt},this.setScissorTest=function(t){C.setScissorTest(lt=t)},this.getClearColor=function(){return B.getClearColor()},this.setClearColor=function(){B.setClearColor.apply(B,arguments)},this.getClearAlpha=function(){return B.getClearAlpha()},this.setClearAlpha=function(){B.setClearAlpha.apply(B,arguments)},this.clear=function(t,e,i){var n=0;void 0!==t&&!t||(n|=16384),void 0!==e&&!e||(n|=256),void 0!==i&&!i||(n|=1024),gt.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){r.removeEventListener("webglcontextlost",i,!1),r.removeEventListener("webglcontextrestored",n,!1),N.dispose(),z.dispose(),P.dispose(),D.dispose(),vt.dispose(),xt.stop()},this.renderBufferImmediate=function(t,e){C.initAttributes();var i=P.get(t);t.hasPositions&&!i.position&&(i.position=gt.createBuffer()),t.hasNormals&&!i.normal&&(i.normal=gt.createBuffer()),t.hasUvs&&!i.uv&&(i.uv=gt.createBuffer()),t.hasColors&&!i.color&&(i.color=gt.createBuffer()),e=e.getAttributes(),t.hasPositions&&(gt.bindBuffer(34962,i.position),gt.bufferData(34962,t.positionArray,35048),C.enableAttribute(e.position),gt.vertexAttribPointer(e.position,3,5126,!1,0,0)),t.hasNormals&&(gt.bindBuffer(34962,i.normal),gt.bufferData(34962,t.normalArray,35048),C.enableAttribute(e.normal),gt.vertexAttribPointer(e.normal,3,5126,!1,0,0)),t.hasUvs&&(gt.bindBuffer(34962,i.uv),gt.bufferData(34962,t.uvArray,35048),C.enableAttribute(e.uv),gt.vertexAttribPointer(e.uv,2,5126,!1,0,0)),t.hasColors&&(gt.bindBuffer(34962,i.color),gt.bufferData(34962,t.colorArray,35048),C.enableAttribute(e.color),gt.vertexAttribPointer(e.color,3,5126,!1,0,0)),C.disableUnusedAttributes(),gt.drawArrays(4,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,i,n,r,o){var a=r.isMesh&&r.matrixWorld.determinant()<0;C.setMaterial(n,a);var s=M(t,e,n,r),c=!1;E===i.id&&J===s.id&&Q===(!0===n.wireframe)||(E=i.id,J=s.id,Q=!0===n.wireframe,c=!0),r.morphTargetInfluences&&(F.update(r,i,n,s),c=!0),a=i.index;var l,h=i.attributes.position;if(e=1,!0===n.wireframe&&(a=O.getWireframeAttribute(i),e=2),t=U,null!==a&&(l=I.get(a),(t=j).setIndex(l)),c){if(i&&i.isInstancedBufferGeometry&&!T.isWebGL2&&null===A.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{C.initAttributes(),c=i.attributes,s=s.getAttributes();var u=n.defaultAttributeValues;for(w in s){var d=s[w];if(0<=d)if(void 0!==(v=c[w])){var p,f,m,g,v,y=v.normalized,b=v.itemSize,x=I.get(v);void 0!==x&&(p=x.buffer,f=x.type,x=x.bytesPerElement,v.isInterleavedBufferAttribute?(g=(m=v.data).stride,v=v.offset,m&&m.isInstancedInterleavedBuffer?(C.enableAttributeAndDivisor(d,m.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=m.meshPerAttribute*m.count)):C.enableAttribute(d),gt.bindBuffer(34962,p),gt.vertexAttribPointer(d,b,f,y,g*x,v*x)):(v.isInstancedBufferAttribute?(C.enableAttributeAndDivisor(d,v.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=v.meshPerAttribute*v.count)):C.enableAttribute(d),gt.bindBuffer(34962,p),gt.vertexAttribPointer(d,b,f,y,0,0)))}else if(void 0!==u&&void 0!==(y=u[w]))switch(y.length){case 2:gt.vertexAttrib2fv(d,y);break;case 3:gt.vertexAttrib3fv(d,y);break;case 4:gt.vertexAttrib4fv(d,y);break;default:gt.vertexAttrib1fv(d,y)}}C.disableUnusedAttributes()}null!==a&&gt.bindBuffer(34963,l.buffer)}l=1/0,null!==a?l=a.count:void 0!==h&&(l=h.count),a=i.drawRange.start*e,h=null!==o?o.start*e:0;var w=Math.max(a,h);if(0!==(o=Math.max(0,Math.min(l,a+i.drawRange.count*e,h+(null!==o?o.count*e:1/0))-1-w+1))){if(r.isMesh)if(!0===n.wireframe)C.setLineWidth(n.wireframeLinewidth*(null===Y?at:1)),t.setMode(1);else switch(r.drawMode){case 0:t.setMode(4);break;case 1:t.setMode(5);break;case 2:t.setMode(6)}else r.isLine?(void 0===(n=n.linewidth)&&(n=1),C.setLineWidth(n*(null===Y?at:1)),r.isLineSegments?t.setMode(1):r.isLineLoop?t.setMode(2):t.setMode(3)):r.isPoints?t.setMode(0):r.isSprite&&t.setMode(4);i&&i.isInstancedBufferGeometry?0<i.maxInstancedCount&&t.renderInstances(i,w,o):t.render(w,o)}},this.compile=function(i,t){(S=z.get(i,t)).init(),i.traverse(function(t){t.isLight&&(S.pushLight(t),t.castShadow&&S.pushShadow(t))}),S.setupLights(t),i.traverse(function(t){if(t.material)if(Array.isArray(t.material))for(var e=0;e<t.material.length;e++)p(t.material[e],i.fog,t);else p(t.material,i.fog,t)})};var bt=null,xt=new Ct;xt.setAnimationLoop(function(t){vt.isPresenting()||bt&&bt(t)}),"undefined"!=typeof window&&xt.setContext(window),this.setAnimationLoop=function(t){bt=t,vt.setAnimationLoop(t),xt.start()},this.render=function(t,e,i,n){var r,o;void 0!==i&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),r=i),void 0!==n&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),o=n),e&&e.isCamera?V||(J=E=null,Q=!1,Z=-1,!(K=null)===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),vt.enabled&&(e=vt.getCamera(e)),(S=z.get(t,e)).init(),t.onBeforeRender(G,t,e,r||Y),ft.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),ht.setFromMatrix(ft),pt=this.localClippingEnabled,dt=ut.init(this.clippingPlanes,pt,e),(_=N.get(t,e)).init(),function t(e,i,n,r){if(!1!==e.visible){if(e.layers.test(i.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLight)S.pushLight(e),e.castShadow&&S.pushShadow(e);else if(e.isSprite){var o,a;e.frustumCulled&&!ht.intersectsSprite(e)||(r&&mt.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ft),o=D.update(e),(a=e.material).visible&&_.push(e,o,a,n,mt.z,null))}else if(e.isImmediateRenderObject)r&&mt.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ft),_.push(e,null,e.material,n,mt.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.update(),!e.frustumCulled||ht.intersectsObject(e)))if(r&&mt.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ft),o=D.update(e),a=e.material,Array.isArray(a))for(var s=o.groups,c=0,l=s.length;c<l;c++){var h=s[c],u=a[h.materialIndex];u&&u.visible&&_.push(e,o,u,n,mt.z,h)}else a.visible&&_.push(e,o,a,n,mt.z,null);for(c=0,l=(e=e.children).length;c<l;c++)t(e[c],i,n,r)}}(t,e,0,G.sortObjects),!0===G.sortObjects&&_.sort(),dt&&ut.beginShadows(),yt.render(S.state.shadowsArray,t,e),S.setupLights(e),dt&&ut.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==r&&this.setRenderTarget(r),B.render(_,t,e,o),i=_.opaque,n=_.transparent,t.overrideMaterial?(r=t.overrideMaterial,i.length&&a(i,t,e,r),n.length&&a(n,t,e,r)):(i.length&&a(i,t,e),n.length&&a(n,t,e)),t.onAfterRender(G,t,e),null!==Y&&(R.updateRenderTargetMipmap(Y),R.updateMultisampleRenderTarget(Y)),C.buffers.depth.setTest(!0),C.buffers.depth.setMask(!0),C.buffers.color.setMask(!0),C.setPolygonOffset(!1),vt.enabled&&vt.submitFrame(),S=_=null):console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(t){W!==t&&gt.bindFramebuffer(36160,t),W=t},this.getActiveCubeFace=function(){return q},this.getActiveMipMapLevel=function(){return X},this.getRenderTarget=function(){return Y},this.setRenderTarget=function(t,e,i){q=e,X=i,(Y=t)&&void 0===P.get(t).__webglFramebuffer&&R.setupRenderTarget(t);var n=W,r=!1;nt=t?(n=P.get(t).__webglFramebuffer,t.isWebGLRenderTargetCube?(n=n[e||0],r=!0):n=t.isWebGLMultisampleRenderTarget?P.get(t).__webglMultisampledFramebuffer:n,et.copy(t.viewport),it.copy(t.scissor),t.scissorTest):(et.copy(st).multiplyScalar(at),it.copy(ct).multiplyScalar(at),lt),$!==n&&(gt.bindFramebuffer(36160,n),$=n),C.viewport(et),C.scissor(it),C.setScissorTest(nt),r&&(t=P.get(t.texture),gt.framebufferTexture2D(36160,36064,34069+(e||0),t.__webglTexture,i||0))},this.readRenderTargetPixels=function(t,e,i,n,r,o,a){if(t&&t.isWebGLRenderTarget){var s=P.get(t).__webglFramebuffer;if(t.isWebGLRenderTargetCube&&void 0!==a&&(s=s[a]),s){a=!1,s!==$&&(gt.bindFramebuffer(36160,s),a=!0);try{var c=t.texture,l=c.format,h=c.type;1023!==l&&H.convert(l)!==gt.getParameter(35739)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):1009===h||H.convert(h)===gt.getParameter(35738)||1015===h&&(T.isWebGL2||A.get("OES_texture_float")||A.get("WEBGL_color_buffer_float"))||1016===h&&(T.isWebGL2?A.get("EXT_color_buffer_float"):A.get("EXT_color_buffer_half_float"))?36053===gt.checkFramebufferStatus(36160)?0<=e&&e<=t.width-n&&0<=i&&i<=t.height-r&&gt.readPixels(e,i,n,r,H.convert(l),H.convert(h),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{a&&gt.bindFramebuffer(36160,$)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,i){var n=e.image.width,r=e.image.height,o=H.convert(e.format);R.setTexture2D(e,0),gt.copyTexImage2D(3553,i||0,o,t.x,t.y,n,r,0)},this.copyTextureToTexture=function(t,e,i,n){var r=e.image.width,o=e.image.height,a=H.convert(i.format),s=H.convert(i.type);R.setTexture2D(i,0),e.isDataTexture?gt.texSubImage2D(3553,n||0,t.x,t.y,r,o,a,s,e.image.data):gt.texSubImage2D(3553,n||0,t.x,t.y,a,s,e.image)}}function Se(t,e){this.name="",this.color=new p(t),this.density=void 0!==e?e:25e-5}function Ae(t,e,i){this.name="",this.color=new p(t),this.near=void 0!==e?e:1,this.far=void 0!==i?i:1e3}function Te(){u.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.background=null,this.autoUpdate=!0}function Ce(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function Le(t,e,i,n){this.data=t,this.itemSize=e,this.offset=i,this.normalized=!0===n}function Pe(t){k.call(this),this.type="SpriteMaterial",this.color=new p(16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0,this.setValues(t)}function Re(t){var e;u.call(this),this.type="Sprite",void 0===cc&&(cc=new P,e=new Ce(e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5),cc.setIndex([0,1,2,0,2,3]),cc.addAttribute("position",new Le(e,3,0,!1)),cc.addAttribute("uv",new Le(e,2,3,!1))),this.geometry=cc,this.material=void 0!==t?t:new Pe,this.center=new wt(.5,.5)}function Ie(){u.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Oe(t,e){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),U.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new At,this.bindMatrixInverse=new At}function De(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[],t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new At)}function ke(){u.call(this),this.type="Bone"}function Ne(t){k.call(this),this.type="LineBasicMaterial",this.color=new p(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.lights=!1,this.setValues(t)}function ze(t,e,i){1===i&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),u.call(this),this.type="Line",this.geometry=void 0!==t?t:new P,this.material=void 0!==e?e:new Ne({color:16777215*Math.random()})}function Be(t,e){ze.call(this,t,e),this.type="LineSegments"}function Fe(t,e){ze.call(this,t,e),this.type="LineLoop"}function Ue(t){k.call(this),this.type="PointsMaterial",this.color=new p(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=this.morphTargets=!1,this.setValues(t)}function je(t,e){u.call(this),this.type="Points",this.geometry=void 0!==t?t:new P,this.material=void 0!==e?e:new Ue({color:16777215*Math.random()})}function He(t,e,i,n,r,o,a,s,c){d.call(this,t,e,i,n,r,o,a,s,c),this.format=void 0!==a?a:1022,this.minFilter=void 0!==o?o:1006,this.magFilter=void 0!==r?r:1006,this.generateMipmaps=!1}function Ge(t,e,i,n,r,o,a,s,c,l,h,u){d.call(this,null,o,a,s,c,l,n,r,h,u),this.image={width:e,height:i},this.mipmaps=t,this.generateMipmaps=this.flipY=!1}function Ve(t,e,i,n,r,o,a,s,c){d.call(this,t,e,i,n,r,o,a,s,c),this.needsUpdate=!0}function We(t,e,i,n,r,o,a,s,c,l){if(1026!==(l=void 0!==l?l:1026)&&1027!==l)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&1026===l&&(i=1012),void 0===i&&1027===l&&(i=1020),d.call(this,null,n,r,o,a,s,l,i,c),this.image={width:t,height:e},this.magFilter=void 0!==a?a:1003,this.minFilter=void 0!==s?s:1003,this.generateMipmaps=this.flipY=!1}function qe(t){P.call(this),this.type="WireframeGeometry";var e,i=[],n=[0,0],r={},o=["a","b","c"];if(t&&t.isGeometry){for(var a=t.faces,s=0,c=a.length;s<c;s++)for(var l=a[s],h=0;h<3;h++){var u=l[o[h]],d=l[o[(h+1)%3]];n[0]=Math.min(u,d),n[1]=Math.max(u,d),void 0===r[u=n[0]+","+n[1]]&&(r[u]={index1:n[0],index2:n[1]})}for(u in r)s=r[u],o=t.vertices[s.index1],i.push(o.x,o.y,o.z),o=t.vertices[s.index2],i.push(o.x,o.y,o.z)}else if(t&&t.isBufferGeometry)if(o=new Et,null!==t.index){a=t.attributes.position,l=t.index;var p=t.groups;for(0===p.length&&(p=[{start:0,count:l.count,materialIndex:0}]),t=0,e=p.length;t<e;++t)for(h=(s=p[t]).start,c=s.count,c=(s=h)+c;s<c;s+=3)for(h=0;h<3;h++)u=l.getX(s+h),d=l.getX(s+(h+1)%3),n[0]=Math.min(u,d),n[1]=Math.max(u,d),void 0===r[u=n[0]+","+n[1]]&&(r[u]={index1:n[0],index2:n[1]});for(u in r)s=r[u],o.fromBufferAttribute(a,s.index1),i.push(o.x,o.y,o.z),o.fromBufferAttribute(a,s.index2),i.push(o.x,o.y,o.z)}else for(s=0,c=(a=t.attributes.position).count/3;s<c;s++)for(h=0;h<3;h++)r=3*s+h,o.fromBufferAttribute(a,r),i.push(o.x,o.y,o.z),r=3*s+(h+1)%3,o.fromBufferAttribute(a,r),i.push(o.x,o.y,o.z);this.addAttribute("position",new L(i,3))}function Xe(t,e,i){f.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:i},this.fromBufferGeometry(new Ye(t,e,i)),this.mergeVertices()}function Ye(t,e,i){P.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:i};var n=[],r=[],o=[],a=[],s=new Et,c=new Et,l=new Et,h=new Et,u=new Et;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var d=e+1,p=0;p<=i;p++)for(var f=p/i,m=0;m<=e;m++){var g=m/e;t(g,f,c),r.push(c.x,c.y,c.z),0<=g-1e-5?(t(g-1e-5,f,l),h.subVectors(c,l)):(t(1e-5+g,f,l),h.subVectors(l,c)),0<=f-1e-5?(t(g,f-1e-5,l),u.subVectors(c,l)):(t(g,1e-5+f,l),u.subVectors(l,c)),s.crossVectors(h,u).normalize(),o.push(s.x,s.y,s.z),a.push(g,f)}for(p=0;p<i;p++)for(m=0;m<e;m++)t=p*d+m+1,s=(p+1)*d+m+1,c=(p+1)*d+m,n.push(p*d+m,t,c),n.push(t,s,c);this.setIndex(n),this.addAttribute("position",new L(r,3)),this.addAttribute("normal",new L(o,3)),this.addAttribute("uv",new L(a,2))}function $e(t,e,i,n){f.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:n},this.fromBufferGeometry(new Ze(t,e,i,n)),this.mergeVertices()}function Ze(i,m,t,e){function g(t){u.push(t.x,t.y,t.z)}function v(t,e){t*=3,e.x=i[t+0],e.y=i[t+1],e.z=i[t+2]}function h(t,e,i,n){n<0&&1===t.x&&(d[e]=t.x-1),0===i.x&&0===i.z&&(d[e]=n/2/Math.PI+.5)}P.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:i,indices:m,radius:t,detail:e},t=t||1;var u=[],d=[];!function(t){for(var e=new Et,i=new Et,n=new Et,r=0;r<m.length;r+=3){v(m[r+0],e),v(m[r+1],i),v(m[r+2],n);for(var o=e,a=i,s=n,c=Math.pow(2,t),l=[],h=0;h<=c;h++){l[h]=[];for(var u=o.clone().lerp(s,h/c),d=a.clone().lerp(s,h/c),p=c-h,f=0;f<=p;f++)l[h][f]=0===f&&h===c?u:u.clone().lerp(d,f/p)}for(h=0;h<c;h++)for(f=0;f<2*(c-h)-1;f++)o=Math.floor(f/2),0==f%2?(g(l[h][o+1]),g(l[h+1][o]),g(l[h][o])):(g(l[h][o+1]),g(l[h+1][o+1]),g(l[h+1][o]))}}(e=e||0),function(t){for(var e=new Et,i=0;i<u.length;i+=3)e.x=u[i+0],e.y=u[i+1],e.z=u[i+2],e.normalize().multiplyScalar(t),u[i+0]=e.x,u[i+1]=e.y,u[i+2]=e.z}(t),function(){for(var t=new Et,e=0;e<u.length;e+=3)t.x=u[e+0],t.y=u[e+1],t.z=u[e+2],d.push(Math.atan2(t.z,-t.x)/2/Math.PI+.5,1-(Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5));t=new Et,e=new Et;for(var i=new Et,n=new Et,r=new wt,o=new wt,a=new wt,s=0,c=0;s<u.length;s+=9,c+=6){t.set(u[s+0],u[s+1],u[s+2]),e.set(u[s+3],u[s+4],u[s+5]),i.set(u[s+6],u[s+7],u[s+8]),r.set(d[c+0],d[c+1]),o.set(d[c+2],d[c+3]),a.set(d[c+4],d[c+5]),n.copy(t).add(e).add(i).divideScalar(3);var l=Math.atan2(n.z,-n.x);h(r,c+0,t,l),h(o,c+2,e,l),h(a,c+4,i,l)}for(t=0;t<d.length;t+=6)e=d[t+0],i=d[t+2],n=d[t+4],r=Math.min(e,i,n),.9<Math.max(e,i,n)&&r<.1&&(e<.2&&(d[t+0]+=1),i<.2&&(d[t+2]+=1),n<.2&&(d[t+4]+=1))}(),this.addAttribute("position",new L(u,3)),this.addAttribute("normal",new L(u.slice(),3)),this.addAttribute("uv",new L(d,2)),0===e?this.computeVertexNormals():this.normalizeNormals()}function Je(t,e){f.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Qe(t,e)),this.mergeVertices()}function Qe(t,e){Ze.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ke(t,e){f.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new ti(t,e)),this.mergeVertices()}function ti(t,e){Ze.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ei(t,e){f.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new ii(t,e)),this.mergeVertices()}function ii(t,e){var i=(1+Math.sqrt(5))/2;Ze.call(this,[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ni(t,e){f.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new ri(t,e)),this.mergeVertices()}function ri(t,e){var i=(1+Math.sqrt(5))/2,n=1/i;Ze.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function oi(t,e,i,n,r,o){f.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:i,radialSegments:n,closed:r},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed."),t=new ai(t,e,i,n,r),this.tangents=t.tangents,this.normals=t.normals,this.binormals=t.binormals,this.fromBufferGeometry(t),this.mergeVertices()}function ai(r,o,a,s,t){function e(t){d=r.getPointAt(t/o,d);var e=c.normals[t];for(t=c.binormals[t],l=0;l<=s;l++){var i=l/s*Math.PI*2,n=Math.sin(i),i=-Math.cos(i);u.x=i*e.x+n*t.x,u.y=i*e.y+n*t.y,u.z=i*e.z+n*t.z,u.normalize(),f.push(u.x,u.y,u.z),h.x=d.x+a*u.x,h.y=d.y+a*u.y,h.z=d.z+a*u.z,p.push(h.x,h.y,h.z)}}P.call(this),this.type="TubeBufferGeometry",this.parameters={path:r,tubularSegments:o,radius:a,radialSegments:s,closed:t},o=o||64,a=a||1,s=s||8,t=t||!1;var c=r.computeFrenetFrames(o,t);this.tangents=c.tangents,this.normals=c.normals,this.binormals=c.binormals;for(var l,h=new Et,u=new Et,i=new wt,d=new Et,p=[],f=[],n=[],m=[],g=0;g<o;g++)e(g);for(e(!1===t?o:0),g=0;g<=o;g++)for(l=0;l<=s;l++)i.x=g/o,i.y=l/s,n.push(i.x,i.y);!function(){for(l=1;l<=o;l++)for(g=1;g<=s;g++){var t=(s+1)*l+(g-1),e=(s+1)*l+g,i=(s+1)*(l-1)+g;m.push((s+1)*(l-1)+(g-1),t,i),m.push(t,e,i)}}(),this.setIndex(m),this.addAttribute("position",new L(p,3)),this.addAttribute("normal",new L(f,3)),this.addAttribute("uv",new L(n,2))}function si(t,e,i,n,r,o,a){f.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:n,p:r,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new ci(t,e,i,n,r,o)),this.mergeVertices()}function ci(t,e,i,n,r,o){function a(t,e,i,n,r){var o=Math.sin(t);e=i/e*t,i=Math.cos(e),r.x=n*(2+i)*.5*Math.cos(t),r.y=n*(2+i)*o*.5,r.z=n*Math.sin(e)*.5}P.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:n,p:r,q:o},t=t||1,e=e||.4,i=Math.floor(i)||64,n=Math.floor(n)||8,r=r||2,o=o||3;for(var s=[],c=[],l=[],h=[],u=new Et,d=new Et,p=new Et,f=new Et,m=new Et,g=new Et,v=new Et,y=0;y<=i;++y){var b=y/i*r*Math.PI*2;for(a(b,r,o,t,p),a(b+.01,r,o,t,f),g.subVectors(f,p),v.addVectors(f,p),m.crossVectors(g,v),v.crossVectors(m,g),m.normalize(),v.normalize(),b=0;b<=n;++b){var x=b/n*Math.PI*2,w=-e*Math.cos(x),x=e*Math.sin(x);u.x=p.x+(w*v.x+x*m.x),u.y=p.y+(w*v.y+x*m.y),u.z=p.z+(w*v.z+x*m.z),c.push(u.x,u.y,u.z),d.subVectors(u,p).normalize(),l.push(d.x,d.y,d.z),h.push(y/i),h.push(b/n)}}for(b=1;b<=i;b++)for(y=1;y<=n;y++)t=(n+1)*b+(y-1),e=(n+1)*b+y,r=(n+1)*(b-1)+y,s.push((n+1)*(b-1)+(y-1),t,r),s.push(t,e,r);this.setIndex(s),this.addAttribute("position",new L(c,3)),this.addAttribute("normal",new L(l,3)),this.addAttribute("uv",new L(h,2))}function li(t,e,i,n,r){f.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:r},this.fromBufferGeometry(new hi(t,e,i,n,r)),this.mergeVertices()}function hi(t,e,i,n,r){P.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:r},t=t||1,e=e||.4,i=Math.floor(i)||8,n=Math.floor(n)||6,r=r||2*Math.PI;for(var o,a=[],s=[],c=[],l=[],h=new Et,u=new Et,d=new Et,p=0;p<=i;p++)for(o=0;o<=n;o++){var f=o/n*r,m=p/i*Math.PI*2;u.x=(t+e*Math.cos(m))*Math.cos(f),u.y=(t+e*Math.cos(m))*Math.sin(f),u.z=e*Math.sin(m),s.push(u.x,u.y,u.z),h.x=t*Math.cos(f),h.y=t*Math.sin(f),d.subVectors(u,h).normalize(),c.push(d.x,d.y,d.z),l.push(o/n),l.push(p/i)}for(p=1;p<=i;p++)for(o=1;o<=n;o++)t=(n+1)*(p-1)+o-1,e=(n+1)*(p-1)+o,r=(n+1)*p+o,a.push((n+1)*p+o-1,t,r),a.push(t,e,r);this.setIndex(a),this.addAttribute("position",new L(s,3)),this.addAttribute("normal",new L(c,3)),this.addAttribute("uv",new L(l,2))}function ui(t,e,i,n,r){for(var o,a=0,s=e,c=i-n;s<i;s+=n)a+=(t[c]-t[s])*(t[s+1]+t[c+1]),c=s;if(r===0<a)for(r=e;r<i;r+=n)o=wi(r,t[r],t[r+1],o);else for(r=i-n;e<=r;r-=n)o=wi(r,t[r],t[r+1],o);return o&&vi(o,o.next)&&(Ei(o),o=o.next),o}function di(t,e){if(!t)return t;e=e||t;do{var i=!1;if(t.steiner||!vi(t,t.next)&&0!==gi(t.prev,t,t.next))t=t.next;else{if(Ei(t),(t=e=t.prev)===t.next)break;i=!0}}while(i||t!==e);return e}function pi(t,e){return t.x-e.x}function fi(t,e,i,n,r){return 1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1)|(1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function mi(t,e,i,n,r,o,a,s){return 0<=(r-a)*(e-s)-(t-a)*(o-s)&&0<=(t-a)*(n-s)-(i-a)*(e-s)&&0<=(i-a)*(o-s)-(r-a)*(n-s)}function gi(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function vi(t,e){return t.x===e.x&&t.y===e.y}function yi(t,e,i,n){return vi(t,e)&&vi(i,n)||vi(t,n)&&vi(i,e)||0<gi(t,e,i)!=0<gi(t,e,n)&&0<gi(i,n,t)!=0<gi(i,n,e)}function bi(t,e){return gi(t.prev,t,t.next)<0?0<=gi(t,e,t.next)&&0<=gi(t,t.prev,e):gi(t,e,t.prev)<0||gi(t,t.next,e)<0}function xi(t,e){var i=new Mi(t.i,t.x,t.y),n=new Mi(e.i,e.x,e.y),r=t.next,o=e.prev;return(t.next=e).prev=t,(i.next=r).prev=i,(n.next=i).prev=n,(o.next=n).prev=o,n}function wi(t,e,i,n){return t=new Mi(t,e,i),n?(t.next=n.next,(t.prev=n).next.prev=t,n.next=t):(t.prev=t).next=t,t}function Ei(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Mi(t,e,i){this.i=t,this.x=e,this.y=i,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function _i(t){var e=t.length;2<e&&t[e-1].equals(t[0])&&t.pop()}function Si(t,e){for(var i=0;i<e.length;i++)t.push(e[i].x),t.push(e[i].y)}function Ai(t,e){f.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new Ti(t,e)),this.mergeVertices()}function Ti(t,H){P.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:H},t=Array.isArray(t)?t:[t];for(var G=this,V=[],W=[],e=0,i=t.length;e<i;e++)!function(t){function e(t,e,i){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(i).add(t)}function i(t,e,i){var n=t.x-e.x,r=t.y-e.y,o=i.x-t.x,a=i.y-t.y,s=n*n+r*r;if(Math.abs(n*a-r*o)>Number.EPSILON){var c=Math.sqrt(s),l=Math.sqrt(o*o+a*a),s=e.x-r/c;if(e=e.y+n/c,(r=(o=s+n*(a=((i.x-a/l-s)*a-(i.y+o/l-e)*o)/(n*a-r*o))-t.x)*o+(n=e+r*a-t.y)*n)<=2)return new wt(o,n);r=Math.sqrt(r/2)}else t=!1,n>Number.EPSILON?o>Number.EPSILON&&(t=!0):n<-Number.EPSILON?o<-Number.EPSILON&&(t=!0):Math.sign(r)===Math.sign(a)&&(t=!0),r=t?(o=-r,Math.sqrt(s)):(o=n,n=r,Math.sqrt(s/2));return new wt(o/r,n/r)}function n(t,e){for(D=t.length;0<=--D;){var i=D,n=D-1;n<0&&(n=t.length-1);for(var r=d+2*g,o=0;o<r;o++){var a=I*o,s=e+n+a,c=e+n+(l=I*(o+1)),l=e+i+l;h(e+i+a),h(s),h(l),h(s),h(c),h(l),a=V.length/3,u((a=y.generateSideWallUV(G,V,a-6,a-3,a-2,a-1))[0]),u(a[1]),u(a[3]),u(a[1]),u(a[2]),u(a[3])}}}function r(t,e,i){a.push(t),a.push(e),a.push(i)}function o(t,e,i){h(t),h(e),h(i),t=V.length/3,u((t=y.generateTopUV(G,V,t-3,t-2,t-1))[0]),u(t[1]),u(t[2])}function h(t){V.push(a[3*t]),V.push(a[3*t+1]),V.push(a[3*t+2])}function u(t){W.push(t.x),W.push(t.y)}var a=[],s=void 0!==H.curveSegments?H.curveSegments:12,d=void 0!==H.steps?H.steps:1,c=void 0!==H.depth?H.depth:100,l=void 0===H.bevelEnabled||H.bevelEnabled,p=void 0!==H.bevelThickness?H.bevelThickness:6,f=void 0!==H.bevelSize?H.bevelSize:p-2,m=void 0!==H.bevelOffset?H.bevelOffset:0,g=void 0!==H.bevelSegments?H.bevelSegments:3,v=H.extrudePath,y=void 0!==H.UVGenerator?H.UVGenerator:jc;void 0!==H.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),c=H.amount);var b,x,w,E,M,_=!1;v&&(b=v.getSpacedPoints(d),l=!(_=!0),x=v.computeFrenetFrames(d,!1),w=new Et,E=new Et,M=new Et),l||(m=f=p=g=0),t=(s=t.extractPoints(s)).shape;var S=s.holes;if(!Uc.isClockWise(t)){t=t.reverse();for(var A=0,T=S.length;A<T;A++){var C=S[A];Uc.isClockWise(C)&&(S[A]=C.reverse())}}var L=Uc.triangulateShape(t,S),P=t,A=0;for(T=S.length;A<T;A++)C=S[A],t=t.concat(C);var R,I=t.length,O=L.length,s=[],D=0,k=(z=P.length)-1;for(F=D+1;D<z;D++,k++,F++)k===z&&(k=0),F===z&&(F=0),s[D]=i(P[D],P[k],P[F]);v=[];var N=s.concat();for(A=0,T=S.length;A<T;A++){C=S[A];for(var z,B=[],D=0,k=(z=C.length)-1,F=D+1;D<z;D++,k++,F++)k===z&&(k=0),F===z&&(F=0),B[D]=i(C[D],C[k],C[F]);v.push(B),N=N.concat(B)}for(k=0;k<g;k++){z=k/g;var U=p*Math.cos(z*Math.PI/2);for(F=f*Math.sin(z*Math.PI/2)+m,D=0,z=P.length;D<z;D++){var j=e(P[D],s[D],F);r(j.x,j.y,-U)}for(A=0,T=S.length;A<T;A++)for(C=S[A],B=v[A],D=0,z=C.length;D<z;D++)r((j=e(C[D],B[D],F)).x,j.y,-U)}for(F=f+m,D=0;D<I;D++)j=l?e(t[D],N[D],F):t[D],_?(E.copy(x.normals[0]).multiplyScalar(j.x),w.copy(x.binormals[0]).multiplyScalar(j.y),M.copy(b[0]).add(E).add(w),r(M.x,M.y,M.z)):r(j.x,j.y,0);for(z=1;z<=d;z++)for(D=0;D<I;D++)j=l?e(t[D],N[D],F):t[D],_?(E.copy(x.normals[z]).multiplyScalar(j.x),w.copy(x.binormals[z]).multiplyScalar(j.y),M.copy(b[z]).add(E).add(w),r(M.x,M.y,M.z)):r(j.x,j.y,c/d*z);for(k=g-1;0<=k;k--){for(z=k/g,U=p*Math.cos(z*Math.PI/2),F=f*Math.sin(z*Math.PI/2)+m,D=0,z=P.length;D<z;D++)r((j=e(P[D],s[D],F)).x,j.y,c+U);for(A=0,T=S.length;A<T;A++)for(C=S[A],B=v[A],D=0,z=C.length;D<z;D++)j=e(C[D],B[D],F),_?r(j.x,j.y+b[d-1].y,b[d-1].x+U):r(j.x,j.y,c+U)}!function(){var t=V.length/3;if(l){var e=0*I;for(D=0;D<O;D++)o((R=L[D])[2]+e,R[1]+e,R[0]+e);for(e=I*(d+2*g),D=0;D<O;D++)o((R=L[D])[0]+e,R[1]+e,R[2]+e)}else{for(D=0;D<O;D++)o((R=L[D])[2],R[1],R[0]);for(D=0;D<O;D++)o((R=L[D])[0]+I*d,R[1]+I*d,R[2]+I*d)}G.addGroup(t,V.length/3-t,0)}(),function(){var t=V.length/3,e=0;for(n(P,e),e+=P.length,A=0,T=S.length;A<T;A++)n(C=S[A],e),e+=C.length;G.addGroup(t,V.length/3-t,1)}()}(t[e]);this.addAttribute("position",new L(V,3)),this.addAttribute("uv",new L(W,2)),this.computeVertexNormals()}function Ci(t,e,i){if(i.shapes=[],Array.isArray(t))for(var n=0,r=t.length;n<r;n++)i.shapes.push(t[n].uuid);else i.shapes.push(t.uuid);return void 0!==e.extrudePath&&(i.options.extrudePath=e.extrudePath.toJSON()),i}function Li(t,e){f.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new Pi(t,e)),this.mergeVertices()}function Pi(t,e){var i=(e=e||{}).font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new f;t=i.generateShapes(t,e.size),e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Ti.call(this,t,e),this.type="TextBufferGeometry"}function Ri(t,e,i,n,r,o,a){f.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Ii(t,e,i,n,r,o,a)),this.mergeVertices()}function Ii(t,e,i,n,r,o,a){P.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:o,thetaLength:a},t=t||1,e=Math.max(3,Math.floor(e)||8),i=Math.max(2,Math.floor(i)||6),n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;for(var s,c=Math.min(o+a,Math.PI),l=0,h=[],u=new Et,d=new Et,p=[],f=[],m=[],g=[],v=0;v<=i;v++){var y=[],b=v/i,x=0;for(0==v&&0==o?x=.5/e:v==i&&c==Math.PI&&(x=-.5/e),s=0;s<=e;s++){var w=s/e;u.x=-t*Math.cos(n+w*r)*Math.sin(o+b*a),u.y=t*Math.cos(o+b*a),u.z=t*Math.sin(n+w*r)*Math.sin(o+b*a),f.push(u.x,u.y,u.z),d.copy(u).normalize(),m.push(d.x,d.y,d.z),g.push(w+x,1-b),y.push(l++)}h.push(y)}for(v=0;v<i;v++)for(s=0;s<e;s++)t=h[v][s+1],n=h[v][s],r=h[v+1][s],a=h[v+1][s+1],(0!==v||0<o)&&p.push(t,n,a),(v!==i-1||c<Math.PI)&&p.push(n,r,a);this.setIndex(p),this.addAttribute("position",new L(f,3)),this.addAttribute("normal",new L(m,3)),this.addAttribute("uv",new L(g,2))}function Oi(t,e,i,n,r,o){f.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:o},this.fromBufferGeometry(new Di(t,e,i,n,r,o)),this.mergeVertices()}function Di(t,e,i,n,r,o){P.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:o},t=t||.5,e=e||1,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI,i=void 0!==i?Math.max(3,i):8;for(var a,s=[],c=[],l=[],h=[],u=t,d=(e-t)/(n=void 0!==n?Math.max(1,n):1),p=new Et,f=new wt,m=0;m<=n;m++){for(a=0;a<=i;a++)t=r+a/i*o,p.x=u*Math.cos(t),p.y=u*Math.sin(t),c.push(p.x,p.y,p.z),l.push(0,0,1),f.x=(p.x/e+1)/2,f.y=(p.y/e+1)/2,h.push(f.x,f.y);u+=d}for(m=0;m<n;m++)for(e=m*(i+1),a=0;a<i;a++)r=(t=a+e)+i+1,o=t+i+2,u=t+1,s.push(t,r,u),s.push(r,o,u);this.setIndex(s),this.addAttribute("position",new L(c,3)),this.addAttribute("normal",new L(l,3)),this.addAttribute("uv",new L(h,2))}function ki(t,e,i,n){f.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},this.fromBufferGeometry(new Ni(t,e,i,n)),this.mergeVertices()}function Ni(t,e,i,n){P.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},e=Math.floor(e)||12,i=i||0,n=n||2*Math.PI,n=uo.clamp(n,0,2*Math.PI);for(var r=[],o=[],a=[],s=1/e,c=new Et,l=new wt,h=0;h<=e;h++)for(var u=i+h*s*n,d=Math.sin(u),p=Math.cos(u),u=0;u<=t.length-1;u++)c.x=t[u].x*d,c.y=t[u].y,c.z=t[u].x*p,o.push(c.x,c.y,c.z),l.x=h/e,l.y=u/(t.length-1),a.push(l.x,l.y);for(h=0;h<e;h++)for(u=0;u<t.length-1;u++)s=(i=u+h*t.length)+t.length,c=i+t.length+1,l=i+1,r.push(i,s,l),r.push(s,c,l);if(this.setIndex(r),this.addAttribute("position",new L(o,3)),this.addAttribute("uv",new L(a,2)),this.computeVertexNormals(),n===2*Math.PI)for(n=this.attributes.normal.array,r=new Et,o=new Et,a=new Et,i=e*t.length*3,u=h=0;h<t.length;h++,u+=3)r.x=n[u+0],r.y=n[u+1],r.z=n[u+2],o.x=n[i+u+0],o.y=n[i+u+1],o.z=n[i+u+2],a.addVectors(r,o).normalize(),n[u+0]=n[i+u+0]=a.x,n[u+1]=n[i+u+1]=a.y,n[u+2]=n[i+u+2]=a.z}function zi(t,e){f.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new Bi(t,e)),this.mergeVertices()}function Bi(t,s){function e(t){var e,i=l.length/3,n=(t=t.extractPoints(s)).shape,r=t.holes;for(!1===Uc.isClockWise(n)&&(n=n.reverse()),t=0,e=r.length;t<e;t++){var o=r[t];!0===Uc.isClockWise(o)&&(r[t]=o.reverse())}var a=Uc.triangulateShape(n,r);for(t=0,e=r.length;t<e;t++)o=r[t],n=n.concat(o);for(t=0,e=n.length;t<e;t++)o=n[t],l.push(o.x,o.y,0),h.push(0,0,1),u.push(o.x,o.y);for(t=0,e=a.length;t<e;t++)n=a[t],c.push(n[0]+i,n[1]+i,n[2]+i),d+=3}P.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:s},s=s||12;var c=[],l=[],h=[],u=[],i=0,d=0;if(!1===Array.isArray(t))e(t);else for(var n=0;n<t.length;n++)e(t[n]),this.addGroup(i,d,n),i+=d,d=0;this.setIndex(c),this.addAttribute("position",new L(l,3)),this.addAttribute("normal",new L(h,3)),this.addAttribute("uv",new L(u,2))}function Fi(t,e){if(e.shapes=[],Array.isArray(t))for(var i=0,n=t.length;i<n;i++)e.shapes.push(t[i].uuid);else e.shapes.push(t.uuid);return e}function Ui(t,e){P.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e};var i=[];e=Math.cos(uo.DEG2RAD*(void 0!==e?e:1));var n,r=[0,0],o={},a=["a","b","c"];t.isBufferGeometry?(n=new f).fromBufferGeometry(t):n=t.clone(),n.mergeVertices(),n.computeFaceNormals(),t=n.vertices;for(var s=0,c=(n=n.faces).length;s<c;s++)for(var l=n[s],h=0;h<3;h++){var u=l[a[h]],d=l[a[(h+1)%3]];r[0]=Math.min(u,d),r[1]=Math.max(u,d),void 0===o[u=r[0]+","+r[1]]?o[u]={index1:r[0],index2:r[1],face1:s,face2:void 0}:o[u].face2=s}for(u in o)(void 0===(r=o[u]).face2||n[r.face1].normal.dot(n[r.face2].normal)<=e)&&(a=t[r.index1],i.push(a.x,a.y,a.z),a=t[r.index2],i.push(a.x,a.y,a.z));this.addAttribute("position",new L(i,3))}function ji(t,e,i,n,r,o,a,s){f.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:n,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new Hi(t,e,i,n,r,o,a,s)),this.mergeVertices()}function Hi(d,p,f,m,g,t,v,y){function e(t){for(var e=new wt,i=new Et,n=0,r=!0===t?d:p,o=!0===t?1:-1,a=_,s=1;s<=m;s++)w.push(0,A*o,0),E.push(0,o,0),M.push(.5,.5),_++;var c=_;for(s=0;s<=m;s++){var l=s/m*y+v,h=Math.cos(l),l=Math.sin(l);i.x=r*l,i.y=A*o,i.z=r*h,w.push(i.x,i.y,i.z),E.push(0,o,0),e.x=.5*h+.5,e.y=.5*l*o+.5,M.push(e.x,e.y),_++}for(s=0;s<m;s++)e=a+s,i=c+s,!0===t?x.push(i,i+1,e):x.push(i+1,i,e),n+=3;b.addGroup(T,n,!0===t?1:2),T+=n}P.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:d,radiusBottom:p,height:f,radialSegments:m,heightSegments:g,openEnded:t,thetaStart:v,thetaLength:y};var b=this;d=void 0!==d?d:1,p=void 0!==p?p:1,f=f||1,m=Math.floor(m)||8,g=Math.floor(g)||1,t=void 0!==t&&t,v=void 0!==v?v:0,y=void 0!==y?y:2*Math.PI;var x=[],w=[],E=[],M=[],_=0,S=[],A=f/2,T=0;!function(){for(var t=new Et,e=new Et,i=0,n=(p-d)/f,r=0;r<=g;r++){for(var o=[],a=r/g,s=a*(p-d)+d,c=0;c<=m;c++){var l=c/m,h=l*y+v,u=Math.sin(h),h=Math.cos(h);e.x=s*u,e.y=-a*f+A,e.z=s*h,w.push(e.x,e.y,e.z),t.set(u,n,h).normalize(),E.push(t.x,t.y,t.z),M.push(l,1-a),o.push(_++)}S.push(o)}for(c=0;c<m;c++)for(r=0;r<g;r++)t=S[r+1][c],e=S[r+1][c+1],n=S[r][c+1],x.push(S[r][c],t,n),x.push(t,e,n),i+=6;b.addGroup(T,i,0),T+=i}(),!1===t&&(0<d&&e(!0),0<p&&e(!1)),this.setIndex(x),this.addAttribute("position",new L(w,3)),this.addAttribute("normal",new L(E,3)),this.addAttribute("uv",new L(M,2))}function Gi(t,e,i,n,r,o,a){ji.call(this,0,t,e,i,n,r,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:o,thetaLength:a}}function Vi(t,e,i,n,r,o,a){Hi.call(this,0,t,e,i,n,r,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:o,thetaLength:a}}function Wi(t,e,i,n){f.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},this.fromBufferGeometry(new qi(t,e,i,n)),this.mergeVertices()}function qi(t,e,i,n){P.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},t=t||1,e=void 0!==e?Math.max(3,e):8,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI;var r=[],o=[],a=[],s=[],c=new Et,l=new wt;o.push(0,0,0),a.push(0,0,1),s.push(.5,.5);for(var h=0,u=3;h<=e;h++,u+=3){var d=i+h/e*n;c.x=t*Math.cos(d),c.y=t*Math.sin(d),o.push(c.x,c.y,c.z),a.push(0,0,1),l.x=(o[u]/t+1)/2,l.y=(o[u+1]/t+1)/2,s.push(l.x,l.y)}for(u=1;u<=e;u++)r.push(u,u+1,0);this.setIndex(r),this.addAttribute("position",new L(o,3)),this.addAttribute("normal",new L(a,3)),this.addAttribute("uv",new L(s,2))}function Xi(t){k.call(this),this.type="ShadowMaterial",this.color=new p(0),this.transparent=!0,this.setValues(t)}function Yi(t){N.call(this,t),this.type="RawShaderMaterial"}function $i(t){k.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new p(16777215),this.metalness=this.roughness=.5,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new p(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function Zi(t){$i.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoatRoughness=this.clearCoat=0,this.setValues(t)}function Ji(t){k.call(this),this.type="MeshPhongMaterial",this.color=new p(16777215),this.specular=new p(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new p(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function Qi(t){Ji.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function Ki(t){k.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.lights=this.fog=!1,this.setValues(t)}function tn(t){k.call(this),this.type="MeshLambertMaterial",this.color=new p(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new p(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function en(t){k.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new p(16777215),this.bumpMap=this.map=this.matcap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.lights=this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function nn(t){Ne.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}function rn(t,e,i,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(i),this.sampleValues=e,this.valueSize=i}function on(t,e,i,n){rn.call(this,t,e,i,n),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function an(t,e,i,n){rn.call(this,t,e,i,n)}function sn(t,e,i,n){rn.call(this,t,e,i,n)}function cn(t,e,i,n){if(void 0===t)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Vc.convertArray(e,this.TimeBufferType),this.values=Vc.convertArray(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}function ln(t,e,i){cn.call(this,t,e,i)}function hn(t,e,i,n){cn.call(this,t,e,i,n)}function un(t,e,i,n){cn.call(this,t,e,i,n)}function dn(t,e,i,n){rn.call(this,t,e,i,n)}function pn(t,e,i,n){cn.call(this,t,e,i,n)}function fn(t,e,i,n){cn.call(this,t,e,i,n)}function mn(t,e,i,n){cn.call(this,t,e,i,n)}function gn(t,e,i){this.name=t,this.tracks=i,this.duration=void 0!==e?e:-1,this.uuid=uo.generateUUID(),this.duration<0&&this.resetDuration()}function vn(t){if(void 0===t.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var e,i,n=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return un;case"vector":case"vector2":case"vector3":case"vector4":return mn;case"color":return hn;case"quaternion":return pn;case"bool":case"boolean":return ln;case"string":return fn}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);return void 0===t.times&&(e=[],i=[],Vc.flattenJSON(t.keys,e,i,"value"),t.times=e,t.values=i),void 0!==n.parse?n.parse(t):new n(t.name,t.times,t.values,t.interpolation)}function yn(t,e,i){var n=this,r=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(t){a++,!1===r&&void 0!==n.onStart&&n.onStart(t,o,a),r=!0},this.itemEnd=function(t){o++,void 0!==n.onProgress&&n.onProgress(t,o,a),o===a&&(r=!1,void 0!==n.onLoad)&&n.onLoad()},this.itemError=function(t){void 0!==n.onError&&n.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this}}function bn(t){this.manager=void 0!==t?t:qc}function xn(t){this.manager=void 0!==t?t:qc}function wn(t){this.manager=void 0!==t?t:qc,this._parser=null}function En(t){this.manager=void 0!==t?t:qc,this._parser=null}function Mn(t){this.manager=void 0!==t?t:qc}function _n(t){this.manager=void 0!==t?t:qc}function Sn(t){this.manager=void 0!==t?t:qc}function An(){this.type="Curve",this.arcLengthDivisions=200}function Tn(t,e,i,n,r,o,a,s){An.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=i||1,this.yRadius=n||1,this.aStartAngle=r||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function Cn(t,e,i,n,r,o){Tn.call(this,t,e,i,i,n,r,o),this.type="ArcCurve"}function Ln(){var s=0,c=0,l=0,h=0;return{initCatmullRom:function(t,e,i,n,r){l=-3*(s=e)+3*i-2*(c=t=r*(i-t))-(n=r*(n-e)),h=2*e-2*i+t+n},initNonuniformCatmullRom:function(t,e,i,n,r,o,a){l=-3*(s=e)+3*i-2*(c=t=((e-t)/r-(i-t)/(r+o)+(i-e)/o)*o)-(n=((i-e)/o-(n-e)/(o+a)+(n-i)/a)*o),h=2*e-2*i+t+n},calc:function(t){var e=t*t;return s+c*t+l*e+h*e*t}}}function Pn(t,e,i,n){An.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=i||"centripetal",this.tension=n||.5}function Rn(t,e,i,n,r){var o=t*t;return(2*i-2*n+(e=.5*(n-e))+(r=.5*(r-i)))*t*o+(-3*i+3*n-2*e-r)*o+e*t+i}function In(t,e,i,n){var r=1-t;return r*r*e+2*(1-t)*t*i+t*t*n}function On(t,e,i,n,r){var o=1-t,a=1-t;return o*o*o*e+3*a*a*t*i+3*(1-t)*t*t*n+t*t*t*r}function Dn(t,e,i,n){An.call(this),this.type="CubicBezierCurve",this.v0=t||new wt,this.v1=e||new wt,this.v2=i||new wt,this.v3=n||new wt}function kn(t,e,i,n){An.call(this),this.type="CubicBezierCurve3",this.v0=t||new Et,this.v1=e||new Et,this.v2=i||new Et,this.v3=n||new Et}function Nn(t,e){An.call(this),this.type="LineCurve",this.v1=t||new wt,this.v2=e||new wt}function zn(t,e){An.call(this),this.type="LineCurve3",this.v1=t||new Et,this.v2=e||new Et}function Bn(t,e,i){An.call(this),this.type="QuadraticBezierCurve",this.v0=t||new wt,this.v1=e||new wt,this.v2=i||new wt}function Fn(t,e,i){An.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new Et,this.v1=e||new Et,this.v2=i||new Et}function Un(t){An.call(this),this.type="SplineCurve",this.points=t||[]}function jn(){An.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Hn(t){jn.call(this),this.type="Path",this.currentPoint=new wt,t&&this.setFromPoints(t)}function Gn(t){Hn.call(this,t),this.uuid=uo.generateUUID(),this.type="Shape",this.holes=[]}function Vn(t,e){u.call(this),this.type="Light",this.color=new p(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function Wn(t,e,i){Vn.call(this,t,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(u.DefaultUp),this.updateMatrix(),this.groundColor=new p(e)}function qn(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new wt(512,512),this.map=null,this.matrix=new At}function Xn(){qn.call(this,new be(50,1,.5,500))}function Yn(t,e,i,n,r,o){Vn.call(this,t,e),this.type="SpotLight",this.position.copy(u.DefaultUp),this.updateMatrix(),this.target=new u,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==o?o:1,this.shadow=new Xn}function $n(t,e,i,n){Vn.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==i?i:0,this.decay=void 0!==n?n:1,this.shadow=new qn(new be(90,1,.5,500))}function Zn(t,e,i,n,r,o){ye.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==e?e:1,this.top=void 0!==i?i:1,this.bottom=void 0!==n?n:-1,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function Jn(){qn.call(this,new Zn(-5,5,5,-5,.5,500))}function Qn(t,e){Vn.call(this,t,e),this.type="DirectionalLight",this.position.copy(u.DefaultUp),this.updateMatrix(),this.target=new u,this.shadow=new Jn}function Kn(t,e){Vn.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function tr(t,e,i,n){Vn.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==i?i:10,this.height=void 0!==n?n:10}function er(t){this.manager=void 0!==t?t:qc,this.textures={}}function ir(){P.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function nr(t,e,i,n){"number"==typeof i&&(n=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),m.call(this,t,e,i),this.meshPerAttribute=n||1}function rr(t){this.manager=void 0!==t?t:qc}function or(t){this.manager=void 0!==t?t:qc,this.resourcePath=""}function ar(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==t?t:qc,this.options=void 0}function sr(){this.type="ShapePath",this.color=new p,this.subPaths=[],this.currentPath=null}function cr(t){this.type="Font",this.data=t}function lr(t){this.manager=void 0!==t?t:qc}function hr(){}function ur(t){this.manager=void 0!==t?t:qc}function dr(){this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new Et)}function pr(t,e){Vn.call(this,void 0,e),this.sh=void 0!==t?t:new dr}function fr(t,e,i){pr.call(this,void 0,i),t=(new p).set(t),i=(new p).set(e),e=new Et(t.r,t.g,t.b),t=new Et(i.r,i.g,i.b);var n=(i=Math.sqrt(Math.PI))*Math.sqrt(.75);this.sh.coefficients[0].copy(e).add(t).multiplyScalar(i),this.sh.coefficients[1].copy(e).sub(t).multiplyScalar(n)}function mr(t,e){pr.call(this,void 0,e),t=(new p).set(t),this.sh.coefficients[0].set(t.r,t.g,t.b).multiplyScalar(2*Math.sqrt(Math.PI))}function gr(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new be,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new be,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function vr(t,e,i,n){u.call(this),this.type="CubeCamera";var o=new be(90,1,t,e);o.up.set(0,-1,0),o.lookAt(new Et(1,0,0)),this.add(o);var a=new be(90,1,t,e);a.up.set(0,-1,0),a.lookAt(new Et(-1,0,0)),this.add(a);var s=new be(90,1,t,e);s.up.set(0,0,1),s.lookAt(new Et(0,1,0)),this.add(s);var c=new be(90,1,t,e);c.up.set(0,0,-1),c.lookAt(new Et(0,-1,0)),this.add(c);var l=new be(90,1,t,e);l.up.set(0,-1,0),l.lookAt(new Et(0,0,1)),this.add(l);var h=new be(90,1,t,e);h.up.set(0,-1,0),h.lookAt(new Et(0,0,-1)),this.add(h),n=n||{format:1022,magFilter:1006,minFilter:1006},this.renderTarget=new r(i,i,n),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var i=t.getRenderTarget(),n=this.renderTarget,r=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,o),t.setRenderTarget(n,1),t.render(e,a),t.setRenderTarget(n,2),t.render(e,s),t.setRenderTarget(n,3),t.render(e,c),t.setRenderTarget(n,4),t.render(e,l),n.texture.generateMipmaps=r,t.setRenderTarget(n,5),t.render(e,h),t.setRenderTarget(i)},this.clear=function(t,e,i,n){for(var r=t.getRenderTarget(),o=this.renderTarget,a=0;a<6;a++)t.setRenderTarget(o,a),t.clear(e,i,n);t.setRenderTarget(r)}}function yr(t){this.autoStart=void 0===t||t,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function br(){u.call(this),this.type="AudioListener",this.context=uh.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0}function xr(t){u.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.offset=this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function wr(t){xr.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function Er(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function Mr(t,e,i){switch(this.binding=t,this.valueSize=i,t=Float64Array,e){case"quaternion":e=this._slerp;break;case"string":case"bool":t=Array,e=this._select;break;default:e=this._lerp}this.buffer=new t(4*i),this._mixBufferRegion=e,this.referenceCount=this.useCount=this.cumulativeWeight=0}function _r(t,e,i){i=i||Sr.parseTrackName(e),this._targetGroup=t,this._bindings=t.subscribe_(e,i)}function Sr(t,e,i){this.path=e,this.parsedPath=i||Sr.parseTrackName(e),this.node=Sr.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function Ar(){this.uuid=uo.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,i=arguments.length;e!==i;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}function Tr(t,e,i){this._mixer=t,this._clip=e,this._localRoot=i||null,e=(t=e.tracks).length,i=Array(e);for(var n={endingStart:2400,endingEnd:2400},r=0;r!==e;++r){var o=t[r].createInterpolant(null);(i[r]=o).settings=n}this._interpolantSettings=n,this._interpolants=i,this._propertyBindings=Array(e),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function Cr(t){this._root=t,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function Lr(t,e){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=e),this.value=t}function Pr(t,e,i){Ce.call(this,t,e),this.meshPerAttribute=i||1}function Rr(t,e,i,n){this.ray=new z(t,e),this.near=i||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Ir(t,e){return t.distance-e.distance}function Or(t,e,i,n){if(!1!==t.visible&&(t.raycast(e,i),!0===n)){n=0;for(var r=(t=t.children).length;n<r;n++)Or(t[n],e,i,!0)}}function Dr(t,e,i){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==i?i:0,this}function kr(t,e,i){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==i?i:0,this}function Nr(t,e){this.min=void 0!==t?t:new wt(1/0,1/0),this.max=void 0!==e?e:new wt(-1/0,-1/0)}function zr(t,e){this.start=void 0!==t?t:new Et,this.end=void 0!==e?e:new Et}function Br(t){u.call(this),this.material=t,this.render=function(){}}function Fr(t,e,i,n){this.object=t,this.size=void 0!==e?e:1,t=void 0!==i?i:16711680,n=void 0!==n?n:1,e=0,(i=this.object.geometry)&&i.isGeometry?e=3*i.faces.length:i&&i.isBufferGeometry&&(e=i.attributes.normal.count),i=new P,e=new L(6*e,3),i.addAttribute("position",e),Be.call(this,i,new Ne({color:t,linewidth:n})),this.matrixAutoUpdate=!1,this.update()}function Ur(t,e){u.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e,t=new P,e=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var i=0,n=1;i<32;i++,n++){var r=i/32*Math.PI*2,o=n/32*Math.PI*2;e.push(Math.cos(r),Math.sin(r),1,Math.cos(o),Math.sin(o),1)}t.addAttribute("position",new L(e,3)),e=new Ne({fog:!1}),this.cone=new Be(t,e),this.add(this.cone),this.update()}function jr(t){for(var e=function t(e){var i=[];e&&e.isBone&&i.push(e);for(var n=0;n<e.children.length;n++)i.push.apply(i,t(e.children[n]));return i}(t),i=new P,n=[],r=[],o=new p(0,0,1),a=new p(0,1,0),s=0;s<e.length;s++){var c=e[s];c.parent&&c.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),r.push(o.r,o.g,o.b),r.push(a.r,a.g,a.b))}i.addAttribute("position",new L(n,3)),i.addAttribute("color",new L(r,3)),n=new Ne({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0}),Be.call(this,i,n),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function Hr(t,e,i){this.light=t,this.light.updateMatrixWorld(),this.color=i,t=new Ii(e,4,2),e=new F({wireframe:!0,fog:!1}),U.call(this,t,e),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Gr(t,e){this.type="RectAreaLightHelper",this.light=t,this.color=e,(t=new P).addAttribute("position",new L([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),t.computeBoundingSphere(),e=new Ne({fog:!1}),ze.call(this,t,e),(t=new P).addAttribute("position",new L([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),t.computeBoundingSphere(),this.add(new U(t,new F({side:1,fog:!1}))),this.update()}function Vr(t,e,i){u.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,(t=new ti(e)).rotateY(.5*Math.PI),this.material=new F({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=2),e=t.getAttribute("position"),e=new Float32Array(3*e.count),t.addAttribute("color",new m(e,3)),this.add(new U(t,this.material)),this.update()}function Wr(t,e){this.lightProbe=t,this.size=e,t=new N({defines:{GAMMA_OUTPUT:""},uniforms:{sh:{value:this.lightProbe.sh.coefficients},intensity:{value:this.lightProbe.intensity}},vertexShader:"varying vec3 vNormal;\nvoid main() {\n\tvNormal = normalize( normalMatrix * normal );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"#define RECIPROCAL_PI 0.318309886\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n\t// matrix is assumed to be orthogonal\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n}\nvec3 linearToOutput( in vec3 a ) {\n\t#ifdef GAMMA_OUTPUT\n\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n\t#else\n\t\treturn a;\n\t#endif\n}\n// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\t// normal is assumed to have unit length\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\t// band 0\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\t// band 1\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\t// band 2\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nuniform vec3 sh[ 9 ]; // sh coefficients\nuniform float intensity; // light probe intensity\nvarying vec3 vNormal;\nvoid main() {\n\tvec3 normal = normalize( vNormal );\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, sh );\n\tvec3 outgoingLight = RECIPROCAL_PI * irradiance * intensity;\n\toutgoingLight = linearToOutput( outgoingLight );\n\tgl_FragColor = vec4( outgoingLight, 1.0 );\n}"}),e=new Ii(1,32,16),U.call(this,e,t),this.onBeforeRender()}function qr(t,e,i,n){t=t||10,e=e||10,i=new p(void 0!==i?i:4473924),n=new p(void 0!==n?n:8947848);var r=e/2,o=t/e,a=t/2;t=[];for(var s=[],c=0,l=0,h=-a;c<=e;c++,h+=o){t.push(-a,0,h,a,0,h),t.push(h,0,-a,h,0,a);var u=c===r?i:n;u.toArray(s,l),l+=3,u.toArray(s,l),l+=3,u.toArray(s,l),l+=3,u.toArray(s,l),l+=3}(e=new P).addAttribute("position",new L(t,3)),e.addAttribute("color",new L(s,3)),i=new Ne({vertexColors:2}),Be.call(this,e,i)}function Xr(t,e,i,n,r,o){t=t||10,e=e||16,i=i||8,n=n||64,r=new p(void 0!==r?r:4473924),o=new p(void 0!==o?o:8947848);for(var a=[],s=[],c=0;c<=e;c++){var l=c/e*2*Math.PI,h=Math.sin(l)*t,l=Math.cos(l)*t;a.push(0,0,0),a.push(h,0,l);var u=1&c?r:o;s.push(u.r,u.g,u.b),s.push(u.r,u.g,u.b)}for(c=0;c<=i;c++){u=1&c?r:o;var d=t-t/i*c;for(e=0;e<n;e++)l=e/n*2*Math.PI,h=Math.sin(l)*d,l=Math.cos(l)*d,a.push(h,0,l),s.push(u.r,u.g,u.b),l=(e+1)/n*2*Math.PI,h=Math.sin(l)*d,l=Math.cos(l)*d,a.push(h,0,l),s.push(u.r,u.g,u.b)}(t=new P).addAttribute("position",new L(a,3)),t.addAttribute("color",new L(s,3)),a=new Ne({vertexColors:2}),Be.call(this,t,a)}function Yr(t,e,i,n){this.audio=t,this.range=e||1,this.divisionsInnerAngle=i||16,this.divisionsOuterAngle=n||2,t=new P,e=new Float32Array(3*(3*(this.divisionsInnerAngle+2*this.divisionsOuterAngle)+3)),t.addAttribute("position",new m(e,3)),e=new Ne({color:65280}),i=new Ne({color:16776960}),ze.call(this,t,[i,e]),this.update()}function $r(t,e,i,n){this.object=t,this.size=void 0!==e?e:1,t=void 0!==i?i:16776960,n=void 0!==n?n:1,e=0,(i=this.object.geometry)&&i.isGeometry?e=i.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead."),i=new P,e=new L(6*e,3),i.addAttribute("position",e),Be.call(this,i,new Ne({color:t,linewidth:n})),this.matrixAutoUpdate=!1,this.update()}function Zr(t,e,i){u.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,void 0===e&&(e=1),(t=new P).addAttribute("position",new L([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3)),e=new Ne({fog:!1}),this.lightPlane=new ze(t,e),this.add(this.lightPlane),(t=new P).addAttribute("position",new L([0,0,0,0,0,1],3)),this.targetLine=new ze(t,e),this.add(this.targetLine),this.update()}function Jr(t){function e(t,e,i){n(t,i),n(e,i)}function n(t,e){o.push(0,0,0),a.push(e.r,e.g,e.b),void 0===s[t]&&(s[t]=[]),s[t].push(o.length/3-1)}var i=new P,r=new Ne({color:16777215,vertexColors:1}),o=[],a=[],s={},c=new p(16755200),l=new p(16711680),h=new p(43775),u=new p(16777215),d=new p(3355443);e("n1","n2",c),e("n2","n4",c),e("n4","n3",c),e("n3","n1",c),e("f1","f2",c),e("f2","f4",c),e("f4","f3",c),e("f3","f1",c),e("n1","f1",c),e("n2","f2",c),e("n3","f3",c),e("n4","f4",c),e("p","n1",l),e("p","n2",l),e("p","n3",l),e("p","n4",l),e("u1","u2",h),e("u2","u3",h),e("u3","u1",h),e("c","t",u),e("p","c",d),e("cn1","cn2",d),e("cn3","cn4",d),e("cf1","cf2",d),e("cf3","cf4",d),i.addAttribute("position",new L(o,3)),i.addAttribute("color",new L(a,3)),Be.call(this,i,r),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}function Qr(t,e){this.object=t,void 0===e&&(e=16776960),t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var i=new Float32Array(24),n=new P;n.setIndex(new m(t,1)),n.addAttribute("position",new m(i,3)),Be.call(this,n,new Ne({color:e})),this.matrixAutoUpdate=!1,this.update()}function Kr(t,e){this.type="Box3Helper",this.box=t,t=void 0!==e?e:16776960,e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var i=new P;i.setIndex(new m(e,1)),i.addAttribute("position",new L([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Be.call(this,i,new Ne({color:t})),this.geometry.computeBoundingSphere()}function to(t,e,i){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e,t=void 0!==i?i:16776960,(e=new P).addAttribute("position",new L([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),e.computeBoundingSphere(),ze.call(this,e,new Ne({color:t})),(e=new P).addAttribute("position",new L([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),e.computeBoundingSphere(),this.add(new U(e,new F({color:t,opacity:.2,transparent:!0,depthWrite:!1})))}function eo(t,e,i,n,r,o){u.call(this),void 0===t&&(t=new Et(0,0,1)),void 0===e&&(e=new Et(0,0,0)),void 0===i&&(i=1),void 0===n&&(n=16776960),void 0===r&&(r=.2*i),void 0===o&&(o=.2*r),void 0===ah&&((ah=new P).addAttribute("position",new L([0,0,0,0,1,0],3)),(sh=new Hi(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new ze(ah,new Ne({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new U(sh,new F({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(i,r,o)}function io(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t];(t=new P).addAttribute("position",new L(e,3)),t.addAttribute("color",new L([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),e=new Ne({vertexColors:2}),Be.call(this,t,e)}function no(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Pn.call(this,t),this.type="catmullrom",this.closed=!0}function ro(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Pn.call(this,t),this.type="catmullrom"}function oo(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Pn.call(this,t),this.type="catmullrom"}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:0<t?1:+t}),!1=="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),Object.assign(e.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)},removeEventListener:function(t,e){void 0!==this._listeners&&(void 0!==(t=this._listeners[t])&&(-1!==(e=t.indexOf(e))&&t.splice(e,1)))},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var i=0,n=(e=e.slice(0)).length;i<n;i++)e[i].call(this,t)}}}});var ao,so,co,lo,ho,uo={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var r=[],t=0;t<256;t++)r[t]=(t<16?"0":"")+t.toString(16);return function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(r[255&t]+r[t>>8&255]+r[t>>16&255]+r[t>>24&255]+"-"+r[255&e]+r[e>>8&255]+"-"+r[e>>16&15|64]+r[e>>24&255]+"-"+r[63&i|128]+r[i>>8&255]+"-"+r[i>>16&255]+r[i>>24&255]+r[255&n]+r[n>>8&255]+r[n>>16&255]+r[n>>24&255]).toUpperCase()}}(),clamp:function(t,e,i){return Math.max(e,Math.min(i,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)},lerp:function(t,e,i){return(1-i)*t+i*e},smoothstep:function(t,e,i){return t<=e?0:i<=t?1:(t=(t-e)/(i-e))*t*(3-2*t)},smootherstep:function(t,e,i){return t<=e?0:i<=t?1:(t=(t-e)/(i-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*uo.DEG2RAD},radToDeg:function(t){return t*uo.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};Object.defineProperties(wt.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(wt.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,i=this.y;return t=t.elements,this.x=t[0]*e+t[3]*i+t[6],this.y=t[1]*e+t[4]*i+t[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x;return e*e+(t=this.y-t.y)*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var i=Math.cos(e);e=Math.sin(e);var n=this.x-t.x,r=this.y-t.y;return this.x=n*i-r*e+t.x,this.y=n*e+r*i+t.y,this}}),Object.assign(S,{slerp:function(t,e,i,n){return i.copy(t).slerp(e,n)},slerpFlat:function(t,e,i,n,r,o,a){var s=i[n+0],c=i[n+1],l=i[n+2];i=i[n+3],n=r[o+0];var h,u,d,p=r[o+1],f=r[o+2];i===(r=r[o+3])&&s===n&&c===p&&l===f||(o=1-a,u=0<=(h=s*n+c*p+l*f+i*r)?1:-1,(d=1-h*h)>Number.EPSILON&&(d=Math.sqrt(d),h=Math.atan2(d,h*u),o=Math.sin(o*h)/d,a=Math.sin(a*h)/d),s=s*o+n*(u*=a),c=c*o+p*u,l=l*o+f*u,i=i*o+r*u,o===1-a&&(s*=a=1/Math.sqrt(s*s+c*c+l*l+i*i),c*=a,l*=a,i*=a)),t[e]=s,t[e+1]=c,t[e+2]=l,t[e+3]=i}}),Object.defineProperties(S.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(S.prototype,{isQuaternion:!0,set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=t._x,n=t._y,r=t._z;t=t.order;var o=Math.cos,a=Math.sin,s=o(i/2),c=o(n/2),o=o(r/2),i=a(i/2),n=a(n/2),r=a(r/2);return"XYZ"===t?(this._x=i*c*o+s*n*r,this._y=s*n*o-i*c*r,this._z=s*c*r+i*n*o,this._w=s*c*o-i*n*r):"YXZ"===t?(this._x=i*c*o+s*n*r,this._y=s*n*o-i*c*r,this._z=s*c*r-i*n*o,this._w=s*c*o+i*n*r):"ZXY"===t?(this._x=i*c*o-s*n*r,this._y=s*n*o+i*c*r,this._z=s*c*r+i*n*o,this._w=s*c*o-i*n*r):"ZYX"===t?(this._x=i*c*o-s*n*r,this._y=s*n*o+i*c*r,this._z=s*c*r-i*n*o,this._w=s*c*o+i*n*r):"YZX"===t?(this._x=i*c*o+s*n*r,this._y=s*n*o+i*c*r,this._z=s*c*r-i*n*o,this._w=s*c*o-i*n*r):"XZY"===t&&(this._x=i*c*o-s*n*r,this._y=s*n*o-i*c*r,this._z=s*c*r+i*n*o,this._w=s*c*o+i*n*r),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){e/=2;var i=Math.sin(e);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(e),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e=t.elements,i=e[0];t=e[4];var n=e[8],r=e[1],o=e[5],a=e[9],s=e[2],c=e[6],l=i+o+(e=e[10]);return 0<l?(i=.5/Math.sqrt(l+1),this._w=.25/i,this._x=(c-a)*i,this._y=(n-s)*i,this._z=(r-t)*i):o<i&&e<i?(i=2*Math.sqrt(1+i-o-e),this._w=(c-a)/i,this._x=.25*i,this._y=(t+r)/i,this._z=(n+s)/i):e<o?(i=2*Math.sqrt(1+o-i-e),this._w=(n-s)/i,this._x=(t+r)/i,this._y=.25*i,this._z=(a+c)/i):(i=2*Math.sqrt(1+e-i-o),this._w=(r-t)/i,this._x=(n+s)/i,this._y=(a+c)/i,this._z=.25*i),this.onChangeCallback(),this},setFromUnitVectors:function(t,e){var i=t.dot(e)+1;return i<1e-6?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0):(this._x=0,this._y=-t.z,this._z=t.y)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x),this._w=i,this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(uo.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var i=this.angleTo(t);return 0===i||this.slerp(t,Math.min(1,e/i)),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._z=this._y=this._x=0,this._w=1):(t=1/t,this._x*=t,this._y*=t,this._z*=t,this._w*=t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var i=t._x,n=t._y,r=t._z;t=t._w;var o=e._x,a=e._y,s=e._z;return e=e._w,this._x=i*e+t*o+n*s-r*a,this._y=n*e+t*a+r*o-i*s,this._z=r*e+t*s+i*a-n*o,this._w=t*e-i*o-n*a-r*s,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var i=this._x,n=this._y,r=this._z,o=this._w;if((s=o*t._w+i*t._x+n*t._y+r*t._z)<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),1<=s)return this._w=o,this._x=i,this._y=n,this._z=r,this;if((t=1-s*s)<=Number.EPSILON)return s=1-e,this._w=s*o+e*this._w,this._x=s*i+e*this._x,this._y=s*n+e*this._y,this._z=s*r+e*this._z,this.normalize();t=Math.sqrt(t);var a=Math.atan2(t,s),s=Math.sin((1-e)*a)/t;return e=Math.sin(e*a)/t,this._w=o*s+this._w*e,this._x=i*s+this._x*e,this._y=n*s+this._y*e,this._z=r*s+this._z*e,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(Et.prototype,{isVector3:!0,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setScalar:function(t){return this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:(lo=new S,function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(lo.setFromEuler(t))}),applyAxisAngle:(co=new S,function(t,e){return this.applyQuaternion(co.setFromAxisAngle(t,e))}),applyMatrix3:function(t){var e=this.x,i=this.y,n=this.z;return t=t.elements,this.x=t[0]*e+t[3]*i+t[6]*n,this.y=t[1]*e+t[4]*i+t[7]*n,this.z=t[2]*e+t[5]*i+t[8]*n,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=1/((t=t.elements)[3]*e+t[7]*i+t[11]*n+t[15]);return this.x=(t[0]*e+t[4]*i+t[8]*n+t[12])*r,this.y=(t[1]*e+t[5]*i+t[9]*n+t[13])*r,this.z=(t[2]*e+t[6]*i+t[10]*n+t[14])*r,this},applyQuaternion:function(t){var e=this.x,i=this.y,n=this.z,r=t.x,o=t.y,a=t.z,s=(t=t.w)*e+o*n-a*i,c=t*i+a*e-r*n,l=t*n+r*i-o*e,e=-r*e-o*i-a*n;return this.x=s*t+e*-r+c*-a-l*-o,this.y=c*t+e*-o+l*-r-s*-a,this.z=l*t+e*-a+s*-o-c*-r,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,i=this.y,n=this.z;return t=t.elements,this.x=t[0]*e+t[4]*i+t[8]*n,this.y=t[1]*e+t[5]*i+t[9]*n,this.z=t[2]*e+t[6]*i+t[10]*n,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var i=t.x,n=t.y;t=t.z;var r=e.x,o=e.y;return e=e.z,this.x=n*e-t*o,this.y=t*r-i*e,this.z=i*o-n*r,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:(so=new Et,function(t){return so.copy(this).projectOnVector(t),this.sub(so)}),reflect:(ao=new Et,function(t){return this.sub(ao.copy(t).multiplyScalar(2*this.dot(t)))}),angleTo:function(t){return t=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq()),Math.acos(uo.clamp(t,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i+(t=this.z-t.z)*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,i){var n=Math.sin(e)*t;return this.x=n*Math.sin(i),this.y=Math.cos(e)*t,this.z=n*Math.cos(i),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){return t=t.elements,this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length();return t=this.setFromMatrixColumn(t,2).length(),this.x=e,this.y=i,this.z=t,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}}),Object.assign(g.prototype,{isMatrix3:!0,set:function(t,e,i,n,r,o,a,s,c){var l=this.elements;return l[0]=t,l[1]=n,l[2]=a,l[3]=e,l[4]=r,l[5]=s,l[6]=i,l[7]=o,l[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements;return t=t.elements,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},setFromMatrix4:function(t){return t=t.elements,this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:(ho=new Et,function(t){for(var e=0,i=t.count;e<i;e++)ho.x=t.getX(e),ho.y=t.getY(e),ho.z=t.getZ(e),ho.applyMatrix3(this),t.setXYZ(e,ho.x,ho.y,ho.z);return t}),multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,n=e.elements;e=this.elements,t=i[0];var r=i[3],o=i[6],a=i[1],s=i[4],c=i[7],l=i[2],h=i[5],i=i[8],u=n[0],d=n[3],p=n[6],f=n[1],m=n[4],g=n[7],v=n[2],y=n[5],n=n[8];return e[0]=t*u+r*f+o*v,e[3]=t*d+r*m+o*y,e[6]=t*p+r*g+o*n,e[1]=a*u+s*f+c*v,e[4]=a*d+s*m+c*y,e[7]=a*p+s*g+c*n,e[2]=l*u+h*f+i*v,e[5]=l*d+h*m+i*y,e[8]=l*p+h*g+i*n,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],c=t[7];return e*o*(t=t[8])-e*a*c-i*r*t+i*a*s+n*r*c-n*o*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var i=t.elements;t=this.elements;var n=i[0],r=i[1],o=i[2],a=i[3],s=i[4],c=i[5],l=i[6],h=i[7],u=(i=i[8])*s-c*h,d=c*l-i*a,p=h*a-s*l,f=n*u+r*d+o*p;if(0!=f)return e=1/f,t[0]=u*e,t[1]=(o*h-i*r)*e,t[2]=(c*r-o*s)*e,t[3]=d*e,t[4]=(i*n-o*l)*e,t[5]=(o*a-c*n)*e,t[6]=p*e,t[7]=(r*l-h*n)*e,t[8]=(s*n-r*a)*e,this;if(!0===e)throw Error("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");return console.warn("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0"),this.identity()},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,i,n,r,o,a){var s=Math.cos(r);r=Math.sin(r),this.set(i*s,i*r,-i*(s*o+r*a)+o+t,-n*r,n*s,-n*(-r*o+s*a)+a+e,0,0,1)},scale:function(t,e){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=e,i[4]*=e,i[7]*=e,this},rotate:function(t){var e=Math.cos(t);t=Math.sin(t);var i=this.elements,n=i[0],r=i[3],o=i[6],a=i[1],s=i[4],c=i[7];return i[0]=e*n+t*a,i[3]=e*r+t*s,i[6]=e*o+t*c,i[1]=-t*n+e*a,i[4]=-t*r+e*s,i[7]=-t*o+e*c,this},translate:function(t,e){var i=this.elements;return i[0]+=t*i[2],i[3]+=t*i[5],i[6]+=t*i[8],i[1]+=e*i[2],i[4]+=e*i[5],i[7]+=e*i[8],this},equals:function(t){var e=this.elements;t=t.elements;for(var i=0;i<9;i++)if(e[i]!==t[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;i<9;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}});var po,fo,mo,go,vo,yo,bo,xo,wo,Eo,Mo,_o,So,Ao,To,Co,Lo,Po,Ro,Io,Oo,Do,ko,No,zo,Bo,Fo,Uo,jo,Ho,Go,Vo,Wo,qo,Xo,Yo,$o,Zo,Jo,Qo,Ko={getDataURL:function(t){return"undefined"==typeof HTMLCanvasElement?t.src:(t instanceof HTMLCanvasElement||(void 0===po&&(po=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),po.width=t.width,po.height=t.height,e=po.getContext("2d"),t instanceof ImageData?e.putImageData(t,0,0):e.drawImage(t,0,0,t.width,t.height),t=po),2048<t.width||2048<t.height?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png"));var e}},ta=0;function ea(t){for(var e=0,i=t.length-3;e<=i;e+=3){So.fromArray(t,e);var n=To.x*Math.abs(So.x)+To.y*Math.abs(So.y)+To.z*Math.abs(So.z),r=bo.dot(So),o=xo.dot(So),a=wo.dot(So);if(Math.max(-Math.max(r,o,a),Math.min(r,o,a))>n)return!1}return!0}function ia(t){var e=t.geometry;if(void 0!==e)if(e.isGeometry)for(e=e.vertices,Ro=0,Io=e.length;Ro<Io;Ro++)Oo.copy(e[Ro]),Oo.applyMatrix4(t.matrixWorld),Po.expandByPoint(Oo);else if(e.isBufferGeometry&&void 0!==(e=e.attributes.position))for(Ro=0,Io=e.count;Ro<Io;Ro++)Oo.fromBufferAttribute(e,Ro).applyMatrix4(t.matrixWorld),Po.expandByPoint(Oo)}d.DEFAULT_IMAGE=void 0,d.DEFAULT_MAPPING=300,d.prototype=Object.assign(Object.create(e.prototype),{constructor:d,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=uo.generateUUID()),!e&&void 0===t.images[n.uuid]){if(Array.isArray(n))for(var r=[],o=0,a=n.length;o<a;o++)r.push(Ko.getDataURL(n[o]));else r=Ko.getDataURL(n);t.images[n.uuid]={uuid:n.uuid,url:r}}i.image=n.uuid}return e||(t.textures[this.uuid]=i),i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||1<t.x)switch(this.wrapS){case 1e3:t.x-=Math.floor(t.x);break;case 1001:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||1<t.y)switch(this.wrapT){case 1e3:t.y-=Math.floor(t.y);break;case 1001:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(d.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Mt.prototype,{isVector4:!0,set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},setScalar:function(t){return this.w=this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=this.w;return t=t.elements,this.x=t[0]*e+t[4]*i+t[8]*n+t[12]*r,this.y=t[1]*e+t[5]*i+t[9]*n+t[13]*r,this.z=t[2]*e+t[6]*i+t[10]*n+t[14]*r,this.w=t[3]*e+t[7]*i+t[11]*n+t[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.z=this.y=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e=(t=t.elements)[0],i=t[4],n=t[8],r=t[1],o=t[5],a=t[9],s=t[2],c=t[6],l=t[10];return Math.abs(i-r)<.01&&Math.abs(n-s)<.01&&Math.abs(a-c)<.01?Math.abs(i+r)<.1&&Math.abs(n+s)<.1&&Math.abs(a+c)<.1&&Math.abs(e+o+l-3)<.1?this.set(1,0,0,0):(t=Math.PI,l=(l+1)/2,i=(i+r)/4,n=(n+s)/4,a=(a+c)/4,(o=(o+1)/2)<(e=(e+1)/2)&&l<e?i=e<.01?(c=0,s=.707106781):(s=i/(c=Math.sqrt(e)),n/c):l<o?i=o<.01?(s=0,c=.707106781):(c=i/(s=Math.sqrt(o)),a/s):l<.01?(s=c=.707106781,i=0):(c=n/(i=Math.sqrt(l)),s=a/i),this.set(c,s,i,t)):(t=Math.sqrt((c-a)*(c-a)+(n-s)*(n-s)+(r-i)*(r-i)),Math.abs(t)<.001&&(t=1),this.x=(c-a)/t,this.y=(n-s)/t,this.z=(r-i)/t,this.w=Math.acos((e+o+l-1)/2)),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return void 0===fo&&(fo=new Mt,mo=new Mt),fo.set(t,t,t,t),mo.set(e,e,e,e),this.clamp(fo,mo)},clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),C.prototype=Object.assign(Object.create(e.prototype),{constructor:C,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),i.prototype=Object.assign(Object.create(C.prototype),{constructor:i,isWebGLMultisampleRenderTarget:!0,copy:function(t){return C.prototype.copy.call(this,t),this.samples=t.samples,this}}),((r.prototype=Object.create(C.prototype)).constructor=r).prototype.isWebGLRenderTargetCube=!0,((_t.prototype=Object.create(d.prototype)).constructor=_t).prototype.isDataTexture=!0,Object.assign(n.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,i=1/0,n=1/0,r=-1/0,o=-1/0,a=-1/0,s=0,c=t.length;s<c;s+=3){var l=t[s],h=t[s+1],u=t[s+2];l<e&&(e=l),h<i&&(i=h),u<n&&(n=u),r<l&&(r=l),o<h&&(o=h),a<u&&(a=u)}return this.min.set(e,i,n),this.max.set(r,o,a),this},setFromBufferAttribute:function(t){for(var e=1/0,i=1/0,n=1/0,r=-1/0,o=-1/0,a=-1/0,s=0,c=t.count;s<c;s++){var l=t.getX(s),h=t.getY(s),u=t.getZ(s);l<e&&(e=l),h<i&&(i=h),u<n&&(n=u),r<l&&(r=l),o<h&&(o=h),a<u&&(a=u)}return this.min.set(e,i,n),this.max.set(r,o,a),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:(Do=new Et,function(t,e){return e=Do.copy(e).multiplyScalar(.5),this.min.copy(t).sub(e),this.max.copy(t).add(e),this}),setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new Et),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new Et),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:(Oo=new Et,function(t){return Po=this,t.updateMatrixWorld(!0),t.traverse(ia),this}),containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new Et),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:(Lo=new Et,function(t){return this.clampPoint(t.center,Lo),Lo.distanceToSquared(t.center)<=t.radius*t.radius}),intersectsPlane:function(t){var e,i=0<t.normal.x?(e=t.normal.x*this.min.x,t.normal.x*this.max.x):(e=t.normal.x*this.max.x,t.normal.x*this.min.x);return 0<t.normal.y?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),0<t.normal.z?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant},intersectsTriangle:(bo=new Et,xo=new Et,wo=new Et,Eo=new Et,Mo=new Et,_o=new Et,So=new Et,Ao=new Et,To=new Et,Co=new Et,function(t){return!this.isEmpty()&&(this.getCenter(Ao),To.subVectors(this.max,Ao),bo.subVectors(t.a,Ao),xo.subVectors(t.b,Ao),wo.subVectors(t.c,Ao),Eo.subVectors(xo,bo),Mo.subVectors(wo,xo),_o.subVectors(bo,wo),!!ea(t=[0,-Eo.z,Eo.y,0,-Mo.z,Mo.y,0,-_o.z,_o.y,Eo.z,0,-Eo.x,Mo.z,0,-Mo.x,_o.z,0,-_o.x,-Eo.y,Eo.x,0,-Mo.y,Mo.x,0,-_o.y,_o.x,0])&&(!!ea(t=[1,0,0,0,1,0,0,0,1])&&(Co.crossVectors(Eo,Mo),ea(t=[Co.x,Co.y,Co.z]))))}),clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new Et),e.copy(t).clamp(this.min,this.max)},distanceToPoint:(yo=new Et,function(t){return yo.copy(t).clamp(this.min,this.max).sub(t).length()}),getBoundingSphere:(vo=new Et,function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(vo).length(),t}),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:(go=[new Et,new Et,new Et,new Et,new Et,new Et,new Et,new Et],function(t){return this.isEmpty()||(go[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),go[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),go[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),go[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),go[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),go[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),go[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),go[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(go)),this}),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(h.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:(ko=new n,function(t,e){var i=this.center;void 0!==e?i.copy(e):ko.setFromPoints(t).getCenter(i);for(var n=e=0,r=t.length;n<r;n++)e=Math.max(e,i.distanceToSquared(t[n]));return this.radius=Math.sqrt(e),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var i=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new Et),e.copy(t),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new n),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius*=t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(v.prototype,{set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:(Fo=new Et,Uo=new Et,function(t,e,i){return e=Fo.subVectors(i,e).cross(Uo.subVectors(t,e)).normalize(),this.setFromNormalAndCoplanarPoint(e,t),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new Et),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:(Bo=new Et,function(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new Et);var i=t.delta(Bo),n=this.normal.dot(i);if(0===n){if(0===this.distanceToPoint(t.start))return e.copy(t.start)}else if(!((n=-(t.start.dot(this.normal)+this.constant)/n)<0||1<n))return e.copy(i).multiplyScalar(n).add(t.start)}),intersectsLine:function(t){var e=this.distanceToPoint(t.start);return t=this.distanceToPoint(t.end),e<0&&0<t||t<0&&0<e},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new Et),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:(No=new Et,zo=new g,function(t,e){return e=e||zo.getNormalMatrix(t),t=this.coplanarPoint(No).applyMatrix4(t),e=this.normal.applyMatrix3(e).normalize(),this.constant=-t.dot(e),this}),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}),Object.assign(St.prototype,{set:function(t,e,i,n,r,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(i),a[3].copy(n),a[4].copy(r),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,i=0;i<6;i++)e[i].copy(t.planes[i]);return this},setFromMatrix:function(t){var e=this.planes;t=(g=t.elements)[0];var i=g[1],n=g[2],r=g[3],o=g[4],a=g[5],s=g[6],c=g[7],l=g[8],h=g[9],u=g[10],d=g[11],p=g[12],f=g[13],m=g[14],g=g[15];return e[0].setComponents(r-t,c-o,d-l,g-p).normalize(),e[1].setComponents(r+t,c+o,d+l,g+p).normalize(),e[2].setComponents(r+i,c+a,d+h,g+f).normalize(),e[3].setComponents(r-i,c-a,d-h,g-f).normalize(),e[4].setComponents(r-n,c-s,d-u,g-m).normalize(),e[5].setComponents(r+n,c+s,d+u,g+m).normalize(),this},intersectsObject:(Go=new h,function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Go.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Go)}),intersectsSprite:(Ho=new h,function(t){return Ho.center.set(0,0,0),Ho.radius=.7071067811865476,Ho.applyMatrix4(t.matrixWorld),this.intersectsSphere(Ho)}),intersectsSphere:function(t){var e=this.planes,i=t.center;t=-t.radius;for(var n=0;n<6;n++)if(e[n].distanceToPoint(i)<t)return!1;return!0},intersectsBox:(jo=new Et,function(t){for(var e=this.planes,i=0;i<6;i++){var n=e[i];if(jo.x=0<n.normal.x?t.max.x:t.min.x,jo.y=0<n.normal.y?t.max.y:t.min.y,jo.z=0<n.normal.z?t.max.z:t.min.z,n.distanceToPoint(jo)<0)return!1}return!0}),containsPoint:function(t){for(var e=this.planes,i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}}),Object.assign(At.prototype,{isMatrix4:!0,set:function(t,e,i,n,r,o,a,s,c,l,h,u,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=n,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=c,g[6]=l,g[10]=h,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new At).fromArray(this.elements)},copy:function(t){var e=this.elements;return t=t.elements,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this},copyPosition:function(t){var e=this.elements;return t=t.elements,e[12]=t[12],e[13]=t[13],e[14]=t[14],this},extractBasis:function(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this},extractRotation:(Qo=new Et,function(t){var e=this.elements,i=t.elements,n=1/Qo.setFromMatrixColumn(t,0).length(),r=1/Qo.setFromMatrixColumn(t,1).length();return t=1/Qo.setFromMatrixColumn(t,2).length(),e[0]=i[0]*n,e[1]=i[1]*n,e[2]=i[2]*n,e[3]=0,e[4]=i[4]*r,e[5]=i[5]*r,e[6]=i[6]*r,e[7]=0,e[8]=i[8]*t,e[9]=i[9]*t,e[10]=i[10]*t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e,i,n,r=this.elements,o=t.x,a=t.y,s=t.z,c=Math.cos(o),o=Math.sin(o),l=Math.cos(a),a=Math.sin(a),h=Math.cos(s),s=Math.sin(s);return"XYZ"===t.order?(t=c*h,e=c*s,i=o*h,n=o*s,r[0]=l*h,r[4]=-l*s,r[8]=a,r[1]=e+i*a,r[5]=t-n*a,r[9]=-o*l,r[2]=n-t*a,r[6]=i+e*a,r[10]=c*l):"YXZ"===t.order?(t=l*h,e=l*s,i=a*h,n=a*s,r[0]=t+n*o,r[4]=i*o-e,r[8]=c*a,r[1]=c*s,r[5]=c*h,r[9]=-o,r[2]=e*o-i,r[6]=n+t*o,r[10]=c*l):"ZXY"===t.order?(t=l*h,e=l*s,i=a*h,n=a*s,r[0]=t-n*o,r[4]=-c*s,r[8]=i+e*o,r[1]=e+i*o,r[5]=c*h,r[9]=n-t*o,r[2]=-c*a,r[6]=o,r[10]=c*l):"ZYX"===t.order?(t=c*h,e=c*s,i=o*h,n=o*s,r[0]=l*h,r[4]=i*a-e,r[8]=t*a+n,r[1]=l*s,r[5]=n*a+t,r[9]=e*a-i,r[2]=-a,r[6]=o*l,r[10]=c*l):"YZX"===t.order?(t=c*l,e=c*a,i=o*l,n=o*a,r[0]=l*h,r[4]=n-t*s,r[8]=i*s+e,r[1]=s,r[5]=c*h,r[9]=-o*h,r[2]=-a*h,r[6]=e*s+i,r[10]=t-n*s):"XZY"===t.order&&(t=c*l,e=c*a,i=o*l,n=o*a,r[0]=l*h,r[4]=-s,r[8]=a*h,r[1]=t*s+n,r[5]=c*h,r[9]=e*s-i,r[2]=i*s-e,r[6]=o*h,r[10]=n*s+t),r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this},makeRotationFromQuaternion:(Zo=new Et(0,0,0),Jo=new Et(1,1,1),function(t){return this.compose(Zo,t,Jo)}),lookAt:(Xo=new Et,Yo=new Et,$o=new Et,function(t,e,i){var n=this.elements;return $o.subVectors(t,e),0===$o.lengthSq()&&($o.z=1),$o.normalize(),Xo.crossVectors(i,$o),0===Xo.lengthSq()&&(1===Math.abs(i.z)?$o.x+=1e-4:$o.z+=1e-4,$o.normalize(),Xo.crossVectors(i,$o)),Xo.normalize(),Yo.crossVectors($o,Xo),n[0]=Xo.x,n[4]=Yo.x,n[8]=$o.x,n[1]=Xo.y,n[5]=Yo.y,n[9]=$o.y,n[2]=Xo.z,n[6]=Yo.z,n[10]=$o.z,this}),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,n=e.elements;e=this.elements,t=i[0];var r=i[4],o=i[8],a=i[12],s=i[1],c=i[5],l=i[9],h=i[13],u=i[2],d=i[6],p=i[10],f=i[14],m=i[3],g=i[7],v=i[11],i=i[15],y=n[0],b=n[4],x=n[8],w=n[12],E=n[1],M=n[5],_=n[9],S=n[13],A=n[2],T=n[6],C=n[10],L=n[14],P=n[3],R=n[7],I=n[11],n=n[15];return e[0]=t*y+r*E+o*A+a*P,e[4]=t*b+r*M+o*T+a*R,e[8]=t*x+r*_+o*C+a*I,e[12]=t*w+r*S+o*L+a*n,e[1]=s*y+c*E+l*A+h*P,e[5]=s*b+c*M+l*T+h*R,e[9]=s*x+c*_+l*C+h*I,e[13]=s*w+c*S+l*L+h*n,e[2]=u*y+d*E+p*A+f*P,e[6]=u*b+d*M+p*T+f*R,e[10]=u*x+d*_+p*C+f*I,e[14]=u*w+d*S+p*L+f*n,e[3]=m*y+g*E+v*A+i*P,e[7]=m*b+g*M+v*T+i*R,e[11]=m*x+g*_+v*C+i*I,e[15]=m*w+g*S+v*L+i*n,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:(qo=new Et,function(t){for(var e=0,i=t.count;e<i;e++)qo.x=t.getX(e),qo.y=t.getY(e),qo.z=t.getZ(e),qo.applyMatrix4(this),t.setXYZ(e,qo.x,qo.y,qo.z);return t}),determinant:function(){var t=this.elements,e=t[0],i=t[4],n=t[8],r=t[12],o=t[1],a=t[5],s=t[9],c=t[13],l=t[2],h=t[6],u=t[10],d=t[14];return t[3]*(r*s*h-n*c*h-r*a*u+i*c*u+n*a*d-i*s*d)+t[7]*(e*s*d-e*c*u+r*o*u-n*o*d+n*c*l-r*s*l)+t[11]*(e*c*h-e*a*d-r*o*h+i*o*d+r*a*l-i*c*l)+t[15]*(-n*a*l-e*s*h+e*a*u+n*o*h-i*o*u+i*s*l)},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(t,e,i){var n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=e,n[14]=i),this},getInverse:function(t,e){var i=this.elements,n=t.elements;t=n[0];var r=n[1],o=n[2],a=n[3],s=n[4],c=n[5],l=n[6],h=n[7],u=n[8],d=n[9],p=n[10],f=n[11],m=n[12],g=n[13],v=n[14],y=d*v*h-g*p*h+g*l*f-c*v*f-d*l*(n=n[15])+c*p*n,b=m*p*h-u*v*h-m*l*f+s*v*f+u*l*n-s*p*n,x=u*g*h-m*d*h+m*c*f-s*g*f-u*c*n+s*d*n,w=m*d*l-u*g*l-m*c*p+s*g*p+u*c*v-s*d*v,E=t*y+r*b+o*x+a*w;if(0!=E)return e=1/E,i[0]=y*e,i[1]=(g*p*a-d*v*a-g*o*f+r*v*f+d*o*n-r*p*n)*e,i[2]=(c*v*a-g*l*a+g*o*h-r*v*h-c*o*n+r*l*n)*e,i[3]=(d*l*a-c*p*a-d*o*h+r*p*h+c*o*f-r*l*f)*e,i[4]=b*e,i[5]=(u*v*a-m*p*a+m*o*f-t*v*f-u*o*n+t*p*n)*e,i[6]=(m*l*a-s*v*a-m*o*h+t*v*h+s*o*n-t*l*n)*e,i[7]=(s*p*a-u*l*a+u*o*h-t*p*h-s*o*f+t*l*f)*e,i[8]=x*e,i[9]=(m*d*a-u*g*a-m*r*f+t*g*f+u*r*n-t*d*n)*e,i[10]=(s*g*a-m*c*a+m*r*h-t*g*h-s*r*n+t*c*n)*e,i[11]=(u*c*a-s*d*a-u*r*h+t*d*h+s*r*f-t*c*f)*e,i[12]=w*e,i[13]=(u*g*o-m*d*o+m*r*p-t*g*p-u*r*v+t*d*v)*e,i[14]=(m*c*o-s*g*o-m*r*l+t*g*l+s*r*v-t*c*v)*e,i[15]=(s*d*o-u*c*o+u*r*l-t*d*l-s*r*p+t*c*p)*e,this;if(!0===e)throw Error("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");return console.warn("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0"),this.identity()},scale:function(t){var e=this.elements,i=t.x,n=t.y;return t=t.z,e[0]*=i,e[4]*=n,e[8]*=t,e[1]*=i,e[5]*=n,e[9]*=t,e[2]*=i,e[6]*=n,e[10]*=t,e[3]*=i,e[7]*=n,e[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e);e=Math.sin(e);var n=1-i,r=t.x,o=t.y;t=t.z;var a=n*r,s=n*o;return this.set(a*r+i,a*o-e*t,a*t+e*o,0,a*o+e*t,s*o+i,s*t-e*r,0,a*t-e*o,s*t+e*r,n*t*t+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(t,e,i){return this.set(1,e,i,0,t,1,i,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,i){var n=this.elements,r=e._x,o=e._y,a=e._z,s=e._w,c=r+r,l=o+o,h=a+a;e=r*c;var u=r*l;r*=h;var d=o*l;o*=h,a*=h,c*=s,l*=s,s*=h,h=i.x;var p=i.y;return i=i.z,n[0]=(1-(d+a))*h,n[1]=(u+s)*h,n[2]=(r-l)*h,n[3]=0,n[4]=(u-s)*p,n[5]=(1-(e+a))*p,n[6]=(o+c)*p,n[7]=0,n[8]=(r+l)*i,n[9]=(o-c)*i,n[10]=(1-(e+d))*i,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this},decompose:(Vo=new Et,Wo=new At,function(t,e,i){var n=this.elements,r=Vo.set(n[0],n[1],n[2]).length(),o=Vo.set(n[4],n[5],n[6]).length(),a=Vo.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),t.x=n[12],t.y=n[13],t.z=n[14],Wo.copy(this),t=1/r,n=1/o;var s=1/a;return Wo.elements[0]*=t,Wo.elements[1]*=t,Wo.elements[2]*=t,Wo.elements[4]*=n,Wo.elements[5]*=n,Wo.elements[6]*=n,Wo.elements[8]*=s,Wo.elements[9]*=s,Wo.elements[10]*=s,e.setFromRotationMatrix(Wo),i.x=r,i.y=o,i.z=a,this}),makePerspective:function(t,e,i,n,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements;return a[0]=2*r/(e-t),a[4]=0,a[8]=(e+t)/(e-t),a[12]=0,a[1]=0,a[5]=2*r/(i-n),a[9]=(i+n)/(i-n),a[13]=0,a[2]=0,a[6]=0,a[10]=-(o+r)/(o-r),a[14]=-2*o*r/(o-r),a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,i,n,r,o){var a=this.elements,s=1/(e-t),c=1/(i-n),l=1/(o-r);return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-(e+t)*s,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-(i+n)*c,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-(o+r)*l,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){var e=this.elements;t=t.elements;for(var i=0;i<16;i++)if(e[i]!==t[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;i<16;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}});var na,ra,oa,aa={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = normalMatrix * objectTangent;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",lights_pars_begin:"uniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#endif\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\tfloat clearCoatInv = 1.0 - clearCoatDHR;\n\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec3 singleScattering = vec3( 0.0 );\n\t\tvec3 multiScattering = vec3( 0.0 );\n\t\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\t\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * singleScattering;\n\t\treflectedLight.indirectDiffuse += multiScattering * cosineWeightedIrradiance;\n\t\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n\t#else\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#endif\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, irradiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t#endif\n#endif",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\t#ifdef USE_TANGENT\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy = normalScale * mapN.xy;\n\t\t\tnormal = normalize( vTBN * mapN );\n\t\t#else\n\t\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t\t#endif\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#if defined( DITHERING )\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},sa={clone:Tt,merge:o},ca={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function la(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function ha(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function ua(t,e,i){return i<0&&(i+=1),1<i&&--i,i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t}Object.assign(p.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.b=this.g=this.r=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,i){return this.r=t,this.g=e,this.b=i,this},setHSL:function(t,e,i){return t=uo.euclideanModulo(t,1),e=uo.clamp(e,0,1),i=uo.clamp(i,0,1),0===e?this.r=this.g=this.b=i:(i=2*i-(e=i<=.5?i*(1+e):i+e-i*e),this.r=ua(i,e,t+1/3),this.g=ua(i,e,t),this.b=ua(i,e,t-1/3)),this},setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n=i[2];switch(i[1]){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,t(i[5]),this;if(i=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,t(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n)){n=parseFloat(i[1])/360;var r=parseInt(i[2],10)/100,o=parseInt(i[3],10)/100;return t(i[5]),this.setHSL(n,r,o)}}}else if(i=/^#([A-Fa-f0-9]+)$/.exec(e)){if(3===(n=(i=i[1]).length))return this.r=parseInt(i.charAt(0)+i.charAt(0),16)/255,this.g=parseInt(i.charAt(1)+i.charAt(1),16)/255,this.b=parseInt(i.charAt(2)+i.charAt(2),16)/255,this;if(6===n)return this.r=parseInt(i.charAt(0)+i.charAt(1),16)/255,this.g=parseInt(i.charAt(2)+i.charAt(3),16)/255,this.b=parseInt(i.charAt(4)+i.charAt(5),16)/255,this}return e&&0<e.length&&(void 0!==(i=ca[e])?this.setHex(i):console.warn("THREE.Color: Unknown color "+e)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){return void 0===e&&(e=2),e=0<e?1/e:1,this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=ha(t.r),this.g=ha(t.g),this.b=ha(t.b),this},copyLinearToSRGB:function(t){return this.r=la(t.r),this.g=la(t.g),this.b=la(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,i=this.r,n=this.g,r=this.b,o=Math.max(i,n,r),a=((c=Math.min(i,n,r))+o)/2;if(c===o)c=e=0;else{var s=o-c,c=a<=.5?s/(o+c):s/(2-o-c);switch(o){case i:e=(n-r)/s+(n<r?6:0);break;case n:e=(r-i)/s+2;break;case r:e=(i-n)/s+4}e/=6}return t.h=e,t.s=c,t.l=a,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:(oa={},function(t,e,i){return this.getHSL(oa),oa.h+=t,oa.s+=e,oa.l+=i,this.setHSL(oa.h,oa.s,oa.l),this}),add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:(na={h:0,s:0,l:0},ra={h:0,s:0,l:0},function(t,e){this.getHSL(na),t.getHSL(ra),t=uo.lerp(na.h,ra.h,e);var i=uo.lerp(na.s,ra.s,e);return e=uo.lerp(na.l,ra.l,e),this.setHSL(t,i,e),this}),equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}});var da,pa,fa={common:{diffuse:{value:new p(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new g},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new wt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new p(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new p(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new g}},sprite:{diffuse:{value:new p(15658734)},opacity:{value:1},center:{value:new wt(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new g}}},ma={basic:{uniforms:o([fa.common,fa.specularmap,fa.envmap,fa.aomap,fa.lightmap,fa.fog]),vertexShader:aa.meshbasic_vert,fragmentShader:aa.meshbasic_frag},lambert:{uniforms:o([fa.common,fa.specularmap,fa.envmap,fa.aomap,fa.lightmap,fa.emissivemap,fa.fog,fa.lights,{emissive:{value:new p(0)}}]),vertexShader:aa.meshlambert_vert,fragmentShader:aa.meshlambert_frag},phong:{uniforms:o([fa.common,fa.specularmap,fa.envmap,fa.aomap,fa.lightmap,fa.emissivemap,fa.bumpmap,fa.normalmap,fa.displacementmap,fa.gradientmap,fa.fog,fa.lights,{emissive:{value:new p(0)},specular:{value:new p(1118481)},shininess:{value:30}}]),vertexShader:aa.meshphong_vert,fragmentShader:aa.meshphong_frag},standard:{uniforms:o([fa.common,fa.envmap,fa.aomap,fa.lightmap,fa.emissivemap,fa.bumpmap,fa.normalmap,fa.displacementmap,fa.roughnessmap,fa.metalnessmap,fa.fog,fa.lights,{emissive:{value:new p(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:aa.meshphysical_vert,fragmentShader:aa.meshphysical_frag},matcap:{uniforms:o([fa.common,fa.bumpmap,fa.normalmap,fa.displacementmap,fa.fog,{matcap:{value:null}}]),vertexShader:aa.meshmatcap_vert,fragmentShader:aa.meshmatcap_frag},points:{uniforms:o([fa.points,fa.fog]),vertexShader:aa.points_vert,fragmentShader:aa.points_frag},dashed:{uniforms:o([fa.common,fa.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:aa.linedashed_vert,fragmentShader:aa.linedashed_frag},depth:{uniforms:o([fa.common,fa.displacementmap]),vertexShader:aa.depth_vert,fragmentShader:aa.depth_frag},normal:{uniforms:o([fa.common,fa.bumpmap,fa.normalmap,fa.displacementmap,{opacity:{value:1}}]),vertexShader:aa.normal_vert,fragmentShader:aa.normal_frag},sprite:{uniforms:o([fa.sprite,fa.fog]),vertexShader:aa.sprite_vert,fragmentShader:aa.sprite_frag},background:{uniforms:{uvTransform:{value:new g},t2D:{value:null}},vertexShader:aa.background_vert,fragmentShader:aa.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:aa.cube_vert,fragmentShader:aa.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:aa.equirect_vert,fragmentShader:aa.equirect_frag},distanceRGBA:{uniforms:o([fa.common,fa.displacementmap,{referencePosition:{value:new Et},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:aa.distanceRGBA_vert,fragmentShader:aa.distanceRGBA_frag},shadow:{uniforms:o([fa.lights,fa.fog,{color:{value:new p(0)},opacity:{value:1}}]),vertexShader:aa.shadow_vert,fragmentShader:aa.shadow_frag}};ma.physical={uniforms:o([ma.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:aa.meshphysical_vert,fragmentShader:aa.meshphysical_frag},Object.assign(y.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,i=t.vertexNormals.length;e<i;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,i=t.vertexColors.length;e<i;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}}),a.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),a.DefaultOrder="XYZ",Object.defineProperties(a.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),Object.assign(a.prototype,{isEuler:!0,set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,i){var n=uo.clamp;t=(u=t.elements)[0];var r=u[4],o=u[8],a=u[1],s=u[5],c=u[9],l=u[2],h=u[6],u=u[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(n(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(-c,u),this._z=Math.atan2(-r,t)):(this._x=Math.atan2(h,s),this._z=0)):"YXZ"===e?(this._x=Math.asin(-n(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(o,u),this._z=Math.atan2(a,s)):(this._y=Math.atan2(-l,t),this._z=0)):"ZXY"===e?(this._x=Math.asin(n(h,-1,1)),Math.abs(h)<.99999?(this._y=Math.atan2(-l,u),this._z=Math.atan2(-r,s)):(this._y=0,this._z=Math.atan2(a,t))):"ZYX"===e?(this._y=Math.asin(-n(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(h,u),this._z=Math.atan2(a,t)):(this._x=0,this._z=Math.atan2(-r,s))):"YZX"===e?(this._z=Math.asin(n(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(-c,s),this._y=Math.atan2(-l,t)):(this._x=0,this._y=Math.atan2(o,u))):"XZY"===e?(this._z=Math.asin(-n(r,-1,1)),Math.abs(r)<.99999?(this._x=Math.atan2(h,s),this._y=Math.atan2(o,t)):(this._x=Math.atan2(-c,u),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==i&&this.onChangeCallback(),this},setFromQuaternion:(pa=new At,function(t,e,i){return pa.makeRotationFromQuaternion(t),this.setFromRotationMatrix(pa,e,i)}),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:(da=new S,function(t){return da.setFromEuler(this),this.setFromQuaternion(da,t)}),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new Et(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(s.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask=this.mask|1<<t|0},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},test:function(t){return 0!=(this.mask&t.mask)}});var ga,va,ya,ba,xa,wa,Ea,Ma,_a,Sa,Aa,Ta,Ca,La,Pa,Ra,Ia,Oa,Da,ka=0;u.DefaultUp=new Et(0,1,0),u.DefaultMatrixAutoUpdate=!0,u.prototype=Object.assign(Object.create(e.prototype),{constructor:u,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:(Da=new S,function(t,e){return Da.setFromAxisAngle(t,e),this.quaternion.multiply(Da),this}),rotateOnWorldAxis:(Oa=new S,function(t,e){return Oa.setFromAxisAngle(t,e),this.quaternion.premultiply(Oa),this}),rotateX:(Ia=new Et(1,0,0),function(t){return this.rotateOnAxis(Ia,t)}),rotateY:(Ra=new Et(0,1,0),function(t){return this.rotateOnAxis(Ra,t)}),rotateZ:(Pa=new Et(0,0,1),function(t){return this.rotateOnAxis(Pa,t)}),translateOnAxis:(La=new Et,function(t,e){return La.copy(t).applyQuaternion(this.quaternion),this.position.add(La.multiplyScalar(e)),this}),translateX:(Ca=new Et(1,0,0),function(t){return this.translateOnAxis(Ca,t)}),translateY:(Ta=new Et(0,1,0),function(t){return this.translateOnAxis(Ta,t)}),translateZ:(Aa=new Et(0,0,1),function(t){return this.translateOnAxis(Aa,t)}),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:(Sa=new At,function(t){return t.applyMatrix4(Sa.getInverse(this.matrixWorld))}),lookAt:(wa=new S,Ea=new At,Ma=new Et,_a=new Et,function(t,e,i){t.isVector3?Ma.copy(t):Ma.set(t,e,i),t=this.parent,this.updateWorldMatrix(!0,!1),_a.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ea.lookAt(_a,Ma,this.up):Ea.lookAt(Ma,_a,this.up),this.quaternion.setFromRotationMatrix(Ea),t&&(Ea.extractRotation(t.matrixWorld),wa.setFromRotationMatrix(Ea),this.quaternion.premultiply(wa.inverse()))}),add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",t):t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this},remove:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}return-1!==(e=this.children.indexOf(t))&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(e,1)),this},attach:(xa=new At,function(t){return this.updateWorldMatrix(!0,!1),xa.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),xa.multiply(t.parent.matrixWorld)),t.applyMatrix(xa),t.updateWorldMatrix(!1,!1),this.add(t),this}),getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var i=0,n=this.children.length;i<n;i++){var r=this.children[i].getObjectByProperty(t,e);if(void 0!==r)return r}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new Et),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(ya=new Et,ba=new Et,function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new S),this.updateMatrixWorld(!0),this.matrixWorld.decompose(ya,t,ba),t}),getWorldScale:(ga=new Et,va=new S,function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new Et),this.updateMatrixWorld(!0),this.matrixWorld.decompose(ga,va,t),t}),getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new Et),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t=!(this.matrixWorldNeedsUpdate=!1));for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var i=this.parent;if(!0===t&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(e=0,i=(t=this.children).length;e<i;e++)t[e].updateWorldMatrix(!1,!0)},toJSON:function(i){function t(t,e){return void 0===t[e.uuid]&&(t[e.uuid]=e.toJSON(i)),e.uuid}function e(t){var e,i=[];for(e in t){var n=t[e];delete n.metadata,i.push(n)}return i}var n=void 0===i||"string"==typeof i,r={};n&&(i={geometries:{},materials:{},textures:{},images:{},shapes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var o,a={};if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),!0===this.castShadow&&(a.castShadow=!0),!0===this.receiveShadow&&(a.receiveShadow=!0),!1===this.visible&&(a.visible=!1),!1===this.frustumCulled&&(a.frustumCulled=!1),0!==this.renderOrder&&(a.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(a.matrixAutoUpdate=!1),this.isMesh&&0!==this.drawMode&&(a.drawMode=this.drawMode),this.isMesh||this.isLine||this.isPoints){a.geometry=t(i.geometries,this.geometry);var s=this.geometry.parameters;if(void 0!==s&&void 0!==s.shapes)if(s=s.shapes,Array.isArray(s))for(var c=0,l=s.length;c<l;c++)t(i.shapes,s[c]);else t(i.shapes,s)}if(void 0!==this.material)if(Array.isArray(this.material)){for(s=[],c=0,l=this.material.length;c<l;c++)s.push(t(i.materials,this.material[c]));a.material=s}else a.material=t(i.materials,this.material);if(0<this.children.length)for(a.children=[],c=0;c<this.children.length;c++)a.children.push(this.children[c].toJSON(i).object);return n&&(n=e(i.geometries),c=e(i.materials),l=e(i.textures),o=e(i.images),s=e(i.shapes),0<n.length&&(r.geometries=n),0<c.length&&(r.materials=c),0<l.length&&(r.textures=l),0<o.length&&(r.images=o),0<s.length&&(r.shapes=s)),r.object=a,r},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(e=0;e<t.children.length;e++)this.add(t.children[e].clone());return this}});var Na,za,Ba,Fa,Ua,ja,Ha,Ga=0;f.prototype=Object.assign(Object.create(e.prototype),{constructor:f,isGeometry:!0,applyMatrix:function(t){for(var e=(new g).getNormalMatrix(t),i=0,n=this.vertices.length;i<n;i++)this.vertices[i].applyMatrix4(t);for(i=0,n=this.faces.length;i<n;i++){(t=this.faces[i]).normal.applyMatrix3(e).normalize();for(var r=0,o=t.vertexNormals.length;r<o;r++)t.vertexNormals[r].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:(Ha=new At,function(t){return Ha.makeRotationX(t),this.applyMatrix(Ha),this}),rotateY:(ja=new At,function(t){return ja.makeRotationY(t),this.applyMatrix(ja),this}),rotateZ:(Ua=new At,function(t){return Ua.makeRotationZ(t),this.applyMatrix(Ua),this}),translate:(Fa=new At,function(t,e,i){return Fa.makeTranslation(t,e,i),this.applyMatrix(Fa),this}),scale:(Ba=new At,function(t,e,i){return Ba.makeScale(t,e,i),this.applyMatrix(Ba),this}),lookAt:(za=new u,function(t){za.lookAt(t),za.updateMatrix(),this.applyMatrix(za.matrix)}),fromBufferGeometry:function(t){function e(t,e,i,n){var r=void 0===s?[]:[o.colors[t].clone(),o.colors[e].clone(),o.colors[i].clone()];n=new y(t,e,i,void 0===a?[]:[(new Et).fromArray(a,3*t),(new Et).fromArray(a,3*e),(new Et).fromArray(a,3*i)],r,n),o.faces.push(n),void 0!==c&&o.faceVertexUvs[0].push([(new wt).fromArray(c,2*t),(new wt).fromArray(c,2*e),(new wt).fromArray(c,2*i)]),void 0!==l&&o.faceVertexUvs[1].push([(new wt).fromArray(l,2*t),(new wt).fromArray(l,2*e),(new wt).fromArray(l,2*i)])}var o=this,i=null!==t.index?t.index.array:void 0,n=t.attributes,r=n.position.array,a=void 0!==n.normal?n.normal.array:void 0,s=void 0!==n.color?n.color.array:void 0,c=void 0!==n.uv?n.uv.array:void 0,l=void 0!==n.uv2?n.uv2.array:void 0;for(void 0!==l&&(this.faceVertexUvs[1]=[]),n=0;n<r.length;n+=3)o.vertices.push((new Et).fromArray(r,n)),void 0!==s&&o.colors.push((new p).fromArray(s,n));var h=t.groups;if(0<h.length)for(n=0;n<h.length;n++){var u=(r=h[n]).start,d=u;for(u+=r.count;d<u;d+=3)void 0!==i?e(i[d],i[d+1],i[d+2],r.materialIndex):e(d,d+1,d+2,r.materialIndex)}else if(void 0!==i)for(n=0;n<i.length;n+=3)e(i[n],i[n+1],i[n+2]);else for(n=0;n<r.length/3;n+=3)e(n,n+1,n+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:(Na=new Et,function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Na).negate(),this.translate(Na.x,Na.y,Na.z),this}),normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=0===(e=this.boundingSphere.radius)?1:1/e,i=new At;return i.set(e,0,0,-e*t.x,0,e,0,-e*t.y,0,0,e,-e*t.z,0,0,0,1),this.applyMatrix(i),this},computeFaceNormals:function(){for(var t=new Et,e=new Et,i=0,n=this.faces.length;i<n;i++){var r=this.faces[i],o=this.vertices[r.a],a=this.vertices[r.b];t.subVectors(this.vertices[r.c],a),e.subVectors(o,a),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);for(var e=Array(this.vertices.length),i=0,n=this.vertices.length;i<n;i++)e[i]=new Et;if(t){var r=new Et,o=new Et;for(t=0,i=this.faces.length;t<i;t++){n=this.faces[t];var a=this.vertices[n.a],s=this.vertices[n.b],c=this.vertices[n.c];r.subVectors(c,s),o.subVectors(a,s),r.cross(o),e[n.a].add(r),e[n.b].add(r),e[n.c].add(r)}}else for(this.computeFaceNormals(),t=0,i=this.faces.length;t<i;t++)e[(n=this.faces[t]).a].add(n.normal),e[n.b].add(n.normal),e[n.c].add(n.normal);for(i=0,n=this.vertices.length;i<n;i++)e[i].normalize();for(t=0,i=this.faces.length;t<i;t++)3===(a=(n=this.faces[t]).vertexNormals).length?(a[0].copy(e[n.a]),a[1].copy(e[n.b]),a[2].copy(e[n.c])):(a[0]=e[n.a].clone(),a[1]=e[n.b].clone(),a[2]=e[n.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(var t=0,e=this.faces.length;t<e;t++){var i=this.faces[t],n=i.vertexNormals;3===n.length?(n[0].copy(i.normal),n[1].copy(i.normal),n[2].copy(i.normal)):(n[0]=i.normal.clone(),n[1]=i.normal.clone(),n[2]=i.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t=0;for(a=this.faces.length;t<a;t++){var e=this.faces[t];e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]);for(var i=0,n=e.vertexNormals.length;i<n;i++)e.__originalVertexNormals[i]?e.__originalVertexNormals[i].copy(e.vertexNormals[i]):e.__originalVertexNormals[i]=e.vertexNormals[i].clone()}var r=new f;for(r.faces=this.faces,i=0,n=this.morphTargets.length;i<n;i++){if(!this.morphNormals[i]){this.morphNormals[i]={},this.morphNormals[i].faceNormals=[],this.morphNormals[i].vertexNormals=[],e=this.morphNormals[i].faceNormals;for(var o=this.morphNormals[i].vertexNormals,t=0,a=this.faces.length;t<a;t++){var s=new Et,c={a:new Et,b:new Et,c:new Et};e.push(s),o.push(c)}}for(o=this.morphNormals[i],r.vertices=this.morphTargets[i].vertices,r.computeFaceNormals(),r.computeVertexNormals(),t=0,a=this.faces.length;t<a;t++)e=this.faces[t],s=o.faceNormals[t],c=o.vertexNormals[t],s.copy(e.normal),c.a.copy(e.vertexNormals[0]),c.b.copy(e.vertexNormals[1]),c.c.copy(e.vertexNormals[2])}for(t=0,a=this.faces.length;t<a;t++)(e=this.faces[t]).normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new n),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new h),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,i){if(t&&t.isGeometry){var n,r=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,c=t.faces,l=this.faceVertexUvs[0],h=t.faceVertexUvs[0],u=this.colors,d=t.colors;void 0===i&&(i=0),void 0!==e&&(n=(new g).getNormalMatrix(e)),t=0;for(var p=a.length;t<p;t++){var f=a[t].clone();void 0!==e&&f.applyMatrix4(e),o.push(f)}for(t=0,p=d.length;t<p;t++)u.push(d[t].clone());for(t=0,p=c.length;t<p;t++){var m=(a=c[t]).vertexNormals,d=a.vertexColors;for((u=new y(a.a+r,a.b+r,a.c+r)).normal.copy(a.normal),void 0!==n&&u.normal.applyMatrix3(n).normalize(),e=0,o=m.length;e<o;e++)f=m[e].clone(),void 0!==n&&f.applyMatrix3(n).normalize(),u.vertexNormals.push(f);for(u.color.copy(a.color),e=0,o=d.length;e<o;e++)f=d[e],u.vertexColors.push(f.clone());u.materialIndex=a.materialIndex+i,s.push(u)}for(t=0,p=h.length;t<p;t++)if(n=[],void 0!==(i=h[t])){for(e=0,o=i.length;e<o;e++)n.push(i[e].clone());l.push(n)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){for(var t={},e=[],i=[],n=Math.pow(10,4),r=0,o=this.vertices.length;r<o;r++){var a=this.vertices[r];void 0===t[a=Math.round(a.x*n)+"_"+Math.round(a.y*n)+"_"+Math.round(a.z*n)]?(t[a]=r,e.push(this.vertices[r]),i[r]=e.length-1):i[r]=i[t[a]]}for(t=[],r=0,o=this.faces.length;r<o;r++)for((n=this.faces[r]).a=i[n.a],n.b=i[n.b],n.c=i[n.c],n=[n.a,n.b,n.c],a=0;a<3;a++)if(n[a]===n[(a+1)%3]){t.push(r);break}for(r=t.length-1;0<=r;r--)for(n=t[r],this.faces.splice(n,1),i=0,o=this.faceVertexUvs.length;i<o;i++)this.faceVertexUvs[i].splice(n,1);return r=this.vertices.length-e.length,this.vertices=e,r},setFromPoints:function(t){this.vertices=[];for(var e=0,i=t.length;e<i;e++){var n=t[e];this.vertices.push(new Et(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,i=0;i<e;i++)t[i]._id=i;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var n,r,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];for(o&&o.length===e&&(n=[]),a&&a.length===e&&(r=[]),i=0;i<e;i++){var s=t[i]._id;n&&n.push(o[s]),r&&r.push(a[s])}n&&(this.faceVertexUvs[0]=n),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){function t(t,e,i){return i?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==c[e]||(c[e]=s.length/3,s.push(t.x,t.y,t.z)),c[e]}function i(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==h[e]||(h[e]=l.length,l.push(t.getHex())),h[e]}function n(t){var e=t.x.toString()+t.y.toString();return void 0!==d[e]||(d[e]=u.length/2,u.push(t.x,t.y)),d[e]}var r={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),void 0!==this.parameters){var o=this.parameters;for(p in o)void 0!==o[p]&&(r[p]=o[p]);return r}for(o=[],p=0;p<this.vertices.length;p++){var a=this.vertices[p];o.push(a.x,a.y,a.z)}a=[];for(var s=[],c={},l=[],h={},u=[],d={},p=0;p<this.faces.length;p++){var f,m=this.faces[p],g=void 0!==this.faceVertexUvs[0][p],v=0<m.normal.length(),y=0<m.vertexNormals.length,b=1!==m.color.r||1!==m.color.g||1!==m.color.b,x=0<m.vertexColors.length;f=t(2,3,g),f=t(f,4,v),f=t(f,5,y),f=t(f,6,b),f=t(f,7,x),a.push(f),a.push(m.a,m.b,m.c),a.push(m.materialIndex),g&&(g=this.faceVertexUvs[0][p],a.push(n(g[0]),n(g[1]),n(g[2]))),v&&a.push(e(m.normal)),y&&(v=m.vertexNormals,a.push(e(v[0]),e(v[1]),e(v[2]))),b&&a.push(i(m.color)),x&&(m=m.vertexColors,a.push(i(m[0]),i(m[1]),i(m[2])))}return r.data={},r.data.vertices=o,r.data.normals=s,0<l.length&&(r.data.colors=l),0<u.length&&(r.data.uvs=[u]),r.data.faces=a,r},clone:function(){return(new f).copy(this)},copy:function(t){var e;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=t.name;for(var i=t.vertices,n=0,r=i.length;n<r;n++)this.vertices.push(i[n].clone());for(n=0,r=(i=t.colors).length;n<r;n++)this.colors.push(i[n].clone());for(n=0,r=(i=t.faces).length;n<r;n++)this.faces.push(i[n].clone());for(n=0,r=t.faceVertexUvs.length;n<r;n++){var o=t.faceVertexUvs[n];for(void 0===this.faceVertexUvs[n]&&(this.faceVertexUvs[n]=[]),i=0,e=o.length;i<e;i++){for(var a=o[i],s=[],c=0,l=a.length;c<l;c++)s.push(a[c].clone());this.faceVertexUvs[n].push(s)}}for(n=0,r=(c=t.morphTargets).length;n<r;n++){if((l={}).name=c[n].name,void 0!==c[n].vertices)for(l.vertices=[],i=0,e=c[n].vertices.length;i<e;i++)l.vertices.push(c[n].vertices[i].clone());if(void 0!==c[n].normals)for(l.normals=[],i=0,e=c[n].normals.length;i<e;i++)l.normals.push(c[n].normals[i].clone());this.morphTargets.push(l)}for(n=0,r=(c=t.morphNormals).length;n<r;n++){if(l={},void 0!==c[n].vertexNormals)for(l.vertexNormals=[],i=0,e=c[n].vertexNormals.length;i<e;i++)o=c[n].vertexNormals[i],(a={}).a=o.a.clone(),a.b=o.b.clone(),a.c=o.c.clone(),l.vertexNormals.push(a);if(void 0!==c[n].faceNormals)for(l.faceNormals=[],i=0,e=c[n].faceNormals.length;i<e;i++)l.faceNormals.push(c[n].faceNormals[i].clone());this.morphNormals.push(l)}for(n=0,r=(i=t.skinWeights).length;n<r;n++)this.skinWeights.push(i[n].clone());for(n=0,r=(i=t.skinIndices).length;n<r;n++)this.skinIndices.push(i[n].clone());for(n=0,r=(i=t.lineDistances).length;n<r;n++)this.lineDistances.push(i[n]);return null!==(n=t.boundingBox)&&(this.boundingBox=n.clone()),null!==(n=t.boundingSphere)&&(this.boundingSphere=n.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(m.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(m.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==t?t.length/this.itemSize:0,this.array=t,this},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.itemSize,i*=e.itemSize;for(var n=0,r=this.itemSize;n<r;n++)this.array[t+n]=e.array[i+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var o=t[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),o=new p),e[i++]=o.r,e[i++]=o.g,e[i++]=o.b}return this},copyVector2sArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var o=t[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),o=new wt),e[i++]=o.x,e[i++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var o=t[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),o=new Et),e[i++]=o.x,e[i++]=o.y,e[i++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var o=t[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),o=new Mt),e[i++]=o.x,e[i++]=o.y,e[i++]=o.z,e[i++]=o.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this},setXYZW:function(t,e,i,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),(c.prototype=Object.create(m.prototype)).constructor=c,(l.prototype=Object.create(m.prototype)).constructor=l,(b.prototype=Object.create(m.prototype)).constructor=b,(x.prototype=Object.create(m.prototype)).constructor=x,(w.prototype=Object.create(m.prototype)).constructor=w,(E.prototype=Object.create(m.prototype)).constructor=E,(M.prototype=Object.create(m.prototype)).constructor=M,(L.prototype=Object.create(m.prototype)).constructor=L,(_.prototype=Object.create(m.prototype)).constructor=_,Object.assign(A.prototype,{computeGroups:function(t){var e=[],i=void 0;t=t.faces;for(var n=0;n<t.length;n++){var r,o=t[n];o.materialIndex!==i&&(i=o.materialIndex,void 0!==r&&(r.count=3*n-r.start,e.push(r)),r={start:3*n,materialIndex:i})}void 0!==r&&(r.count=3*n-r.start,e.push(r)),this.groups=e},fromGeometry:function(t){var e=t.faces,i=t.vertices,n=t.faceVertexUvs,r=n[0]&&0<n[0].length,o=n[1]&&0<n[1].length,a=t.morphTargets,s=a.length;if(0<s){for(var c=[],l=0;l<s;l++)c[l]={name:a[l].name,data:[]};this.morphTargets.position=c}var h=t.morphNormals,u=h.length;if(0<u){for(var d=[],l=0;l<u;l++)d[l]={name:h[l].name,data:[]};this.morphTargets.normal=d}var p=t.skinIndices,f=t.skinWeights,m=p.length===i.length,g=f.length===i.length;for(0<i.length&&0===e.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported."),l=0;l<e.length;l++){var v=e[l];this.vertices.push(i[v.a],i[v.b],i[v.c]);var y=v.vertexNormals;for(3===y.length?this.normals.push(y[0],y[1],y[2]):(y=v.normal,this.normals.push(y,y,y)),3===(y=v.vertexColors).length?this.colors.push(y[0],y[1],y[2]):(y=v.color,this.colors.push(y,y,y)),!0===r&&(void 0!==(y=n[0][l])?this.uvs.push(y[0],y[1],y[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new wt,new wt,new wt))),!0===o&&(void 0!==(y=n[1][l])?this.uvs2.push(y[0],y[1],y[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new wt,new wt,new wt))),y=0;y<s;y++){var b=a[y].vertices;c[y].data.push(b[v.a],b[v.b],b[v.c])}for(y=0;y<u;y++)b=h[y].vertexNormals[l],d[y].data.push(b.a,b.b,b.c);m&&this.skinIndices.push(p[v.a],p[v.b],p[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}});var Va,Wa,qa,Xa,Ya,$a,Za,Ja,Qa,Ka,ts,es,is=1;P.prototype=Object.assign(Object.create(e.prototype),{constructor:P,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<T(t)?M:w)(t,1):this.index=t},addAttribute:function(t,e,i){return e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?("index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e)):this.attributes[t]=e,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(t,new m(e,i)))},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,i){this.groups.push({start:t,count:e,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0);var i=this.attributes.normal;return void 0!==i&&((e=(new g).getNormalMatrix(t)).applyToBufferAttribute(i),i.needsUpdate=!0),void 0!==(i=this.attributes.tangent)&&((e=(new g).getNormalMatrix(t)).applyToBufferAttribute(i),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:(es=new At,function(t){return es.makeRotationX(t),this.applyMatrix(es),this}),rotateY:(ts=new At,function(t){return ts.makeRotationY(t),this.applyMatrix(ts),this}),rotateZ:(Ka=new At,function(t){return Ka.makeRotationZ(t),this.applyMatrix(Ka),this}),translate:(Qa=new At,function(t,e,i){return Qa.makeTranslation(t,e,i),this.applyMatrix(Qa),this}),scale:(Ja=new At,function(t,e,i){return Ja.makeScale(t,e,i),this.applyMatrix(Ja),this}),lookAt:(Za=new u,function(t){Za.lookAt(t),Za.updateMatrix(),this.applyMatrix(Za.matrix)}),center:($a=new Et,function(){return this.computeBoundingBox(),this.boundingBox.getCenter($a).negate(),this.translate($a.x,$a.y,$a.z),this}),setFromObject:function(t){var e,i=t.geometry;return t.isPoints||t.isLine?(t=new L(3*i.vertices.length,3),e=new L(3*i.colors.length,3),this.addAttribute("position",t.copyVector3sArray(i.vertices)),this.addAttribute("color",e.copyColorsArray(i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length&&(t=new L(i.lineDistances.length,1),this.addAttribute("lineDistance",t.copyArray(i.lineDistances))),null!==i.boundingSphere&&(this.boundingSphere=i.boundingSphere.clone()),null!==i.boundingBox&&(this.boundingBox=i.boundingBox.clone())):t.isMesh&&i&&i.isGeometry&&this.fromGeometry(i),this},setFromPoints:function(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i];e.push(r.x,r.y,r.z||0)}return this.addAttribute("position",new L(e,3)),this},updateFromObject:function(t){var e=t.geometry;if(t.isMesh){var i=e.__directGeometry;if(!0===e.elementsNeedUpdate&&(i=void 0,e.elementsNeedUpdate=!1),void 0===i)return this.fromGeometry(e);i.verticesNeedUpdate=e.verticesNeedUpdate,i.normalsNeedUpdate=e.normalsNeedUpdate,i.colorsNeedUpdate=e.colorsNeedUpdate,i.uvsNeedUpdate=e.uvsNeedUpdate,i.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=i}return!0===e.verticesNeedUpdate&&(void 0!==(i=this.attributes.position)&&(i.copyVector3sArray(e.vertices),i.needsUpdate=!0),e.verticesNeedUpdate=!1),!0===e.normalsNeedUpdate&&(void 0!==(i=this.attributes.normal)&&(i.copyVector3sArray(e.normals),i.needsUpdate=!0),e.normalsNeedUpdate=!1),!0===e.colorsNeedUpdate&&(void 0!==(i=this.attributes.color)&&(i.copyColorsArray(e.colors),i.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(void 0!==(i=this.attributes.uv)&&(i.copyVector2sArray(e.uvs),i.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(void 0!==(i=this.attributes.lineDistance)&&(i.copyArray(e.lineDistances),i.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new A).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);for(var i in this.addAttribute("position",new m(e,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(e=new Float32Array(3*t.normals.length),this.addAttribute("normal",new m(e,3).copyVector3sArray(t.normals))),0<t.colors.length&&(e=new Float32Array(3*t.colors.length),this.addAttribute("color",new m(e,3).copyColorsArray(t.colors))),0<t.uvs.length&&(e=new Float32Array(2*t.uvs.length),this.addAttribute("uv",new m(e,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(e=new Float32Array(2*t.uvs2.length),this.addAttribute("uv2",new m(e,2).copyVector2sArray(t.uvs2))),this.groups=t.groups,t.morphTargets){e=[];for(var n=t.morphTargets[i],r=0,o=n.length;r<o;r++){var a=n[r],s=new L(3*a.data.length,3);s.name=a.name,e.push(s.copyVector3sArray(a.data))}this.morphAttributes[i]=e}return 0<t.skinIndices.length&&(i=new L(4*t.skinIndices.length,4),this.addAttribute("skinIndex",i.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(i=new L(4*t.skinWeights.length,4),this.addAttribute("skinWeight",i.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:(Ya=new n,function(){null===this.boundingBox&&(this.boundingBox=new n);var t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e){t=0;for(var i=e.length;t<i;t++)Ya.setFromBufferAttribute(e[t]),this.boundingBox.expandByPoint(Ya.min),this.boundingBox.expandByPoint(Ya.max)}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}),computeBoundingSphere:(Wa=new n,qa=new n,Xa=new Et,function(){null===this.boundingSphere&&(this.boundingSphere=new h);var t=this.attributes.position,e=this.morphAttributes.position;if(t){var i=this.boundingSphere.center;if(Wa.setFromBufferAttribute(t),e)for(var n=0,r=e.length;n<r;n++){var o=e[n];qa.setFromBufferAttribute(o),Wa.expandByPoint(qa.min),Wa.expandByPoint(qa.max)}Wa.getCenter(i);for(var a=0,n=0,r=t.count;n<r;n++)Xa.fromBufferAttribute(t,n),a=Math.max(a,i.distanceToSquared(Xa));if(e)for(n=0,r=e.length;n<r;n++){t=0;for(var s=(o=e[n]).count;t<s;t++)Xa.fromBufferAttribute(o,t),a=Math.max(a,i.distanceToSquared(Xa))}this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var i=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new m(new Float32Array(i.length),3));else for(var n=e.normal.array,r=0,o=n.length;r<o;r++)n[r]=0;n=e.normal.array;var a=new Et,s=new Et,c=new Et,l=new Et,h=new Et;if(t)for(var u=t.array,r=0,o=t.count;r<o;r+=3){t=3*u[r+0];var d=3*u[r+1],p=3*u[r+2];a.fromArray(i,t),s.fromArray(i,d),c.fromArray(i,p),l.subVectors(c,s),h.subVectors(a,s),l.cross(h),n[t]+=l.x,n[t+1]+=l.y,n[t+2]+=l.z,n[d]+=l.x,n[1+d]+=l.y,n[2+d]+=l.z,n[p]+=l.x,n[1+p]+=l.y,n[2+p]+=l.z}else for(r=0,o=i.length;r<o;r+=9)a.fromArray(i,r),s.fromArray(i,r+3),c.fromArray(i,r+6),l.subVectors(c,s),h.subVectors(a,s),l.cross(h),n[r]=l.x,n[r+1]=l.y,n[r+2]=l.z,n[r+3]=l.x,n[r+4]=l.y,n[r+5]=l.z,n[r+6]=l.x,n[r+7]=l.y,n[r+8]=l.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var i,n=this.attributes;for(i in n)if(void 0!==t.attributes[i])for(var r=n[i].array,o=(s=t.attributes[i]).array,a=s.itemSize*e,s=Math.min(o.length,r.length-a),c=0;c<s;c++,a++)r[a]=o[c];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:(Va=new Et,function(){for(var t=this.attributes.normal,e=0,i=t.count;e<i;e++)Va.x=t.getX(e),Va.y=t.getY(e),Va.z=t.getZ(e),Va.normalize(),t.setXYZ(e,Va.x,Va.y,Va.z)}),toNonIndexed:function(){function t(t,e){var i=t.array;t=t.itemSize;for(var n,r=new i.constructor(e.length*t),o=0,a=0,s=e.length;a<s;a++){n=e[a]*t;for(var c=0;c<t;c++)r[o++]=i[n++]}return new m(r,t)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e,i=new P,n=this.index.array,r=this.attributes;for(e in r){var o=t(o=r[e],n);i.addAttribute(e,o)}var a=this.morphAttributes;for(e in a){for(var s=[],c=a[e],r=0,l=c.length;r<l;r++)o=t(o=c[r],n),s.push(o);i.morphAttributes[e]=s}for(r=0,e=(n=this.groups).length;r<e;r++)o=n[r],i.addGroup(o.start,o.count,o.materialIndex);return i},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),0<Object.keys(this.userData).length&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(l in e)void 0!==e[l]&&(t[l]=e[l]);return t}t.data={attributes:{}},null!==(e=this.index)&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});var i=this.attributes;for(l in i){var n=(e=i[l]).toJSON();""!==e.name&&(n.name=e.name),t.data.attributes[l]=n}var r=!(i={});for(l in this.morphAttributes){for(var o=this.morphAttributes[l],a=[],s=0,c=o.length;s<c;s++)n=(e=o[s]).toJSON(),""!==e.name&&(n.name=e.name),a.push(n);0<a.length&&(i[l]=a,r=!0)}r&&(t.data.morphAttributes=i);var l=this.groups;return 0<l.length&&(t.data.groups=JSON.parse(JSON.stringify(l))),null!==(l=this.boundingSphere)&&(t.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),t},clone:function(){return(new P).copy(this)},copy:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.name=t.name;var e=t.index;for(a in null!==e&&this.setIndex(e.clone()),e=t.attributes)this.addAttribute(a,e[a].clone());var i=t.morphAttributes;for(a in i){for(var n=[],r=i[a],e=0,o=r.length;e<o;e++)n.push(r[e].clone());this.morphAttributes[a]=n}var a=t.groups;for(e=0,o=a.length;e<o;e++)i=a[e],this.addGroup(i.start,i.count,i.materialIndex);return null!==(a=t.boundingBox)&&(this.boundingBox=a.clone()),null!==(a=t.boundingSphere)&&(this.boundingSphere=a.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(R.prototype=Object.create(f.prototype)).constructor=R,(I.prototype=Object.create(P.prototype)).constructor=I,(O.prototype=Object.create(f.prototype)).constructor=O,(D.prototype=Object.create(P.prototype)).constructor=D;var ns,rs,os,as,ss,cs,ls,hs,us,ds,ps,fs,ms,gs,vs,ys,bs,xs,ws,Es,Ms,_s,Ss,As,Ts,Cs,Ls,Ps,Rs,Is,Os,Ds,ks,Ns,zs,Bs,Fs,Us,js,Hs,Gs,Vs,Ws,qs,Xs=0;function Ys(t,e,i,n,r,o,a,s){return null===(1===e.side?n.intersectTriangle(a,o,r,!0,s):n.intersectTriangle(r,o,a,2!==e.side,s))?null:(qs.copy(s),qs.applyMatrix4(t.matrixWorld),(e=i.ray.origin.distanceTo(qs))<i.near||e>i.far?null:{distance:e,point:qs.clone(),object:t})}function $s(t,e,i,n,r,o,a,s,c,l){if(Os.fromBufferAttribute(r,s),Ds.fromBufferAttribute(r,c),ks.fromBufferAttribute(r,l),r=t.morphTargetInfluences,e.morphTargets&&o&&r){Fs.set(0,0,0),Us.set(0,0,0),js.set(0,0,0);for(var h=0,u=o.length;h<u;h++){var d=r[h],p=o[h];0!==d&&(Ns.fromBufferAttribute(p,s),zs.fromBufferAttribute(p,c),Bs.fromBufferAttribute(p,l),Fs.addScaledVector(Ns.sub(Os),d),Us.addScaledVector(zs.sub(Ds),d),js.addScaledVector(Bs.sub(ks),d))}Os.add(Fs),Ds.add(Us),ks.add(js)}return(t=Ys(t,e,i,n,Os,Ds,ks,Ws))&&(a&&(Hs.fromBufferAttribute(a,s),Gs.fromBufferAttribute(a,c),Vs.fromBufferAttribute(a,l),t.uv=B.getUV(Ws,Os,Ds,ks,Hs,Gs,Vs,new wt)),a=new y(s,c,l),B.getNormal(Os,Ds,ks,a.normal),t.face=a),t}k.prototype=Object.assign(Object.create(e.prototype),{constructor:k,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var i,n=t[e];void 0===n?console.warn("THREE.Material: '"+e+"' parameter is undefined."):"shading"===e?(console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n):void 0===(i=this[e])?console.warn("THREE."+this.type+": '"+e+"' is not a property of this material."):i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n}},toJSON:function(t){function e(t){var e,i=[];for(e in t){var n=t[e];delete n.metadata,i.push(n)}return i}var i=void 0===t||"string"==typeof t;i&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};return n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),0!==this.side&&(n.side=this.side),0!==this.vertexColors&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),0<this.alphaTest&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),1<this.wireframeLinewidth&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),i&&(i=e(t.textures),t=e(t.images),0<i.length&&(n.textures=i),0<t.length&&(n.images=t)),n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.userData=JSON.parse(JSON.stringify(t.userData)),this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=t.clippingPlanes,i=null;if(null!==e)for(var n=e.length,i=Array(n),r=0;r!==n;++r)i[r]=e[r].clone();return this.clippingPlanes=i,this.shadowSide=t.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),((N.prototype=Object.create(k.prototype)).constructor=N).prototype.isShaderMaterial=!0,N.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Tt(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},N.prototype.toJSON=function(t){var e=k.prototype.toJSON.call(this,t);for(var i in e.uniforms={},this.uniforms){var n=this.uniforms[i].value;e.uniforms[i]=n&&n.isTexture?{type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?{type:"c",value:n.getHex()}:n&&n.isVector2?{type:"v2",value:n.toArray()}:n&&n.isVector3?{type:"v3",value:n.toArray()}:n&&n.isVector4?{type:"v4",value:n.toArray()}:n&&n.isMatrix3?{type:"m3",value:n.toArray()}:n&&n.isMatrix4?{type:"m4",value:n.toArray()}:{value:n}}for(var r in 0<Object.keys(this.defines).length&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,t={},this.extensions)!0===this.extensions[r]&&(t[r]=!0);return 0<Object.keys(t).length&&(e.extensions=t),e},Object.assign(z.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new Et),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:(ps=new Et,function(t){return this.origin.copy(this.at(t,ps)),this}),closestPointToPoint:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new Et),e.subVectors(t,this.origin),(t=e.dot(this.direction))<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(t).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:(ds=new Et,function(t){var e=ds.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(ds.copy(this.direction).multiplyScalar(e).add(this.origin),ds.distanceToSquared(t))}),distanceSqToSegment:(ls=new Et,hs=new Et,us=new Et,function(t,e,i,n){ls.copy(t).add(e).multiplyScalar(.5),hs.copy(e).sub(t).normalize(),us.copy(this.origin).sub(ls);var r,o=.5*t.distanceTo(e),a=-this.direction.dot(hs),s=us.dot(this.direction),c=-us.dot(hs),l=us.lengthSq(),h=Math.abs(1-a*a);return a=0<h?(e=a*s-c,r=o*h,0<=(t=a*c-s)?-r<=e?e<=r?(t*=o=1/h)*(t+a*(e*=o)+2*s)+e*(a*t+e+2*c)+l:(e=o,-(t=Math.max(0,-(a*e+s)))*t+e*(e+2*c)+l):(e=-o,-(t=Math.max(0,-(a*e+s)))*t+e*(e+2*c)+l):e<=-r?-(t=Math.max(0,-(-a*o+s)))*t+(e=0<t?-o:Math.min(Math.max(-o,-c),o))*(e+2*c)+l:e<=r?(t=0,(e=Math.min(Math.max(-o,-c),o))*(e+2*c)+l):-(t=Math.max(0,-(a*o+s)))*t+(e=0<t?o:Math.min(Math.max(-o,-c),o))*(e+2*c)+l):(e=0<a?-o:o,-(t=Math.max(0,-(a*e+s)))*t+e*(e+2*c)+l),i&&i.copy(this.direction).multiplyScalar(t).add(this.origin),n&&n.copy(hs).multiplyScalar(e).add(ls),a}),intersectSphere:(cs=new Et,function(t,e){cs.subVectors(t.center,this.origin);var i=cs.dot(this.direction),n=cs.dot(cs)-i*i;return(t=t.radius*t.radius)<n?null:(n=i-(t=Math.sqrt(t-n)),i+=t,n<0&&i<0?null:n<0?this.at(i,e):this.at(n,e))}),intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);return 0===e?0===t.distanceToPoint(this.origin)?0:null:0<=(t=-(this.origin.dot(t.normal)+t.constant)/e)?t:null},intersectPlane:function(t,e){return null===(t=this.distanceToPlane(t))?null:this.at(t,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var i,n,r=1/this.direction.x,o=1/this.direction.y,a=1/this.direction.z,s=this.origin;return 0<=r?(i=(t.min.x-s.x)*r,r*=t.max.x-s.x):(i=(t.max.x-s.x)*r,r*=t.min.x-s.x),0<=o?(n=(t.min.y-s.y)*o,o*=t.max.y-s.y):(n=(t.max.y-s.y)*o,o*=t.min.y-s.y),o<i||r<n?null:((i<n||i!=i)&&(i=n),(o<r||r!=r)&&(r=o),(t=0<=a?(n=(t.min.z-s.z)*a,(t.max.z-s.z)*a):(n=(t.max.z-s.z)*a,(t.min.z-s.z)*a))<i||r<n?null:((i<n||i!=i)&&(i=n),(t<r||r!=r)&&(r=t),r<0?null:this.at(0<=i?i:r,e)))},intersectsBox:(ss=new Et,function(t){return null!==this.intersectBox(t,ss)}),intersectTriangle:(ns=new Et,rs=new Et,os=new Et,as=new Et,function(t,e,i,n,r){if(rs.subVectors(e,t),os.subVectors(i,t),as.crossVectors(rs,os),0<(e=this.direction.dot(as))){if(n)return null;n=1}else{if(!(e<0))return null;n=-1,e=-e}return ns.subVectors(this.origin,t),(t=n*this.direction.dot(os.crossVectors(ns,os)))<0||(i=n*this.direction.dot(rs.cross(ns)))<0||e<t+i||(t=-n*ns.dot(as))<0?null:this.at(t/e,r)}),applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}),Object.assign(B,{getNormal:(ws=new Et,function(t,e,i,n){return void 0===n&&(console.warn("THREE.Triangle: .getNormal() target is now required"),n=new Et),n.subVectors(i,e),ws.subVectors(t,e),n.cross(ws),0<(t=n.lengthSq())?n.multiplyScalar(1/Math.sqrt(t)):n.set(0,0,0)}),getBarycoord:(ys=new Et,bs=new Et,xs=new Et,function(t,e,i,n,r){ys.subVectors(n,e),bs.subVectors(i,e),xs.subVectors(t,e),t=ys.dot(ys),e=ys.dot(bs),i=ys.dot(xs);var o=bs.dot(bs);n=bs.dot(xs);var a=t*o-e*e;return void 0===r&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),r=new Et),0==a?r.set(-2,-1,-1):(o=(o*i-e*n)*(a=1/a),t=(t*n-e*i)*a,r.set(1-o-t,t,o))}),containsPoint:(vs=new Et,function(t,e,i,n){return B.getBarycoord(t,e,i,n,vs),0<=vs.x&&0<=vs.y&&vs.x+vs.y<=1}),getUV:(gs=new Et,function(t,e,i,n,r,o,a,s){return this.getBarycoord(t,e,i,n,gs),s.set(0,0),s.addScaledVector(r,gs.x),s.addScaledVector(o,gs.y),s.addScaledVector(a,gs.z),s}),isFrontFacing:(fs=new Et,ms=new Et,function(t,e,i,n){return fs.subVectors(i,e),ms.subVectors(t,e),fs.cross(ms).dot(n)<0})}),Object.assign(B.prototype,{set:function(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this},setFromPointsAndIndices:function(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:(Cs=new Et,Ls=new Et,function(){return Cs.subVectors(this.c,this.b),Ls.subVectors(this.a,this.b),.5*Cs.cross(Ls).length()}),getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new Et),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return B.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Et),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return B.getBarycoord(t,this.a,this.b,this.c,e)},getUV:function(t,e,i,n,r){return B.getUV(t,this.a,this.b,this.c,e,i,n,r)},containsPoint:function(t){return B.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return B.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:(Es=new Et,Ms=new Et,_s=new Et,Ss=new Et,As=new Et,Ts=new Et,function(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new Et);var i=this.a,n=this.b,r=this.c;Es.subVectors(n,i),Ms.subVectors(r,i),Ss.subVectors(t,i);var o=Es.dot(Ss),a=Ms.dot(Ss);if(o<=0&&a<=0)return e.copy(i);As.subVectors(t,n);var s=Es.dot(As),c=Ms.dot(As);if(0<=s&&c<=s)return e.copy(n);var l=o*c-s*a;if(l<=0&&0<=o&&s<=0)return n=o/(o-s),e.copy(i).addScaledVector(Es,n);Ts.subVectors(t,r),t=Es.dot(Ts);var h=Ms.dot(Ts);return 0<=h&&t<=h?e.copy(r):(o=t*a-o*h)<=0&&0<=a&&h<=0?(l=a/(a-h),e.copy(i).addScaledVector(Ms,l)):(a=s*h-t*c)<=0&&0<=c-s&&0<=t-h?(_s.subVectors(r,n),l=(c-s)/(c-s+(t-h)),e.copy(n).addScaledVector(_s,l)):(n=o*(r=1/(a+o+l)),l*=r,e.copy(i).addScaledVector(Es,n).addScaledVector(Ms,l))}),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}),((F.prototype=Object.create(k.prototype)).constructor=F).prototype.isMeshBasicMaterial=!0,F.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},U.prototype=Object.assign(Object.create(u.prototype),{constructor:U,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return u.prototype.copy.call(this,t),this.drawMode=t.drawMode,void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){t=t.morphAttributes;var e=Object.keys(t);if(0<e.length){var i=t[e[0]];if(void 0!==i)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=i.length;t<e;t++){var n=i[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}else void 0!==(t=t.morphTargets)&&0<t.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},raycast:(Ps=new At,Rs=new z,Is=new h,Os=new Et,Ds=new Et,ks=new Et,Ns=new Et,zs=new Et,Bs=new Et,Fs=new Et,Us=new Et,js=new Et,Hs=new wt,Gs=new wt,Vs=new wt,Ws=new Et,qs=new Et,function(t,e){var i=this.geometry,n=this.material,r=this.matrixWorld;if(void 0!==n&&(null===i.boundingSphere&&i.computeBoundingSphere(),Is.copy(i.boundingSphere),Is.applyMatrix4(r),!1!==t.ray.intersectsSphere(Is)&&(Ps.getInverse(r),Rs.copy(t.ray).applyMatrix4(Ps),null===i.boundingBox||!1!==Rs.intersectsBox(i.boundingBox))))if(i.isBufferGeometry){var o=i.index,r=i.attributes.position,a=i.morphAttributes.position,s=i.attributes.uv,c=i.groups,l=i.drawRange;if(null!==o)if(Array.isArray(n))for(var h=0,u=c.length;h<u;h++)for(var d=c[h],p=n[d.materialIndex],f=Math.max(d.start,l.start),m=i=Math.min(d.start+d.count,l.start+l.count);f<m;f+=3){i=o.getX(f);var g=o.getX(f+1),v=o.getX(f+2);(i=$s(this,p,t,Rs,r,a,s,i,g,v))&&(i.faceIndex=Math.floor(f/3),i.face.materialIndex=d.materialIndex,e.push(i))}else for(h=f=Math.max(0,l.start),u=i=Math.min(o.count,l.start+l.count);h<u;h+=3)i=o.getX(h),g=o.getX(h+1),v=o.getX(h+2),(i=$s(this,n,t,Rs,r,a,s,i,g,v))&&(i.faceIndex=Math.floor(h/3),e.push(i));else if(void 0!==r)if(Array.isArray(n))for(h=0,u=c.length;h<u;h++)for(p=n[(d=c[h]).materialIndex],f=Math.max(d.start,l.start),m=i=Math.min(d.start+d.count,l.start+l.count);f<m;f+=3)(i=$s(this,p,t,Rs,r,a,s,i=f,g=f+1,v=f+2))&&(i.faceIndex=Math.floor(f/3),i.face.materialIndex=d.materialIndex,e.push(i));else for(h=f=Math.max(0,l.start),u=i=Math.min(r.count,l.start+l.count);h<u;h+=3)(i=$s(this,n,t,Rs,r,a,s,i=h,g=h+1,v=h+2))&&(i.faceIndex=Math.floor(h/3),e.push(i))}else if(i.isGeometry)for(r=Array.isArray(n),a=i.vertices,s=i.faces,0<(i=i.faceVertexUvs[0]).length&&(o=i),u=0,d=s.length;u<d;u++)p=s[u],void 0!==(i=r?n[p.materialIndex]:n)&&(c=a[p.a],l=a[p.b],h=a[p.c],i=Ys(this,i,t,Rs,c,l,h,Ws))&&(o&&o[u]&&(f=o[u],Hs.copy(f[0]),Gs.copy(f[1]),Vs.copy(f[2]),i.uv=B.getUV(Ws,c,l,h,Hs,Gs,Vs,new wt)),i.face=p,i.faceIndex=u,e.push(i))}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),((H.prototype=Object.create(d.prototype)).constructor=H).prototype.isCubeTexture=!0,Object.defineProperty(H.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),((G.prototype=Object.create(d.prototype)).constructor=G).prototype.isDataTexture2DArray=!0,((V.prototype=Object.create(d.prototype)).constructor=V).prototype.isDataTexture3D=!0;var Zs=new d,Js=new G,Qs=new V,Ks=new H,tc=[],ec=[],ic=new Float32Array(16),nc=new Float32Array(9),rc=new Float32Array(4);Gt.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),X(e,t)},Vt.prototype.setValue=function(t,e,i){for(var n=this.seq,r=0,o=n.length;r!==o;++r){var a=n[r];a.setValue(t,e[a.id],i)}};var oc=/([\w\d_]+)(\])?(\[|\.)?/g;Wt.prototype.setValue=function(t,e,i,n){void 0!==(e=this.map[e])&&e.setValue(t,i,n)},Wt.prototype.setOptional=function(t,e,i){void 0!==(e=e[i])&&this.setValue(t,i,e)},Wt.upload=function(t,e,i,n){for(var r=0,o=e.length;r!==o;++r){var a=e[r],s=i[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,n)}},Wt.seqWithValue=function(t,e){for(var i=[],n=0,r=t.length;n!==r;++n){var o=t[n];o.id in e&&i.push(o)}return i};var ac=0,sc=0;((ue.prototype=Object.create(k.prototype)).constructor=ue).prototype.isMeshDepthMaterial=!0,ue.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},((de.prototype=Object.create(k.prototype)).constructor=de).prototype.isMeshDistanceMaterial=!0,de.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},ve.prototype=Object.assign(Object.create(u.prototype),{constructor:ve,isGroup:!0}),ye.prototype=Object.assign(Object.create(u.prototype),{constructor:ye,isCamera:!0,copy:function(t,e){return u.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new Et),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){u.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),be.prototype=Object.assign(Object.create(ye.prototype),{constructor:be,isPerspectiveCamera:!0,copy:function(t,e){return ye.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){t=.5*this.getFilmHeight()/t,this.fov=2*uo.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*uo.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*uo.RAD2DEG*Math.atan(Math.tan(.5*uo.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,i,n,r,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t,e,i=this.near,n=i*Math.tan(.5*uo.DEG2RAD*this.fov)/this.zoom,r=2*n,o=this.aspect*r,a=-.5*o,s=this.view;null!==this.view&&this.view.enabled&&(t=s.fullWidth,e=s.fullHeight,a+=s.offsetX*o/t,n-=s.offsetY*r/e,o*=s.width/t,r*=s.height/e),0!==(s=this.filmOffset)&&(a+=i*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+o,n,n-r,i,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){return(t=u.prototype.toJSON.call(this,t)).object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),xe.prototype=Object.assign(Object.create(be.prototype),{constructor:xe,isArrayCamera:!0});var cc,lc,hc,uc,dc,pc,fc,mc,gc,vc,yc,bc,xc,wc,Ec,Mc,_c,Sc,Ac,Tc,Cc,Lc,Pc,Rc,Ic,Oc,Dc,kc,Nc=new Et,zc=new Et;function Bc(t,e,i,n,r,o){dc.subVectors(t,i).addScalar(.5).multiply(n),void 0!==r?(pc.x=o*dc.x-r*dc.y,pc.y=r*dc.x+o*dc.y):pc.copy(dc),t.copy(e),t.x+=pc.x,t.y+=pc.y,t.applyMatrix4(fc)}Object.assign(Se.prototype,{isFogExp2:!0,clone:function(){return new Se(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Ae.prototype,{isFog:!0,clone:function(){return new Ae(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Te.prototype=Object.assign(Object.create(u.prototype),{constructor:Te,isScene:!0,copy:function(t,e){return u.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=u.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Ce.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Ce.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==t?t.length/this.stride:0,this.array=t,this},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.stride,i*=e.stride;for(var n=0,r=this.stride;n<r;n++)this.array[t+n]=e.array[i+n];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}}),Object.defineProperties(Le.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Le.prototype,{isInterleavedBufferAttribute:!0,setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this},setXYZW:function(t,e,i,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this.data.array[t+3]=r,this}}),((Pe.prototype=Object.create(k.prototype)).constructor=Pe).prototype.isSpriteMaterial=!0,Pe.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this},Re.prototype=Object.assign(Object.create(u.prototype),{constructor:Re,isSprite:!0,raycast:(lc=new Et,hc=new Et,uc=new Et,dc=new wt,pc=new wt,fc=new At,mc=new Et,gc=new Et,vc=new Et,yc=new wt,bc=new wt,xc=new wt,function(t,e){hc.setFromMatrixScale(this.matrixWorld),fc.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld),uc.setFromMatrixPosition(this.modelViewMatrix);var i,n,r=this.material.rotation;0!==r&&(i=Math.cos(r),n=Math.sin(r)),r=this.center,Bc(mc.set(-.5,-.5,0),uc,r,hc,n,i),Bc(gc.set(.5,-.5,0),uc,r,hc,n,i),Bc(vc.set(.5,.5,0),uc,r,hc,n,i),yc.set(0,0),bc.set(1,0),xc.set(1,1);var o=t.ray.intersectTriangle(mc,gc,vc,!1,lc);null===o&&(Bc(gc.set(-.5,.5,0),uc,r,hc,n,i),bc.set(0,1),null===t.ray.intersectTriangle(mc,vc,gc,!1,lc))||(n=t.ray.origin.distanceTo(lc))<t.near||n>t.far||e.push({distance:n,point:lc.clone(),uv:B.getUV(lc,mc,gc,vc,yc,bc,xc,new wt),face:null,object:this})}),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return u.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}}),Ie.prototype=Object.assign(Object.create(u.prototype),{constructor:Ie,isLOD:!0,copy:function(t){u.prototype.copy.call(this,t,!1);for(var e=0,i=(t=t.levels).length;e<i;e++){var n=t[e];this.addLevel(n.object.clone(),n.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var i=this.levels,n=0;n<i.length&&!(e<i[n].distance);n++);return i.splice(n,0,{distance:e,object:t}),this.add(t),this},getObjectForDistance:function(t){for(var e=this.levels,i=1,n=e.length;i<n&&!(t<e[i].distance);i++);return e[i-1].object},raycast:(Mc=new Et,function(t,e){Mc.setFromMatrixPosition(this.matrixWorld);var i=t.ray.origin.distanceTo(Mc);this.getObjectForDistance(i).raycast(t,e)}),update:(wc=new Et,Ec=new Et,function(t){var e=this.levels;if(1<e.length){wc.setFromMatrixPosition(t.matrixWorld),Ec.setFromMatrixPosition(this.matrixWorld),t=wc.distanceTo(Ec),e[0].object.visible=!0;for(var i=1,n=e.length;i<n&&t>=e[i].distance;i++)e[i-1].object.visible=!1,e[i].object.visible=!0;for(;i<n;i++)e[i].object.visible=!1}}),toJSON:function(t){(t=u.prototype.toJSON.call(this,t)).object.levels=[];for(var e=this.levels,i=0,n=e.length;i<n;i++){var r=e[i];t.object.levels.push({object:r.object.uuid,distance:r.distance})}return t}}),Oe.prototype=Object.assign(Object.create(U.prototype),{constructor:Oe,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new Mt,e=this.geometry.attributes.skinWeight,i=0,n=e.count;i<n;i++){t.x=e.getX(i),t.y=e.getY(i),t.z=e.getZ(i),t.w=e.getW(i);var r=1/t.manhattanLength();1/0!=r?t.multiplyScalar(r):t.set(1,0,0,0),e.setXYZW(i,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){U.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Object.assign(De.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var i=new At;this.bones[t]&&i.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(i)}},pose:function(){for(var t,e=0,i=this.bones.length;e<i;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,i=this.bones.length;e<i;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:(_c=new At,Sc=new At,function(){for(var t=this.bones,e=this.boneInverses,i=this.boneMatrices,n=this.boneTexture,r=0,o=t.length;r<o;r++)_c.multiplyMatrices(t[r]?t[r].matrixWorld:Sc,e[r]),_c.toArray(i,16*r);void 0!==n&&(n.needsUpdate=!0)}),clone:function(){return new De(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,i=this.bones.length;e<i;e++){var n=this.bones[e];if(n.name===t)return n}}}),ke.prototype=Object.assign(Object.create(u.prototype),{constructor:ke,isBone:!0}),((Ne.prototype=Object.create(k.prototype)).constructor=Ne).prototype.isLineBasicMaterial=!0,Ne.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},ze.prototype=Object.assign(Object.create(u.prototype),{constructor:ze,isLine:!0,computeLineDistances:(Lc=new Et,Pc=new Et,function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,i=[0],n=1,r=e.count;n<r;n++)Lc.fromBufferAttribute(e,n-1),Pc.fromBufferAttribute(e,n),i[n]=i[n-1],i[n]+=Lc.distanceTo(Pc);t.addAttribute("lineDistance",new L(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(e=t.vertices,(i=t.lineDistances)[0]=0,n=1,r=e.length;n<r;n++)i[n]=i[n-1],i[n]+=e[n-1].distanceTo(e[n]);return this}),raycast:(Ac=new At,Tc=new z,Cc=new h,function(t,e){var i=t.linePrecision,n=this.geometry,r=this.matrixWorld;if(null===n.boundingSphere&&n.computeBoundingSphere(),Cc.copy(n.boundingSphere),Cc.applyMatrix4(r),Cc.radius+=i,!1!==t.ray.intersectsSphere(Cc)){Ac.getInverse(r),Tc.copy(t.ray).applyMatrix4(Ac),i/=(this.scale.x+this.scale.y+this.scale.z)/3,i*=i;var o=new Et,a=new Et,r=new Et,s=new Et,c=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){var l=n.index,h=n.attributes.position.array;if(null!==l){n=0;for(var u=(l=l.array).length-1;n<u;n+=c){var d=l[n+1];o.fromArray(h,3*l[n]),a.fromArray(h,3*d),i<(d=Tc.distanceSqToSegment(o,a,s,r))||(s.applyMatrix4(this.matrixWorld),(d=t.ray.origin.distanceTo(s))<t.near||d>t.far||e.push({distance:d,point:r.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this}))}}else for(n=0,u=h.length/3-1;n<u;n+=c)o.fromArray(h,3*n),a.fromArray(h,3*n+3),i<(d=Tc.distanceSqToSegment(o,a,s,r))||(s.applyMatrix4(this.matrixWorld),(d=t.ray.origin.distanceTo(s))<t.near||d>t.far||e.push({distance:d,point:r.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this}))}else if(n.isGeometry)for(a=(o=n.vertices).length,n=0;n<a-1;n+=c)i<(d=Tc.distanceSqToSegment(o[n],o[n+1],s,r))||(s.applyMatrix4(this.matrixWorld),(d=t.ray.origin.distanceTo(s))<t.near||d>t.far||e.push({distance:d,point:r.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this}))}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Be.prototype=Object.assign(Object.create(ze.prototype),{constructor:Be,isLineSegments:!0,computeLineDistances:(Rc=new Et,Ic=new Et,function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,i=[],n=0,r=e.count;n<r;n+=2)Rc.fromBufferAttribute(e,n),Ic.fromBufferAttribute(e,n+1),i[n]=0===n?0:i[n-1],i[n+1]=i[n]+Rc.distanceTo(Ic);t.addAttribute("lineDistance",new L(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(e=t.vertices,i=t.lineDistances,n=0,r=e.length;n<r;n+=2)Rc.copy(e[n]),Ic.copy(e[n+1]),i[n]=0===n?0:i[n-1],i[n+1]=i[n]+Rc.distanceTo(Ic);return this})}),Fe.prototype=Object.assign(Object.create(ze.prototype),{constructor:Fe,isLineLoop:!0}),((Ue.prototype=Object.create(k.prototype)).constructor=Ue).prototype.isPointsMaterial=!0,Ue.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this},je.prototype=Object.assign(Object.create(u.prototype),{constructor:je,isPoints:!0,raycast:(Oc=new At,Dc=new z,kc=new h,function(n,r){function t(t,e){var i=Dc.distanceSqToPoint(t);i<s&&(Dc.closestPointToPoint(t,c),c.applyMatrix4(a),(t=n.ray.origin.distanceTo(c))<n.near||t>n.far||r.push({distance:t,distanceToRay:Math.sqrt(i),point:c.clone(),index:e,face:null,object:o}))}var o=this,e=this.geometry,a=this.matrixWorld,i=n.params.Points.threshold;if(null===e.boundingSphere&&e.computeBoundingSphere(),kc.copy(e.boundingSphere),kc.applyMatrix4(a),kc.radius+=i,!1!==n.ray.intersectsSphere(kc)){Oc.getInverse(a),Dc.copy(n.ray).applyMatrix4(Oc);var s=(i/=(this.scale.x+this.scale.y+this.scale.z)/3)*i,i=new Et,c=new Et;if(e.isBufferGeometry){var l=e.index,e=e.attributes.position.array;if(null!==l)for(var h=l.array,l=0,u=h.length;l<u;l++){var d=h[l];i.fromArray(e,3*d),t(i,d)}else for(l=0,h=e.length/3;l<h;l++)i.fromArray(e,3*l),t(i,l)}else for(l=0,h=(i=e.vertices).length;l<h;l++)t(i[l],l)}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),He.prototype=Object.assign(Object.create(d.prototype),{constructor:He,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),((Ge.prototype=Object.create(d.prototype)).constructor=Ge).prototype.isCompressedTexture=!0,((Ve.prototype=Object.create(d.prototype)).constructor=Ve).prototype.isCanvasTexture=!0,((We.prototype=Object.create(d.prototype)).constructor=We).prototype.isDepthTexture=!0,(qe.prototype=Object.create(P.prototype)).constructor=qe,(Xe.prototype=Object.create(f.prototype)).constructor=Xe,(Ye.prototype=Object.create(P.prototype)).constructor=Ye,($e.prototype=Object.create(f.prototype)).constructor=$e,(Ze.prototype=Object.create(P.prototype)).constructor=Ze,(Je.prototype=Object.create(f.prototype)).constructor=Je,(Qe.prototype=Object.create(Ze.prototype)).constructor=Qe,(Ke.prototype=Object.create(f.prototype)).constructor=Ke,(ti.prototype=Object.create(Ze.prototype)).constructor=ti,(ei.prototype=Object.create(f.prototype)).constructor=ei,(ii.prototype=Object.create(Ze.prototype)).constructor=ii,(ni.prototype=Object.create(f.prototype)).constructor=ni,(ri.prototype=Object.create(Ze.prototype)).constructor=ri,(oi.prototype=Object.create(f.prototype)).constructor=oi,((ai.prototype=Object.create(P.prototype)).constructor=ai).prototype.toJSON=function(){var t=P.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},(si.prototype=Object.create(f.prototype)).constructor=si,(ci.prototype=Object.create(P.prototype)).constructor=ci,(li.prototype=Object.create(f.prototype)).constructor=li,(hi.prototype=Object.create(P.prototype)).constructor=hi;var Fc=function(t,e,i){i=i||2;var n,r=(c=e&&e.length)?e[0]*i:t.length,o=ui(t,0,r,i,!0),a=[];if(!o)return a;if(c){for(var s=i,c=[],l=0,h=e.length;l<h;l++){var u=e[l]*s;(u=ui(t,u,l<h-1?e[l+1]*s:t.length,s,!1))===u.next&&(u.steiner=!0),c.push(function(t){for(var e=t,i=t;e.x<i.x&&(i=e),(e=e.next)!==t;);return i}(u))}for(c.sort(pi),l=0;l<c.length;l++)(s=function(t,e){var i=e,n=t.x,r=t.y,o=-1/0;do{if(r<=i.y&&r>=i.next.y&&i.next.y!==i.y){var a=i.x+(r-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=n&&o<a){if((o=a)===n){if(r===i.y)return i;if(r===i.next.y)return i.next}var s=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!s)return null;if(n===o)return s.prev;a=(e=s).x;for(var c,l=s.y,h=1/0,i=s.next;i!==e;){n>=i.x&&i.x>=a&&n!==i.x&&mi(r<l?n:o,r,a,l,r<l?o:n,r,i.x,i.y)&&(((c=Math.abs(r-i.y)/(n-i.x))<h||c===h&&i.x>s.x)&&bi(i,t)&&(s=i,h=c)),i=i.next}return s}(e=c[l],s=o))&&di(e=xi(s,e),e.next),o=di(o,o.next)}if(t.length>80*i){for(var d=n=t[0],p=c=t[1],s=i;s<r;s+=i)(l=t[s])<d&&(d=l),(e=t[s+1])<p&&(p=e),n<l&&(n=l),c<e&&(c=e);n=0!==(n=Math.max(n-d,c-p))?1/n:0}return function t(e,i,n,r,o,a,s){if(e){if(!s&&a){for(var c=e,l=c;null===l.z&&(l.z=fi(l.x,l.y,r,o,a)),l.prevZ=l.prev,(l=l.nextZ=l.next)!==c;);l.prevZ.nextZ=null,l.prevZ=null,c=l;var h,u,d=1;do{l=c;for(var p=c=null,f=0;l;){f++;for(var m=l,g=h=0;g<d&&(h++,m=m.nextZ);g++);for(u=d;0<h||0<u&&m;)0!==h&&(0===u||!m||l.z<=m.z)?(l=(g=l).nextZ,h--):(m=(g=m).nextZ,u--),p?p.nextZ=g:c=g,g.prevZ=p,p=g;l=m}p.nextZ=null,d*=2}while(1<f)}for(c=e;e.prev!==e.next;){if(l=e.prev,m=e.next,a)t:{u=r;var v=o;if(0<=gi(f=(p=e).prev,h=p,d=p.next))p=!1;else{var y=f.x>h.x?f.x>d.x?f.x:d.x:h.x>d.x?h.x:d.x,b=f.y>h.y?f.y>d.y?f.y:d.y:h.y>d.y?h.y:d.y;for(g=fi(f.x<h.x?f.x<d.x?f.x:d.x:h.x<d.x?h.x:d.x,f.y<h.y?f.y<d.y?f.y:d.y:h.y<d.y?h.y:d.y,u,v,a),u=fi(y,b,u,v,a),v=p.nextZ;v&&v.z<=u;){if(v!==p.prev&&v!==p.next&&mi(f.x,f.y,h.x,h.y,d.x,d.y,v.x,v.y)&&0<=gi(v.prev,v,v.next)){p=!1;break t}v=v.nextZ}for(v=p.prevZ;v&&v.z>=g;){if(v!==p.prev&&v!==p.next&&mi(f.x,f.y,h.x,h.y,d.x,d.y,v.x,v.y)&&0<=gi(v.prev,v,v.next)){p=!1;break t}v=v.prevZ}p=!0}}else t:if(p=e,f=p.prev,h=p,d=p.next,0<=gi(f,h,d))p=!1;else{for(g=p.next.next;g!==p.prev;){if(mi(f.x,f.y,h.x,h.y,d.x,d.y,g.x,g.y)&&0<=gi(g.prev,g,g.next)){p=!1;break t}g=g.next}p=!0}if(p)i.push(l.i/n),i.push(e.i/n),i.push(m.i/n),Ei(e),c=e=m.next;else if((e=m)===c){if(s){if(1===s){for(s=i,c=n,l=e;!vi(m=l.prev,p=l.next.next)&&yi(m,l,l.next,p)&&bi(m,p)&&bi(p,m)&&(s.push(m.i/c),s.push(l.i/c),s.push(p.i/c),Ei(l),Ei(l.next),l=e=p),(l=l.next)!==e;);t(e=l,i,n,r,o,a,2)}else if(2===s)t:{s=e;do{for(c=s.next.next;c!==s.prev;){if(l=s.i!==c.i){if(m=c,p=(l=s).next.i!==m.i&&l.prev.i!==m.i){e:{p=l;do{if(p.i!==l.i&&p.next.i!==l.i&&p.i!==m.i&&p.next.i!==m.i&&yi(p,p.next,l,m)){p=!0;break e}p=p.next}while(p!==l);p=!1}p=!p}if(p=p&&bi(l,m)&&bi(m,l)){for(f=!1,h=((p=l).x+m.x)/2,m=(l.y+m.y)/2;p.y>m!=p.next.y>m&&p.next.y!==p.y&&h<(p.next.x-p.x)*(m-p.y)/(p.next.y-p.y)+p.x&&(f=!f),(p=p.next)!==l;);p=f}l=p}if(l){e=xi(s,c),s=di(s,s.next),e=di(e,e.next),t(s,i,n,r,o,a),t(e,i,n,r,o,a);break t}c=c.next}s=s.next}while(s!==e)}}else t(di(e),i,n,r,o,a,1);break}}}}(o,a,i,d,p,n),a},Uc={area:function(t){for(var e=t.length,i=0,n=e-1,r=0;r<e;n=r++)i+=t[n].x*t[r].y-t[r].x*t[n].y;return.5*i},isClockWise:function(t){return Uc.area(t)<0},triangulateShape:function(t,e){var i=[],n=[],r=[];_i(t),Si(i,t);var o=t.length;for(e.forEach(_i),t=0;t<e.length;t++)n.push(o),o+=e[t].length,Si(i,e[t]);for(e=Fc(i,n),t=0;t<e.length;t+=3)r.push(e.slice(t,t+3));return r}};((Ai.prototype=Object.create(f.prototype)).constructor=Ai).prototype.toJSON=function(){var t=f.prototype.toJSON.call(this);return Ci(this.parameters.shapes,this.parameters.options,t)},((Ti.prototype=Object.create(P.prototype)).constructor=Ti).prototype.toJSON=function(){var t=P.prototype.toJSON.call(this);return Ci(this.parameters.shapes,this.parameters.options,t)};var jc={generateTopUV:function(t,e,i,n,r){t=e[3*n],n=e[3*n+1];var o=e[3*r];return r=e[3*r+1],[new wt(e[3*i],e[3*i+1]),new wt(t,n),new wt(o,r)]},generateSideWallUV:function(t,e,i,n,r,o){t=e[3*i];var a=e[3*i+1];i=e[3*i+2];var s=e[3*n],c=e[3*n+1];n=e[3*n+2];var l=e[3*r],h=e[3*r+1];r=e[3*r+2];var u=e[3*o],d=e[3*o+1];return e=e[3*o+2],Math.abs(a-c)<.01?[new wt(t,1-i),new wt(s,1-n),new wt(l,1-r),new wt(u,1-e)]:[new wt(a,1-i),new wt(c,1-n),new wt(h,1-r),new wt(d,1-e)]}};(Li.prototype=Object.create(f.prototype)).constructor=Li,(Pi.prototype=Object.create(Ti.prototype)).constructor=Pi,(Ri.prototype=Object.create(f.prototype)).constructor=Ri,(Ii.prototype=Object.create(P.prototype)).constructor=Ii,(Oi.prototype=Object.create(f.prototype)).constructor=Oi,(Di.prototype=Object.create(P.prototype)).constructor=Di,(ki.prototype=Object.create(f.prototype)).constructor=ki,(Ni.prototype=Object.create(P.prototype)).constructor=Ni,((zi.prototype=Object.create(f.prototype)).constructor=zi).prototype.toJSON=function(){var t=f.prototype.toJSON.call(this);return Fi(this.parameters.shapes,t)},((Bi.prototype=Object.create(P.prototype)).constructor=Bi).prototype.toJSON=function(){var t=P.prototype.toJSON.call(this);return Fi(this.parameters.shapes,t)},(Ui.prototype=Object.create(P.prototype)).constructor=Ui,(ji.prototype=Object.create(f.prototype)).constructor=ji,(Hi.prototype=Object.create(P.prototype)).constructor=Hi,(Gi.prototype=Object.create(ji.prototype)).constructor=Gi,(Vi.prototype=Object.create(Hi.prototype)).constructor=Vi,(Wi.prototype=Object.create(f.prototype)).constructor=Wi,(qi.prototype=Object.create(P.prototype)).constructor=qi;var Hc=Object.freeze({WireframeGeometry:qe,ParametricGeometry:Xe,ParametricBufferGeometry:Ye,TetrahedronGeometry:Je,TetrahedronBufferGeometry:Qe,OctahedronGeometry:Ke,OctahedronBufferGeometry:ti,IcosahedronGeometry:ei,IcosahedronBufferGeometry:ii,DodecahedronGeometry:ni,DodecahedronBufferGeometry:ri,PolyhedronGeometry:$e,PolyhedronBufferGeometry:Ze,TubeGeometry:oi,TubeBufferGeometry:ai,TorusKnotGeometry:si,TorusKnotBufferGeometry:ci,TorusGeometry:li,TorusBufferGeometry:hi,TextGeometry:Li,TextBufferGeometry:Pi,SphereGeometry:Ri,SphereBufferGeometry:Ii,RingGeometry:Oi,RingBufferGeometry:Di,PlaneGeometry:O,PlaneBufferGeometry:D,LatheGeometry:ki,LatheBufferGeometry:Ni,ShapeGeometry:zi,ShapeBufferGeometry:Bi,ExtrudeGeometry:Ai,ExtrudeBufferGeometry:Ti,EdgesGeometry:Ui,ConeGeometry:Gi,ConeBufferGeometry:Vi,CylinderGeometry:ji,CylinderBufferGeometry:Hi,CircleGeometry:Wi,CircleBufferGeometry:qi,BoxGeometry:R,BoxBufferGeometry:I});((Xi.prototype=Object.create(k.prototype)).constructor=Xi).prototype.isShadowMaterial=!0,Xi.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.color.copy(t.color),this},((Yi.prototype=Object.create(N.prototype)).constructor=Yi).prototype.isRawShaderMaterial=!0,(($i.prototype=Object.create(k.prototype)).constructor=$i).prototype.isMeshStandardMaterial=!0,$i.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Zi.prototype=Object.create($i.prototype)).constructor=Zi).prototype.isMeshPhysicalMaterial=!0,Zi.prototype.copy=function(t){return $i.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},((Ji.prototype=Object.create(k.prototype)).constructor=Ji).prototype.isMeshPhongMaterial=!0,Ji.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Qi.prototype=Object.create(Ji.prototype)).constructor=Qi).prototype.isMeshToonMaterial=!0,Qi.prototype.copy=function(t){return Ji.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},((Ki.prototype=Object.create(k.prototype)).constructor=Ki).prototype.isMeshNormalMaterial=!0,Ki.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((tn.prototype=Object.create(k.prototype)).constructor=tn).prototype.isMeshLambertMaterial=!0,tn.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((en.prototype=Object.create(k.prototype)).constructor=en).prototype.isMeshMatcapMaterial=!0,en.prototype.copy=function(t){return k.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((nn.prototype=Object.create(Ne.prototype)).constructor=nn).prototype.isLineDashedMaterial=!0,nn.prototype.copy=function(t){return Ne.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Gc=Object.freeze({ShadowMaterial:Xi,SpriteMaterial:Pe,RawShaderMaterial:Yi,ShaderMaterial:N,PointsMaterial:Ue,MeshPhysicalMaterial:Zi,MeshStandardMaterial:$i,MeshPhongMaterial:Ji,MeshToonMaterial:Qi,MeshNormalMaterial:Ki,MeshLambertMaterial:tn,MeshDepthMaterial:ue,MeshDistanceMaterial:de,MeshBasicMaterial:F,MeshMatcapMaterial:en,LineDashedMaterial:nn,LineBasicMaterial:Ne,Material:k}),Vc={arraySlice:function(t,e,i){return Vc.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==i?i:t.length)):t.slice(e,i)},convertArray:function(t,e,i){return!t||!i&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(i){for(var t=i.length,e=Array(t),n=0;n!==t;++n)e[n]=n;return e.sort(function(t,e){return i[t]-i[e]}),e},sortedArray:function(t,e,i){for(var n=t.length,r=new t.constructor(n),o=0,a=0;a!==n;++o)for(var s=i[o]*e,c=0;c!==e;++c)r[a++]=t[s+c];return r},flattenJSON:function(t,e,i,n){for(var r=1,o=t[0];void 0!==o&&void 0===o[n];)o=t[r++];if(void 0!==o){var a=o[n];if(void 0!==a)if(Array.isArray(a))for(;void 0!==(a=o[n])&&(e.push(o.time),i.push.apply(i,a)),void 0!==(o=t[r++]););else if(void 0!==a.toArray)for(;void 0!==(a=o[n])&&(e.push(o.time),a.toArray(i,i.length)),void 0!==(o=t[r++]););else for(;void 0!==(a=o[n])&&(e.push(o.time),i.push(a)),void 0!==(o=t[r++]););}}};Object.assign(rn.prototype,{evaluate:function(t){var e=this.parameterPositions,i=this._cachedIndex,n=e[i],r=e[i-1];t:{e:{i:{n:if(!(t<n)){for(var o=i+2;;){if(void 0===n){if(t<r)break n;return this._cachedIndex=i=e.length,this.afterEnd_(i-1,t,r)}if(i===o)break;if(r=n,t<(n=e[++i]))break e}n=e.length;break i}if(r<=t)break t;for(t<(o=e[1])&&(i=2,r=o),o=i-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(i===o)break;if(n=r,(r=e[--i-1])<=t)break e}n=i,i=0}for(;i<n;)t<e[r=i+n>>>1]?n=r:i=r+1;if(n=e[i],void 0===(r=e[i-1]))return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return this._cachedIndex=i=e.length,this.afterEnd_(i-1,r,t)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){var e=this.resultBuffer,i=this.sampleValues,n=this.valueSize;t*=n;for(var r=0;r!==n;++r)e[r]=i[t+r];return e},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(rn.prototype,{beforeStart_:rn.prototype.copySampleValue_,afterEnd_:rn.prototype.copySampleValue_}),on.prototype=Object.assign(Object.create(rn.prototype),{constructor:on,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,i){var n=this.parameterPositions,r=t-2,o=t+1,a=n[r],s=n[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:r=t,a=2*e-i;break;case 2402:a=e+n[r=n.length-2]-n[r+1];break;default:r=t,a=i}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:o=t,s=2*i-e;break;case 2402:s=i+n[o=1]-n[0];break;default:o=t-1,s=e}t=.5*(i-e),n=this.valueSize,this._weightPrev=t/(e-a),this._weightNext=t/(s-i),this._offsetPrev=r*n,this._offsetNext=o*n},interpolate_:function(t,e,i,n){var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(t*=a)-a,c=this._offsetPrev,l=this._offsetNext,h=this._weightPrev,u=this._weightNext,d=(i-e)/(n-e);for(e=-h*(n=(i=d*d)*d)+2*h*i-h*d,h=(1+h)*n+(-1.5-2*h)*i+(-.5+h)*d+1,d=(-1-u)*n+(1.5+u)*i+.5*d,u=u*n-u*i,i=0;i!==a;++i)r[i]=e*o[c+i]+h*o[s+i]+d*o[t+i]+u*o[l+i];return r}}),an.prototype=Object.assign(Object.create(rn.prototype),{constructor:an,interpolate_:function(t,e,i,n){var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(t*=a)-a;for(i=1-(e=(i-e)/(n-e)),n=0;n!==a;++n)r[n]=o[s+n]*i+o[t+n]*e;return r}}),sn.prototype=Object.assign(Object.create(rn.prototype),{constructor:sn,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(cn,{toJSON:function(t){var e,i=t.constructor;return void 0!==i.toJSON?i=i.toJSON(t):(i={name:t.name,times:Vc.convertArray(t.times,Array),values:Vc.convertArray(t.values,Array)},(e=t.getInterpolation())!==t.DefaultInterpolation&&(i.interpolation=e)),i.type=t.ValueTypeName,i}}),Object.assign(cn.prototype,{constructor:cn,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new sn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new an(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new on(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){switch(t){case 2300:var e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0!==e)return this.createInterpolant=e,this;if(e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]*=t;return this},trim:function(t,e){for(var i=this.times,n=i.length,r=0,o=n-1;r!==n&&i[r]<t;)++r;for(;-1!==o&&i[o]>e;)--o;return++o,0===r&&o===n||(o<=r&&(r=(o=Math.max(o,1))-1),t=this.getValueSize(),this.times=Vc.arraySlice(i,r,o),this.values=Vc.arraySlice(this.values,r*t,o*t)),this},validate:function(){var t=!0;0!=(i=this.getValueSize())-Math.floor(i)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var e=this.times,i=this.values,n=e.length;0===n&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var r=null,o=0;o!==n;o++){var a=e[o];if("number"==typeof a&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,a),t=!1;break}if(null!==r&&a<r){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,a,r),t=!1;break}r=a}if(void 0!==i&&Vc.isTypedArray(i))for(o=0,e=i.length;o!==e;++o)if(n=i[o],isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,n),t=!1;break}return t},optimize:function(){for(var t=this.times,e=this.values,i=this.getValueSize(),n=2302===this.getInterpolation(),r=1,o=t.length-1,a=1;a<o;++a){var s=!1;if((u=t[a])!==t[a+1]&&(1!==a||u!==u[0]))if(n)s=!0;else for(var c=a*i,l=c-i,h=c+i,u=0;u!==i;++u){var d=e[c+u];if(d!==e[l+u]||d!==e[h+u]){s=!0;break}}if(s){if(a!==r)for(t[r]=t[a],s=a*i,c=r*i,u=0;u!==i;++u)e[c+u]=e[s+u];++r}}if(0<o){for(t[r]=t[o],s=o*i,c=r*i,u=0;u!==i;++u)e[c+u]=e[s+u];++r}return r!==t.length&&(this.times=Vc.arraySlice(t,0,r),this.values=Vc.arraySlice(e,0,r*i)),this},clone:function(){var t=Vc.arraySlice(this.times,0),e=Vc.arraySlice(this.values,0);return(t=new this.constructor(this.name,t,e)).createInterpolant=this.createInterpolant,t}}),ln.prototype=Object.assign(Object.create(cn.prototype),{constructor:ln,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),hn.prototype=Object.assign(Object.create(cn.prototype),{constructor:hn,ValueTypeName:"color"}),un.prototype=Object.assign(Object.create(cn.prototype),{constructor:un,ValueTypeName:"number"}),dn.prototype=Object.assign(Object.create(rn.prototype),{constructor:dn,interpolate_:function(t,e,i,n){var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize;for(e=(i-e)/(n-e),i=(t*=a)+a;t!==i;t+=4)S.slerpFlat(r,0,o,t-a,o,t,e);return r}}),pn.prototype=Object.assign(Object.create(cn.prototype),{constructor:pn,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new dn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),fn.prototype=Object.assign(Object.create(cn.prototype),{constructor:fn,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),mn.prototype=Object.assign(Object.create(cn.prototype),{constructor:mn,ValueTypeName:"vector"}),Object.assign(gn,{parse:function(t){for(var e=[],i=t.tracks,n=1/(t.fps||1),r=0,o=i.length;r!==o;++r)e.push(vn(i[r]).scale(n));return new gn(t.name,t.duration,e)},toJSON:function(t){var e=[],i=t.tracks;t={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid};for(var n=0,r=i.length;n!==r;++n)e.push(cn.toJSON(i[n]));return t},CreateFromMorphTargetSequence:function(t,e,i,n){for(var r=e.length,o=[],a=0;a<r;a++){var s=[];(l=[]).push((a+r-1)%r,a,(a+1)%r),s.push(0,1,0);var c=Vc.getKeyframeOrder(l),l=Vc.sortedArray(l,1,c),s=Vc.sortedArray(s,1,c);n||0!==l[0]||(l.push(r),s.push(s[0])),o.push(new un(".morphTargetInfluences["+e[a].name+"]",l,s).scale(1/i))}return new gn(t,-1,o)},findByName:function(t,e){var i=t;for(Array.isArray(t)||(i=t.geometry&&t.geometry.animations||t.animations),t=0;t<i.length;t++)if(i[t].name===e)return i[t];return null},CreateClipsFromMorphTargetSequences:function(t,e,i){for(var n={},r=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var s,c=t[o],l=c.name.match(r);l&&1<l.length&&((l=n[s=l[1]])||(n[s]=l=[]),l.push(c))}for(s in t=[],n)t.push(gn.CreateFromMorphTargetSequence(s,n[s],e,i));return t},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;function i(t,e,i,n,r){var o,a;0!==i.length&&(o=[],a=[],Vc.flattenJSON(i,o,a,n),0!==o.length&&r.push(new t(e,o,a)))}var n=[],r=t.name||"default",o=t.length||-1,a=t.fps||30;t=t.hierarchy||[];for(var s=0;s<t.length;s++){var c=t[s].keys;if(c&&0!==c.length)if(c[0].morphTargets){o={};for(var l=0;l<c.length;l++)if(c[l].morphTargets)for(var h=0;h<c[l].morphTargets.length;h++)o[c[l].morphTargets[h]]=-1;for(var u in o){for(var d=[],p=[],h=0;h!==c[l].morphTargets.length;++h){var f=c[l];d.push(f.time),p.push(f.morphTarget===u?1:0)}n.push(new un(".morphTargetInfluence["+u+"]",d,p))}o=o.length*(a||1)}else i(mn,(l=".bones["+e[s].name+"]")+".position",c,"pos",n),i(pn,l+".quaternion",c,"rot",n),i(mn,l+".scale",c,"scl",n)}return 0===n.length?null:new gn(r,o,n)}}),Object.assign(gn.prototype,{resetDuration:function(){for(var t=0,e=0,i=this.tracks.length;e!==i;++e)var n=this.tracks[e],t=Math.max(t,n.times[n.times.length-1]);return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new gn(this.name,this.duration,t)}});var Wc={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},qc=new yn,Xc={};Object.assign(bn.prototype,{load:function(a,t,e,i){void 0===a&&(a=""),void 0!==this.path&&(a=this.path+a),a=this.manager.resolveURL(a);var s=this,n=Wc.get(a);if(void 0!==n)return s.manager.itemStart(a),setTimeout(function(){t&&t(n),s.manager.itemEnd(a)},0),n;if(void 0===Xc[a]){if(o=a.match(/^data:(.*?)(;base64)?,(.*)$/)){e=o[1];var r=!!o[2],o=o[3];o=decodeURIComponent(o),r&&(o=atob(o));try{var c=(this.responseType||"").toLowerCase();switch(c){case"arraybuffer":case"blob":for(var l=new Uint8Array(o.length),r=0;r<o.length;r++)l[r]=o.charCodeAt(r);var h="blob"===c?new Blob([l.buffer],{type:e}):l.buffer;break;case"document":h=(new DOMParser).parseFromString(o,e);break;case"json":h=JSON.parse(o);break;default:h=o}setTimeout(function(){t&&t(h),s.manager.itemEnd(a)},0)}catch(t){setTimeout(function(){i&&i(t),s.manager.itemError(a),s.manager.itemEnd(a)},0)}}else{Xc[a]=[],Xc[a].push({onLoad:t,onProgress:e,onError:i});var u=new XMLHttpRequest;for(r in u.open("GET",a,!0),u.addEventListener("load",function(t){var e=this.response;Wc.add(a,e);var i=Xc[a];if(delete Xc[a],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var n=0,r=i.length;n<r;n++){var o=i[n];o.onLoad&&o.onLoad(e)}}else{for(n=0,r=i.length;n<r;n++)(o=i[n]).onError&&o.onError(t);s.manager.itemError(a)}s.manager.itemEnd(a)},!1),u.addEventListener("progress",function(t){for(var e=Xc[a],i=0,n=e.length;i<n;i++){var r=e[i];r.onProgress&&r.onProgress(t)}},!1),u.addEventListener("error",function(t){var e=Xc[a];delete Xc[a];for(var i=0,n=e.length;i<n;i++){var r=e[i];r.onError&&r.onError(t)}s.manager.itemError(a),s.manager.itemEnd(a)},!1),u.addEventListener("abort",function(t){var e=Xc[a];delete Xc[a];for(var i=0,n=e.length;i<n;i++){var r=e[i];r.onError&&r.onError(t)}s.manager.itemError(a),s.manager.itemEnd(a)},!1),void 0!==this.responseType&&(u.responseType=this.responseType),void 0!==this.withCredentials&&(u.withCredentials=this.withCredentials),u.overrideMimeType&&u.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)u.setRequestHeader(r,this.requestHeader[r]);u.send(null)}return s.manager.itemStart(a),u}Xc[a].push({onLoad:t,onProgress:e,onError:i})},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),Object.assign(xn.prototype,{load:function(t,e,i,n){var r=this,o=new bn(r.manager);o.setPath(r.path),o.load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},parse:function(t){for(var e=[],i=0;i<t.length;i++){var n=gn.parse(t[i]);e.push(n)}return e},setPath:function(t){return this.path=t,this}}),Object.assign(wn.prototype,{load:function(t,r,i,n){var o=this,a=[],s=new Ge;s.image=a;var c=new bn(this.manager);if(c.setPath(this.path),c.setResponseType("arraybuffer"),Array.isArray(t))for(var l=0,e=0,h=t.length;e<h;++e)!function(e){c.load(t[e],function(t){t=o._parser(t,!0),a[e]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},6===(l+=1)&&(1===t.mipmapCount&&(s.minFilter=1006),s.format=t.format,s.needsUpdate=!0,r&&r(s))},i,n)}(e);else c.load(t,function(t){if((t=o._parser(t,!0)).isCubemap)for(var e=t.mipmaps.length/t.mipmapCount,i=0;i<e;i++){a[i]={mipmaps:[]};for(var n=0;n<t.mipmapCount;n++)a[i].mipmaps.push(t.mipmaps[i*t.mipmapCount+n]),a[i].format=t.format,a[i].width=t.width,a[i].height=t.height}else s.image.width=t.width,s.image.height=t.height,s.mipmaps=t.mipmaps;1===t.mipmapCount&&(s.minFilter=1006),s.format=t.format,s.needsUpdate=!0,r&&r(s)},i,n);return s},setPath:function(t){return this.path=t,this}}),Object.assign(En.prototype,{load:function(t,e,i,n){var r=this,o=new _t,a=new bn(this.manager);return a.setResponseType("arraybuffer"),a.setPath(this.path),a.load(t,function(t){(t=r._parser(t))&&(void 0!==t.image?o.image=t.image:void 0!==t.data&&(o.image.width=t.width,o.image.height=t.height,o.image.data=t.data),o.wrapS=void 0!==t.wrapS?t.wrapS:1001,o.wrapT=void 0!==t.wrapT?t.wrapT:1001,o.magFilter=void 0!==t.magFilter?t.magFilter:1006,o.minFilter=void 0!==t.minFilter?t.minFilter:1008,o.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(o.format=t.format),void 0!==t.type&&(o.type=t.type),void 0!==t.mipmaps&&(o.mipmaps=t.mipmaps),1===t.mipmapCount&&(o.minFilter=1006),o.needsUpdate=!0,e&&e(o,t))},i,n),o},setPath:function(t){return this.path=t,this}}),Object.assign(Mn.prototype,{crossOrigin:"anonymous",load:function(e,t,i,n){function r(){c.removeEventListener("load",r,!1),c.removeEventListener("error",o,!1),Wc.add(e,this),t&&t(this),a.manager.itemEnd(e)}function o(t){c.removeEventListener("load",r,!1),c.removeEventListener("error",o,!1),n&&n(t),a.manager.itemError(e),a.manager.itemEnd(e)}void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var a=this,s=Wc.get(e);if(void 0!==s)return a.manager.itemStart(e),setTimeout(function(){t&&t(s),a.manager.itemEnd(e)},0),s;var c=document.createElementNS("http://www.w3.org/1999/xhtml","img");return c.addEventListener("load",r,!1),c.addEventListener("error",o,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(c.crossOrigin=this.crossOrigin),a.manager.itemStart(e),c.src=e,c},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(_n.prototype,{crossOrigin:"anonymous",load:function(t,i,e,n){var r=new H,o=new Mn(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;for(e=0;e<t.length;++e)!function(e){o.load(t[e],function(t){r.images[e]=t,6===++a&&(r.needsUpdate=!0,i&&i(r))},void 0,n)}(e);return r},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Sn.prototype,{crossOrigin:"anonymous",load:function(e,i,t,n){var r=new d,o=new Mn(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(t){r.image=t,t=0<e.search(/\.jpe?g($|\?)/i)||0===e.search(/^data:image\/jpeg/),r.format=t?1022:1023,r.needsUpdate=!0,void 0!==i&&i(r)},t,n),r},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(An.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){return t=this.getUtoTmapping(t),this.getPoint(t,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],i=0;i<=t;i++)e.push(this.getPointAt(i/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i=[],n=this.getPoint(0),r=0;for(i.push(0),e=1;e<=t;e++){var o=this.getPoint(e/t);r+=o.distanceTo(n),i.push(r),n=o}return this.cacheArcLengths=i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var i=this.getLengths(),n=i.length;e=e||t*i[n-1];for(var r,o=0,a=n-1;o<=a;)if((r=i[t=Math.floor(o+(a-o)/2)]-e)<0)o=t+1;else{if(!(0<r)){a=t;break}a=t-1}return i[t=a]===e?t/(n-1):(t+(e-(o=i[t]))/(i[t+1]-o))/(n-1)},getTangent:function(t){var e=t-1e-4;return e<0&&(e=0),1<(t+=1e-4)&&(t=1),e=this.getPoint(e),this.getPoint(t).clone().sub(e).normalize()},getTangentAt:function(t){return t=this.getUtoTmapping(t),this.getTangent(t)},computeFrenetFrames:function(t,e){for(var i=new Et,n=[],r=[],o=[],a=new Et,s=new At,c=0;c<=t;c++){var l=c/t;n[c]=this.getTangentAt(l),n[c].normalize()}r[0]=new Et,o[0]=new Et,c=Number.MAX_VALUE,l=Math.abs(n[0].x);var h=Math.abs(n[0].y),u=Math.abs(n[0].z);for(l<=c&&(c=l,i.set(1,0,0)),h<=c&&(c=h,i.set(0,1,0)),u<=c&&i.set(0,0,1),a.crossVectors(n[0],i).normalize(),r[0].crossVectors(n[0],a),o[0].crossVectors(n[0],r[0]),c=1;c<=t;c++)r[c]=r[c-1].clone(),o[c]=o[c-1].clone(),a.crossVectors(n[c-1],n[c]),a.length()>Number.EPSILON&&(a.normalize(),i=Math.acos(uo.clamp(n[c-1].dot(n[c]),-1,1)),r[c].applyMatrix4(s.makeRotationAxis(a,i))),o[c].crossVectors(n[c],r[c]);if(!0===e)for(i=Math.acos(uo.clamp(r[0].dot(r[t]),-1,1)),i/=t,0<n[0].dot(a.crossVectors(r[0],r[t]))&&(i=-i),c=1;c<=t;c++)r[c].applyMatrix4(s.makeRotationAxis(n[c],i*c)),o[c].crossVectors(n[c],r[c]);return{tangents:n,normals:r,binormals:o}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),((Tn.prototype=Object.create(An.prototype)).constructor=Tn).prototype.isEllipseCurve=!0,Tn.prototype.getPoint=function(t,e){e=e||new wt;for(var i=2*Math.PI,n=this.aEndAngle-this.aStartAngle,r=Math.abs(n)<Number.EPSILON;n<0;)n+=i;for(;i<n;)n-=i;n<Number.EPSILON&&(n=r?0:i),!0!==this.aClockwise||r||(n=n===i?-i:n-i),i=this.aStartAngle+t*n,t=this.aX+this.xRadius*Math.cos(i);var o=this.aY+this.yRadius*Math.sin(i);return 0!==this.aRotation&&(i=Math.cos(this.aRotation),n=Math.sin(this.aRotation),t=(r=t-this.aX)*i-(o-=this.aY)*n+this.aX,o=r*n+o*i+this.aY),e.set(t,o)},Tn.prototype.copy=function(t){return An.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Tn.prototype.toJSON=function(){var t=An.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Tn.prototype.fromJSON=function(t){return An.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},((Cn.prototype=Object.create(Tn.prototype)).constructor=Cn).prototype.isArcCurve=!0;var Yc=new Et,$c=new Ln,Zc=new Ln,Jc=new Ln;((Pn.prototype=Object.create(An.prototype)).constructor=Pn).prototype.isCatmullRomCurve3=!0,Pn.prototype.getPoint=function(t,e){e=e||new Et;var i=(c=this.points).length;t*=i-(this.closed?0:1);var n,r=Math.floor(t);t-=r,this.closed?r+=0<r?0:(Math.floor(Math.abs(r)/i)+1)*i:0===t&&r===i-1&&(r=i-2,t=1),n=this.closed||0<r?c[(r-1)%i]:(Yc.subVectors(c[0],c[1]).add(c[0]),Yc);var o,a=c[r%i],s=c[(r+1)%i],c=this.closed||r+2<i?c[(r+2)%i]:(Yc.subVectors(c[i-1],c[i-2]).add(c[i-1]),Yc);return"centripetal"===this.curveType||"chordal"===this.curveType?(o="chordal"===this.curveType?.5:.25,i=Math.pow(n.distanceToSquared(a),o),(r=Math.pow(a.distanceToSquared(s),o))<1e-4&&(r=1),i<1e-4&&(i=r),(o=Math.pow(s.distanceToSquared(c),o))<1e-4&&(o=r),$c.initNonuniformCatmullRom(n.x,a.x,s.x,c.x,i,r,o),Zc.initNonuniformCatmullRom(n.y,a.y,s.y,c.y,i,r,o),Jc.initNonuniformCatmullRom(n.z,a.z,s.z,c.z,i,r,o)):"catmullrom"===this.curveType&&($c.initCatmullRom(n.x,a.x,s.x,c.x,this.tension),Zc.initCatmullRom(n.y,a.y,s.y,c.y,this.tension),Jc.initCatmullRom(n.z,a.z,s.z,c.z,this.tension)),e.set($c.calc(t),Zc.calc(t),Jc.calc(t)),e},Pn.prototype.copy=function(t){An.prototype.copy.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++)this.points.push(t.points[e].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Pn.prototype.toJSON=function(){var t=An.prototype.toJSON.call(this);t.points=[];for(var e=0,i=this.points.length;e<i;e++)t.points.push(this.points[e].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Pn.prototype.fromJSON=function(t){An.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var n=t.points[e];this.points.push((new Et).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},((Dn.prototype=Object.create(An.prototype)).constructor=Dn).prototype.isCubicBezierCurve=!0,Dn.prototype.getPoint=function(t,e){e=e||new wt;var i=this.v0,n=this.v1,r=this.v2,o=this.v3;return e.set(On(t,i.x,n.x,r.x,o.x),On(t,i.y,n.y,r.y,o.y)),e},Dn.prototype.copy=function(t){return An.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Dn.prototype.toJSON=function(){var t=An.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Dn.prototype.fromJSON=function(t){return An.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},((kn.prototype=Object.create(An.prototype)).constructor=kn).prototype.isCubicBezierCurve3=!0,kn.prototype.getPoint=function(t,e){e=e||new Et;var i=this.v0,n=this.v1,r=this.v2,o=this.v3;return e.set(On(t,i.x,n.x,r.x,o.x),On(t,i.y,n.y,r.y,o.y),On(t,i.z,n.z,r.z,o.z)),e},kn.prototype.copy=function(t){return An.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},kn.prototype.toJSON=function(){var t=An.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},kn.prototype.fromJSON=function(t){return An.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},((Nn.prototype=Object.create(An.prototype)).constructor=Nn).prototype.isLineCurve=!0,Nn.prototype.getPoint=function(t,e){return e=e||new wt,1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},Nn.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Nn.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Nn.prototype.copy=function(t){return An.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Nn.prototype.toJSON=function(){var t=An.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Nn.prototype.fromJSON=function(t){return An.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((zn.prototype=Object.create(An.prototype)).constructor=zn).prototype.isLineCurve3=!0,zn.prototype.getPoint=function(t,e){return e=e||new Et,1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},zn.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},zn.prototype.copy=function(t){return An.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},zn.prototype.toJSON=function(){var t=An.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},zn.prototype.fromJSON=function(t){return An.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((Bn.prototype=Object.create(An.prototype)).constructor=Bn).prototype.isQuadraticBezierCurve=!0,Bn.prototype.getPoint=function(t,e){e=e||new wt;var i=this.v0,n=this.v1,r=this.v2;return e.set(In(t,i.x,n.x,r.x),In(t,i.y,n.y,r.y)),e},Bn.prototype.copy=function(t){return An.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Bn.prototype.toJSON=function(){var t=An.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Bn.prototype.fromJSON=function(t){return An.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((Fn.prototype=Object.create(An.prototype)).constructor=Fn).prototype.isQuadraticBezierCurve3=!0,Fn.prototype.getPoint=function(t,e){e=e||new Et;var i=this.v0,n=this.v1,r=this.v2;return e.set(In(t,i.x,n.x,r.x),In(t,i.y,n.y,r.y),In(t,i.z,n.z,r.z)),e},Fn.prototype.copy=function(t){return An.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Fn.prototype.toJSON=function(){var t=An.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Fn.prototype.fromJSON=function(t){return An.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((Un.prototype=Object.create(An.prototype)).constructor=Un).prototype.isSplineCurve=!0,Un.prototype.getPoint=function(t,e){e=e||new wt;var i=((a=this.points).length-1)*t;i-=t=Math.floor(i);var n=a[0===t?t:t-1],r=a[t],o=a[t>a.length-2?a.length-1:t+1],a=a[t>a.length-3?a.length-1:t+2];return e.set(Rn(i,n.x,r.x,o.x,a.x),Rn(i,n.y,r.y,o.y,a.y)),e},Un.prototype.copy=function(t){An.prototype.copy.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++)this.points.push(t.points[e].clone());return this},Un.prototype.toJSON=function(){var t=An.prototype.toJSON.call(this);t.points=[];for(var e=0,i=this.points.length;e<i;e++)t.points.push(this.points[e].toArray());return t},Un.prototype.fromJSON=function(t){An.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var n=t.points[e];this.points.push((new wt).fromArray(n))}return this};var Qc=Object.freeze({ArcCurve:Cn,CatmullRomCurve3:Pn,CubicBezierCurve:Dn,CubicBezierCurve3:kn,EllipseCurve:Tn,LineCurve:Nn,LineCurve3:zn,QuadraticBezierCurve:Bn,QuadraticBezierCurve3:Fn,SplineCurve:Un});jn.prototype=Object.assign(Object.create(An.prototype),{constructor:jn,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Nn(e,t))},getPoint:function(t){var e=t*this.getLength(),i=this.getCurveLengths();for(t=0;t<i.length;){if(i[t]>=e)return e=i[t]-e,i=(t=this.curves[t]).getLength(),t.getPointAt(0===i?0:1-e/i);t++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,i=0,n=this.curves.length;i<n;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,i=[],n=0,r=this.curves;n<r.length;n++)for(var o=(o=r[n]).getPoints(o&&o.isEllipseCurve?2*t:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?t*o.points.length:t),a=0;a<o.length;a++){var s=o[a];e&&e.equals(s)||(i.push(s),e=s)}return this.autoClose&&1<i.length&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},copy:function(t){An.prototype.copy.call(this,t),this.curves=[];for(var e=0,i=t.curves.length;e<i;e++)this.curves.push(t.curves[e].clone());return this.autoClose=t.autoClose,this},toJSON:function(){var t=An.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,i=this.curves.length;e<i;e++)t.curves.push(this.curves[e].toJSON());return t},fromJSON:function(t){An.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,i=t.curves.length;e<i;e++){var n=t.curves[e];this.curves.push((new Qc[n.type]).fromJSON(n))}return this}}),Hn.prototype=Object.assign(Object.create(jn.prototype),{constructor:Hn,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var i=new Nn(this.currentPoint.clone(),new wt(t,e));this.curves.push(i),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,i,n){t=new Bn(this.currentPoint.clone(),new wt(t,e),new wt(i,n)),this.curves.push(t),this.currentPoint.set(i,n)},bezierCurveTo:function(t,e,i,n,r,o){t=new Dn(this.currentPoint.clone(),new wt(t,e),new wt(i,n),new wt(r,o)),this.curves.push(t),this.currentPoint.set(r,o)},splineThru:function(t){var e=new Un(e=[this.currentPoint.clone()].concat(t));this.curves.push(e),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,i,n,r,o){this.absarc(t+this.currentPoint.x,e+this.currentPoint.y,i,n,r,o)},absarc:function(t,e,i,n,r,o){this.absellipse(t,e,i,i,n,r,o)},ellipse:function(t,e,i,n,r,o,a,s){this.absellipse(t+this.currentPoint.x,e+this.currentPoint.y,i,n,r,o,a,s)},absellipse:function(t,e,i,n,r,o,a,s){t=new Tn(t,e,i,n,r,o,a,s),0<this.curves.length&&((e=t.getPoint(0)).equals(this.currentPoint)||this.lineTo(e.x,e.y)),this.curves.push(t),t=t.getPoint(1),this.currentPoint.copy(t)},copy:function(t){return jn.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=jn.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return jn.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),Gn.prototype=Object.assign(Object.create(Hn.prototype),{constructor:Gn,getPointsHoles:function(t){for(var e=[],i=0,n=this.holes.length;i<n;i++)e[i]=this.holes[i].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){Hn.prototype.copy.call(this,t),this.holes=[];for(var e=0,i=t.holes.length;e<i;e++)this.holes.push(t.holes[e].clone());return this},toJSON:function(){var t=Hn.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,i=this.holes.length;e<i;e++)t.holes.push(this.holes[e].toJSON());return t},fromJSON:function(t){Hn.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,i=t.holes.length;e<i;e++){var n=t.holes[e];this.holes.push((new Hn).fromJSON(n))}return this}}),Vn.prototype=Object.assign(Object.create(u.prototype),{constructor:Vn,isLight:!0,copy:function(t){return u.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){return(t=u.prototype.toJSON.call(this,t)).object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Wn.prototype=Object.assign(Object.create(Vn.prototype),{constructor:Wn,isHemisphereLight:!0,copy:function(t){return Vn.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(qn.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),Xn.prototype=Object.assign(Object.create(qn.prototype),{constructor:Xn,isSpotLightShadow:!0,update:function(t){var e=this.camera,i=2*uo.RAD2DEG*t.angle,n=this.mapSize.width/this.mapSize.height;t=t.distance||e.far,i===e.fov&&n===e.aspect&&t===e.far||(e.fov=i,e.aspect=n,e.far=t,e.updateProjectionMatrix())}}),Yn.prototype=Object.assign(Object.create(Vn.prototype),{constructor:Yn,isSpotLight:!0,copy:function(t){return Vn.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),$n.prototype=Object.assign(Object.create(Vn.prototype),{constructor:$n,isPointLight:!0,copy:function(t){return Vn.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),Zn.prototype=Object.assign(Object.create(ye.prototype),{constructor:Zn,isOrthographicCamera:!0,copy:function(t,e){return ye.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,i,n,r,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t,e=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,o=n-e;n+=e,e=r+i,i=r-i,null!==this.view&&this.view.enabled&&(n=this.zoom/(this.view.width/this.view.fullWidth),i=this.zoom/(this.view.height/this.view.fullHeight),t=(this.right-this.left)/this.view.width,r=(this.top-this.bottom)/this.view.height,n=(o+=this.view.offsetX/n*t)+this.view.width/n*t,i=(e-=this.view.offsetY/i*r)-this.view.height/i*r),this.projectionMatrix.makeOrthographic(o,n,e,i,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){return(t=u.prototype.toJSON.call(this,t)).object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Jn.prototype=Object.assign(Object.create(qn.prototype),{constructor:Jn}),Qn.prototype=Object.assign(Object.create(Vn.prototype),{constructor:Qn,isDirectionalLight:!0,copy:function(t){return Vn.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Kn.prototype=Object.assign(Object.create(Vn.prototype),{constructor:Kn,isAmbientLight:!0}),tr.prototype=Object.assign(Object.create(Vn.prototype),{constructor:tr,isRectAreaLight:!0,copy:function(t){return Vn.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){return(t=Vn.prototype.toJSON.call(this,t)).object.width=this.width,t.object.height=this.height,t}}),Object.assign(er.prototype,{load:function(t,e,i,n){var r=this,o=new bn(r.manager);o.setPath(r.path),o.load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},parse:function(t){function e(t){return void 0===i[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),i[t]}var i=this.textures,n=new Gc[t.type];if(void 0!==t.uuid&&(n.uuid=t.uuid),void 0!==t.name&&(n.name=t.name),void 0!==t.color&&n.color.setHex(t.color),void 0!==t.roughness&&(n.roughness=t.roughness),void 0!==t.metalness&&(n.metalness=t.metalness),void 0!==t.emissive&&n.emissive.setHex(t.emissive),void 0!==t.specular&&n.specular.setHex(t.specular),void 0!==t.shininess&&(n.shininess=t.shininess),void 0!==t.clearCoat&&(n.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(n.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.vertexColors&&(n.vertexColors=t.vertexColors),void 0!==t.fog&&(n.fog=t.fog),void 0!==t.flatShading&&(n.flatShading=t.flatShading),void 0!==t.blending&&(n.blending=t.blending),void 0!==t.combine&&(n.combine=t.combine),void 0!==t.side&&(n.side=t.side),void 0!==t.opacity&&(n.opacity=t.opacity),void 0!==t.transparent&&(n.transparent=t.transparent),void 0!==t.alphaTest&&(n.alphaTest=t.alphaTest),void 0!==t.depthTest&&(n.depthTest=t.depthTest),void 0!==t.depthWrite&&(n.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(n.colorWrite=t.colorWrite),void 0!==t.wireframe&&(n.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(n.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(n.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(n.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(n.rotation=t.rotation),1!==t.linewidth&&(n.linewidth=t.linewidth),void 0!==t.dashSize&&(n.dashSize=t.dashSize),void 0!==t.gapSize&&(n.gapSize=t.gapSize),void 0!==t.scale&&(n.scale=t.scale),void 0!==t.polygonOffset&&(n.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(n.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(n.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(n.skinning=t.skinning),void 0!==t.morphTargets&&(n.morphTargets=t.morphTargets),void 0!==t.dithering&&(n.dithering=t.dithering),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.uniforms)for(var r in t.uniforms){var o=t.uniforms[r];switch(n.uniforms[r]={},o.type){case"t":n.uniforms[r].value=e(o.value);break;case"c":n.uniforms[r].value=(new p).setHex(o.value);break;case"v2":n.uniforms[r].value=(new wt).fromArray(o.value);break;case"v3":n.uniforms[r].value=(new Et).fromArray(o.value);break;case"v4":n.uniforms[r].value=(new Mt).fromArray(o.value);break;case"m3":n.uniforms[r].value=(new g).fromArray(o.value);case"m4":n.uniforms[r].value=(new At).fromArray(o.value);break;default:n.uniforms[r].value=o.value}}if(void 0!==t.defines&&(n.defines=t.defines),void 0!==t.vertexShader&&(n.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(n.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var a in t.extensions)n.extensions[a]=t.extensions[a];return void 0!==t.shading&&(n.flatShading=1===t.shading),void 0!==t.size&&(n.size=t.size),void 0!==t.sizeAttenuation&&(n.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(n.map=e(t.map)),void 0!==t.matcap&&(n.matcap=e(t.matcap)),void 0!==t.alphaMap&&(n.alphaMap=e(t.alphaMap),n.transparent=!0),void 0!==t.bumpMap&&(n.bumpMap=e(t.bumpMap)),void 0!==t.bumpScale&&(n.bumpScale=t.bumpScale),void 0!==t.normalMap&&(n.normalMap=e(t.normalMap)),void 0!==t.normalMapType&&(n.normalMapType=t.normalMapType),void 0!==t.normalScale&&(r=t.normalScale,!1===Array.isArray(r)&&(r=[r,r]),n.normalScale=(new wt).fromArray(r)),void 0!==t.displacementMap&&(n.displacementMap=e(t.displacementMap)),void 0!==t.displacementScale&&(n.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(n.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(n.roughnessMap=e(t.roughnessMap)),void 0!==t.metalnessMap&&(n.metalnessMap=e(t.metalnessMap)),void 0!==t.emissiveMap&&(n.emissiveMap=e(t.emissiveMap)),void 0!==t.emissiveIntensity&&(n.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(n.specularMap=e(t.specularMap)),void 0!==t.envMap&&(n.envMap=e(t.envMap)),void 0!==t.envMapIntensity&&(n.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(n.reflectivity=t.reflectivity),void 0!==t.lightMap&&(n.lightMap=e(t.lightMap)),void 0!==t.lightMapIntensity&&(n.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(n.aoMap=e(t.aoMap)),void 0!==t.aoMapIntensity&&(n.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(n.gradientMap=e(t.gradientMap)),n},setPath:function(t){return this.path=t,this},setTextures:function(t){return this.textures=t,this}});var Kc={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",i=0,n=t.length;i<n;i++)e+=String.fromCharCode(t[i]);try{return decodeURIComponent(escape(e))}catch(t){return e}},extractUrlBase:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}};ir.prototype=Object.assign(Object.create(P.prototype),{constructor:ir,isInstancedBufferGeometry:!0,copy:function(t){return P.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t=P.prototype.toJSON.call(this);return t.maxInstancedCount=this.maxInstancedCount,t.isInstancedBufferGeometry=!0,t}}),nr.prototype=Object.assign(Object.create(m.prototype),{constructor:nr,isInstancedBufferAttribute:!0,copy:function(t){return m.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=m.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),Object.assign(rr.prototype,{load:function(t,e,i,n){var r=this,o=new bn(r.manager);o.setPath(r.path),o.load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},parse:function(t){var e=new(t.isInstancedBufferGeometry?ir:P),i=t.data.index;for(var n in void 0!==i&&(o=new tl[i.type](i.array),e.setIndex(new m(o,1))),i=t.data.attributes){var r=i[n],o=new tl[r.type](r.array);o=new(r.isInstancedBufferAttribute?nr:m)(o,r.itemSize,r.normalized),void 0!==r.name&&(o.name=r.name),e.addAttribute(n,o)}var a=t.data.morphAttributes;if(a)for(n in a){for(var s=a[n],c=[],i=0,l=s.length;i<l;i++)r=s[i],o=new m(o=new tl[r.type](r.array),r.itemSize,r.normalized),void 0!==r.name&&(o.name=r.name),c.push(o);e.morphAttributes[n]=c}if(void 0!==(n=t.data.groups||t.data.drawcalls||t.data.offsets))for(i=0,r=n.length;i!==r;++i)o=n[i],e.addGroup(o.start,o.count,o.materialIndex);return void 0!==(i=t.data.boundingSphere)&&(n=new Et,void 0!==i.center&&n.fromArray(i.center),e.boundingSphere=new h(n,i.radius)),t.name&&(e.name=t.name),t.userData&&(e.userData=t.userData),e},setPath:function(t){return this.path=t,this}});var tl={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};Object.assign(or.prototype,{crossOrigin:"anonymous",load:function(i,n,t,r){var o=this,e=void 0===this.path?Kc.extractUrlBase(i):this.path;this.resourcePath=this.resourcePath||e,(e=new bn(o.manager)).setPath(this.path),e.load(i,function(t){var e=null;try{e=JSON.parse(t)}catch(t){return void 0!==r&&r(t),void console.error("THREE:ObjectLoader: Can't parse "+i+".",t.message)}void 0===(t=e.metadata)||void 0===t.type||"geometry"===t.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+i):o.parse(e,n)},t,r)},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setCrossOrigin:function(t){return this.crossOrigin=t,this},parse:function(t,e){var i=this.parseShape(t.shapes),i=this.parseGeometries(t.geometries,i),n=this.parseImages(t.images,function(){void 0!==e&&e(r)}),n=this.parseTextures(t.textures,n);n=this.parseMaterials(t.materials,n);var r=this.parseObject(t.object,i,n);return t.animations&&(r.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0===e||e(r),r},parseShape:function(t){var e={};if(void 0!==t)for(var i=0,n=t.length;i<n;i++){var r=(new Gn).fromJSON(t[i]);e[r.uuid]=r}return e},parseGeometries:function(t,e){var i={};if(void 0!==t)for(var n=new rr,r=0,o=t.length;r<o;r++){var a=t[r];switch(a.type){case"PlaneGeometry":case"PlaneBufferGeometry":var s=new Hc[a.type](a.width,a.height,a.widthSegments,a.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new Hc[a.type](a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new Hc[a.type](a.radius,a.segments,a.thetaStart,a.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new Hc[a.type](a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new Hc[a.type](a.radius,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new Hc[a.type](a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new Hc[a.type](a.radius,a.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new Hc[a.type](a.innerRadius,a.outerRadius,a.thetaSegments,a.phiSegments,a.thetaStart,a.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new Hc[a.type](a.radius,a.tube,a.radialSegments,a.tubularSegments,a.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new Hc[a.type](a.radius,a.tube,a.tubularSegments,a.radialSegments,a.p,a.q);break;case"TubeGeometry":case"TubeBufferGeometry":s=new Hc[a.type]((new Qc[a.path.type]).fromJSON(a.path),a.tubularSegments,a.radius,a.radialSegments,a.closed);break;case"LatheGeometry":case"LatheBufferGeometry":s=new Hc[a.type](a.points,a.segments,a.phiStart,a.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new Hc[a.type](a.vertices,a.indices,a.radius,a.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":s=[];for(var c=0,l=a.shapes.length;c<l;c++){var h=e[a.shapes[c]];s.push(h)}s=new Hc[a.type](s,a.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(s=[],c=0,l=a.shapes.length;c<l;c++)h=e[a.shapes[c]],s.push(h);void 0!==(c=a.options.extrudePath)&&(a.options.extrudePath=(new Qc[c.type]).fromJSON(c)),s=new Hc[a.type](s,a.options);break;case"BufferGeometry":case"InstancedBufferGeometry":s=n.parse(a);break;case"Geometry":"THREE"in window&&"LegacyJSONLoader"in THREE?s=(new THREE.LegacyJSONLoader).parse(a,this.resourcePath).geometry:console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+a.type+'"');continue}s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),!0===s.isBufferGeometry&&void 0!==a.userData&&(s.userData=a.userData),i[a.uuid]=s}return i},parseMaterials:function(t,e){var i={},n={};if(void 0!==t){var r=new er;r.setTextures(e),e=0;for(var o=t.length;e<o;e++){var a=t[e];if("MultiMaterial"===a.type){for(var s=[],c=0;c<a.materials.length;c++){var l=a.materials[c];void 0===i[l.uuid]&&(i[l.uuid]=r.parse(l)),s.push(i[l.uuid])}n[a.uuid]=s}else void 0===i[a.uuid]&&(i[a.uuid]=r.parse(a)),n[a.uuid]=i[a.uuid]}}return n},parseAnimations:function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i],r=gn.parse(n);void 0!==n.uuid&&(r.uuid=n.uuid),e.push(r)}return e},parseImages:function(t,e){function i(t){return n.manager.itemStart(t),o.load(t,function(){n.manager.itemEnd(t)},void 0,function(){n.manager.itemError(t),n.manager.itemEnd(t)})}var n=this,r={};if(void 0!==t&&0<t.length){var o=new Mn(e=new yn(e));o.setCrossOrigin(this.crossOrigin),e=0;for(var a=t.length;e<a;e++){var s=t[e],c=s.url;if(Array.isArray(c)){r[s.uuid]=[];for(var l=0,h=c.length;l<h;l++){var u=c[l],u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:n.resourcePath+u;r[s.uuid].push(i(u))}}else u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(s.url)?s.url:n.resourcePath+s.url,r[s.uuid]=i(u)}}return r},parseTextures:function(t,e){function i(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var n={};if(void 0!==t)for(var r=0,o=t.length;r<o;r++){var a=t[r];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===e[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=new(Array.isArray(e[a.image])?H:d)(e[a.image]);s.needsUpdate=!0,s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=i(a.mapping,ol)),void 0!==a.offset&&s.offset.fromArray(a.offset),void 0!==a.repeat&&s.repeat.fromArray(a.repeat),void 0!==a.center&&s.center.fromArray(a.center),void 0!==a.rotation&&(s.rotation=a.rotation),void 0!==a.wrap&&(s.wrapS=i(a.wrap[0],al),s.wrapT=i(a.wrap[1],al)),void 0!==a.format&&(s.format=a.format),void 0!==a.type&&(s.type=a.type),void 0!==a.encoding&&(s.encoding=a.encoding),void 0!==a.minFilter&&(s.minFilter=i(a.minFilter,sl)),void 0!==a.magFilter&&(s.magFilter=i(a.magFilter,sl)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),void 0!==a.flipY&&(s.flipY=a.flipY),void 0!==a.premultiplyAlpha&&(s.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(s.unpackAlignment=a.unpackAlignment),n[a.uuid]=s}return n},parseObject:function(t,e,o){function i(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function n(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i];void 0===o[r]&&console.warn("THREE.ObjectLoader: Undefined material",r),e.push(o[r])}return e}return void 0===o[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),o[t]}}switch(t.type){case"Scene":var r=new Te;void 0!==t.background&&Number.isInteger(t.background)&&(r.background=new p(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?r.fog=new Ae(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(r.fog=new Se(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":r=new be(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(r.focus=t.focus),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.filmGauge&&(r.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(r.filmOffset=t.filmOffset),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"OrthographicCamera":r=new Zn(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"AmbientLight":r=new Kn(t.color,t.intensity);break;case"DirectionalLight":r=new Qn(t.color,t.intensity);break;case"PointLight":r=new $n(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":r=new tr(t.color,t.intensity,t.width,t.height);break;case"SpotLight":r=new Yn(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":r=new Wn(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":r=i(t.geometry);var a=n(t.material),r=new(r.bones&&0<r.bones.length?Oe:U)(r,a);void 0!==t.drawMode&&r.setDrawMode(t.drawMode);break;case"LOD":r=new Ie;break;case"Line":r=new ze(i(t.geometry),n(t.material),t.mode);break;case"LineLoop":r=new Fe(i(t.geometry),n(t.material));break;case"LineSegments":r=new Be(i(t.geometry),n(t.material));break;case"PointCloud":case"Points":r=new je(i(t.geometry),n(t.material));break;case"Sprite":r=new Re(n(t.material));break;case"Group":r=new ve;break;default:r=new u}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(r.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(r.matrixAutoUpdate=t.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.quaternion&&r.quaternion.fromArray(t.quaternion),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.castShadow&&(r.castShadow=t.castShadow),void 0!==t.receiveShadow&&(r.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(r.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(r.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&r.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(r.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.frustumCulled&&(r.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(r.renderOrder=t.renderOrder),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.layers&&(r.layers.mask=t.layers),void 0!==t.children){a=t.children;for(var s=0;s<a.length;s++)r.add(this.parseObject(a[s],e,o))}if("LOD"===t.type)for(t=t.levels,a=0;a<t.length;a++){s=t[a];var c=r.getObjectByProperty("uuid",s.object);void 0!==c&&r.addLevel(c,s.distance)}return r}});var el,il,nl,rl,ol={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},al={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},sl={NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008};ar.prototype={constructor:ar,setOptions:function(t){return this.options=t,this},load:function(e,i,t,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,o=Wc.get(e);if(void 0!==o)return r.manager.itemStart(e),setTimeout(function(){i&&i(o),r.manager.itemEnd(e)},0),o;fetch(e).then(function(t){return t.blob()}).then(function(t){return void 0===r.options?createImageBitmap(t):createImageBitmap(t,r.options)}).then(function(t){Wc.add(e,t),i&&i(t),r.manager.itemEnd(e)}).catch(function(t){n&&n(t),r.manager.itemError(e),r.manager.itemEnd(e)}),r.manager.itemStart(e)},setCrossOrigin:function(){return this},setPath:function(t){return this.path=t,this}},Object.assign(sr.prototype,{moveTo:function(t,e){this.currentPath=new Hn,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,i,n){this.currentPath.quadraticCurveTo(t,e,i,n)},bezierCurveTo:function(t,e,i,n,r,o){this.currentPath.bezierCurveTo(t,e,i,n,r,o)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function i(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i],o=new Gn;o.curves=r.curves,e.push(o)}return e}var n=Uc.isClockWise,r=this.subPaths;if(0===r.length)return[];if(!0===e)return i(r);if(e=[],1===r.length){var o=r[0],a=new Gn;return a.curves=o.curves,e.push(a),e}var s=!n(r[0].getPoints()),s=t?!s:s,a=[],c=[],l=[],h=0;c[h]=void 0,l[h]=[];for(var u=0,d=r.length;u<d;u++){var p=(o=r[u]).getPoints(),f=n(p);(f=t?!f:f)?(!s&&c[h]&&h++,c[h]={s:new Gn,p:p},c[h].s.curves=o.curves,s&&h++,l[h]=[]):l[h].push({h:o,p:p[0]})}if(!c[0])return i(r);if(1<c.length){for(u=!1,t=[],n=0,r=c.length;n<r;n++)a[n]=[];for(n=0,r=c.length;n<r;n++)for(o=l[n],f=0;f<o.length;f++){for(s=o[f],h=!0,p=0;p<c.length;p++)!function(t,e){for(var i=e.length,n=!1,r=i-1,o=0;o<i;r=o++){var a=e[r],s=e[o],c=s.x-a.x,l=s.y-a.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(a=e[o],c=-c,s=e[r],l=-l),!(t.y<a.y||t.y>s.y))if(t.y===a.y){if(t.x===a.x)return 1}else{if(0===(r=l*(t.x-a.x)-c*(t.y-a.y)))return 1;r<0||(n=!n)}}else if(t.y===a.y&&(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x))return 1}return n}(s.p,c[p].p)||(n!==p&&t.push({froms:n,tos:p,hole:f}),h?(h=!1,a[p].push(s)):u=!0);h&&a[n].push(s)}0<t.length&&(u||(l=a))}for(u=0,n=c.length;u<n;u++)for(a=c[u].s,e.push(a),r=0,o=(t=l[u]).length;r<o;r++)a.holes.push(t[r].h);return e}}),Object.assign(cr.prototype,{isFont:!0,generateShapes:function(t,e){void 0===e&&(e=100);var i=[],n=e;e=this.data;var r=Array.from?Array.from(t):String(t).split("");n/=e.resolution;var o=(e.boundingBox.yMax-e.boundingBox.yMin+e.underlineThickness)*n;t=[];for(var a=0,s=0,c=0;c<r.length;c++){var l=r[c];if("\n"===l)a=0,s-=o;else{var h=n,u=a,d=s;if(l=e.glyphs[l]||e.glyphs["?"]){var p=new sr;if(l.o)for(var f=l._cachedOutline||(l._cachedOutline=l.o.split(" ")),m=0,g=f.length;m<g;)switch(f[m++]){case"m":var v=f[m++]*h+u,y=f[m++]*h+d;p.moveTo(v,y);break;case"l":v=f[m++]*h+u,y=f[m++]*h+d,p.lineTo(v,y);break;case"q":var b=f[m++]*h+u,x=f[m++]*h+d,w=f[m++]*h+u,E=f[m++]*h+d;p.quadraticCurveTo(w,E,b,x);break;case"b":b=f[m++]*h+u,x=f[m++]*h+d,w=f[m++]*h+u,E=f[m++]*h+d,v=f[m++]*h+u,y=f[m++]*h+d,p.bezierCurveTo(w,E,v,y,b,x)}h={offsetX:l.ha*h,path:p}}else h=void 0;a+=h.offsetX,t.push(h.path)}}for(e=0,r=t.length;e<r;e++)Array.prototype.push.apply(i,t[e].toShapes());return i}}),Object.assign(lr.prototype,{load:function(t,n,e,i){var r=this,o=new bn(this.manager);o.setPath(this.path),o.load(t,function(e){try{var i=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),i=JSON.parse(e.substring(65,e.length-2))}e=r.parse(i),n&&n(e)},e,i)},parse:function(t){return new cr(t)},setPath:function(t){return this.path=t,this}}),hr.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,i=0,n=e.length;i<n;i+=2){var r=e[i+1];if(e[i].test(t))return r}return null}},Object.assign(hr.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(t,e,i){for(var n=[],r=0;r<t.length;++r)n[r]=this.createMaterial(t[r],e,i);return n},createMaterial:(el={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},il=new p,nl=new Sn,rl=new er,function(t,a,s){function e(t,e,i,n,r){t=a+t;var o=hr.Handlers.get(t);return t=null!==o?o.load(t):(nl.setCrossOrigin(s),nl.load(t)),void 0!==e&&(t.repeat.fromArray(e),1!==e[0]&&(t.wrapS=1e3),1!==e[1]&&(t.wrapT=1e3)),void 0!==i&&t.offset.fromArray(i),void 0!==n&&("repeat"===n[0]&&(t.wrapS=1e3),"mirror"===n[0]&&(t.wrapS=1002),"repeat"===n[1]&&(t.wrapT=1e3),"mirror"===n[1]&&(t.wrapT=1002)),void 0!==r&&(t.anisotropy=r),e=uo.generateUUID(),c[e]=t,e}var i,c={},n={uuid:uo.generateUUID(),type:"MeshLambertMaterial"};for(i in t){var r=t[i];switch(i){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":n.name=r;break;case"blending":n.blending=el[r];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",i,"is no longer supported.");break;case"colorDiffuse":n.color=il.fromArray(r).getHex();break;case"colorSpecular":n.specular=il.fromArray(r).getHex();break;case"colorEmissive":n.emissive=il.fromArray(r).getHex();break;case"specularCoef":n.shininess=r;break;case"shading":"basic"===r.toLowerCase()&&(n.type="MeshBasicMaterial"),"phong"===r.toLowerCase()&&(n.type="MeshPhongMaterial"),"standard"===r.toLowerCase()&&(n.type="MeshStandardMaterial");break;case"mapDiffuse":n.map=e(r,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":n.emissiveMap=e(r,t.mapEmissiveRepeat,t.mapEmissiveOffset,t.mapEmissiveWrap,t.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":n.lightMap=e(r,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":n.aoMap=e(r,t.mapAORepeat,t.mapAOOffset,t.mapAOWrap,t.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":n.bumpMap=e(r,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy);break;case"mapBumpScale":n.bumpScale=r;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":n.normalMap=e(r,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy);break;case"mapNormalFactor":n.normalScale=r;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":n.specularMap=e(r,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":n.metalnessMap=e(r,t.mapMetalnessRepeat,t.mapMetalnessOffset,t.mapMetalnessWrap,t.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":n.roughnessMap=e(r,t.mapRoughnessRepeat,t.mapRoughnessOffset,t.mapRoughnessWrap,t.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":n.alphaMap=e(r,t.mapAlphaRepeat,t.mapAlphaOffset,t.mapAlphaWrap,t.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":n.side=1;break;case"doubleSided":n.side=2;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),n.opacity=r;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":n[i]=r;break;case"vertexColors":!0===r&&(n.vertexColors=2),"face"===r&&(n.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",i,r)}}return"MeshBasicMaterial"===n.type&&delete n.emissive,"MeshPhongMaterial"!==n.type&&delete n.specular,n.opacity<1&&(n.transparent=!0),rl.setTextures(c),rl.parse(n)})});var cl,ll,hl,ul,dl,pl,fl,ml,gl,vl,yl,bl,xl,wl,El,Ml,_l,Sl,Al,Tl,Cl,Ll,Pl,Rl,Il,Ol,Dl,kl,Nl,zl,Bl,Fl,Ul,jl,Hl,Gl,Vl,Wl,ql,Xl,Yl,$l,Zl,Jl,Ql,Kl,th,eh,ih,nh,rh,oh,ah,sh,ch,lh,hh,uh={getContext:function(){return void 0===cl&&(cl=new(window.AudioContext||window.webkitAudioContext)),cl},setContext:function(t){cl=t}};function dh(t,e,i,n){if(nh.set(e,i,n).unproject(rh),void 0!==(t=ih[t]))for(e=eh.getAttribute("position"),i=0,n=t.length;i<n;i++)e.setXYZ(t[i],nh.x,nh.y,nh.z)}Object.assign(ur.prototype,{load:function(t,e,i,n){var r=new bn(this.manager);r.setResponseType("arraybuffer"),r.setPath(this.path),r.load(t,function(t){t=t.slice(0),uh.getContext().decodeAudioData(t,function(t){e(t)})},i,n)},setPath:function(t){return this.path=t,this}}),Object.assign(dr.prototype,{isSphericalHarmonics3:!0,set:function(t){for(var e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this},zero:function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,e){var i=t.x,n=t.y;t=t.z;var r=this.coefficients;return e=.282095*r[0],e+=.488603*r[1]*n,e+=.488603*r[2]*t,e+=.488603*r[3]*i,e+=1.092548*r[4]*i*n,e+=1.092548*r[5]*n*t,e+=.315392*r[6]*(3*t*t-1),(e+=1.092548*r[7]*i*t)+.546274*r[8]*(i*i-n*n)},getIrradianceAt:function(t,e){var i=t.x,n=t.y;t=t.z;var r=this.coefficients;return e=.886227*r[0],e+=1.023328*r[1]*n,e+=1.023328*r[2]*t,e+=1.023328*r[3]*i,e+=.858086*r[4]*i*n,e+=.858086*r[5]*n*t,e+=r[6]*(.743125*t*t-.247708),(e+=.858086*r[7]*i*t)+.429043*r[8]*(i*i-n*n)},add:function(t){for(var e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this},scale:function(t){for(var e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this},lerp:function(t,e){for(var i=0;i<9;i++)this.coefficients[i].lerp(t.coefficients[i],e);return this},equals:function(t){for(var e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(t){for(var e=this.coefficients,i=0;i<9;i++)e[i].fromArray(t,3*i);return this},toArray:function(){for(var t=[],e=this.coefficients,i=0;i<9;i++)e[i].toArray(t,3*i);return t}}),Object.assign(dr,{getBasisAt:function(t,e){var i=t.x,n=t.y;t=t.z,e[0]=.282095,e[1]=.488603*n,e[2]=.488603*t,e[3]=.488603*i,e[4]=1.092548*i*n,e[5]=1.092548*n*t,e[6]=.315392*(3*t*t-1),e[7]=1.092548*i*t,e[8]=.546274*(i*i-n*n)}}),pr.prototype=Object.assign(Object.create(Vn.prototype),{constructor:pr,isLightProbe:!0,copy:function(t){return Vn.prototype.copy.call(this,t),this.sh.copy(t.sh),this.intensity=t.intensity,this},toJSON:function(t){return Vn.prototype.toJSON.call(this,t)}}),fr.prototype=Object.assign(Object.create(pr.prototype),{constructor:fr,isHemisphereLightProbe:!0,copy:function(t){return pr.prototype.copy.call(this,t),this},toJSON:function(t){return pr.prototype.toJSON.call(this,t)}}),mr.prototype=Object.assign(Object.create(pr.prototype),{constructor:mr,isAmbientLightProbe:!0,copy:function(t){return pr.prototype.copy.call(this,t),this},toJSON:function(t){return pr.prototype.toJSON.call(this,t)}}),Object.assign(gr.prototype,{update:(vl=new At,yl=new At,function(t){var e,i,n,r,o;ll===this&&hl===t.focus&&ul===t.fov&&dl===t.aspect*this.aspect&&pl===t.near&&fl===t.far&&ml===t.zoom&&gl===this.eyeSep||(ll=this,hl=t.focus,ul=t.fov,dl=t.aspect*this.aspect,pl=t.near,fl=t.far,ml=t.zoom,e=t.projectionMatrix.clone(),i=(gl=this.eyeSep/2)*pl/hl,n=pl*Math.tan(uo.DEG2RAD*ul*.5)/ml,yl.elements[12]=-gl,vl.elements[12]=gl,r=-n*dl+i,o=n*dl+i,e.elements[0]=2*pl/(o-r),e.elements[8]=(o+r)/(o-r),this.cameraL.projectionMatrix.copy(e),r=-n*dl-i,o=n*dl-i,e.elements[0]=2*pl/(o-r),e.elements[8]=(o+r)/(o-r),this.cameraR.projectionMatrix.copy(e)),this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(yl),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(vl)})}),(vr.prototype=Object.create(u.prototype)).constructor=vr,Object.assign(yr.prototype,{start:function(){this.oldTime=this.startTime=("undefined"==typeof performance?Date:performance).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.autoStart=this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t,e=0;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(e=((t=("undefined"==typeof performance?Date:performance).now())-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e),e)}}),br.prototype=Object.assign(Object.create(u.prototype),{constructor:br,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:(bl=new Et,xl=new S,wl=new Et,El=new Et,Ml=new yr,function(t){u.prototype.updateMatrixWorld.call(this,t),t=this.context.listener;var e,i=this.up;this.timeDelta=Ml.getDelta(),this.matrixWorld.decompose(bl,xl,wl),El.set(0,0,-1).applyQuaternion(xl),t.positionX?(e=this.context.currentTime+this.timeDelta,t.positionX.linearRampToValueAtTime(bl.x,e),t.positionY.linearRampToValueAtTime(bl.y,e),t.positionZ.linearRampToValueAtTime(bl.z,e),t.forwardX.linearRampToValueAtTime(El.x,e),t.forwardY.linearRampToValueAtTime(El.y,e),t.forwardZ.linearRampToValueAtTime(El.z,e),t.upX.linearRampToValueAtTime(i.x,e),t.upY.linearRampToValueAtTime(i.y,e),t.upZ.linearRampToValueAtTime(i.z,e)):(t.setPosition(bl.x,bl.y,bl.z),t.setOrientation(El.x,El.y,El.z,i.x,i.y,i.z))})}),xr.prototype=Object.assign(Object.create(u.prototype),{constructor:xr,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else{if(!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),this.startTime=this.context.currentTime,t.start(this.startTime,this.offset),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t=t||[],!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}),wr.prototype=Object.assign(Object.create(xr.prototype),{constructor:wr,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,e,i){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=i,this},updateMatrixWorld:(_l=new Et,Sl=new S,Al=new Et,Tl=new Et,function(t){var e;u.prototype.updateMatrixWorld.call(this,t),!0===this.hasPlaybackControl&&!1===this.isPlaying||(this.matrixWorld.decompose(_l,Sl,Al),Tl.set(0,0,1).applyQuaternion(Sl),(t=this.panner).positionX?(e=this.context.currentTime+this.listener.timeDelta,t.positionX.linearRampToValueAtTime(_l.x,e),t.positionY.linearRampToValueAtTime(_l.y,e),t.positionZ.linearRampToValueAtTime(_l.z,e),t.orientationX.linearRampToValueAtTime(Tl.x,e),t.orientationY.linearRampToValueAtTime(Tl.y,e),t.orientationZ.linearRampToValueAtTime(Tl.z,e)):(t.setPosition(_l.x,_l.y,_l.z),t.setOrientation(Tl.x,Tl.y,Tl.z)))})}),Object.assign(Er.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),i=0;i<e.length;i++)t+=e[i];return t/e.length}}),Object.assign(Mr.prototype,{accumulate:function(t,e){var i=this.buffer,n=this.valueSize;t=t*n+n;var r=this.cumulativeWeight;if(0===r){for(r=0;r!==n;++r)i[t+r]=i[r];r=e}else r+=e,this._mixBufferRegion(i,t,0,e/r,n);this.cumulativeWeight=r},apply:function(t){var e=this.valueSize,i=this.buffer;t=t*e+e;var n=this.cumulativeWeight,r=this.binding;this.cumulativeWeight=0,n<1&&this._mixBufferRegion(i,t,3*e,1-n,e);for(var o=(n=e)+e;n!==o;++n)if(i[n]!==i[n+e]){r.setValue(i,t);break}},saveOriginalState:function(){var t=this.buffer,e=this.valueSize,i=3*e;this.binding.getValue(t,i);for(var n=e;n!==i;++n)t[n]=t[i+n%e];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(t,e,i,n,r){if(.5<=n)for(n=0;n!==r;++n)t[e+n]=t[i+n]},_slerp:function(t,e,i,n){S.slerpFlat(t,e,t,e,t,i,n)},_lerp:function(t,e,i,n,r){for(var o=1-n,a=0;a!==r;++a){var s=e+a;t[s]=t[s]*o+t[i+a]*n}}}),Object.assign(_r.prototype,{getValue:function(t,e){this.bind();var i=this._bindings[this._targetGroup.nCachedObjects_];void 0!==i&&i.getValue(t,e)},setValue:function(t,e){for(var i=this._bindings,n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}}),Object.assign(Sr,{Composite:_r,create:function(t,e,i){return t&&t.isAnimationObjectGroup?new Sr.Composite(t,e,i):new Sr(t,e,i)},sanitizeNodeName:(Dl=/[\[\]\.:\/]/g,function(t){return t.replace(/\s/g,"_").replace(Dl,"")}),parseTrackName:(Cl="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Ll=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),Cl=/(WCOD+)?/.source.replace("WCOD",Cl),Pl=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Rl=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Il=new RegExp("^"+Ll+Cl+Pl+Rl+"$"),Ol=["material","materials","bones"],function(t){var e=Il.exec(t);if(!e)throw Error("PropertyBinding: Cannot parse trackName: "+t);var i,n=(e={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]}).nodeName&&e.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n&&(i=e.nodeName.substring(n+1),-1!==Ol.indexOf(i)&&(e.nodeName=e.nodeName.substring(0,n),e.objectName=i)),null===e.propertyName||0===e.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+t);return e}),findNode:function(t,n){if(!n||""===n||"root"===n||"."===n||-1===n||n===t.name||n===t.uuid)return t;if(t.skeleton){var e=t.skeleton.getBoneByName(n);if(void 0!==e)return e}if(t.children){var r=function(t){for(var e=0;e<t.length;e++){var i=t[e];if(i.name===n||i.uuid===n||(i=r(i.children)))return i}return null};if(t=r(t.children))return t}return null}}),Object.assign(Sr.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)t[e++]=i[n]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++]},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,i=e.objectName,n=e.propertyName,r=e.propertyIndex;if(t||(this.node=t=Sr.findNode(this.rootNode,e.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(i){var o=e.objectIndex;switch(i){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);for(t=t.skeleton.bones,i=0;i<t.length;i++)if(t[i].name===o){o=i;break}break;default:if(void 0===t[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[i]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}if(void 0===(o=t[n]))console.error("THREE.PropertyBinding: Trying to update property for track: "+e.nodeName+"."+n+" but it wasn't found.",t);else{if(e=this.Versioning.None,void 0!==(this.targetObject=t).needsUpdate?e=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(e=this.Versioning.MatrixWorldNeedsUpdate),i=this.BindingType.Direct,void 0!==r){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(i=0;i<this.node.geometry.morphAttributes.position.length;i++)if(t.geometry.morphAttributes.position[i].name===r){r=i;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(i=0;i<this.node.geometry.morphTargets.length;i++)if(t.geometry.morphTargets[i].name===r){r=i;break}}}i=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else void 0!==o.fromArray&&void 0!==o.toArray?(i=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(i=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=n;this.getValue=this.GetterByBindingType[i],this.setValue=this.SetterByBindingTypeAndVersioning[i][e]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Sr.prototype,{_getValue_unbound:Sr.prototype.getValue,_setValue_unbound:Sr.prototype.setValue}),Object.assign(Ar.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,c=void 0,l=0,h=arguments.length;l!==h;++l){var u=arguments[l],d=u.uuid,p=n[d];if(void 0===p){p=e++,n[d]=p,t.push(u),d=0;for(var f=s;d!==f;++d)a[d].push(new Sr(u,r[d],o[d]))}else if(p<i){c=t[p];var m=--i;for(t[n[(f=t[m]).uuid]=p]=f,t[n[d]=m]=u,d=0,f=s;d!==f;++d){var g=a[d],v=g[p];g[p]=g[m],void 0===v&&(v=new Sr(u,r[d],o[d])),g[m]=v}}else t[p]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=i},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,i=this._indicesByUUID,n=this._bindings,r=n.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],c=s.uuid,l=i[c];if(void 0!==l&&e<=l){var h=e++,u=t[h];for(t[i[u.uuid]=l]=u,t[i[c]=h]=s,s=0,c=r;s!==c;++s){var d=(u=n[s])[l];u[l]=u[h],u[h]=d}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,o=r.length,a=0,s=arguments.length;a!==s;++a){var c=arguments[a].uuid,l=n[c];if(void 0!==l)if(delete n[c],l<i){var h=t[c=--i],u=--e,d=t[u];for(t[n[h.uuid]=l]=h,t[n[d.uuid]=c]=d,t.pop(),h=0,d=o;h!==d;++h){var p=r[h],f=p[u];p[l]=p[c],p[c]=f,p.pop()}}else for(t[n[(d=t[u=--e]).uuid]=l]=d,t.pop(),h=0,d=o;h!==d;++h)(p=r[h])[l]=p[u],p.pop()}this.nCachedObjects_=i},subscribe_:function(t,e){var i=this._bindingsIndicesByPath,n=i[t],r=this._bindings;if(void 0!==n)return r[n];var o=this._paths,a=this._parsedPaths,s=this._objects,c=this.nCachedObjects_,l=Array(s.length),n=r.length;for(i[t]=n,o.push(t),a.push(e),r.push(l),i=c,n=s.length;i!==n;++i)l[i]=new Sr(s[i],t,e);return l},unsubscribe_:function(t){var e,i,n,r,o,a=this._bindingsIndicesByPath,s=a[t];void 0!==s&&(e=this._paths,i=this._parsedPaths,o=(n=this._bindings)[r=n.length-1],n[a[t[r]]=s]=o,n.pop(),i[s]=i[r],i.pop(),e[s]=e[r],e.pop())}}),Object.assign(Tr.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,i){var n,r;return t.fadeOut(e),this.fadeIn(e),i&&(r=(i=this._clip.duration)/(n=t._clip.duration),t.warp(1,n/i,e),this.warp(r,1,e)),this},crossFadeTo:function(t,e,i){return t.crossFadeFrom(this,e,i)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,i){var n=this._mixer,r=n.time,o=this._timeScaleInterpolant,a=this.timeScale;return null===o&&(this._timeScaleInterpolant=o=n._lendControlInterpolant()),n=o.parameterPositions,o=o.sampleValues,n[0]=r,n[1]=r+i,o[0]=t/a,o[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,i,n){if(this.enabled){var r=this._startTime;if(null!==r){if((e=(t-r)*i)<0||0===i)return;this._startTime=null,e*=i}if(e*=this._updateTimeScale(t),i=this._updateTime(e),0<(t=this._updateWeight(t))){e=this._interpolants,r=this._propertyBindings;for(var o=0,a=e.length;o!==a;++o)e[o].evaluate(i),r[o].accumulate(n,t)}}else this._updateWeight(t)},_updateWeight:function(t){var e,i,n=0;return this.enabled&&(n=this.weight,null!==(e=this._weightInterpolant)&&(n*=i=e.evaluate(t)[0],t>e.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1)))),this._effectiveWeight=n},_updateTimeScale:function(t){var e,i=0;return this.paused||(i=this.timeScale,null!==(e=this._timeScaleInterpolant)&&(i*=e.evaluate(t)[0],t>e.parameterPositions[1]&&(this.stopWarping(),0===i?this.paused=!0:this.timeScale=i))),this._effectiveTimeScale=i},_updateTime:function(t){var e,i=this.time+t,n=this._clip.duration,r=this.loop,o=this._loopCount,a=2202===r;if(0===t)return-1!==o&&a&&1==(1&o)?n-i:i;if(2200===r)t:{if(-1===o&&(this._loopCount=0,this._setEndings(!0,!0,!1)),n<=i)i=n;else{if(!(i<0)){this.time=i;break t}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}else if(-1===o&&(0<=t?(o=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),n<=i||i<0?(i-=n*(r=Math.floor(i/n)),o+=Math.abs(r),(e=this.repetitions-o)<=0?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i=0<t?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1})):(1==e?(t=t<0,this._setEndings(t,!t,a)):this._setEndings(!1,!1,a),this._loopCount=o,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:r}))):this.time=i,a&&1==(1&o))return n-i;return i},_setEndings:function(t,e,i){var n=this._interpolantSettings;i?(n.endingStart=2401,n.endingEnd=2401):(n.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,n.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,e,i){var n=this._mixer,r=n.time,o=this._weightInterpolant;return null===o&&(this._weightInterpolant=o=n._lendControlInterpolant()),n=o.parameterPositions,o=o.sampleValues,n[0]=r,o[0]=e,n[1]=r+t,o[1]=i,this}}),Cr.prototype=Object.assign(Object.create(e.prototype),{constructor:Cr,_bindAction:function(t,e){var i=t._localRoot||this._root,n=t._clip.tracks,r=n.length,o=t._propertyBindings;t=t._interpolants;var a=i.uuid,s=this._bindingsByRootAndName,c=s[a];for(void 0===c&&(c={},s[a]=c),s=0;s!==r;++s){var l=n[s],h=l.name,u=c[h];if(void 0===u){if(void 0!==(u=o[s])){null===u._cacheIndex&&(++u.referenceCount,this._addInactiveBinding(u,a,h));continue}++(u=new Mr(Sr.create(i,h,e&&e._propertyBindings[s].binding.parsedPath),l.ValueTypeName,l.getValueSize())).referenceCount,this._addInactiveBinding(u,a,h)}o[s]=u,t[s].resultBuffer=u.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){var e,i,n;for(null===t._cacheIndex&&(e=(t._localRoot||this._root).uuid,i=t._clip.uuid,n=this._actionsByClip[i],this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,i,e)),i=0,n=(e=t._propertyBindings).length;i!==n;++i){var r=e[i];0==r.useCount++&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,i=0,n=e.length;i!==n;++i){var r=e[i];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){return null!==(t=t._cacheIndex)&&t<this._nActiveActions},_addInactiveAction:function(t,e,i){var n=this._actions,r=this._actionsByClip,o=r[e];void 0===o?(o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=o):(e=o.knownActions,t._byClipCacheIndex=e.length,e.push(t)),t._cacheIndex=n.length,n.push(t),o.actionByRoot[i]=t},_removeInactiveAction:function(t){var e=this._actions,i=e[e.length-1],n=t._cacheIndex;e[i._cacheIndex=n]=i,e.pop(),t._cacheIndex=null,e=t._clip.uuid;var r=(n=(i=this._actionsByClip)[e]).knownActions,o=r[r.length-1],a=t._byClipCacheIndex;r[o._byClipCacheIndex=a]=o,r.pop(),t._byClipCacheIndex=null,delete n.actionByRoot[(t._localRoot||this._root).uuid],0===r.length&&delete i[e],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=0,i=(t=t._propertyBindings).length;e!==i;++e){var n=t[e];0==--n.referenceCount&&this._removeInactiveBinding(n)}},_lendAction:function(t){var e=this._actions,i=t._cacheIndex,n=this._nActiveActions++,r=e[n];e[t._cacheIndex=n]=t,e[r._cacheIndex=i]=r},_takeBackAction:function(t){var e=this._actions,i=t._cacheIndex,n=--this._nActiveActions,r=e[n];e[t._cacheIndex=n]=t,e[r._cacheIndex=i]=r},_addInactiveBinding:function(t,e,i){var n=this._bindingsByRootAndName,r=n[e],o=this._bindings;void 0===r&&(r={},n[e]=r),(r[i]=t)._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,i=(n=t.binding).rootNode.uuid,n=n.path,r=this._bindingsByRootAndName,o=r[i],a=e[e.length-1];t=t._cacheIndex,e[a._cacheIndex=t]=a,e.pop(),delete o[n];t:{for(var s in o)break t;delete r[i]}},_lendBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=this._nActiveBindings++,r=e[n];e[t._cacheIndex=n]=t,e[r._cacheIndex=i]=r},_takeBackBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=--this._nActiveBindings,r=e[n];e[t._cacheIndex=n]=t,e[r._cacheIndex=i]=r},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,i=t[e];return void 0===i&&(t[(i=new an(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e]=i),i},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,i=t.__cacheIndex,n=--this._nActiveControlInterpolants,r=e[n];e[t.__cacheIndex=n]=t,e[r.__cacheIndex=i]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var i=e||this._root,n=i.uuid;t=null!==(i="string"==typeof t?gn.findByName(i,t):t)?i.uuid:t;var r=this._actionsByClip[t],o=null;if(void 0!==r){if(void 0!==(o=r.actionByRoot[n]))return o;o=r.knownActions[0],null===i&&(i=o._clip)}return null===i?null:(e=new Tr(this,i,e),this._bindAction(e,o),this._addInactiveAction(e,t,n),e)},existingAction:function(t,e){var i=e||this._root;return e=i.uuid,i="string"==typeof t?gn.findByName(i,t):t,void 0!==(t=this._actionsByClip[i?i.uuid:t])&&t.actionByRoot[e]||null},stopAllAction:function(){for(var t=this._actions,e=this._nActiveActions,i=this._bindings,n=this._nActiveBindings,r=this._nActiveBindings=this._nActiveActions=0;r!==e;++r)t[r].reset();for(r=0;r!==n;++r)i[r].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,i=this._nActiveActions,n=this.time+=t,r=Math.sign(t),o=this._accuIndex^=1,a=0;a!==i;++a)e[a]._update(n,t,r,o);for(t=this._bindings,e=this._nActiveBindings,a=0;a!==e;++a)t[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions;t=t.uuid;var i=this._actionsByClip,n=i[t];if(void 0!==n){for(var r=0,o=(n=n.knownActions).length;r!==o;++r){var a=n[r];this._deactivateAction(a);var s=a._cacheIndex,c=e[e.length-1];a._cacheIndex=null,a._byClipCacheIndex=null,e[c._cacheIndex=s]=c,e.pop(),this._removeInactiveBindingsForAction(a)}delete i[t]}},uncacheRoot:function(t){t=t.uuid;var e=this._actionsByClip;for(n in e){var i=e[n].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var n=this._bindingsByRootAndName[t];if(void 0!==n)for(var r in n)(t=n[r]).restoreOriginalState(),this._removeInactiveBinding(t)},uncacheAction:function(t,e){null!==(t=this.existingAction(t,e))&&(this._deactivateAction(t),this._removeInactiveAction(t))}}),Lr.prototype.clone=function(){return new Lr(void 0===this.value.clone?this.value:this.value.clone())},Pr.prototype=Object.assign(Object.create(Ce.prototype),{constructor:Pr,isInstancedInterleavedBuffer:!0,copy:function(t){return Ce.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(Rr.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,i){return Or(t,this,i=i||[],e),i.sort(Ir),i},intersectObjects:function(t,e,i){if(i=i||[],!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var n=0,r=t.length;n<r;n++)Or(t[n],this,i,e);return i.sort(Ir),i}}),Object.assign(Dr.prototype,{set:function(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,i){return this.radius=Math.sqrt(t*t+e*e+i*i),0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(t,i),this.phi=Math.acos(uo.clamp(e/this.radius,-1,1))),this}}),Object.assign(kr.prototype,{set:function(t,e,i){return this.radius=t,this.theta=e,this.y=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,i){return this.radius=Math.sqrt(t*t+i*i),this.theta=Math.atan2(t,i),this.y=e,this}}),Object.assign(Nr.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:(Nl=new wt,function(t,e){return e=Nl.copy(e).multiplyScalar(.5),this.min.copy(t).sub(e),this.max.copy(t).add(e),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new wt),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new wt),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new wt),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new wt),e.copy(t).clamp(this.min,this.max)},distanceToPoint:(kl=new wt,function(t){return kl.copy(t).clamp(this.min,this.max).sub(t).length()}),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(zr.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new Et),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new Et),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new Et),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:(zl=new Et,Bl=new Et,function(t,e){return zl.subVectors(t,this.start),Bl.subVectors(this.end,this.start),t=Bl.dot(Bl),t=Bl.dot(zl)/t,e&&(t=uo.clamp(t,0,1)),t}),closestPointToPoint:function(t,e,i){return t=this.closestPointToPointParameter(t,e),void 0===i&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),i=new Et),this.delta(i).multiplyScalar(t).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),((Br.prototype=Object.create(u.prototype)).constructor=Br).prototype.isImmediateRenderObject=!0,((Fr.prototype=Object.create(Be.prototype)).constructor=Fr).prototype.update=(Fl=new Et,Ul=new Et,jl=new g,function(){var t=["a","b","c"];this.object.updateMatrixWorld(!0),jl.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld,i=this.geometry.attributes.position,n=this.object.geometry;if(n&&n.isGeometry)for(var r=n.vertices,o=n.faces,a=n=0,s=o.length;a<s;a++)for(var c=o[a],l=0,h=c.vertexNormals.length;l<h;l++){var u=c.vertexNormals[l];Fl.copy(r[c[t[l]]]).applyMatrix4(e),Ul.copy(u).applyMatrix3(jl).normalize().multiplyScalar(this.size).add(Fl),i.setXYZ(n,Fl.x,Fl.y,Fl.z),n+=1,i.setXYZ(n,Ul.x,Ul.y,Ul.z),n+=1}else if(n&&n.isBufferGeometry)for(t=n.attributes.position,r=n.attributes.normal,l=n=0,h=t.count;l<h;l++)Fl.set(t.getX(l),t.getY(l),t.getZ(l)).applyMatrix4(e),Ul.set(r.getX(l),r.getY(l),r.getZ(l)),Ul.applyMatrix3(jl).normalize().multiplyScalar(this.size).add(Fl),i.setXYZ(n,Fl.x,Fl.y,Fl.z),n+=1,i.setXYZ(n,Ul.x,Ul.y,Ul.z),n+=1;i.needsUpdate=!0}),((Ur.prototype=Object.create(u.prototype)).constructor=Ur).prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Ur.prototype.update=(Hl=new Et,function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),Hl.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Hl),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}),((jr.prototype=Object.create(Be.prototype)).constructor=jr).prototype.updateMatrixWorld=(Gl=new Et,Vl=new At,Wl=new At,function(t){var e=this.bones,i=this.geometry,n=i.getAttribute("position");Wl.getInverse(this.root.matrixWorld);for(var r=0,o=0;r<e.length;r++){var a=e[r];a.parent&&a.parent.isBone&&(Vl.multiplyMatrices(Wl,a.matrixWorld),Gl.setFromMatrixPosition(Vl),n.setXYZ(o,Gl.x,Gl.y,Gl.z),Vl.multiplyMatrices(Wl,a.parent.matrixWorld),Gl.setFromMatrixPosition(Vl),n.setXYZ(o+1,Gl.x,Gl.y,Gl.z),o+=2)}i.getAttribute("position").needsUpdate=!0,u.prototype.updateMatrixWorld.call(this,t)}),((Hr.prototype=Object.create(U.prototype)).constructor=Hr).prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Hr.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},((Gr.prototype=Object.create(ze.prototype)).constructor=Gr).prototype.update=function(){var t,e;this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color?(this.material.color.set(this.color),this.children[0].material.color.set(this.color)):(this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),t=this.material.color,1<(e=Math.max(t.r,t.g,t.b))&&t.multiplyScalar(1/e),this.children[0].material.color.copy(this.material.color))},Gr.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()},((Vr.prototype=Object.create(u.prototype)).constructor=Vr).prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Vr.prototype.update=(ql=new Et,Xl=new p,Yl=new p,function(){var t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=t.geometry.getAttribute("color");Xl.copy(this.light.color),Yl.copy(this.light.groundColor);for(var i=0,n=e.count;i<n;i++){var r=i<n/2?Xl:Yl;e.setXYZ(i,r.r,r.g,r.b)}e.needsUpdate=!0}t.lookAt(ql.setFromMatrixPosition(this.light.matrixWorld).negate())}),((Wr.prototype=Object.create(U.prototype)).constructor=Wr).prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Wr.prototype.onBeforeRender=function(){this.position.copy(this.lightProbe.position),this.scale.set(1,1,1).multiplyScalar(this.size),this.material.uniforms.intensity.value=this.lightProbe.intensity},qr.prototype=Object.assign(Object.create(Be.prototype),{constructor:qr,copy:function(t){return Be.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return(new this.constructor).copy(this)}}),(Xr.prototype=Object.create(Be.prototype)).constructor=Xr,((Yr.prototype=Object.create(ze.prototype)).constructor=Yr).prototype.update=function(){function t(t,e,i,n){for(i=(e-t)/i,p.setXYZ(h,0,0,0),u++,r=t;r<e;r+=i)o=h+u,p.setXYZ(o,Math.sin(r)*a,0,Math.cos(r)*a),p.setXYZ(o+1,Math.sin(Math.min(r+i,e))*a,0,Math.cos(Math.min(r+i,e))*a),p.setXYZ(o+2,0,0,0),u+=3;d.addGroup(h,u,n),h+=u,u=0}var r,o,e=this.audio,a=this.range,i=this.divisionsInnerAngle,n=this.divisionsOuterAngle,s=uo.degToRad(e.panner.coneInnerAngle),c=s/2,l=(e=uo.degToRad(e.panner.coneOuterAngle))/2,h=0,u=0,d=this.geometry,p=d.attributes.position;d.clearGroups(),t(-l,-c,n,0),t(-c,c,i,1),t(c,l,n,0),p.needsUpdate=!0,s===e&&(this.material[0].visible=!1)},Yr.prototype.dispose=function(){this.geometry.dispose(),this.material[0].dispose(),this.material[1].dispose()},(($r.prototype=Object.create(Be.prototype)).constructor=$r).prototype.update=($l=new Et,Zl=new Et,Jl=new g,function(){this.object.updateMatrixWorld(!0),Jl.getNormalMatrix(this.object.matrixWorld);for(var t=this.object.matrixWorld,e=this.geometry.attributes.position,i=this.object.geometry,n=i.vertices,r=0,o=0,a=(i=i.faces).length;o<a;o++){var s=i[o],c=s.normal;$l.copy(n[s.a]).add(n[s.b]).add(n[s.c]).divideScalar(3).applyMatrix4(t),Zl.copy(c).applyMatrix3(Jl).normalize().multiplyScalar(this.size).add($l),e.setXYZ(r,$l.x,$l.y,$l.z),r+=1,e.setXYZ(r,Zl.x,Zl.y,Zl.z),r+=1}e.needsUpdate=!0}),((Zr.prototype=Object.create(u.prototype)).constructor=Zr).prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Zr.prototype.update=(Ql=new Et,Kl=new Et,th=new Et,function(){Ql.setFromMatrixPosition(this.light.matrixWorld),Kl.setFromMatrixPosition(this.light.target.matrixWorld),th.subVectors(Kl,Ql),this.lightPlane.lookAt(Kl),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Kl),this.targetLine.scale.z=th.length()}),((Jr.prototype=Object.create(Be.prototype)).constructor=Jr).prototype.update=(nh=new Et,rh=new ye,function(){eh=this.geometry,ih=this.pointMap,rh.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),dh("c",0,0,-1),dh("t",0,0,1),dh("n1",-1,-1,-1),dh("n2",1,-1,-1),dh("n3",-1,1,-1),dh("n4",1,1,-1),dh("f1",-1,-1,1),dh("f2",1,-1,1),dh("f3",-1,1,1),dh("f4",1,1,1),dh("u1",.7,1.1,-1),dh("u2",-.7,1.1,-1),dh("u3",0,2,-1),dh("cf1",-1,0,1),dh("cf2",1,0,1),dh("cf3",0,-1,1),dh("cf4",0,1,1),dh("cn1",-1,0,-1),dh("cn2",1,0,-1),dh("cn3",0,-1,-1),dh("cn4",0,1,-1),eh.getAttribute("position").needsUpdate=!0}),((Qr.prototype=Object.create(Be.prototype)).constructor=Qr).prototype.update=(oh=new n,function(t){var e,i,n;void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&oh.setFromObject(this.object),oh.isEmpty()||(t=oh.min,e=oh.max,(n=(i=this.geometry.attributes.position).array)[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=t.x,n[4]=e.y,n[5]=e.z,n[6]=t.x,n[7]=t.y,n[8]=e.z,n[9]=e.x,n[10]=t.y,n[11]=e.z,n[12]=e.x,n[13]=e.y,n[14]=t.z,n[15]=t.x,n[16]=e.y,n[17]=t.z,n[18]=t.x,n[19]=t.y,n[20]=t.z,n[21]=e.x,n[22]=t.y,n[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere())}),Qr.prototype.setFromObject=function(t){return this.object=t,this.update(),this},Qr.prototype.copy=function(t){return Be.prototype.copy.call(this,t),this.object=t.object,this},Qr.prototype.clone=function(){return(new this.constructor).copy(this)},((Kr.prototype=Object.create(Be.prototype)).constructor=Kr).prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),u.prototype.updateMatrixWorld.call(this,t))},((to.prototype=Object.create(ze.prototype)).constructor=to).prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?1:0,this.lookAt(this.plane.normal),u.prototype.updateMatrixWorld.call(this,t)},((eo.prototype=Object.create(u.prototype)).constructor=eo).prototype.setDirection=(lh=new Et,function(t){.99999<t.y?this.quaternion.set(0,0,0,1):t.y<-.99999?this.quaternion.set(1,0,0,0):(lh.set(t.z,0,-t.x).normalize(),ch=Math.acos(t.y),this.quaternion.setFromAxisAngle(lh,ch))}),eo.prototype.setLength=function(t,e,i){void 0===e&&(e=.2*t),void 0===i&&(i=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(i,e,i),this.cone.position.y=t,this.cone.updateMatrix()},eo.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},eo.prototype.copy=function(t){return u.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},eo.prototype.clone=function(){return(new this.constructor).copy(this)},(io.prototype=Object.create(Be.prototype)).constructor=io,An.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(An.prototype),(t.prototype.constructor=t).prototype.getPoint=e,t},Object.assign(jn.prototype,{createPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getPoints(t),this.createGeometry(t)},createSpacedPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getSpacedPoints(t),this.createGeometry(t)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new f,i=0,n=t.length;i<n;i++){var r=t[i];e.vertices.push(new Et(r.x,r.y,r.z||0))}return e}}),Object.assign(Hn.prototype,{fromPoints:function(t){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),no.prototype=Object.create(Pn.prototype),ro.prototype=Object.create(Pn.prototype),oo.prototype=Object.create(Pn.prototype),Object.assign(oo.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),qr.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},jr.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(hr.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Kc.extractUrlBase(t)}}),Object.assign(or.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Object.assign(Nr.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(n.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),zr.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(uo,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),uo.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),uo.ceilPowerOfTwo(t)}}),Object.assign(g.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(At.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){return void 0===hh&&(hh=new Et),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),hh.setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,i,n,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,n,i,r,o)}}),v.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},S.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(z.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(B.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(B,{barycoordFromPoint:function(t,e,i,n,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),B.getBarycoord(t,e,i,n,r)},normal:function(t,e,i,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),B.getNormal(t,e,i,n)}}),Object.assign(Gn.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ai(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new zi(this,t)}}),Object.assign(wt.prototype,{fromAttribute:function(t,e,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Et.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Mt.prototype,{fromAttribute:function(t,e,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(f.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(u.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(u.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Ie.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(De.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Oe.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(An.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),be.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(Vn.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(m.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(P.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(P.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(Ti.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Lr.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(k.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new p}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}}}),Object.defineProperties(Ji.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(N.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(_e.prototype,{clearTarget:function(t,e,i,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,i,n)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")}}),Object.defineProperties(_e.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(pe.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(r.prototype,{activeCubeFace:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeCubeFace has been removed. It is now the second parameter of WebGLRenderer.setRenderTarget().")}},activeMipMapLevel:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeMipMapLevel has been removed. It is now the third parameter of WebGLRenderer.setRenderTarget().")}}}),Object.defineProperties(C.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(Ee.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}},userHeight:{set:function(){console.warn("THREE.WebVRManager: .userHeight has been removed.")}}}),xr.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new ur).load(t,function(t){e.setBuffer(t)}),this},Er.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},vr.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},Ko.crossOrigin=void 0,Ko.loadTexture=function(t,e,i,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new Sn;return r.setCrossOrigin(this.crossOrigin),t=r.load(t,i,void 0,n),e&&(t.mapping=e),t},Ko.loadTextureCube=function(t,e,i,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new _n;return r.setCrossOrigin(this.crossOrigin),t=r.load(t,i,void 0,n),e&&(t.mapping=e),t},Ko.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ko.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},t.ACESFilmicToneMapping=5,t.AddEquation=100,t.AddOperation=2,t.AdditiveBlending=2,t.AlphaFormat=1021,t.AlwaysDepth=1,t.AmbientLight=Kn,t.AmbientLightProbe=mr,t.AnimationClip=gn,t.AnimationLoader=xn,t.AnimationMixer=Cr,t.AnimationObjectGroup=Ar,t.AnimationUtils=Vc,t.ArcCurve=Cn,t.ArrayCamera=xe,t.ArrowHelper=eo,t.Audio=xr,t.AudioAnalyser=Er,t.AudioContext=uh,t.AudioListener=br,t.AudioLoader=ur,t.AxesHelper=io,t.AxisHelper=function(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new io(t)},t.BackSide=1,t.BasicDepthPacking=3200,t.BasicShadowMap=0,t.BinaryTextureLoader=function(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new En(t)},t.Bone=ke,t.BooleanKeyframeTrack=ln,t.BoundingBoxHelper=function(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Qr(t,e)},t.Box2=Nr,t.Box3=n,t.Box3Helper=Kr,t.BoxBufferGeometry=I,t.BoxGeometry=R,t.BoxHelper=Qr,t.BufferAttribute=m,t.BufferGeometry=P,t.BufferGeometryLoader=rr,t.ByteType=1010,t.Cache=Wc,t.Camera=ye,t.CameraHelper=Jr,t.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},t.CanvasTexture=Ve,t.CatmullRomCurve3=Pn,t.CineonToneMapping=4,t.CircleBufferGeometry=qi,t.CircleGeometry=Wi,t.ClampToEdgeWrapping=1001,t.Clock=yr,t.ClosedSplineCurve3=no,t.Color=p,t.ColorKeyframeTrack=hn,t.CompressedTexture=Ge,t.CompressedTextureLoader=wn,t.ConeBufferGeometry=Vi,t.ConeGeometry=Gi,t.CubeCamera=vr,t.CubeGeometry=R,t.CubeReflectionMapping=301,t.CubeRefractionMapping=302,t.CubeTexture=H,t.CubeTextureLoader=_n,t.CubeUVReflectionMapping=306,t.CubeUVRefractionMapping=307,t.CubicBezierCurve=Dn,t.CubicBezierCurve3=kn,t.CubicInterpolant=on,t.CullFaceBack=1,t.CullFaceFront=2,t.CullFaceFrontBack=3,t.CullFaceNone=0,t.Curve=An,t.CurvePath=jn,t.CustomBlending=5,t.CylinderBufferGeometry=Hi,t.CylinderGeometry=ji,t.Cylindrical=kr,t.DataTexture=_t,t.DataTexture2DArray=G,t.DataTexture3D=V,t.DataTextureLoader=En,t.DefaultLoadingManager=qc,t.DepthFormat=1026,t.DepthStencilFormat=1027,t.DepthTexture=We,t.DirectionalLight=Qn,t.DirectionalLightHelper=Zr,t.DirectionalLightShadow=Jn,t.DiscreteInterpolant=sn,t.DodecahedronBufferGeometry=ri,t.DodecahedronGeometry=ni,t.DoubleSide=2,t.DstAlphaFactor=206,t.DstColorFactor=208,t.DynamicBufferAttribute=function(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new m(t,e).setDynamic(!0)},t.EdgesGeometry=Ui,t.EdgesHelper=function(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Be(new Ui(t.geometry),new Ne({color:void 0!==e?e:16777215}))},t.EllipseCurve=Tn,t.EqualDepth=4,t.EquirectangularReflectionMapping=303,t.EquirectangularRefractionMapping=304,t.Euler=a,t.EventDispatcher=e,t.ExtrudeBufferGeometry=Ti,t.ExtrudeGeometry=Ai,t.Face3=y,t.Face4=function(t,e,i,n,r,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new y(t,e,i,r,o,a)},t.FaceColors=1,t.FaceNormalsHelper=$r,t.FileLoader=bn,t.FlatShading=1,t.Float32Attribute=function(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new L(t,e)},t.Float32BufferAttribute=L,t.Float64Attribute=function(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new _(t,e)},t.Float64BufferAttribute=_,t.FloatType=1015,t.Fog=Ae,t.FogExp2=Se,t.Font=cr,t.FontLoader=lr,t.FrontFaceDirectionCCW=1,t.FrontFaceDirectionCW=0,t.FrontSide=0,t.Frustum=St,t.GammaEncoding=3007,t.Geometry=f,t.GeometryUtils={merge:function(t,e,i){var n;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),n=e.matrix,e=e.geometry),t.merge(e,n,i)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},t.GreaterDepth=6,t.GreaterEqualDepth=5,t.GridHelper=qr,t.Group=ve,t.HalfFloatType=1016,t.HemisphereLight=Wn,t.HemisphereLightHelper=Vr,t.HemisphereLightProbe=fr,t.IcosahedronBufferGeometry=ii,t.IcosahedronGeometry=ei,t.ImageBitmapLoader=ar,t.ImageLoader=Mn,t.ImageUtils=Ko,t.ImmediateRenderObject=Br,t.InstancedBufferAttribute=nr,t.InstancedBufferGeometry=ir,t.InstancedInterleavedBuffer=Pr,t.Int16Attribute=function(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new x(t,e)},t.Int16BufferAttribute=x,t.Int32Attribute=function(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new E(t,e)},t.Int32BufferAttribute=E,t.Int8Attribute=function(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new c(t,e)},t.Int8BufferAttribute=c,t.IntType=1013,t.InterleavedBuffer=Ce,t.InterleavedBufferAttribute=Le,t.Interpolant=rn,t.InterpolateDiscrete=2300,t.InterpolateLinear=2301,t.InterpolateSmooth=2302,t.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},t.KeyframeTrack=cn,t.LOD=Ie,t.LatheBufferGeometry=Ni,t.LatheGeometry=ki,t.Layers=s,t.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")},t.LessDepth=2,t.LessEqualDepth=3,t.Light=Vn,t.LightProbe=pr,t.LightProbeHelper=Wr,t.LightShadow=qn,t.Line=ze,t.Line3=zr,t.LineBasicMaterial=Ne,t.LineCurve=Nn,t.LineCurve3=zn,t.LineDashedMaterial=nn,t.LineLoop=Fe,t.LinePieces=1,t.LineSegments=Be,t.LineStrip=0,t.LinearEncoding=3e3,t.LinearFilter=1006,t.LinearInterpolant=an,t.LinearMipMapLinearFilter=1008,t.LinearMipMapNearestFilter=1007,t.LinearToneMapping=1,t.Loader=hr,t.LoaderUtils=Kc,t.LoadingManager=yn,t.LogLuvEncoding=3003,t.LoopOnce=2200,t.LoopPingPong=2202,t.LoopRepeat=2201,t.LuminanceAlphaFormat=1025,t.LuminanceFormat=1024,t.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},t.Material=k,t.MaterialLoader=er,t.Math=uo,t.Matrix3=g,t.Matrix4=At,t.MaxEquation=104,t.Mesh=U,t.MeshBasicMaterial=F,t.MeshDepthMaterial=ue,t.MeshDistanceMaterial=de,t.MeshFaceMaterial=function(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t},t.MeshLambertMaterial=tn,t.MeshMatcapMaterial=en,t.MeshNormalMaterial=Ki,t.MeshPhongMaterial=Ji,t.MeshPhysicalMaterial=Zi,t.MeshStandardMaterial=$i,t.MeshToonMaterial=Qi,t.MinEquation=103,t.MirroredRepeatWrapping=1002,t.MixOperation=1,t.MultiMaterial=function(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,(t.materials=t).clone=function(){return t.slice()},t},t.MultiplyBlending=4,t.MultiplyOperation=0,t.NearestFilter=1003,t.NearestMipMapLinearFilter=1005,t.NearestMipMapNearestFilter=1004,t.NeverDepth=0,t.NoBlending=0,t.NoColors=0,t.NoToneMapping=0,t.NormalBlending=1,t.NotEqualDepth=7,t.NumberKeyframeTrack=un,t.Object3D=u,t.ObjectLoader=or,t.ObjectSpaceNormalMap=1,t.OctahedronBufferGeometry=ti,t.OctahedronGeometry=Ke,t.OneFactor=201,t.OneMinusDstAlphaFactor=207,t.OneMinusDstColorFactor=209,t.OneMinusSrcAlphaFactor=205,t.OneMinusSrcColorFactor=203,t.OrthographicCamera=Zn,t.PCFShadowMap=1,t.PCFSoftShadowMap=2,t.ParametricBufferGeometry=Ye,t.ParametricGeometry=Xe,t.Particle=function(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Re(t)},t.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Ue(t)},t.ParticleSystem=function(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new je(t,e)},t.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Ue(t)},t.Path=Hn,t.PerspectiveCamera=be,t.Plane=v,t.PlaneBufferGeometry=D,t.PlaneGeometry=O,t.PlaneHelper=to,t.PointCloud=function(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new je(t,e)},t.PointCloudMaterial=function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Ue(t)},t.PointLight=$n,t.PointLightHelper=Hr,t.Points=je,t.PointsMaterial=Ue,t.PolarGridHelper=Xr,t.PolyhedronBufferGeometry=Ze,t.PolyhedronGeometry=$e,t.PositionalAudio=wr,t.PositionalAudioHelper=Yr,t.PropertyBinding=Sr,t.PropertyMixer=Mr,t.QuadraticBezierCurve=Bn,t.QuadraticBezierCurve3=Fn,t.Quaternion=S,t.QuaternionKeyframeTrack=pn,t.QuaternionLinearInterpolant=dn,t.REVISION="105",t.RGBADepthPacking=3201,t.RGBAFormat=1023,t.RGBA_ASTC_10x10_Format=37819,t.RGBA_ASTC_10x5_Format=37816,t.RGBA_ASTC_10x6_Format=37817,t.RGBA_ASTC_10x8_Format=37818,t.RGBA_ASTC_12x10_Format=37820,t.RGBA_ASTC_12x12_Format=37821,t.RGBA_ASTC_4x4_Format=37808,t.RGBA_ASTC_5x4_Format=37809,t.RGBA_ASTC_5x5_Format=37810,t.RGBA_ASTC_6x5_Format=37811,t.RGBA_ASTC_6x6_Format=37812,t.RGBA_ASTC_8x5_Format=37813,t.RGBA_ASTC_8x6_Format=37814,t.RGBA_ASTC_8x8_Format=37815,t.RGBA_PVRTC_2BPPV1_Format=35843,t.RGBA_PVRTC_4BPPV1_Format=35842,t.RGBA_S3TC_DXT1_Format=33777,t.RGBA_S3TC_DXT3_Format=33778,t.RGBA_S3TC_DXT5_Format=33779,t.RGBDEncoding=3006,t.RGBEEncoding=3002,t.RGBEFormat=1023,t.RGBFormat=1022,t.RGBM16Encoding=3005,t.RGBM7Encoding=3004,t.RGB_ETC1_Format=36196,t.RGB_PVRTC_2BPPV1_Format=35841,t.RGB_PVRTC_4BPPV1_Format=35840,t.RGB_S3TC_DXT1_Format=33776,t.RawShaderMaterial=Yi,t.Ray=z,t.Raycaster=Rr,t.RectAreaLight=tr,t.RectAreaLightHelper=Gr,t.RedFormat=1028,t.ReinhardToneMapping=2,t.RepeatWrapping=1e3,t.ReverseSubtractEquation=102,t.RingBufferGeometry=Di,t.RingGeometry=Oi,t.Scene=Te,t.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}},t.ShaderChunk=aa,t.ShaderLib=ma,t.ShaderMaterial=N,t.ShadowMaterial=Xi,t.Shape=Gn,t.ShapeBufferGeometry=Bi,t.ShapeGeometry=zi,t.ShapePath=sr,t.ShapeUtils=Uc,t.ShortType=1011,t.Skeleton=De,t.SkeletonHelper=jr,t.SkinnedMesh=Oe,t.SmoothShading=2,t.Sphere=h,t.SphereBufferGeometry=Ii,t.SphereGeometry=Ri,t.Spherical=Dr,t.SphericalHarmonics3=dr,t.SphericalReflectionMapping=305,t.Spline=oo,t.SplineCurve=Un,t.SplineCurve3=ro,t.SpotLight=Yn,t.SpotLightHelper=Ur,t.SpotLightShadow=Xn,t.Sprite=Re,t.SpriteMaterial=Pe,t.SrcAlphaFactor=204,t.SrcAlphaSaturateFactor=210,t.SrcColorFactor=202,t.StereoCamera=gr,t.StringKeyframeTrack=fn,t.SubtractEquation=101,t.SubtractiveBlending=3,t.TangentSpaceNormalMap=0,t.TetrahedronBufferGeometry=Qe,t.TetrahedronGeometry=Je,t.TextBufferGeometry=Pi,t.TextGeometry=Li,t.Texture=d,t.TextureLoader=Sn,t.TorusBufferGeometry=hi,t.TorusGeometry=li,t.TorusKnotBufferGeometry=ci,t.TorusKnotGeometry=si,t.Triangle=B,t.TriangleFanDrawMode=2,t.TriangleStripDrawMode=1,t.TrianglesDrawMode=0,t.TubeBufferGeometry=ai,t.TubeGeometry=oi,t.UVMapping=300,t.Uint16Attribute=function(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new w(t,e)},t.Uint16BufferAttribute=w,t.Uint32Attribute=function(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new M(t,e)},t.Uint32BufferAttribute=M,t.Uint8Attribute=function(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new l(t,e)},t.Uint8BufferAttribute=l,t.Uint8ClampedAttribute=function(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new b(t,e)},t.Uint8ClampedBufferAttribute=b,t.Uncharted2ToneMapping=3,t.Uniform=Lr,t.UniformsLib=fa,t.UniformsUtils=sa,t.UnsignedByteType=1009,t.UnsignedInt248Type=1020,t.UnsignedIntType=1014,t.UnsignedShort4444Type=1017,t.UnsignedShort5551Type=1018,t.UnsignedShort565Type=1019,t.UnsignedShortType=1012,t.Vector2=wt,t.Vector3=Et,t.Vector4=Mt,t.VectorKeyframeTrack=mn,t.Vertex=function(t,e,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Et(t,e,i)},t.VertexColors=2,t.VertexNormalsHelper=Fr,t.VideoTexture=He,t.WebGLMultisampleRenderTarget=i,t.WebGLRenderTarget=C,t.WebGLRenderTargetCube=r,t.WebGLRenderer=_e,t.WebGLUtils=ge,t.WireframeGeometry=qe,t.WireframeHelper=function(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Be(new qe(t.geometry),new Ne({color:void 0!==e?e:16777215}))},t.WrapAroundEnding=2402,t.XHRLoader=function(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new bn(t)},t.ZeroCurvatureEnding=2400,t.ZeroFactor=200,t.ZeroSlopeEnding=2401,t.sRGBEncoding=3001,Object.defineProperty(t,"__esModule",{value:!0})}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],e):e((t=t||self).PANOLENS={},t.THREE)}(this,function(t,q){function e(t){this.constraints=Object.assign({video:{width:{ideal:1920},height:{ideal:1080},facingMode:{exact:"environment"}},audio:!1},t),this.element=this.scene=this.container=null,this.devices=[],this.stream=null,this.ratioScalar=1,this.videoDeviceIndex=0}function n(t){this.format=null,this.eyeSep=void 0===t?.064:t,this.loffset=new q.Vector2,this.roffset=new q.Vector2}function r(t,e,i){t=void 0===t?16777215:t,e=void 0===e||e,i=void 0===i?1500:i,this.dpr=window.devicePixelRatio;var n=(r=this.createCanvas()).canvas,r=r.context,o=new q.SpriteMaterial({color:t,map:this.createCanvasTexture(n)});q.Sprite.call(this,o),this.canvasWidth=n.width,this.canvasHeight=n.height,this.context=r,this.color=t instanceof q.Color?t:new q.Color(t),this.autoSelect=e,this.dwellTime=i,this.rippleDuration=500,this.position.z=-10,this.center.set(.5,.5),this.scale.set(.5,.5,1),this.callback=this.timerId=this.startTimestamp=null,this.frustumCulled=!1,this.updateCanvasArcByProgress(0)}function a(n,t,e){n=void 0===n?300:n,t=t||T.Info,q.Sprite.call(this),this.type="infospot",this.animated=void 0===e||e,this.frustumCulled=this.isHovering=!1,this.cursorStyle=this.toPanorama=this.element=null,this.mode=S.NORMAL,this.scale.set(n,n,1),this.rotation.y=Math.PI,this.container=null,this.originalRaycast=this.raycast,this.HANDLER_FOCUS=null,this.material.side=q.DoubleSide,this.material.depthTest=!1,this.material.transparent=!0,this.material.opacity=0,this.scaleUpAnimation=new I.Tween,this.scaleDownAnimation=new I.Tween,e=function(t){var e,i;this.material&&(e=t.image.width/t.image.height,i=new q.Vector3,t.image.width=t.image.naturalWidth||64,t.image.height=t.image.naturalHeight||64,this.scale.set(e*n,n,1),i.copy(this.scale),this.scaleUpAnimation=new I.Tween(this.scale).to({x:1.3*i.x,y:1.3*i.y},500).easing(I.Easing.Elastic.Out),this.scaleDownAnimation=new I.Tween(this.scale).to({x:i.x,y:i.y},500).easing(I.Easing.Elastic.Out),this.material.map=t,this.material.needsUpdate=!0)}.bind(this),this.showAnimation=new I.Tween(this.material).to({opacity:1},500).onStart(this.enableRaycast.bind(this,!0)).easing(I.Easing.Quartic.Out),this.hideAnimation=new I.Tween(this.material).to({opacity:0},500).onStart(this.enableRaycast.bind(this,!1)).easing(I.Easing.Quartic.Out),this.addEventListener("click",this.onClick),this.addEventListener("hover",this.onHover),this.addEventListener("hoverenter",this.onHoverStart),this.addEventListener("hoverleave",this.onHoverEnd),this.addEventListener("panolens-dual-eye-effect",this.onDualEyeEffect),this.addEventListener("panolens-container",this.setContainer.bind(this)),this.addEventListener("dismiss",this.onDismiss),this.addEventListener("panolens-infospot-focus",this.setFocusMethod),L.load(t,e)}function i(t){t||console.warn("PANOLENS.Widget: No container specified"),q.EventDispatcher.call(this),this.DEFAULT_TRANSITION="all 0.27s ease",this.TOUCH_ENABLED=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch),this.PREVENT_EVENT_HANDLER=function(t){t.preventDefault(),t.stopPropagation()},this.container=t,this.mask=this.activeSubMenu=this.activeMainItem=this.mainMenu=this.settingElement=this.videoElement=this.fullscreenElement=this.barElement=null}function o(){this.edgeLength=1e4,q.Mesh.call(this,this.createGeometry(this.edgeLength),this.createMaterial()),this.type="panorama",this.ImageQualityLow=1,this.ImageQualityFair=2,this.ImageQualityMedium=3,this.ImageQualityHigh=4,this.ImageQualitySuperHigh=5,this.animationDuration=1e3,this.defaultInfospotSize=350,this.container=void 0,this.loaded=!1,this.linkedSpots=[],this.isInfospotVisible=!1,this.linkingImageScale=this.linkingImageURL=void 0,this.renderOrder=-1,this.active=!1,this.infospotAnimation=new I.Tween(this).to({},this.animationDuration/2),this.addEventListener("load",this.fadeIn.bind(this)),this.addEventListener("panolens-container",this.setContainer.bind(this)),this.addEventListener("click",this.onClick.bind(this)),this.setupTransitions()}function s(t){o.call(this),this.src=t,this.type="image_panorama"}function c(){o.call(this),this.type="empty_panorama"}function l(t){t=void 0===t?[]:t,o.call(this),this.images=t,this.type="cube_panorama"}function h(){for(var t=[],e=0;e<6;e++)t.push(T.WhiteTile);l.call(this,t),this.type="basic_panorama"}function u(t,e){e=void 0===e?{}:e,o.call(this),this.src=t,this.options=Object.assign({videoElement:document.createElement("video"),loop:!0,muted:!0,autoplay:!1,playsinline:!0,crossOrigin:"anonymous"},e),this.videoElement=this.options.videoElement,this.videoProgress=0,this.type="video_panorama",this.addEventListener("leave",this.pauseVideo.bind(this)),this.addEventListener("enter-fade-start",this.resumeVideoProgress.bind(this)),this.addEventListener("video-toggle",this.toggleVideo.bind(this)),this.addEventListener("video-time",this.setVideoCurrentTime.bind(this))}function d(t){var e;this._parameters=t=void 0===t?{}:t,this._panoId=this._zoom=null,this._panoClient=new google.maps.StreetViewService,this._total=this._count=0,this._canvas=[],this._ctx=[],this._hc=this._wc=0,this.result=null,this.rotation=0,this.copyright="",this.onPanoramaLoad=this.onSizeChange=null,this.levelsW=[1,2,4,7,13,26],this.levelsH=[1,1,2,4,7,13],this.widths=[416,832,1664,3328,6656,13312],this.heights=[416,416,832,1664,3328,6656],this.maxH=this.maxW=6656;try{var i=document.createElement("canvas");(e=i.getContext("experimental-webgl"))||(e=i.getContext("webgl"))}catch(t){}this.maxW=Math.max(e.getParameter(e.MAX_TEXTURE_SIZE),this.maxW),this.maxH=Math.max(e.getParameter(e.MAX_TEXTURE_SIZE),this.maxH)}function p(t,e){s.call(this),this.panoId=t,this.gsvLoader=null,this.loadRequested=!1,this.setupGoogleMapAPI(e),this.type="google_streetview_panorama"}function f(t,e){"image"===(void 0===t?"image":t)&&s.call(this,e),this.EPS=1e-6,this.frameId=null,this.dragging=!1,this.userMouse=new q.Vector2,this.quatA=new q.Quaternion,this.quatB=new q.Quaternion,this.quatCur=new q.Quaternion,this.quatSlerp=new q.Quaternion,this.vectorX=new q.Vector3(1,0,0),this.vectorY=new q.Vector3(0,1,0),this.type="little_planet",this.addEventListener("window-resize",this.onWindowResize)}function m(t){f.call(this,"image",t),this.type="image_little_planet"}function g(t){o.call(this),this.media=new e(t),this.type="camera_panorama",this.addEventListener("enter",this.start.bind(this)),this.addEventListener("leave",this.stop.bind(this)),this.addEventListener("panolens-container",this.onPanolensContainer.bind(this)),this.addEventListener("panolens-scene",this.onPanolensScene.bind(this))}function v(t,e){e=void 0===e?new n:e,s.call(this,t),this.stereo=e,this.type="stereo_image_panorama"}function y(t,e,i){e=void 0===e?{}:e,i=void 0===i?new n:i,u.call(this,t,e),this.stereo=i,this.type="stereo_video_panorama"}function b(t,e){function i(t){if(N=z=0,(B=!1)!==g.enabled){if(t.preventDefault(),t.button===g.mouseButtons.ORBIT){if(!0===g.noRotate)return;U=F.ROTATE,v.set(t.clientX,t.clientY)}else if(t.button===g.mouseButtons.ZOOM){if(!0===g.noZoom)return;U=F.DOLLY,S.set(t.clientX,t.clientY)}else if(t.button===g.mouseButtons.PAN){if(!0===g.noPan)return;U=F.PAN,x.set(t.clientX,t.clientY)}U!==F.NONE&&(document.addEventListener("mousemove",n,!1),document.addEventListener("mouseup",r,!1),g.dispatchEvent(V)),g.update()}}function n(t){if(!1!==g.enabled){t.preventDefault();var e=g.domElement===document?g.domElement.body:g.domElement;if(U===F.ROTATE){if(!0===g.noRotate)return;y.set(t.clientX,t.clientY),b.subVectors(y,v),g.rotateLeft(2*Math.PI*b.x/e.clientWidth*g.rotateSpeed),g.rotateUp(2*Math.PI*b.y/e.clientHeight*g.rotateSpeed),v.copy(y),u&&(N=t.clientX-u.clientX,z=t.clientY-u.clientY),u=t}else if(U===F.DOLLY){if(!0===g.noZoom)return;A.set(t.clientX,t.clientY),T.subVectors(A,S),0<T.y?g.dollyIn():T.y<0&&g.dollyOut(),S.copy(A)}else if(U===F.PAN){if(!0===g.noPan)return;w.set(t.clientX,t.clientY),E.subVectors(w,x),g.pan(E.x,E.y),x.copy(w)}U!==F.NONE&&g.update()}}function r(){!(B=!(u=void 0))!==g.enabled&&(document.removeEventListener("mousemove",n,!1),document.removeEventListener("mouseup",r,!1),g.dispatchEvent(W),U=F.NONE)}function o(t){var e;!1!==g.enabled&&!0!==g.noZoom&&U===F.NONE&&(t.preventDefault(),t.stopPropagation(),void(e=0)!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),0<e?(g.object.fov=g.object.fov<g.maxFov?g.object.fov+1:g.maxFov,g.object.updateProjectionMatrix()):e<0&&(g.object.fov=g.object.fov>g.minFov?g.object.fov-1:g.minFov,g.object.updateProjectionMatrix()),g.update(),g.dispatchEvent(G),g.dispatchEvent(V),g.dispatchEvent(W))}function a(t){switch(t.keyCode){case g.keys.UP:d=!1;break;case g.keys.BOTTOM:p=!1;break;case g.keys.LEFT:f=!1;break;case g.keys.RIGHT:m=!1}}function s(t){if(!1!==g.enabled&&!0!==g.noKeys&&!0!==g.noRotate){switch(t.keyCode){case g.keys.UP:d=!0;break;case g.keys.BOTTOM:p=!0;break;case g.keys.LEFT:f=!0;break;case g.keys.RIGHT:m=!0}(d||p||f||m)&&(B=!0,d&&(z=-g.rotateSpeed*g.momentumKeydownFactor),p&&(z=g.rotateSpeed*g.momentumKeydownFactor),f&&(N=-g.rotateSpeed*g.momentumKeydownFactor),m&&(N=g.rotateSpeed*g.momentumKeydownFactor))}}function c(t){if(N=z=0,(B=!1)!==g.enabled){switch(t.touches.length){case 1:if(!0===g.noRotate)return;U=F.TOUCH_ROTATE,v.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(!0===g.noZoom)return;U=F.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX;t=t.touches[0].pageY-t.touches[1].pageY,S.set(0,Math.sqrt(e*e+t*t));break;case 3:if(!0===g.noPan)return;U=F.TOUCH_PAN,x.set(t.touches[0].pageX,t.touches[0].pageY);break;default:U=F.NONE}U!==F.NONE&&g.dispatchEvent(V)}}function l(t){if(!1!==g.enabled){t.preventDefault(),t.stopPropagation();var e=g.domElement===document?g.domElement.body:g.domElement;switch(t.touches.length){case 1:if(!0===g.noRotate)break;if(U!==F.TOUCH_ROTATE)break;y.set(t.touches[0].pageX,t.touches[0].pageY),b.subVectors(y,v),g.rotateLeft(2*Math.PI*b.x/e.clientWidth*g.rotateSpeed),g.rotateUp(2*Math.PI*b.y/e.clientHeight*g.rotateSpeed),v.copy(y),u&&(N=t.touches[0].pageX-u.pageX,z=t.touches[0].pageY-u.pageY),u={pageX:t.touches[0].pageX,pageY:t.touches[0].pageY},g.update();break;case 2:if(!0===g.noZoom)break;if(U!==F.TOUCH_DOLLY)break;e=t.touches[0].pageX-t.touches[1].pageX,t=t.touches[0].pageY-t.touches[1].pageY,A.set(0,Math.sqrt(e*e+t*t)),T.subVectors(A,S),T.y<0?(g.object.fov=g.object.fov<g.maxFov?g.object.fov+1:g.maxFov,g.object.updateProjectionMatrix()):0<T.y&&(g.object.fov=g.object.fov>g.minFov?g.object.fov-1:g.minFov,g.object.updateProjectionMatrix()),S.copy(A),g.update(),g.dispatchEvent(G);break;case 3:if(!0===g.noPan)break;if(U!==F.TOUCH_PAN)break;w.set(t.touches[0].pageX,t.touches[0].pageY),E.subVectors(w,x),g.pan(E.x,E.y),x.copy(w),g.update();break;default:U=F.NONE}}}function h(){!(B=!(u=void 0))!==g.enabled&&(g.dispatchEvent(W),U=F.NONE)}this.object=t,this.domElement=void 0!==e?e:document,this.frameId=null,this.enabled=!0,this.center=this.target=new q.Vector3,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.noRotate=!1,this.rotateSpeed=-.15,this.noPan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.momentumDampingFactor=.9,this.momentumScalingFactor=-.005,this.momentumKeydownFactor=20,this.minFov=30,this.maxFov=120,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:q.MOUSE.LEFT,ZOOM:q.MOUSE.MIDDLE,PAN:q.MOUSE.RIGHT};var u,d,p,f,m,g=this,v=new q.Vector2,y=new q.Vector2,b=new q.Vector2,x=new q.Vector2,w=new q.Vector2,E=new q.Vector2,M=new q.Vector3,_=new q.Vector3,S=new q.Vector2,A=new q.Vector2,T=new q.Vector2,C=0,L=0,P=0,R=0,I=1,O=new q.Vector3,D=new q.Vector3,k=new q.Quaternion,N=0,z=0,B=!1,F={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},U=F.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var j=(new q.Quaternion).setFromUnitVectors(t.up,new q.Vector3(0,1,0)),H=j.clone().inverse(),G={type:"change"},V={type:"start"},W={type:"end"};this.setLastQuaternion=function(t){k.copy(t),g.object.quaternion.copy(t)},this.getLastPosition=function(){return D},this.rotateLeft=function(t){void 0===t&&(t=2*Math.PI/60/60*g.autoRotateSpeed),R-=t},this.rotateUp=function(t){void 0===t&&(t=2*Math.PI/60/60*g.autoRotateSpeed),P-=t},this.panLeft=function(t){var e=this.object.matrix.elements;M.set(e[0],e[1],e[2]),M.multiplyScalar(-t),O.add(M)},this.panUp=function(t){var e=this.object.matrix.elements;M.set(e[4],e[5],e[6]),M.multiplyScalar(t),O.add(M)},this.pan=function(t,e){var i,n=g.domElement===document?g.domElement.body:g.domElement;g.object instanceof q.PerspectiveCamera?(i=g.object.position.clone().sub(g.target).length(),i*=Math.tan(g.object.fov/2*Math.PI/180),g.panLeft(2*t*i/n.clientHeight),g.panUp(2*e*i/n.clientHeight)):g.object instanceof q.OrthographicCamera?(g.panLeft(t*(g.object.right-g.object.left)/n.clientWidth),g.panUp(e*(g.object.top-g.object.bottom)/n.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.momentum=function(){B&&(Math.abs(N)<1e-4&&Math.abs(z)<1e-4?B=!1:(z*=this.momentumDampingFactor,N*=this.momentumDampingFactor,R-=this.momentumScalingFactor*N,P-=this.momentumScalingFactor*z))},this.dollyIn=function(t){void 0===t&&(t=Math.pow(.95,g.zoomSpeed)),g.object instanceof q.PerspectiveCamera?I/=t:g.object instanceof q.OrthographicCamera?(g.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*t)),g.object.updateProjectionMatrix(),g.dispatchEvent(G)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.dollyOut=function(t){void 0===t&&(t=Math.pow(.95,g.zoomSpeed)),g.object instanceof q.PerspectiveCamera?I*=t:g.object instanceof q.OrthographicCamera?(g.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/t)),g.object.updateProjectionMatrix(),g.dispatchEvent(G)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.update=function(t){var e=this.object.position;_.copy(e).sub(this.target),_.applyQuaternion(j),C=Math.atan2(_.x,_.z),L=Math.atan2(Math.sqrt(_.x*_.x+_.z*_.z),_.y),this.autoRotate&&U===F.NONE&&this.rotateLeft(2*Math.PI/60/60*g.autoRotateSpeed),this.momentum(),C+=R,L+=P,C=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,C)),L=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,L)),L=Math.max(1e-7,Math.min(Math.PI-1e-7,L));var i=_.length()*I,i=Math.max(this.minDistance,Math.min(this.maxDistance,i));this.target.add(O),_.x=i*Math.sin(L)*Math.sin(C),_.y=i*Math.cos(L),_.z=i*Math.sin(L)*Math.cos(C),_.applyQuaternion(H),e.copy(this.target).add(_),this.object.lookAt(this.target),P=R=0,I=1,O.set(0,0,0),(1e-7<D.distanceToSquared(this.object.position)||1e-7<8*(1-k.dot(this.object.quaternion)))&&(!0!==t&&this.dispatchEvent(G),D.copy(this.object.position),k.copy(this.object.quaternion))},this.reset=function(){U=F.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(G),this.update()},this.getPolarAngle=function(){return L},this.getAzimuthalAngle=function(){return C},this.dispose=function(){this.domElement.removeEventListener("mousedown",i),this.domElement.removeEventListener("mousewheel",o),this.domElement.removeEventListener("DOMMouseScroll",o),this.domElement.removeEventListener("touchstart",c),this.domElement.removeEventListener("touchend",h),this.domElement.removeEventListener("touchmove",l),window.removeEventListener("keyup",a),window.removeEventListener("keydown",s)},this.domElement.addEventListener("mousedown",i,{passive:!1}),this.domElement.addEventListener("mousewheel",o,{passive:!1}),this.domElement.addEventListener("DOMMouseScroll",o,{passive:!1}),this.domElement.addEventListener("touchstart",c,{passive:!1}),this.domElement.addEventListener("touchend",h,{passive:!1}),this.domElement.addEventListener("touchmove",l,{passive:!1}),window.addEventListener("keyup",a,{passive:!1}),window.addEventListener("keydown",s,{passive:!1}),this.update()}function x(t,e){var p=this,f={type:"change"},m=0,i=0,n=0;this.camera=t,this.camera.rotation.reorder("YXZ"),this.domElement=void 0!==e?e:document,this.enabled=!0,this.deviceOrientation=null,this.alphaOffsetAngle=this.alpha=this.screenOrientation=0;function r(t){p.deviceOrientation=t}function o(){p.screenOrientation=window.orientation||0}function a(t){t.preventDefault(),t.stopPropagation(),i=t.touches[0].pageX,n=t.touches[0].pageY}function s(t){t.preventDefault(),t.stopPropagation(),m+=q.Math.degToRad((n-t.touches[0].pageY)/4),p.rotateLeft(-q.Math.degToRad((t.touches[0].pageX-i)/4)),i=t.touches[0].pageX,n=t.touches[0].pageY}this.connect=function(){o(),window.addEventListener("orientationchange",o,{passive:!0}),window.addEventListener("deviceorientation",r,{passive:!0}),window.addEventListener("deviceorientation",this.update.bind(this),{passive:!0}),p.domElement.addEventListener("touchstart",a,{passive:!1}),p.domElement.addEventListener("touchmove",s,{passive:!1}),p.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",o,!1),window.removeEventListener("deviceorientation",r,!1),window.removeEventListener("deviceorientation",this.update.bind(this),!1),p.domElement.removeEventListener("touchstart",a,!1),p.domElement.removeEventListener("touchmove",s,!1),p.enabled=!1},this.update=function(t){var e,i,n,r,o,a,s,c,l,h,u,d;!1!==p.enabled&&p.deviceOrientation&&(e=p.deviceOrientation.alpha?q.Math.degToRad(p.deviceOrientation.alpha)+p.alphaOffsetAngle:0,i=p.deviceOrientation.beta?q.Math.degToRad(p.deviceOrientation.beta):0,n=p.deviceOrientation.gamma?q.Math.degToRad(p.deviceOrientation.gamma):0,r=p.screenOrientation?q.Math.degToRad(p.screenOrientation):0,o=p.camera.quaternion,a=new q.Vector3(0,0,1),s=new q.Euler,c=new q.Quaternion,l=new q.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),h=new q.Quaternion,u=new q.Quaternion,0==p.screenOrientation?(d=new q.Vector3(1,0,0),h.setFromAxisAngle(d,-m)):180==p.screenOrientation?(d=new q.Vector3(1,0,0),h.setFromAxisAngle(d,m)):90==p.screenOrientation?(d=new q.Vector3(0,1,0),h.setFromAxisAngle(d,m)):-90==p.screenOrientation&&(d=new q.Vector3(0,1,0),h.setFromAxisAngle(d,-m)),l.multiply(h),l.multiply(u),s.set(i,e,-n,"YXZ"),o.setFromEuler(s),o.multiply(l),o.multiply(c.setFromAxisAngle(a,-r)),p.alpha=e,!0!==t&&p.dispatchEvent(f))},this.updateAlphaOffsetAngle=function(t){this.alphaOffsetAngle=t},this.updateRotX=function(t){m=t},this.rotateLeft=function(t){this.updateAlphaOffsetAngle(this.alphaOffsetAngle-t)},this.rotateUp=function(t){this.updateRotX(m+t)},this.dispose=function(){this.disconnect()},this.connect()}function w(o){var a=new q.OrthographicCamera(-1,1,1,-1,0,1),s=new q.Scene,c=new q.StereoCamera;c.aspect=.5;var l=new q.WebGLRenderTarget(512,512,{minFilter:q.LinearFilter,magFilter:q.NearestFilter,format:q.RGBAFormat});l.scissorTest=!0,l.texture.generateMipmaps=!1;var t=new q.Vector2(.441,.156),e=new q.PlaneBufferGeometry(1,1,10,20).removeAttribute("normal").toNonIndexed(),i=e.attributes.position.array,n=e.attributes.uv.array;e.attributes.position.count*=2,e.attributes.uv.count*=2;var r=new Float32Array(2*i.length);r.set(i),r.set(i,i.length);var h=new Float32Array(2*n.length);h.set(n),h.set(n,n.length),n=new q.Vector2,i=i.length/3;for(var u=0,d=r.length/3;u<d;u++){n.x=r[3*u],n.y=r[3*u+1];var p=n.dot(n),p=1.5+(t.x+t.y*p)*p,f=u<i?0:1;r[3*u]=n.x/p*1.5-.5+f,r[3*u+1]=n.y/p*3,h[2*u]=.5*(h[2*u]+f)}e.attributes.position.array=r,e.attributes.uv.array=h,t=new q.MeshBasicMaterial({map:l.texture}),e=new q.Mesh(e,t),s.add(e),this.setEyeSeparation=function(t){c.eyeSep=t},this.setSize=function(t,e){o.setSize(t,e);var i=o.getPixelRatio();l.setSize(t*i,e*i)},this.render=function(t,e,i){var n=i instanceof v||i instanceof y;t.updateMatrixWorld(),n&&this.setEyeSeparation(i.stereo.eyeSep),null===e.parent&&e.updateMatrixWorld(),c.update(e),e=l.width/2;var r=l.height;o.autoClear&&o.clear(),n&&i.updateTextureToLeft(),l.scissor.set(0,0,e,r),l.viewport.set(0,0,e,r),o.setRenderTarget(l),o.render(t,c.cameraL),o.clearDepth(),n&&i.updateTextureToRight(),l.scissor.set(e,0,e,r),l.viewport.set(e,0,e,r),o.setRenderTarget(l),o.render(t,c.cameraR),o.clearDepth(),o.setRenderTarget(null),o.render(s,a)}}function E(t){t=void 0===t?{}:t,t=(u=this.options=Object.assign({container:this.setupContainer(t.container),controlBar:!0,controlButtons:["fullscreen","setting","video"],autoHideControlBar:!1,autoHideInfospot:!0,horizontalView:!1,clickTolerance:10,cameraFov:60,reverseDragging:!1,enableReticle:!1,dwellTime:1500,autoReticleSelect:!0,viewIndicator:!1,indicatorSize:30,output:null,autoRotate:!1,autoRotateSpeed:2,autoRotateActivationDuration:5e3,initialLookAt:new q.Vector3(0,0,-Number.MAX_SAFE_INTEGER)},t)).container;var e=u.cameraFov,i=u.controlBar,n=u.controlButtons,r=u.viewIndicator,o=u.indicatorSize,a=u.enableReticle,s=u.reverseDragging,c=u.output,l=u.scene,h=u.camera,u=u.renderer,d=t.clientWidth,p=t.clientHeight;this.container=t,this.scene=this.setupScene(l),this.sceneReticle=new q.Scene,this.camera=this.setupCamera(e,d/p,h),this.renderer=this.setupRenderer(u,t),this.reticle=this.addReticle(this.camera,this.sceneReticle),this.control=this.setupControls(this.camera,t),this.effect=this.setupEffects(this.renderer,t),this.mode=S.NORMAL,this.pressObject=this.pressEntityObject=this.infospot=this.hoverObject=this.widget=this.panorama=null,this.raycaster=new q.Raycaster,this.raycasterPoint=new q.Vector2,this.userMouse=new q.Vector2,this.updateCallbacks=[],this.requestAnimationId=null,this.cameraFrustum=new q.Frustum,this.cameraViewProjectionMatrix=new q.Matrix4,this.outputDivElement=this.autoRotateRequestId=null,this.touchSupported="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,this.tweenLeftAnimation=new I.Tween,this.tweenUpAnimation=new I.Tween,this.outputEnabled=!1,this.viewIndicatorSize=o,this.tempEnableReticle=a,this.handlerMouseUp=this.onMouseUp.bind(this),this.handlerMouseDown=this.onMouseDown.bind(this),this.handlerMouseMove=this.onMouseMove.bind(this),this.handlerWindowResize=this.onWindowResize.bind(this),this.handlerKeyDown=this.onKeyDown.bind(this),this.handlerKeyUp=this.onKeyUp.bind(this),this.handlerTap=this.onTap.bind(this,{clientX:d/2,clientY:p/2}),i&&this.addDefaultControlBar(n),r&&this.addViewIndicator(),s&&this.reverseDraggingDirection(),a?this.enableReticleControl():this.registerMouseAndTouchEvents(),"overlay"===c&&this.addOutputElement(),this.registerEventListeners(),this.animate.call(this)}var M="^0.105.2".replace(/[^0-9.]/g,""),_={ORBIT:0,DEVICEORIENTATION:1},S={UNKNOWN:0,NORMAL:1,CARDBOARD:2,STEREO:3},A={TAB:0,SBS:1},T={Info:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABAAAAAQADq8/hgAAADBklEQVR42u2bP08UQRiHnzFaSYCI/xoksdBIqGwIiYWRUBISExpCQ0ej38FWOmlIKKhoMPEbaCxsrrHiYrQgOSlQEaICrT+LHSPZzNzt3s3c3Hn7lHvLzvv82L2dm30XKioqKgYY062BJF0HpoA7wARwBbhsPz4DjoEG8AnYNcZ8Sx1Op8IXJM1KWpdUV3nq9m9nJV1I7VNGfEzSM0mNNqR9NOwxx1L7NRMflbQm6SSgeJ4TO8Zoat+8/LKkg4jieQ4kLaf2RtKwpJ0uiufZkTScSn5S0l5C+b/sSZrstvyMpKPU5uc4kjTTjkvpeYCkaeA1/+7hvcIZMGuMqUULQNIU8Aa4ltrWwyHwyBizGzwASSPAe+B2assW7AH3jTE/i+xcZoa12Qfy2Bo3i+5cKABl99zF1GYlWFTBeULLS0DZrOsDcDNggTXgc27bLWA64BhfgHvGmB8dHUXZ1DM0S45xliKMs9bKr+klIOkqsBrwv9JtVq1DewEAT4Ch1BYdMGQdygeg7Df4SmqDAKyoyXpCszPgITCeuvoAjFuX0gE8jljUdv7bCtiOOJ7XpdUZ8L/gdXHOA5QtYH5NXXVgbrgWWn1nwFTqaiPgdPIFcDd1tRFwOl307DwRuZgXwLvctgfA04hjOp18AcReZ6sZY16e3yDpUuQxnU6+S2AkcjEpcDr1zxOXSPgCKLSa0mc4nXwB/EpdbQScTr4AGqmrjYDTyRfAx9TVRsDp5Aug8LJyH+F0cgZg58z11BUHpO5ruGh2G3ybuuqAeF2aBfAqddUB8bq0OgP2U1cegH3aOQOMMb+BrdTVB2DLupQLwLIOnKY26IBT6+ClaQDGmO/ARmqLDtiwDn7HVkcY+EdjNoTlCI+tYhO2iUppm6HKslPUq2qQKHpUe8AFsjaUXuUQWCgqXyoAG8IuME/WkNRrnAHzZfqDSgdgQ6gBc2Td3b3CMTBXtkOsIzTIjZLnQhjcVtlcEIPZLJ0LoVvt8s/Va+3yuSAG84UJRxB98cpM9dJURUVFxSDzBxKde4Lk3/h2AAAAAElFTkSuQmCC",Arrow:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABAAAAAQADq8/hgAAADPklEQVR42u2bMUscQRiG30/SRaJEI1ZKUiRErNIELRUbQYSAnX8hpVUgkDYp0wgWVjYW+QcJaQzYpLojJIXhtDDEKBpj65ti58ixmdmb2ZvZ7+T2AUHudmfmeXf2bnb3O6CmpqZmgJGqOiI5AWAWwEMA0wDuArht3r4CcAagBeAbgIaI/NQOp1fhIZKLJN+SbDKcptl3keSQtk+I+BjJVyRbJaRdtEybY9p+ReKjJN+QvIwonufS9DGq7ZuXXyd5nFA8zzHJdW1vkLxDcrdC8Ty7JO9oyc+QPFCUb3NAcqZq+TmSp9rmHZySnCvjErwOIPkUwHv8+w7vF64ALIrIfrIASM4C+ADgnratgxMACyLSiB4AyREAnwE80LbswgGAJyJy4bNxyApr6wbIw4xxy3djrwCYfeeuaZsFsEbPdULXU4DZqusLgMkEA21P05EEbf8A8FhEzos28pkBLxLKL5s/r/M1kEkz9vKQHGeatf05yfmOfubNa7G5JDle5NhtBjwHMBz5yFwAWBaRT+0XzP8pZsKwcQiH2fX8Ycojb+kzxUw4ZJn7CSQXqpRPHMKCq7+iZJ71Mvdy/DftXSQ6HcJdSDaqPPKW/mPOBO+lcbvzCU35RCFM2PpwnQKzZQfdgfe0dxH5dLA6uQJ4pC2fIASrkyuA6X6QjxyC1ckVQNn7bNHlI4ZgdXIFUObiJJl8pBCsTjGfuIwA2Cv4FN7xbYjkjqsRAHuIePXoCiDF1Zk2VidXAL+1R5sAq5MrgJb2aBNgdXIF8FV7tAmwOrkCCFs73wysTtYATHFCU3vEEWm6Ci6KvgY/ao86Ik6XogDeaY86Ik6XbjPgSHvkEThCwQy45XpDRK5JbgN4GWkgUyR9H65MRQxgW0SunZ5FezK7pfwd8e8MV8UfAPdF5Jdrg8JrAbPjprZFD2wWyQP6j8ZSEufRmGlgQ9umBBvd5IOgbjFUKLu+XnWBhG+rpsFVZGUo/coJgFVf+aAATAgNACvICpL6jSsAKyH1QcEBmBD2ASwhq+7uF84ALIVWiPUEB7lQsiOEwS2VzQUxmMXSuRCqKpd/zX4rl88FMZg/mLAEcSN+MlP/aKqmpqZmkPkL0hSjwOpNKxwAAAAASUVORK5CYII=",FullscreenEnter:"data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4KICAgIDxwYXRoIGQ9Ik03IDE0SDV2NWg1di0ySDd2LTN6bS0yLTRoMlY3aDNWNUg1djV6bTEyIDdoLTN2Mmg1di01aC0ydjN6TTE0IDV2MmgzdjNoMlY1aC01eiIvPgo8L3N2Zz4=",FullscreenLeave:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggc3R5bGU9ImZpbGw6I2ZmZiIgZD0iTTE0LDE0SDE5VjE2SDE2VjE5SDE0VjE0TTUsMTRIMTBWMTlIOFYxNkg1VjE0TTgsNUgxMFYxMEg1VjhIOFY1TTE5LDhWMTBIMTRWNUgxNlY4SDE5WiIgLz48L3N2Zz4=",VideoPlay:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggc3R5bGU9ImZpbGw6I2ZmZiIgZD0iTTgsNS4xNFYxOS4xNEwxOSwxMi4xNEw4LDUuMTRaIiAvPjwvc3ZnPg==",VideoPause:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggc3R5bGU9ImZpbGw6I2ZmZiIgZD0iTTE0LDE5LjE0SDE4VjUuMTRIMTRNNiwxOS4xNEgxMFY1LjE0SDZWMTkuMTRaIiAvPjwvc3ZnPg==",WhiteTile:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIABAMAAAAGVsnJAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB1WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOkNvbXByZXNzaW9uPjE8L3RpZmY6Q29tcHJlc3Npb24+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOlBob3RvbWV0cmljSW50ZXJwcmV0YXRpb24+MjwvdGlmZjpQaG90b21ldHJpY0ludGVycHJldGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KAtiABQAAACRQTFRFAAAAAAAABgYGBwcHHh4eKysrx8fHy8vLzMzM7OzsAAAABgYG+q7SZgAAAAp0Uk5TAP7+/v7+/v7+/iJx/a8AAAOwSURBVHja7d0hbsNAEAVQo6SFI6XEcALDcgNLvUBvEBQVhpkWVYWlhSsVFS7t5QIshRt695lEASZP+8c7a1kzDL1fz+/zyuvzp6FbvoddrL6uDd1yGZ5eXldeb18N3fIx7A+58prmhm65DfvDcd0952lu6JabFbD/zVprZj1lzcys+fj9z8xTZtbT8rv8yWlu6BYAIgAAAAAAAAAAAABAM6QXEAEAAAAAAAAAgJ2gnaAIiIA3Q2qAGgAAAAAAAAAAAAAAAAAAAAAAAAAAQJsADkVFAAAAAAA8Bj0GRUAEREAEREAEREAEREAEAAAAAAAAAAB2gnaCIiACPplRA9QANUAERAAAAEVQERQBERCBVlfAcZ3aeZobusUKMGBhV6KUElHGKBERJR6/fxExRkQZl9/lT8S1oVsuhqyYMmPKjCkzvfcCpsxohrwY0Q06EAEAAAAAAAAAAACgGdILiAAAAAAAAAAAwE7QTlAERMCbITVADQAAAAAAAAAAAAAAAAAAAAAAAAAAwKmwQ1ERAAAAAACPQY9BERABERABERABERABERABAAAAAAAAAICdoJ2gCIiAT2bUADVADRABEQAAQBFUBEVABERgEyvAlJm+V4ApM6bMmDJjyowpM6bMdN0LmDKjGfJiRDfoQAQAAAAAAAAAAACAZkgvIAIAAAAAAAAAADtBO0EREAFvhtQANQAAAAAAAAAAAAAAAAAAAAAAAAAAAKfCDkVFAAAAAAA8Bj0GRUAEREAEREAEREAEREAEAAAAAAAAAAB2gnaCIiACPplRA9QANUAERAAAAEVQERQBERCBTawAU2b6XgGmzJgyY8qMKTOmzJgy03UvYMqMZsiLEd2gAxEAAAAAAAAAAAAAmiG9gAgAAAAAAAAAAOwE7QRFQAS8GVID1AAAAAAAAAAAAAAAAAAAAAAAAAAAAJwKOxQVAQAAAADwGPQYFAEREAEREAEREAEREAERAAAAAAAAAADYCdoJioAI+GRGDVAD1AAREAEAABRBRVAEREAENrECTJnpewWYMmPKjCkzpsyYMmPKTNe9gCkzmiEvRnSDDkQAAAAAAAAAAAAAaIb0AiIAAAAAAAAAALATtBMUARHwZkgNUAMAAAAAAAAAAAAAAAAAAAAAAAAAAHAq7FBUBAAAAADAY9BjUAREQAREQAREQAREQAREAAAAAAAAAABgJ2gnKAIi4JMZNUANUANEQAQAAFAEFUEREAER2MQKMGWm7xVgyowpM50PWen9ugNGXz1XaocAFgAAAABJRU5ErkJggg==",Setting:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABAAAAAQADq8/hgAAADn0lEQVR42u2bzUsVURjGnyO6CPzAMnTjppAo3LTwH1CqTfaxbeOiRS37A0wXtROFVi1aRBs3LWohSIGbQAQXViBGRhG0UIRKUCpK7q/FnOB2uc6cOXNmRnGe3eW+H8/7zLln3vNxpQoVKlQ4wjBFJAFOSRqX1O7osivpvjHmU1nChBZglvSYLYJbS0EanCvIJzWK+gnsyH34/8OuMaYjb265jwCgz6N4SWq3vodbAEmnS/KtBDgoAgyU5BteAOAkMAPcBroc7PskDWfgN+wyDwBdltMMcDI3tYBnde/pHeARMNTErgd4APzweP834oeN1dMkz5DlsFNn/yyv4kdiSK4At4AO4CqwGaDwRmza2B0210qM7YhrXU59ANAq6bWkwQTTn5KO5fIE0uVYlXTeGLOXFMx1DrjlULwKKN41x6DlnIjEEQCckPRe0okCiguJr5LOGGO+xhm5jICJQ1i8LOeJJKPYEQAMKvrtt5ZdjSf2FM0Fq/sZJI2A6UNcvCz36TiDfUcAcE1SPu/U6Mm8k/TFfu6XdFb5iX3dGPM8lQfwNod3+TowBnQ3yddtv1vPIe+b1JIBiwEJ1IAJ208k5W21trWA+V/5CHAcmAtU/A2P/DcCiTAHHE8tgCVhgLvAXgYCk17Jo/yTGfLuWe7Zd72AC8CWB4n3OAz7mLytNkZabAEXMhfeQKYfWEpJZCxA3rGUOZeA/qDF15FpAz47EvlNk9neI2e3jeWCz0BbmvipNkSMMX8kuSZYM8Z8zyqAjbHmaN5mOeYjgIXrU93MWrxHrNQjrqiDkQMLHwG+OdqF3NN3jeXKzU8AoF1SzdH8XKhJUO7HZDXLMbwAwICkJUULFxe0SbqSVQAbw3Xi7Ze0ZLmGAzAKbHs0JGU1QtvAaIjCW4B7ZOvJy2qFa5a730RPtBiaz0CgnkiZi6F5fBZDVMvho7EhcuS3xJJ2hV9IupgTqaLw0hhzab8vq23xOG/r+LDsKjLgYVzxUnU0ltwK2wDezUyJmEwqXgp/PL4rvxthaeCSI+zxuA10J8ZkWdJNSb2SLkvayKHwDRu71+ZajrG941J8agALDQ3GU/a/IvMkYCPzmCbtLNEVmacNtgs5iP9fYVNEV1Q6Hez7yNZSL+J2SarTcpqiyV2iUkG0IvPFvbz5FbEn+KEk3wMjwMeSfCsBXFBdly9CAPk9ydyffpECuB5tZfVJjaKWueOSfinln6YK4lahQoUKRxd/AcRPGTcQCAUQAAAAAElFTkSuQmCC",ChevronRight:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTguNTksMTYuNThMMTMuMTcsMTJMOC41OSw3LjQxTDEwLDZMMTYsMTJMMTAsMThMOC41OSwxNi41OFoiIC8+PC9zdmc+",Check:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTIxLDdMOSwxOUwzLjUsMTMuNUw0LjkxLDEyLjA5TDksMTYuMTdMMTkuNTksNS41OUwyMSw3WiIgLz48L3N2Zz4=",ViewIndicator:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBpZD0idmlldy1pbmRpY2F0b3IiIGhlaWdodD0iMzAiIHdpZHRoPSIzMCIgdmlld0JveD0iLTIuNSAtMSAzMCAzMCI+Cgk8c3R5bGUgdHlwZT0idGV4dC9jc3MiPi5zdDB7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLW1pdGVybGltaXQ6MTA7ZmlsbDpub25lO30uc3Qxe3N0cm9rZS13aWR0aDo2O3N0cm9rZS1taXRlcmxpbWl0OjEwO30KCTwvc3R5bGU+Cgk8Zz4KCQk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNIDEyLjUgMCBBIDEyLjUgMTIuNSAwIDAgMCAtMTIuNSAwIEEgMTIuNSAxMi41IDAgMCAwIDEyLjUgMCIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxMywxNS41KSI+PC9wYXRoPgoJCTxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik0gMTMgMCBMIDEwIDIgTCAxNiAyIFoiPjwvcGF0aD4KCQk8cGF0aCBjbGFzcz0ic3QyIiBkPSJNIDIgMCBBIDIgMiAwIDAgMCAtMiAwIEEgMiAyIDAgMCAwIDIgMCIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxMywxNS41KSI+PC9wYXRoPgoJCTxwYXRoIGNsYXNzPSJzdDEiIGlkPSJpbmRpY2F0b3IiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMTMsMTUuNSkiPjwvcGF0aD4KCTwvZz4KPC9zdmc+"},C={load:function(t,e,n,i){var r,o,a,s;for(s in e=void 0===e?function(){}:e,n=void 0===n?function(){}:n,i=void 0===i?function(){}:i,q.Cache.enabled=!0,T)T.hasOwnProperty(s)&&t===T[s]&&(r=s);var c=q.Cache.get(r||t);if(void 0!==c)return e&&setTimeout(function(){n({loaded:1,total:1}),e(c)},0),c;var l=window.URL||window.webkitURL,h=document.createElementNS("http://www.w3.org/1999/xhtml","img");q.Cache.add(r||t,h);function u(){l.revokeObjectURL(h.src),e(h)}if(0===t.indexOf("data:"))return h.addEventListener("load",u,!1),h.src=t,h;h.crossOrigin=void 0!==this.crossOrigin?this.crossOrigin:"",(r=new window.XMLHttpRequest).open("GET",t,!0),r.responseType="arraybuffer",r.addEventListener("error",i),r.addEventListener("progress",function(t){var e,i;t&&(e=t.loaded,i=t.total,t.lengthComputable&&n({loaded:e,total:i}))}),r.addEventListener("loadend",function(t){t&&(o=new Uint8Array(t.currentTarget.response),a=new window.Blob([o]),h.addEventListener("load",u,!1),h.src=l.createObjectURL(a))}),r.send(null)}},L={load:function(e,i,t,n){i=void 0===i?function(){}:i;var r=new q.Texture;return C.load(e,function(t){r.image=t,t=0<e.search(/\.(jpg|jpeg)$/)||0===e.search(/^data:image\/jpeg/),r.format=t?q.RGBFormat:q.RGBAFormat,r.needsUpdate=!0,i(r)},t,n),r}},P={load:function(t,e,n,r){var o;e=void 0===e?function(){}:e,n=void 0===n?function(){}:n;var a=new q.CubeTexture([]),s=0,c={},l={};return t.map(function(t,i){C.load(t,function(t){a.images[i]=t,6===++s&&(a.needsUpdate=!0,e(a))},function(t){for(var e in c[i]={loaded:t.loaded,total:t.total},l.loaded=0,o=l.total=0,c)o++,l.loaded+=c[e].loaded,l.total+=c[e].total;o<6&&(l.total=l.total/o*6),n(l)},r)}),a}};e.prototype=Object.assign(Object.create(q.EventDispatcher.prototype),{setContainer:function(t){this.container=t},setScene:function(t){this.scene=t},enumerateDevices:function(){var e=this.devices,t=new Promise(function(t){t(e)});return 0<e.length?t:window.navigator.mediaDevices.enumerateDevices()},switchNextVideoDevice:function(){var e=this.stop.bind(this),i=this.start.bind(this),n=this.setVideDeviceIndex.bind(this),r=this.videoDeviceIndex;this.getDevices("video").then(function(t){e(),++r>=t.length?(n(0),r--):n(r),i(t[r])})},getDevices:function(i){i=void 0===i?"video":i;var e=this.devices;return this.enumerateDevices().then(function(t){return t.map(function(t){return e.includes(t)||e.push(t),t})}).then(function(t){var e=new RegExp(i,"i");return t.filter(function(t){return e.test(t.kind)})})},getUserMedia:function(t){var e=this.setMediaStream.bind(this),i=this.playVideo.bind(this);return window.navigator.mediaDevices.getUserMedia(t).then(e).then(i).catch(function(t){console.warn("PANOLENS.Media: "+t)})},setVideDeviceIndex:function(t){this.videoDeviceIndex=t},start:function(e){var i=this.constraints,n=this.getUserMedia.bind(this);return this.element=this.createVideoElement(),this.getDevices().then(function(t){if(!t||0===t.length)throw Error("no video device found");return i.video.deviceId=(e||t[0]).deviceId,n(i)})},stop:function(){var t=this.stream;t&&t.active&&(t.getTracks()[0].stop(),window.removeEventListener("resize",this.onWindowResize.bind(this)),this.stream=this.element=null)},setMediaStream:function(t){this.stream=t,this.element.srcObject=t,this.scene&&(this.scene.background=this.createVideoTexture()),window.addEventListener("resize",this.onWindowResize.bind(this))},playVideo:function(){var t=this.element;t&&(t.play(),this.dispatchEvent({type:"play"}))},pauseVideo:function(){var t=this.element;t&&(t.pause(),this.dispatchEvent({type:"pause"}))},createVideoTexture:function(){var t=this.element,e=new q.VideoTexture(t);return e.generateMipmaps=!1,e.minFilter=q.LinearFilter,e.magFilter=q.LinearFilter,e.format=q.RGBFormat,e.center.set(.5,.5),t.addEventListener("canplay",this.onWindowResize.bind(this)),e},createVideoElement:function(){var t=this.dispatchEvent.bind(this),e=document.createElement("video");return e.setAttribute("autoplay",""),e.setAttribute("muted",""),e.setAttribute("playsinline",""),e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.objectPosition="center",e.style.objectFit="cover",e.style.display=this.scene?"none":"",e.addEventListener("canplay",function(){return t({type:"canplay"})}),e},onWindowResize:function(){var t,e,i,n;this.element&&this.element.videoWidth&&this.element.videoHeight&&this.scene&&(t=(e=this.container).clientWidth,e=e.clientHeight,i=this.scene.background,n=(n=this.element).videoHeight/n.videoWidth*(this.container?t/e:1)*this.ratioScalar,e<t?i.repeat.set(n,1):i.repeat.set(1,1/n))}}),Object.assign(n.prototype,{constructor:n,updateUniformByFormat:function(t,e){this.format=t;var i=e.repeat.value;e=e.offset.value;var n=this.loffset,r=this.roffset;switch(t){case A.TAB:i.set(1,.5),e.set(0,.5),n.set(0,.5),r.set(0,0);break;case A.SBS:i.set(.5,1),e.set(0,0),n.set(0,0),r.set(.5,0)}},updateTextureToLeft:function(t){t.copy(this.loffset)},updateTextureToRight:function(t){t.copy(this.roffset)}}),r.prototype=Object.assign(Object.create(q.Sprite.prototype),{constructor:r,setColor:function(t){this.material.color.copy(t instanceof q.Color?t:new q.Color(t))},createCanvasTexture:function(t){return(t=new q.CanvasTexture(t)).minFilter=q.LinearFilter,t.magFilter=q.LinearFilter,t.generateMipmaps=!1,t},createCanvas:function(){var t=document.createElement("canvas"),e=t.getContext("2d"),i=this.dpr;return t.width=32*i,t.height=32*i,e.scale(i,i),e.shadowBlur=5,e.shadowColor="rgba(200,200,200,0.9)",{canvas:t,context:e}},updateCanvasArcByProgress:function(t){var e=this.context,i=this.canvasWidth,n=this.canvasHeight,r=this.material,o=this.dpr,a=t*Math.PI*2,s=this.color.getStyle(),c=.5*i/o,o=.5*n/o;e.clearRect(0,0,i,n),e.beginPath(),0===t?(e.arc(c,o,i/16,0,2*Math.PI),e.fillStyle=s,e.fill()):(e.arc(c,o,i/4-3,-Math.PI/2,-Math.PI/2+a),e.strokeStyle=s,e.lineWidth=3,e.stroke()),e.closePath(),r.map.needsUpdate=!0},ripple:function(){var r=this,o=this.context,a=this.canvasWidth,s=this.canvasHeight,c=this.material,l=this.rippleDuration,h=performance.now(),u=this.color,d=this.dpr,p=.5*a/d,f=.5*s/d,m=function(){var t=window.requestAnimationFrame(m),e=(performance.now()-h)/l,i=0<1-e?1-e:0,n=e*a*.5/d;o.clearRect(0,0,a,s),o.beginPath(),o.arc(p,f,n,0,2*Math.PI),o.fillStyle="rgba("+255*u.r+", "+255*u.g+", "+255*u.b+", "+i+")",o.fill(),o.closePath(),1<=e&&(window.cancelAnimationFrame(t),r.updateCanvasArcByProgress(0),r.dispatchEvent({type:"reticle-ripple-end"})),c.map.needsUpdate=!0};this.dispatchEvent({type:"reticle-ripple-start"}),m()},show:function(){this.visible=!0},hide:function(){this.visible=!1},start:function(t){this.autoSelect&&(this.dispatchEvent({type:"reticle-start"}),this.startTimestamp=performance.now(),this.callback=t,this.update())},end:function(){this.startTimestamp&&(window.cancelAnimationFrame(this.timerId),this.updateCanvasArcByProgress(0),this.startTimestamp=this.timerId=this.callback=null,this.dispatchEvent({type:"reticle-end"}))},update:function(){this.timerId=window.requestAnimationFrame(this.update.bind(this));var t=(performance.now()-this.startTimestamp)/this.dwellTime;this.updateCanvasArcByProgress(t),this.dispatchEvent({type:"reticle-update",progress:t}),1<=t&&(window.cancelAnimationFrame(this.timerId),this.callback&&this.callback(),this.end(),this.ripple())}});var R,I=(function(t,e){(e=function(){this._tweens={};this._tweensAddedDuringUpdate={}}).prototype={getAll:function(){return Object.keys(this._tweens).map(function(t){return this._tweens[t]}.bind(this))},removeAll:function(){this._tweens={}},add:function(t){this._tweens[t.getId()]=t;this._tweensAddedDuringUpdate[t.getId()]=t},remove:function(t){delete this._tweens[t.getId()];delete this._tweensAddedDuringUpdate[t.getId()]},update:function(t,e){var i=Object.keys(this._tweens);if(0===i.length)return!1;for(t=void 0!==t?t:s.now();0<i.length;){this._tweensAddedDuringUpdate={};for(var n=0;n<i.length;n++){var r=this._tweens[i[n]];r&&!1===r.update(t)&&(r._isPlaying=!1,e||delete this._tweens[i[n]])}i=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var s=new e;s.Group=e,s._nextId=0,s.nextId=function(){return s._nextId++},s.now="undefined"===typeof self&&"undefined"!==typeof process&&process.hrtime?function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!==typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()},s.Tween=function(t,e){this._object=t;this._valuesStart={};this._valuesEnd={};this._valuesStartRepeat={};this._duration=1e3;this._repeat=0;this._repeatDelayTime=void 0;this._reversed=this._isPlaying=this._yoyo=!1;this._delayTime=0;this._startTime=null;this._easingFunction=s.Easing.Linear.None;this._interpolationFunction=s.Interpolation.Linear;this._chainedTweens=[];this._onStartCallback=null;this._onStartCallbackFired=!1;this._onStopCallback=this._onCompleteCallback=this._onRepeatCallback=this._onUpdateCallback=null;this._group=e||s;this._id=s.nextId()},s.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(t,e){this._valuesEnd=Object.create(t);void 0!==e&&(this._duration=e);return this},duration:function(t){this._duration=t;return this},start:function(t){this._group.add(this);this._isPlaying=!0;this._onStartCallbackFired=!1;this._startTime=void 0!==t?"string"===typeof t?s.now()+parseFloat(t):t:s.now();this._startTime+=this._delayTime;for(var e in this._valuesEnd){if(this._valuesEnd[e]instanceof Array){if(0===this._valuesEnd[e].length)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}void 0!==this._object[e]&&(this._valuesStart[e]=this._object[e],!1===this._valuesStart[e]instanceof Array&&(this._valuesStart[e]*=1),this._valuesStartRepeat[e]=this._valuesStart[e]||0)}return this},stop:function(){if(!this._isPlaying)return this;this._group.remove(this);this._isPlaying=!1;null!==this._onStopCallback&&this._onStopCallback(this._object);this.stopChainedTweens();return this},end:function(){this.update(Infinity);return this},stopChainedTweens:function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop()},group:function(t){this._group=t;return this},delay:function(t){this._delayTime=t;return this},repeat:function(t){this._repeat=t;return this},repeatDelay:function(t){this._repeatDelayTime=t;return this},yoyo:function(t){this._yoyo=t;return this},easing:function(t){this._easingFunction=t;return this},interpolation:function(t){this._interpolationFunction=t;return this},chain:function(){this._chainedTweens=arguments;return this},onStart:function(t){this._onStartCallback=t;return this},onUpdate:function(t){this._onUpdateCallback=t;return this},onRepeat:function(t){this._onRepeatCallback=t;return this},onComplete:function(t){this._onCompleteCallback=t;return this},onStop:function(t){this._onStopCallback=t;return this},update:function(t){var e;if(t<this._startTime)return!0;!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0);var i=(t-this._startTime)/this._duration;i=0===this._duration||1<i?1:i;var n=this._easingFunction(i);for(e in this._valuesEnd)if(void 0!==this._valuesStart[e]){var r=this._valuesStart[e]||0,o=this._valuesEnd[e];o instanceof Array?this._object[e]=this._interpolationFunction(o,n):("string"===typeof o&&(o="+"===o.charAt(0)||"-"===o.charAt(0)?r+parseFloat(o):parseFloat(o)),"number"===typeof o&&(this._object[e]=r+(o-r)*n))}null!==this._onUpdateCallback&&this._onUpdateCallback(this._object,i);if(1===i)if(0<this._repeat){isFinite(this._repeat)&&this._repeat--;for(e in this._valuesStartRepeat)"string"===typeof this._valuesEnd[e]&&(this._valuesStartRepeat[e]+=parseFloat(this._valuesEnd[e])),this._yoyo&&(i=this._valuesStartRepeat[e],this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=i),this._valuesStart[e]=this._valuesStartRepeat[e];this._yoyo&&(this._reversed=!this._reversed);this._startTime=void 0!==this._repeatDelayTime?t+this._repeatDelayTime:t+this._delayTime;null!==this._onRepeatCallback&&this._onRepeatCallback(this._object)}else{null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);t=0;for(e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].start(this._startTime+this._duration);return!1}return!0}},s.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return 1>(t*=2)?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return 1>(t*=2)?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return 1>(t*=2)?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return 1>(t*=2)?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:1>(t*=2)?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return 1>(t*=2)?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){if(0===t)return 0;if(1===t)return 1;t*=2;return 1>t?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){return t*t*(2.70158*t-1.70158)},Out:function(t){return--t*t*(2.70158*t+1.70158)+1},InOut:function(t){return 1>(t*=2)?.5*t*t*(3.5949095*t-2.5949095):.5*((t-=2)*t*(3.5949095*t+2.5949095)+2)}},Bounce:{In:function(t){return 1-s.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return.5>t?.5*s.Easing.Bounce.In(2*t):.5*s.Easing.Bounce.Out(2*t-1)+.5}}},s.Interpolation={Linear:function(t,e){var i=t.length-1,n=i*e,r=Math.floor(n),o=s.Interpolation.Utils.Linear;return 0>e?o(t[0],t[1],n):1<e?o(t[i],t[i-1],i-n):o(t[r],t[r+1>i?i:r+1],n-r)},Bezier:function(t,e){for(var i=0,n=t.length-1,r=Math.pow,o=s.Interpolation.Utils.Bernstein,a=0;a<=n;a++)i+=r(1-e,n-a)*r(e,a)*t[a]*o(n,a);return i},CatmullRom:function(t,e){var i=t.length-1,n=i*e,r=Math.floor(n),o=s.Interpolation.Utils.CatmullRom;return t[0]===t[i]?(0>e&&(r=Math.floor(n=i*(1+e))),o(t[(r-1+i)%i],t[r],t[(r+1)%i],t[(r+2)%i],n-r)):0>e?t[0]-(o(t[0],t[0],t[1],t[1],-n)-t[0]):1<e?t[i]-(o(t[i],t[i],t[i-1],t[i-1],n-i)-t[i]):o(t[r?r-1:0],t[r],t[i<r+1?i:r+1],t[i<r+2?i:r+2],n-r)},Utils:{Linear:function(t,e,i){return(e-t)*i+t},Bernstein:function(t,e){var i=s.Interpolation.Utils.Factorial;return i(t)/i(e)/i(t-e)},Factorial:function(){var n=[1];return function(t){var e=1;if(n[t])return n[t];for(var i=t;1<i;i--)e*=i;return n[t]=e}}(),CatmullRom:function(t,e,i,n,r){t=.5*(i-t);n=.5*(n-e);var o=r*r;return(2*e-2*i+t+n)*r*o+(-3*e+3*i-2*t-n)*o+t*r+e}}},t.exports=s}(R={exports:{}},R.exports),R.exports);a.prototype=Object.assign(Object.create(q.Sprite.prototype),{constructor:a,setContainer:function(t){var e;t instanceof HTMLElement?e=t:t&&t.container&&(e=t.container),e&&this.element&&e.appendChild(this.element),this.container=e},getContainer:function(){return this.container},onClick:function(t){this.element&&this.getContainer()&&(this.onHoverStart(t),this.lockHoverElement())},onDismiss:function(){this.element&&(this.unlockHoverElement(),this.onHoverEnd())},onHover:function(){},onHoverStart:function(t){var e,i,n,r;this.getContainer()&&(e=this.cursorStyle||(this.mode===S.NORMAL?"pointer":"default"),i=this.scaleDownAnimation,n=this.scaleUpAnimation,r=this.element,this.isHovering=!0,this.container.style.cursor=e,this.animated&&(i.stop(),n.start()),r&&0<=t.mouseEvent.clientX&&0<=t.mouseEvent.clientY&&(t=r.left,e=r.right,i=r.style,this.mode===S.CARDBOARD||this.mode===S.STEREO?(i.display="none",t.style.display="block",e.style.display="block",r._width=t.clientWidth,r._height=t.clientHeight):(i.display="block",t&&(t.style.display="none"),e&&(e.style.display="none"),r._width=r.clientWidth,r._height=r.clientHeight)))},onHoverEnd:function(){var t,e,i;this.getContainer()&&(t=this.scaleDownAnimation,e=this.scaleUpAnimation,i=this.element,this.isHovering=!1,this.container.style.cursor="default",this.animated&&(e.stop(),t.start()),i&&!this.element.locked&&(t=i.left,e=i.right,i.style.display="none",t&&(t.style.display="none"),e&&(e.style.display="none"),this.unlockHoverElement()))},onDualEyeEffect:function(t){var e,i;this.getContainer()&&(this.mode=t.mode,t=this.element,e=this.container.clientWidth/2,i=this.container.clientHeight/2,t&&(t.left||t.right||(t.left=t.cloneNode(!0),t.right=t.cloneNode(!0)),this.mode===S.CARDBOARD||this.mode===S.STEREO?(t.left.style.display=t.style.display,t.right.style.display=t.style.display,t.style.display="none"):(t.style.display=t.left.style.display,t.left.style.display="none",t.right.style.display="none"),this.translateElement(e,i),this.container.appendChild(t.left),this.container.appendChild(t.right)))},translateElement:function(t,e){var i,n,r,o,a,s,c;this.element._width&&this.element._height&&this.getContainer()&&(i=this.container,s=t-(r=(n=this.element)._width/2),c=e-(o=n._height/2)-(a=void 0!==n.verticalDelta?n.verticalDelta:40),this.mode!==S.CARDBOARD&&this.mode!==S.STEREO||!n.left||!n.right||t===i.clientWidth/2&&e===i.clientHeight/2?this.setElementStyle("transform",n,"translate("+s+"px, "+c+"px)"):(s=i.clientWidth/4-r+(t-i.clientWidth/2),c=i.clientHeight/2-o-a+(e-i.clientHeight/2),this.setElementStyle("transform",n.left,"translate("+s+"px, "+c+"px)"),s+=i.clientWidth/2,this.setElementStyle("transform",n.right,"translate("+s+"px, "+c+"px)")))},setElementStyle:function(t,e,i){e=e.style,"transform"===t&&(e.webkitTransform=e.msTransform=e.transform=i)},setText:function(t){this.element&&(this.element.textContent=t)},setCursorHoverStyle:function(t){this.cursorStyle=t},addHoverText:function(t,e){e=void 0===e?40:e,this.element||(this.element=document.createElement("div"),this.element.style.display="none",this.element.style.color="#fff",this.element.style.top=0,this.element.style.maxWidth="50%",this.element.style.maxHeight="50%",this.element.style.textShadow="0 0 3px #000000",this.element.style.fontFamily='"Trebuchet MS", Helvetica, sans-serif',this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=e),this.setText(t)},addHoverElement:function(t,e){e=void 0===e?40:e,this.element||(this.element=t.cloneNode(!0),this.element.style.display="none",this.element.style.top=0,this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=e)},removeHoverElement:function(){this.element&&(this.element.left&&(this.container.removeChild(this.element.left),this.element.left=null),this.element.right&&(this.container.removeChild(this.element.right),this.element.right=null),this.container.removeChild(this.element),this.element=null)},lockHoverElement:function(){this.element&&(this.element.locked=!0)},unlockHoverElement:function(){this.element&&(this.element.locked=!1)},enableRaycast:function(t){this.raycast=void 0===t||t?this.originalRaycast:function(){}},show:function(t){t=void 0===t?0:t;var e=this.hideAnimation,i=this.showAnimation,n=this.material;this.animated?(e.stop(),i.delay(t).start()):(this.enableRaycast(!0),n.opacity=1)},hide:function(t){t=void 0===t?0:t;var e=this.hideAnimation,i=this.showAnimation,n=this.material;this.animated?(i.stop(),e.delay(t).start()):(this.enableRaycast(!1),n.opacity=0)},setFocusMethod:function(t){t&&(this.HANDLER_FOCUS=t.method)},focus:function(t,e){this.HANDLER_FOCUS&&(this.HANDLER_FOCUS(this.position,t,e),this.onDismiss())},dispose:function(){var t=this.geometry,e=this.material,i=e.map;this.removeHoverElement(),this.parent&&this.parent.remove(this),i&&(i.dispose(),e.map=null),t&&(t.dispose(),this.geometry=null),e&&(e.dispose(),this.material=null)}}),i.prototype=Object.assign(Object.create(q.EventDispatcher.prototype),{constructor:i,addControlBar:function(){var e,i,t;this.container?(e=this,(i=document.createElement("div")).style.width="100%",i.style.height="44px",i.style.float="left",i.style.transform=i.style.webkitTransform=i.style.msTransform="translateY(-100%)",i.style.background="-webkit-linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))",i.style.background="-moz-linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))",i.style.background="-o-linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))",i.style.background="-ms-linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))",i.style.background="linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))",i.style.transition=this.DEFAULT_TRANSITION,i.style.pointerEvents="none",i.isHidden=!1,i.toggle=function(){i.isHidden=!i.isHidden;var t=i.isHidden?0:1;i.style.transform=i.style.webkitTransform=i.style.msTransform=i.isHidden?"translateY(0)":"translateY(-100%)",i.style.opacity=t},t=this.createDefaultMenu(),this.mainMenu=this.createMainMenu(t),i.appendChild(this.mainMenu),this.mask=t=this.createMask(),this.container.appendChild(t),i.dispose=function(){e.fullscreenElement&&(i.removeChild(e.fullscreenElement),e.fullscreenElement.dispose(),e.fullscreenElement=null),e.settingElement&&(i.removeChild(e.settingElement),e.settingElement.dispose(),e.settingElement=null),e.videoElement&&(i.removeChild(e.videoElement),e.videoElement.dispose(),e.videoElement=null)},this.container.appendChild(i),this.mask.addEventListener("mousemove",this.PREVENT_EVENT_HANDLER,!0),this.mask.addEventListener("mouseup",this.PREVENT_EVENT_HANDLER,!0),this.mask.addEventListener("mousedown",this.PREVENT_EVENT_HANDLER,!0),this.mask.addEventListener(e.TOUCH_ENABLED?"touchend":"click",function(t){t.preventDefault(),t.stopPropagation(),e.mask.hide(),e.settingElement.deactivate()},!1),this.addEventListener("control-bar-toggle",i.toggle),this.barElement=i):console.warn("Widget container not set")},createDefaultMenu:function(){function t(t,e){return function(){i.dispatchEvent({type:"panolens-viewer-handler",method:t,data:e})}}var i=this;return[{title:"Control",subMenu:[{title:this.TOUCH_ENABLED?"Touch":"Mouse",handler:t("enableControl",_.ORBIT)},{title:"Sensor",handler:t("enableControl",_.DEVICEORIENTATION)}]},{title:"Mode",subMenu:[{title:"Normal",handler:t("disableEffect")},{title:"Cardboard",handler:t("enableEffect",S.CARDBOARD)},{title:"Stereoscopic",handler:t("enableEffect",S.STEREO)}]}]},addControlButton:function(t){switch(t){case"fullscreen":this.fullscreenElement=t=this.createFullscreenButton();break;case"setting":this.settingElement=t=this.createSettingButton();break;case"video":this.videoElement=t=this.createVideoControl();break;default:return}t&&this.barElement.appendChild(t)},createMask:function(){var t=document.createElement("div");return t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.width="100%",t.style.height="100%",t.style.background="transparent",t.style.display="none",t.show=function(){this.style.display="block"},t.hide=function(){this.style.display="none"},t},createSettingButton:function(){var e=this,t=this.createCustomItem({style:{backgroundImage:'url("'+T.Setting+'")',webkitTransition:this.DEFAULT_TRANSITION,transition:this.DEFAULT_TRANSITION},onTap:function(t){t.preventDefault(),t.stopPropagation(),e.mainMenu.toggle(),this.activated?this.deactivate():this.activate()}});return t.activate=function(){this.style.transform="rotate3d(0,0,1,90deg)",this.activated=!0,e.mask.show()},t.deactivate=function(){this.style.transform="rotate3d(0,0,0,0)",this.activated=!1,e.mask.hide(),e.mainMenu&&e.mainMenu.visible&&e.mainMenu.hide(),e.activeSubMenu&&e.activeSubMenu.visible&&e.activeSubMenu.hide(),e.mainMenu&&e.mainMenu._width&&(e.mainMenu.changeSize(e.mainMenu._width),e.mainMenu.unslideAll())},t.activated=!1,t},createFullscreenButton:function(){function t(){n&&(i=!i,a.style.backgroundImage=i?'url("'+T.FullscreenLeave+'")':'url("'+T.FullscreenEnter+'")'),e.dispatchEvent({type:"panolens-viewer-handler",method:"onWindowResize"}),n=!0}var e=this,i=!1,n=!0,r=this.container;if(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled){document.addEventListener("fullscreenchange",t,!1),document.addEventListener("webkitfullscreenchange",t,!1),document.addEventListener("mozfullscreenchange",t,!1),document.addEventListener("MSFullscreenChange",t,!1);var o,a=this.createCustomItem({style:{backgroundImage:'url("'+T.FullscreenEnter+'")'},onTap:function(t){t.preventDefault(),t.stopPropagation(),n=!1,i=i?(document.exitFullscreen&&document.exitFullscreen(),document.msExitFullscreen&&document.msExitFullscreen(),document.mozCancelFullScreen&&document.mozCancelFullScreen(),document.webkitExitFullscreen&&document.webkitExitFullscreen(),!1):(r.requestFullscreen&&r.requestFullscreen(),r.msRequestFullscreen&&r.msRequestFullscreen(),r.mozRequestFullScreen&&r.mozRequestFullScreen(),r.webkitRequestFullscreen&&r.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),!0),this.style.backgroundImage=i?'url("'+T.FullscreenLeave+'")':'url("'+T.FullscreenEnter+'")'}});return document.querySelector("panolens-style-addon")||((o=document.createElement("style")).id="panolens-style-addon",o.innerHTML=":-webkit-full-screen { width: 100% !important; height: 100% !important }",document.body.appendChild(o)),a}},createVideoControl:function(){var t=document.createElement("span");return t.style.display="none",t.show=function(){t.style.display=""},t.hide=function(){t.style.display="none",t.controlButton.paused=!0,t.controlButton.update()},t.controlButton=this.createVideoControlButton(),t.seekBar=this.createVideoControlSeekbar(),t.appendChild(t.controlButton),t.appendChild(t.seekBar),t.dispose=function(){t.removeChild(t.controlButton),t.removeChild(t.seekBar),t.controlButton.dispose(),t.controlButton=null,t.seekBar.dispose(),t.seekBar=null},this.addEventListener("video-control-show",t.show),this.addEventListener("video-control-hide",t.hide),t},createVideoControlButton:function(){var e=this,i=this.createCustomItem({style:{float:"left",backgroundImage:'url("'+T.VideoPlay+'")'},onTap:function(t){t.preventDefault(),t.stopPropagation(),e.dispatchEvent({type:"panolens-viewer-handler",method:"toggleVideoPlay",data:!this.paused}),this.paused=!this.paused,i.update()}});return i.paused=!0,i.update=function(t){this.paused=void 0!==t?t:this.paused,this.style.backgroundImage='url("'+(this.paused?T.VideoPlay:T.VideoPause)+'")'},i},createVideoControlSeekbar:function(){function t(t){t.stopPropagation(),c=!0,r=t.clientX||t.changedTouches&&t.changedTouches[0].clientX,o=parseInt(l.style.width)/100,s.container.addEventListener("mousemove",e,{passive:!0}),s.container.addEventListener("mouseup",i,{passive:!0}),s.container.addEventListener("touchmove",e,{passive:!0}),s.container.addEventListener("touchend",i,{passive:!0})}function e(t){c&&(a=((t.clientX||t.changedTouches&&t.changedTouches[0].clientX)-r)/u.clientWidth,a=1<(a=o+a)?1:a<0?0:a,u.setProgress(a),s.dispatchEvent({type:"panolens-viewer-handler",method:"setVideoCurrentTime",data:a}))}function i(t){t.stopPropagation(),c=!1,n()}function n(){s.container.removeEventListener("mousemove",e,!1),s.container.removeEventListener("mouseup",i,!1),s.container.removeEventListener("touchmove",e,!1),s.container.removeEventListener("touchend",i,!1)}var r,o,a,s=this,c=!1,l=document.createElement("div");l.style.width="0%",l.style.height="100%",l.style.backgroundColor="#fff";var h=document.createElement("div");h.style.float="right",h.style.width="14px",h.style.height="14px",h.style.transform="translate(7px, -5px)",h.style.borderRadius="50%",h.style.backgroundColor="#ddd",h.addEventListener("mousedown",t,{passive:!0}),h.addEventListener("touchstart",t,{passive:!0}),l.appendChild(h);var u=this.createCustomItem({style:{float:"left",width:"30%",height:"4px",marginTop:"20px",backgroundColor:"rgba(188,188,188,0.8)"},onTap:function(t){var e;t.preventDefault(),t.stopPropagation(),t.target!==h&&(e=t.changedTouches&&0<t.changedTouches.length?(t.changedTouches[0].pageX-t.target.getBoundingClientRect().left)/this.clientWidth:t.offsetX/this.clientWidth,s.dispatchEvent({type:"panolens-viewer-handler",method:"setVideoCurrentTime",data:e}),u.setProgress(t.offsetX/this.clientWidth))},onDispose:function(){n(),h=l=null}});return u.appendChild(l),u.setProgress=function(t){l.style.width=100*t+"%"},this.addEventListener("video-update",function(t){u.setProgress(t.percentage)}),u.progressElement=l,u.progressElementControl=h,u},createMenuItem:function(t){var i=this,e=document.createElement("a");return e.textContent=t,e.style.display="block",e.style.padding="10px",e.style.textDecoration="none",e.style.cursor="pointer",e.style.pointerEvents="auto",e.style.transition=this.DEFAULT_TRANSITION,e.slide=function(t){this.style.transform="translateX("+(t?"":"-")+"100%)"},e.unslide=function(){this.style.transform="translateX(0)"},e.setIcon=function(t){this.icon&&(this.icon.style.backgroundImage="url("+t+")")},e.setSelectionTitle=function(t){this.selection&&(this.selection.textContent=t)},e.addSelection=function(t){var e=document.createElement("span");return e.style.fontSize="13px",e.style.fontWeight="300",e.style.float="right",this.selection=e,this.setSelectionTitle(t),this.appendChild(e),this},e.addIcon=function(t,e,i){t=void 0===t?T.ChevronRight:t,e=void 0!==e&&e,i=void 0!==i&&i;var n=document.createElement("span");return n.style.float=e?"left":"right",n.style.width="17px",n.style.height="17px",n.style["margin"+(e?"Right":"Left")]="12px",n.style.backgroundSize="cover",i&&(n.style.transform="rotateZ(180deg)"),this.icon=n,this.setIcon(t),this.appendChild(n),this},e.addSubMenu=function(t,e){return this.subMenu=i.createSubMenu(t,e),this},e.addEventListener("mouseenter",function(){this.style.backgroundColor="#e0e0e0"},!1),e.addEventListener("mouseleave",function(){this.style.backgroundColor="#fafafa"},!1),e},createMenuItemHeader:function(t){return(t=this.createMenuItem(t)).style.borderBottom="1px solid #333",t.style.paddingBottom="15px",t},createMainMenu:function(t){function e(t){t.preventDefault(),t.stopPropagation();var e=n.mainMenu,i=this.subMenu;e.hide(),e.slideAll(),e.parentElement.appendChild(i),n.activeMainItem=this,n.activeSubMenu=i,window.requestAnimationFrame(function(){e.changeSize(i.clientWidth),i.show(),i.unslideAll()})}var n=this,i=this.createMenu();i._width=200,i.changeSize(i._width);for(var r=0;r<t.length;r++){var o=i.addItem(t[r].title);o.style.paddingLeft="20px",o.addIcon().addEventListener(n.TOUCH_ENABLED?"touchend":"click",e,!1),t[r].subMenu&&0<t[r].subMenu.length&&o.addSelection(t[r].subMenu[0].title).addSubMenu(t[r].title,t[r].subMenu)}return i},createSubMenu:function(t,e){function i(t){t.preventDefault(),t.stopPropagation(),(n=r.mainMenu).changeSize(n._width),n.unslideAll(),n.show(),o.slideAll(!0),o.hide(),"header"!==this.type&&(o.setActiveItem(this),r.activeMainItem.setSelectionTitle(this.textContent),this.handler&&this.handler())}var n,r=this,o=this.createMenu();for(o.items=e,o.activeItem=null,o.addHeader(t).addIcon(void 0,!0,!0).addEventListener(r.TOUCH_ENABLED?"touchend":"click",i,!1),t=0;t<e.length;t++){var a=o.addItem(e[t].title);a.style.fontWeight=300,a.handler=e[t].handler,a.addIcon(" ",!0),a.addEventListener(r.TOUCH_ENABLED?"touchend":"click",i,!1),o.activeItem||o.setActiveItem(a)}return o.slideAll(!0),o},createMenu:function(){var e=this,i=document.createElement("span"),t=i.style;return t.padding="5px 0",t.position="fixed",t.bottom="100%",t.right="14px",t.backgroundColor="#fafafa",t.fontFamily="Helvetica Neue",t.fontSize="14px",t.visibility="hidden",t.opacity=0,t.boxShadow="0 0 12pt rgba(0,0,0,0.25)",t.borderRadius="2px",t.overflow="hidden",t.willChange="width, height, opacity",t.pointerEvents="auto",t.transition=this.DEFAULT_TRANSITION,i.visible=!1,i.changeSize=function(t,e){t&&(this.style.width=t+"px"),e&&(this.style.height=e+"px")},i.show=function(){this.style.opacity=1,this.style.visibility="visible",this.visible=!0},i.hide=function(){this.style.opacity=0,this.style.visibility="hidden",this.visible=!1},i.toggle=function(){this.visible?this.hide():this.show()},i.slideAll=function(t){for(var e=0;e<i.children.length;e++)i.children[e].slide&&i.children[e].slide(t)},i.unslideAll=function(){for(var t=0;t<i.children.length;t++)i.children[t].unslide&&i.children[t].unslide()},i.addHeader=function(t){return(t=e.createMenuItemHeader(t)).type="header",this.appendChild(t),t},i.addItem=function(t){return(t=e.createMenuItem(t)).type="item",this.appendChild(t),t},i.setActiveItem=function(t){this.activeItem&&this.activeItem.setIcon(" "),t.setIcon(T.Check),this.activeItem=t},i.addEventListener("mousemove",this.PREVENT_EVENT_HANDLER,!0),i.addEventListener("mouseup",this.PREVENT_EVENT_HANDLER,!0),i.addEventListener("mousedown",this.PREVENT_EVENT_HANDLER,!0),i},createCustomItem:function(t){var e=this,i=(t=void 0===t?{}:t).element||document.createElement("span"),n=t.onDispose;return i.style.cursor="pointer",i.style.float="right",i.style.width="44px",i.style.height="100%",i.style.backgroundSize="60%",i.style.backgroundRepeat="no-repeat",i.style.backgroundPosition="center",i.style.webkitUserSelect=i.style.MozUserSelect=i.style.userSelect="none",i.style.position="relative",i.style.pointerEvents="auto",i.addEventListener(e.TOUCH_ENABLED?"touchstart":"mouseenter",function(){i.style.filter=i.style.webkitFilter="drop-shadow(0 0 5px rgba(255,255,255,1))"},{passive:!0}),i.addEventListener(e.TOUCH_ENABLED?"touchend":"mouseleave",function(){i.style.filter=i.style.webkitFilter=""},{passive:!0}),this.mergeStyleOptions(i,t.style),t.onTap&&i.addEventListener(e.TOUCH_ENABLED?"touchend":"click",t.onTap,!1),i.dispose=function(){i.removeEventListener(e.TOUCH_ENABLED?"touchend":"click",t.onTap,!1),n&&t.onDispose()},i},mergeStyleOptions:function(t,e){for(var i in e=void 0===e?{}:e)e.hasOwnProperty(i)&&(t.style[i]=e[i]);return t},dispose:function(){this.barElement&&(this.container.removeChild(this.barElement),this.barElement.dispose(),this.barElement=null)}});var O={tEquirect:{value:new q.Texture},repeat:{value:new q.Vector2(1,1)},offset:{value:new q.Vector2(0,0)},opacity:{value:1}};o.prototype=Object.assign(Object.create(q.Mesh.prototype),{constructor:o,createGeometry:function(t){return new q.BoxBufferGeometry(t,t,t)},createMaterial:function(t,e){t=void 0===t?new q.Vector2(1,1):t,e=void 0===e?new q.Vector2(0,0):e;var i=q.UniformsUtils.clone(O);return i.repeat.value.copy(t),i.offset.value.copy(e),i.opacity.value=0,new q.ShaderMaterial({fragmentShader:"\n        uniform sampler2D tEquirect;\n        uniform vec2 repeat;\n        uniform vec2 offset;\n        uniform float opacity;\n        varying vec3 vWorldDirection;\n        #include <common>\n        void main() {\n            vec3 direction = normalize( vWorldDirection );\n            vec2 sampleUV;\n            sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n            sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n            sampleUV *= repeat;\n            sampleUV += offset;\n            vec4 texColor = texture2D( tEquirect, sampleUV );\n            gl_FragColor = mapTexelToLinear( texColor );\n            gl_FragColor.a *= opacity;\n            #include <tonemapping_fragment>\n            #include <encodings_fragment>\n        }\n    ",vertexShader:"\n        varying vec3 vWorldDirection;\n        #include <common>\n        void main() {\n            vWorldDirection = transformDirection( position, modelMatrix );\n            #include <begin_vertex>\n            #include <project_vertex>\n        }\n    ",uniforms:i,side:q.BackSide,transparent:!0,opacity:0})},add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}t instanceof a&&((e=this.container)&&t.dispatchEvent({type:"panolens-container",container:e}),t.dispatchEvent({type:"panolens-infospot-focus",method:function(t,e,i){this.dispatchEvent({type:"panolens-viewer-handler",method:"tweenControlCenter",data:[t,e,i]})}.bind(this)})),q.Object3D.prototype.add.call(this,t)},getTexture:function(){return this.material.uniforms.tEquirect.value},load:function(){this.onLoad()},onClick:function(t){t.intersects&&0===t.intersects.length&&this.traverse(function(t){t.dispatchEvent({type:"dismiss"})})},setContainer:function(t){var e;t instanceof HTMLElement?e=t:t&&t.container&&(e=t.container),e&&(this.children.forEach(function(t){t instanceof a&&t.dispatchEvent&&t.dispatchEvent({type:"panolens-container",container:e})}),this.container=e)},onLoad:function(){this.loaded=!0,this.dispatchEvent({type:"load"})},onProgress:function(t){this.dispatchEvent({type:"progress",progress:t})},onError:function(){this.dispatchEvent({type:"error"})},getZoomLevel:function(){return window.innerWidth<=800?this.ImageQualityFair:800<window.innerWidth&&window.innerWidth<=1280?this.ImageQualityMedium:1280<window.innerWidth&&window.innerWidth<=1920?this.ImageQualityHigh:1920<window.innerWidth?this.ImageQualitySuperHigh:this.ImageQualityLow},updateTexture:function(t){this.material.uniforms.tEquirect.value=t},toggleInfospotVisibility:function(t,e){e=void 0!==e?e:0;var i=void 0!==t?t:!this.isInfospotVisible;this.traverse(function(t){t instanceof a&&(i?t.show(e):t.hide(e))}),this.isInfospotVisible=i,this.infospotAnimation.onComplete(function(){this.dispatchEvent({type:"infospot-animation-complete",visible:i})}.bind(this)).delay(e).start()},setLinkingImage:function(t,e){this.linkingImageURL=t,this.linkingImageScale=e},link:function(t,e,i,n){this.visible=!0,e?((n=new a(i=void 0!==i?i:void 0!==t.linkingImageScale?t.linkingImageScale:300,n=n||(t.linkingImageURL?t.linkingImageURL:T.Arrow))).position.copy(e),n.toPanorama=t,n.addEventListener("click",function(){this.dispatchEvent({type:"panolens-viewer-handler",method:"setPanorama",data:t})}.bind(this)),this.linkedSpots.push(n),this.add(n),this.visible=!1):console.warn("Please specify infospot position for linking")},reset:function(){this.children.length=0},setupTransitions:function(){this.fadeInAnimation=new I.Tween(this.material).easing(I.Easing.Quartic.Out).onStart(function(){this.visible=!0,this.dispatchEvent({type:"enter-fade-start"})}.bind(this)),this.fadeOutAnimation=new I.Tween(this.material).easing(I.Easing.Quartic.Out).onComplete(function(){this.visible=!1,this.dispatchEvent({type:"leave-complete"})}.bind(this)),this.enterTransition=new I.Tween(this).easing(I.Easing.Quartic.Out).onComplete(function(){this.dispatchEvent({type:"enter-complete"})}.bind(this)).start(),this.leaveTransition=new I.Tween(this).easing(I.Easing.Quartic.Out)},onFadeAnimationUpdate:function(){var t=this.material.opacity,e=this.material.uniforms;e&&e.opacity&&(e.opacity.value=t)},fadeIn:function(t){t=0<=t?t:this.animationDuration,this.fadeOutAnimation.stop(),this.fadeInAnimation.to({opacity:1},t).onUpdate(this.onFadeAnimationUpdate.bind(this)).onComplete(function(){this.toggleInfospotVisibility(!0,t/2),this.dispatchEvent({type:"enter-fade-complete"})}.bind(this)).start()},fadeOut:function(t){t=0<=t?t:this.animationDuration,this.fadeInAnimation.stop(),this.fadeOutAnimation.to({opacity:0},t).onUpdate(this.onFadeAnimationUpdate.bind(this)).start()},onEnter:function(){var t=this.animationDuration;this.dispatchEvent({type:"enter"}),this.leaveTransition.stop(),this.enterTransition.to({},t).onStart(function(){this.dispatchEvent({type:"enter-start"}),this.loaded?this.fadeIn(t):this.load()}.bind(this)).start(),this.children.forEach(function(t){t.dispatchEvent({type:"panorama-enter"})}),this.active=!0},onLeave:function(){var t=this.animationDuration;this.enterTransition.stop(),this.leaveTransition.to({},t).onStart(function(){this.dispatchEvent({type:"leave-start"}),this.fadeOut(t),this.toggleInfospotVisibility(!1)}.bind(this)).start(),this.dispatchEvent({type:"leave"}),this.children.forEach(function(t){t.dispatchEvent({type:"panorama-leave"})}),this.active=!1},dispose:function(){var t=this.material;t&&t.uniforms&&t.uniforms.tEquirect&&t.uniforms.tEquirect.value.dispose(),this.infospotAnimation.stop(),this.fadeInAnimation.stop(),this.fadeOutAnimation.stop(),this.enterTransition.stop(),this.leaveTransition.stop(),this.dispatchEvent({type:"panolens-viewer-handler",method:"onPanoramaDispose",data:this}),function t(e){for(var i=e.geometry,n=e.material,r=e.children.length-1;0<=r;r--)t(e.children[r]),e.remove(e.children[r]);e instanceof a&&e.dispose(),i&&(i.dispose(),e.geometry=null),n&&(n.dispose(),e.material=null)}(this),this.parent&&this.parent.remove(this)}}),s.prototype=Object.assign(Object.create(o.prototype),{constructor:s,load:function(t){(t=t||this.src)?"string"==typeof t?L.load(t,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this)):t instanceof HTMLImageElement&&this.onLoad(new q.Texture(t)):console.warn("Image source undefined")},onLoad:function(t){t.minFilter=t.magFilter=q.LinearFilter,t.needsUpdate=!0,this.updateTexture(t),window.requestAnimationFrame(o.prototype.onLoad.bind(this))},reset:function(){o.prototype.reset.call(this)},dispose:function(){q.Cache.remove(this.src),o.prototype.dispose.call(this)}}),c.prototype=Object.assign(Object.create(o.prototype),{constructor:c,createGeometry:function(){var t=new q.BufferGeometry;return t.addAttribute("position",new q.BufferAttribute(new Float32Array,1)),t},createMaterial:function(){new q.MeshBasicMaterial({color:0,opacity:0,transparent:!0})},getTexture:function(){return null}}),l.prototype=Object.assign(Object.create(o.prototype),{constructor:l,createMaterial:function(){var t=q.ShaderLib.cube,e=t.fragmentShader,i=t.vertexShader;return(t=q.UniformsUtils.clone(t.uniforms)).opacity.value=0,new q.ShaderMaterial({fragmentShader:e,vertexShader:i,uniforms:t,side:q.BackSide,transparent:!0,opacity:0})},load:function(){P.load(this.images,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this))},onLoad:function(t){this.material.uniforms.tCube.value=t,o.prototype.onLoad.call(this)},getTexture:function(){return this.material.uniforms.tCube.value},dispose:function(){var t=this.material.uniforms.tCube.value;this.images.forEach(function(t){q.Cache.remove(t)}),t instanceof q.CubeTexture&&t.dispose(),o.prototype.dispose.call(this)}}),h.prototype=Object.assign(Object.create(l.prototype),{constructor:h}),u.prototype=Object.assign(Object.create(o.prototype),{constructor:u,isMobile:function(){var t=!1,e=window.navigator.userAgent||window.navigator.vendor||window.opera;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},load:function(){var e=(r=this.options).muted,t=r.loop,i=r.autoplay,n=r.playsinline,r=r.crossOrigin,o=this.videoElement,a=this.onProgress.bind(this),s=this.onLoad.bind(this);o.loop=t,o.autoplay=i,o.playsinline=n,o.crossOrigin=r,o.muted=e,n&&(o.setAttribute("playsinline",""),o.setAttribute("webkit-playsinline","")),n=function(){var t=this.setVideoTexture(o);i&&this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1}),this.isMobile()&&(o.pause(),i&&e?this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1}):this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0})),window.requestAnimationFrame(function(){a({loaded:1,total:1}),s(t)})},2<o.readyState?n.call(this):(0===o.querySelectorAll("source").length&&((r=document.createElement("source")).src=this.src,o.appendChild(r)),o.load()),o.addEventListener("loadeddata",n.bind(this)),o.addEventListener("timeupdate",function(){this.videoProgress=0<=o.duration?o.currentTime/o.duration:0,this.dispatchEvent({type:"panolens-viewer-handler",method:"onVideoUpdate",data:this.videoProgress})}.bind(this)),o.addEventListener("ended",function(){t||(this.resetVideo(),this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0}))}.bind(this),!1)},onLoad:function(){o.prototype.onLoad.call(this)},setVideoTexture:function(t){if(t)return(t=new q.VideoTexture(t)).minFilter=q.LinearFilter,t.magFilter=q.LinearFilter,t.format=q.RGBFormat,this.updateTexture(t),t},reset:function(){this.videoElement=void 0,o.prototype.reset.call(this)},isVideoPaused:function(){return this.videoElement.paused},toggleVideo:function(){var t=this.videoElement;t&&t[t.paused?"play":"pause"]()},setVideoCurrentTime:function(t){t=t.percentage;var e=this.videoElement;e&&!Number.isNaN(t)&&1!==t&&(e.currentTime=e.duration*t,this.dispatchEvent({type:"panolens-viewer-handler",method:"onVideoUpdate",data:t}))},playVideo:function(){var t=this.videoElement,e=this.playVideo.bind(this),i=this.dispatchEvent.bind(this);t&&t.paused&&t.play().then(function(){i({type:"play"})}).catch(function(t){window.requestAnimationFrame(e),i({type:"play-error",error:t})})},pauseVideo:function(){var t=this.videoElement;t&&!t.paused&&t.pause(),this.dispatchEvent({type:"pause"})},resumeVideoProgress:function(){var t=this.videoElement;4<=t.readyState&&t.autoplay&&!this.isMobile()?(this.playVideo(),this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1})):(this.pauseVideo(),this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0})),this.setVideoCurrentTime({percentage:this.videoProgress})},resetVideo:function(){this.videoElement&&this.setVideoCurrentTime({percentage:0})},isVideoMuted:function(){return this.videoElement.muted},muteVideo:function(){var t=this.videoElement;t&&!t.muted&&(t.muted=!0),this.dispatchEvent({type:"volumechange"})},unmuteVideo:function(){var t=this.videoElement;t&&this.isVideoMuted()&&(t.muted=!1),this.dispatchEvent({type:"volumechange"})},getVideoElement:function(){return this.videoElement},dispose:function(){this.pauseVideo(),this.removeEventListener("leave",this.pauseVideo.bind(this)),this.removeEventListener("enter-fade-start",this.resumeVideoProgress.bind(this)),this.removeEventListener("video-toggle",this.toggleVideo.bind(this)),this.removeEventListener("video-time",this.setVideoCurrentTime.bind(this)),o.prototype.dispose.call(this)}}),Object.assign(d.prototype,{constructor:d,setProgress:function(t,e){this.onProgress&&this.onProgress({loaded:t,total:e})},adaptTextureToZoom:function(){var t=this.widths[this._zoom],e=this.heights[this._zoom],i=this.maxW,n=this.maxH;this._wc=Math.ceil(t/i),this._hc=Math.ceil(e/n);for(var r=0;r<this._hc;r++)for(var o=0;o<this._wc;o++){var a=document.createElement("canvas");a.width=o<this._wc-1?i:t-i*o,a.height=r<this._hc-1?n:e-n*r,this._canvas.push(a),this._ctx.push(a.getContext("2d"))}},composeFromTile:function(t,e,i){var n=this.maxW,r=this.maxH;t*=512,e*=512;var o=Math.floor(t/n),a=Math.floor(e/r);this._ctx[a*this._wc+o].drawImage(i,0,0,i.width,i.height,t-o*n,e-a*r,512,512),this.progress()},progress:function(){this._count++,this.setProgress(this._count,this._total),this._count===this._total&&(this.canvas=this._canvas,this.panoId=this._panoId,this.zoom=this._zoom,this.onPanoramaLoad)&&this.onPanoramaLoad(this._canvas[0])},composePanorama:function(){this.setProgress(0,1);var t=this.levelsW[this._zoom],e=this.levelsH[this._zoom],o=this;this._count=0,this._total=t*e;for(var a=this._parameters.useWebGL,i=0;i<e;i++)for(var n={},r=0;r<t;n={$jscomp$loop$prop$url$2:n.$jscomp$loop$prop$url$2},r++)n.$jscomp$loop$prop$url$2="https://geo0.ggpht.com/cbk?cb_client=maps_sv.tactile&authuser=0&hl=en&output=tile&zoom="+this._zoom+"&x="+r+"&y="+i+"&panoid="+this._panoId+"&nbt&fover=2",function(r){return function(t,e){var i,n;a?i=L.load(r.$jscomp$loop$prop$url$2,null,function(){o.composeFromTile(t,e,i)}):((n=new Image).addEventListener("load",function(){o.composeFromTile(t,e,this)}),n.crossOrigin="",n.src=r.$jscomp$loop$prop$url$2)}}(n)(r,i)},load:function(t){this.loadPano(t)},loadPano:function(t){var i=this;this._panoClient.getPanoramaById(t,function(t,e){e===google.maps.StreetViewStatus.OK&&(i.result=t,i.copyright=t.copyright,i._panoId=t.location.pano,i.composePanorama())})},setZoom:function(t){this._zoom=t,this.adaptTextureToZoom()}}),p.prototype=Object.assign(Object.create(s.prototype),{constructor:p,load:function(t){this.loadRequested=!0,t=t||this.panoId||{},this.gsvLoader&&this.loadGSVLoader(t)},setupGoogleMapAPI:function(t){var e=document.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?",e.src+=t?"key="+t:"",e.onreadystatechange=this.setGSVLoader.bind(this),e.onload=this.setGSVLoader.bind(this),document.querySelector("head").appendChild(e)},setGSVLoader:function(){this.gsvLoader=new d,this.loadRequested&&this.load()},getGSVLoader:function(){return this.gsvLoader},loadGSVLoader:function(t){this.loadRequested=!1,this.gsvLoader.onProgress=this.onProgress.bind(this),this.gsvLoader.onPanoramaLoad=this.onLoad.bind(this),this.gsvLoader.setZoom(this.getZoomLevel()),this.gsvLoader.load(t),this.gsvLoader.loaded=!0},onLoad:function(t){s.prototype.onLoad.call(this,new q.Texture(t))},reset:function(){this.gsvLoader=void 0,s.prototype.reset.call(this)}});var D={tDiffuse:{value:new q.Texture},resolution:{value:1},transform:{value:new q.Matrix4},zoom:{value:1},opacity:{value:1}};f.prototype=Object.assign(Object.create(s.prototype),{constructor:f,add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}t instanceof a&&(t.material.depthTest=!1),s.prototype.add.call(this,t)},createGeometry:function(t){return new q.PlaneBufferGeometry(t,.5*t)},createMaterial:function(t){t=void 0===t?this.edgeLength:t;var e=q.UniformsUtils.clone(D);return e.zoom.value=t,e.opacity.value=0,new q.ShaderMaterial({vertexShader:"\n\n        varying vec2 vUv;\n\n        void main() {\n\n            vUv = uv;\n            gl_Position = vec4( position, 1.0 );\n\n        }\n\n    ",fragmentShader:"\n\n        uniform sampler2D tDiffuse;\n        uniform float resolution;\n        uniform mat4 transform;\n        uniform float zoom;\n        uniform float opacity;\n\n        varying vec2 vUv;\n\n        const float PI = 3.141592653589793;\n\n        void main(){\n\n            vec2 position = -1.0 +  2.0 * vUv;\n\n            position *= vec2( zoom * resolution, zoom * 0.5 );\n\n            float x2y2 = position.x * position.x + position.y * position.y;\n            vec3 sphere_pnt = vec3( 2. * position, x2y2 - 1. ) / ( x2y2 + 1. );\n\n            sphere_pnt = vec3( transform * vec4( sphere_pnt, 1.0 ) );\n\n            vec2 sampleUV = vec2(\n                (atan(sphere_pnt.y, sphere_pnt.x) / PI + 1.0) * 0.5,\n                (asin(sphere_pnt.z) / PI + 0.5)\n            );\n\n            gl_FragColor = texture2D( tDiffuse, sampleUV );\n            gl_FragColor.a *= opacity;\n\n        }\n    ",uniforms:e,transparent:!0,opacity:0})},registerMouseEvents:function(){this.container.addEventListener("mousedown",this.onMouseDown.bind(this),{passive:!0}),this.container.addEventListener("mousemove",this.onMouseMove.bind(this),{passive:!0}),this.container.addEventListener("mouseup",this.onMouseUp.bind(this),{passive:!0}),this.container.addEventListener("touchstart",this.onMouseDown.bind(this),{passive:!0}),this.container.addEventListener("touchmove",this.onMouseMove.bind(this),{passive:!0}),this.container.addEventListener("touchend",this.onMouseUp.bind(this),{passive:!0}),this.container.addEventListener("mousewheel",this.onMouseWheel.bind(this),{passive:!1}),this.container.addEventListener("DOMMouseScroll",this.onMouseWheel.bind(this),{passive:!1}),this.container.addEventListener("contextmenu",this.onContextMenu.bind(this),{passive:!0})},unregisterMouseEvents:function(){this.container.removeEventListener("mousedown",this.onMouseDown.bind(this),!1),this.container.removeEventListener("mousemove",this.onMouseMove.bind(this),!1),this.container.removeEventListener("mouseup",this.onMouseUp.bind(this),!1),this.container.removeEventListener("touchstart",this.onMouseDown.bind(this),!1),this.container.removeEventListener("touchmove",this.onMouseMove.bind(this),!1),this.container.removeEventListener("touchend",this.onMouseUp.bind(this),!1),this.container.removeEventListener("mousewheel",this.onMouseWheel.bind(this),!1),this.container.removeEventListener("DOMMouseScroll",this.onMouseWheel.bind(this),!1),this.container.removeEventListener("contextmenu",this.onContextMenu.bind(this),!1)},onMouseDown:function(t){switch(t.touches&&t.touches.length||1){case 1:var e=0<=t.clientX?t.clientX:t.touches[0].clientX;t=0<=t.clientY?t.clientY:t.touches[0].clientY,this.dragging=!0,this.userMouse.set(e,t);break;case 2:e=t.touches[0].pageX-t.touches[1].pageX,t=t.touches[0].pageY-t.touches[1].pageY,this.userMouse.pinchDistance=Math.sqrt(e*e+t*t)}this.onUpdateCallback()},onMouseMove:function(t){switch(t.touches&&t.touches.length||1){case 1:var e=0<=t.clientX?t.clientX:t.touches[0].clientX;t=0<=t.clientY?t.clientY:t.touches[0].clientY;var i=.4*q.Math.degToRad(e-this.userMouse.x),n=.4*q.Math.degToRad(t-this.userMouse.y);this.dragging&&(this.quatA.setFromAxisAngle(this.vectorY,i),this.quatB.setFromAxisAngle(this.vectorX,n),this.quatCur.multiply(this.quatA).multiply(this.quatB),this.userMouse.set(e,t));break;case 2:e=t.touches[0].pageX-t.touches[1].pageX,t=t.touches[0].pageY-t.touches[1].pageY,this.addZoomDelta(this.userMouse.pinchDistance-Math.sqrt(e*e+t*t))}},onMouseUp:function(){this.dragging=!1},onMouseWheel:function(t){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),this.addZoomDelta(e),this.onUpdateCallback()},addZoomDelta:function(t){var e=this.material.uniforms,i=.1*this.size,n=10*this.size;e.zoom.value+=t,e.zoom.value<=i?e.zoom.value=i:e.zoom.value>=n&&(e.zoom.value=n)},onUpdateCallback:function(){this.frameId=window.requestAnimationFrame(this.onUpdateCallback.bind(this)),this.quatSlerp.slerp(this.quatCur,.1),this.material&&this.material.uniforms.transform.value.makeRotationFromQuaternion(this.quatSlerp),!this.dragging&&1-this.quatSlerp.clone().dot(this.quatCur)<this.EPS&&window.cancelAnimationFrame(this.frameId)},reset:function(){this.quatCur.set(0,0,0,1),this.quatSlerp.set(0,0,0,1),this.onUpdateCallback()},updateTexture:function(t){this.material.uniforms.tDiffuse.value=t},getTexture:function(){return this.material.uniforms.tDiffuse.value},onLoad:function(t){this.material.uniforms.resolution.value=this.container.clientWidth/this.container.clientHeight,this.registerMouseEvents(),this.onUpdateCallback(),this.dispatchEvent({type:"panolens-viewer-handler",method:"disableControl"}),s.prototype.onLoad.call(this,t)},onLeave:function(){this.unregisterMouseEvents(),this.dispatchEvent({type:"panolens-viewer-handler",method:"enableControl",data:_.ORBIT}),window.cancelAnimationFrame(this.frameId),s.prototype.onLeave.call(this)},onWindowResize:function(){this.material.uniforms.resolution.value=this.container.clientWidth/this.container.clientHeight},onContextMenu:function(){this.dragging=!1},dispose:function(){this.unregisterMouseEvents(),s.prototype.dispose.call(this)}}),m.prototype=Object.assign(Object.create(f.prototype),{constructor:m,onLoad:function(t){this.updateTexture(t),f.prototype.onLoad.call(this,t)},updateTexture:function(t){t.minFilter=t.magFilter=q.LinearFilter,this.material.uniforms.tDiffuse.value=t},dispose:function(){var t=this.material.uniforms.tDiffuse;t&&t.value&&t.value.dispose(),f.prototype.dispose.call(this)}}),g.prototype=Object.assign(Object.create(o.prototype),{constructor:g,onPanolensContainer:function(t){this.media.setContainer(t.container)},onPanolensScene:function(t){this.media.setScene(t.scene)},start:function(){return this.media.start()},stop:function(){this.media.stop()}}),v.prototype=Object.assign(Object.create(s.prototype),{constructor:v,onLoad:function(t){var e=t.image;this.stereo.updateUniformByFormat(4==e.width/e.height?A.SBS:A.TAB,this.material.uniforms),this.material.uniforms.tEquirect.value=t,s.prototype.onLoad.call(this,t)},updateTextureToLeft:function(){this.stereo.updateTextureToLeft(this.material.uniforms.offset.value)},updateTextureToRight:function(){this.stereo.updateTextureToRight(this.material.uniforms.offset.value)},dispose:function(){var t=this.material.uniforms.tEquirect.value;t instanceof q.Texture&&t.dispose(),s.prototype.dispose.call(this)}}),y.prototype=Object.assign(Object.create(u.prototype),{constructor:y,onLoad:function(t){var e=t.image;this.stereo.updateUniformByFormat(4==e.videoWidth/e.videoHeight?A.SBS:A.TAB,this.material.uniforms),this.material.uniforms.tEquirect.value=t,u.prototype.onLoad.call(this)},updateTextureToLeft:function(){this.stereo.updateTextureToLeft(this.material.uniforms.offset.value)},updateTextureToRight:function(){this.stereo.updateTextureToRight(this.material.uniforms.offset.value)},dispose:function(){var t=this.material.uniforms.tEquirect.value;t instanceof q.Texture&&t.dispose(),u.prototype.dispose.call(this)}}),b.prototype=Object.assign(Object.create(q.EventDispatcher.prototype),{constructor:b}),x.prototype=Object.assign(Object.create(q.EventDispatcher.prototype),{constructor:x});function k(r){var o=new q.StereoCamera;o.aspect=.5;var a=new q.Vector2;this.setEyeSeparation=function(t){o.eyeSep=t},this.setSize=function(t,e){r.setSize(t,e)},this.render=function(t,e,i){var n=i instanceof v||i instanceof y;t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),n&&this.setEyeSeparation(i.stereo.eyeSep),o.update(e),r.getSize(a),r.autoClear&&r.clear(),r.setScissorTest(!0),n&&i.updateTextureToLeft(),r.setScissor(0,0,a.width/2,a.height),r.setViewport(0,0,a.width/2,a.height),r.render(t,o.cameraL),n&&i.updateTextureToRight(),r.setScissor(a.width/2,0,a.width/2,a.height),r.setViewport(a.width/2,0,a.width/2,a.height),r.render(t,o.cameraR),r.setScissorTest(!1),n&&i.updateTextureToLeft()}}E.prototype=Object.assign(Object.create(q.EventDispatcher.prototype),{constructor:E,setupScene:function(t){return void 0===t?new q.Scene:t},setupCamera:function(t,e,i){return void 0===i?new q.PerspectiveCamera(t,e,1,1e4):i},setupRenderer:function(t,e){t=void 0===t?new q.WebGLRenderer({alpha:!0,antialias:!1}):t;var i=e.clientWidth,n=e.clientHeight;return t.setPixelRatio(window.devicePixelRatio),t.setSize(i,n),t.setClearColor(0,0),t.autoClear=!1,t.domElement.classList.add("panolens-canvas"),t.domElement.style.display="block",e.style.backgroundColor="#000",e.appendChild(t.domElement),t},setupControls:function(t,e){var i=this.options,n=i.autoRotate,r=i.autoRotateSpeed,o=i.horizontalView;return(i=new b(t,e)).id="orbit",i.index=_.ORBIT,i.minDistance=1,i.noPan=!0,i.autoRotate=n,i.autoRotateSpeed=r,o&&(i.minPolarAngle=Math.PI/2,i.maxPolarAngle=Math.PI/2),(t=new x(t,e)).id="device-orientation",t.index=_.DEVICEORIENTATION,t.enabled=!1,this.controls=[i,t],this.OrbitControls=i,this.DeviceOrientationControls=t,i},setupEffects:function(t,e){var i=e.clientWidth;e=e.clientHeight;var n=new w(t);return n.setSize(i,e),(t=new k(t)).setSize(i,e),this.CardboardEffect=n,this.StereoEffect=t,n},setupContainer:function(t){return t?(t._width=t.clientWidth,t._height=t.clientHeight):((t=document.createElement("div")).classList.add("panolens-container"),t.style.width="100%",t.style.height="100%",document.body.appendChild(t)),t},add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}this.scene.add(t),t.addEventListener&&t.addEventListener("panolens-viewer-handler",this.eventHandler.bind(this)),t instanceof o&&t.dispatchEvent&&t.dispatchEvent({type:"panolens-container",container:this.container}),t instanceof g&&t.dispatchEvent({type:"panolens-scene",scene:this.scene}),t instanceof o&&(this.addPanoramaEventListener(t),this.panorama||(e=this.options.initialLookAt,this.setPanorama(t),this.setControlCenter(e)))},remove:function(t){t.removeEventListener&&t.removeEventListener("panolens-viewer-handler",this.eventHandler.bind(this)),this.scene.remove(t)},addDefaultControlBar:function(t){var e;this.widget?console.warn("Default control bar exists"):((e=new i(this.container)).addEventListener("panolens-viewer-handler",this.eventHandler.bind(this)),e.addControlBar(),t.forEach(function(t){e.addControlButton(t)}),this.widget=e)},setPanorama:function(t){var e,i=this.panorama;t instanceof o&&i!==t&&(this.hideInfospot(),e=function(){i&&i.onLeave(),t.removeEventListener("enter-fade-start",e)},t.addEventListener("enter-fade-start",e),(this.panorama=t).onEnter())},eventHandler:function(t){t.method&&this[t.method]&&this[t.method](t.data)},dispatchEventToChildren:function(e){this.scene.traverse(function(t){t.dispatchEvent&&t.dispatchEvent(e)})},activateWidgetItem:function(t,e){var i=(n=this.widget.mainMenu).children[0],n=n.children[1];if(void 0!==t){switch(t){case 0:t=i.subMenu.children[1];break;case 1:t=i.subMenu.children[2];break;default:t=i.subMenu.children[1]}i.subMenu.setActiveItem(t),i.setSelectionTitle(t.textContent)}if(void 0!==e){switch(e){case S.CARDBOARD:t=n.subMenu.children[2];break;case S.STEREO:t=n.subMenu.children[3];break;default:t=n.subMenu.children[1]}n.subMenu.setActiveItem(t),n.setSelectionTitle(t.textContent)}},enableEffect:function(t){if(this.mode!==t)if(t===S.NORMAL)this.disableEffect();else{this.mode=t;var e=this.camera.fov;switch(t){case S.CARDBOARD:this.effect=this.CardboardEffect,this.enableReticleControl();break;case S.STEREO:this.effect=this.StereoEffect,this.enableReticleControl();break;default:this.effect=null,this.disableReticleControl()}this.activateWidgetItem(void 0,this.mode),this.dispatchEventToChildren({type:"panolens-dual-eye-effect",mode:this.mode}),this.camera.fov=e+.01,this.effect.setSize(this.container.clientWidth,this.container.clientHeight),this.render(),this.camera.fov=e,this.dispatchEvent({type:"mode-change",mode:this.mode})}},disableEffect:function(){this.mode!==S.NORMAL&&(this.mode=S.NORMAL,this.disableReticleControl(),this.activateWidgetItem(void 0,this.mode),this.dispatchEventToChildren({type:"panolens-dual-eye-effect",mode:this.mode}),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.render(),this.dispatchEvent({type:"mode-change",mode:this.mode}))},enableReticleControl:function(){this.reticle.visible||(this.tempEnableReticle=!0,this.unregisterMouseAndTouchEvents(),this.reticle.show(),this.registerReticleEvent(),this.updateReticleEvent())},disableReticleControl:function(){this.tempEnableReticle=!1,this.options.enableReticle?this.updateReticleEvent():(this.reticle.hide(),this.unregisterReticleEvent(),this.registerMouseAndTouchEvents())},enableAutoRate:function(){this.options.autoRotate=!0,this.OrbitControls.autoRotate=!0},disableAutoRate:function(){clearTimeout(this.autoRotateRequestId),this.options.autoRotate=!1,this.OrbitControls.autoRotate=!1},toggleVideoPlay:function(t){this.panorama instanceof u&&this.panorama.dispatchEvent({type:"video-toggle",pause:t})},setVideoCurrentTime:function(t){this.panorama instanceof u&&this.panorama.dispatchEvent({type:"video-time",percentage:t})},onVideoUpdate:function(t){var e=this.widget;e&&e.dispatchEvent({type:"video-update",percentage:t})},addUpdateCallback:function(t){t&&this.updateCallbacks.push(t)},removeUpdateCallback:function(t){var e=this.updateCallbacks.indexOf(t);t&&0<=e&&this.updateCallbacks.splice(e,1)},showVideoWidget:function(){var t=this.widget;t&&t.dispatchEvent({type:"video-control-show"})},hideVideoWidget:function(){var t=this.widget;t&&t.dispatchEvent({type:"video-control-hide"})},updateVideoPlayButton:function(t){var e=this.widget;e&&e.videoElement&&e.videoElement.controlButton&&e.videoElement.controlButton.update(t)},addPanoramaEventListener:function(t){t.addEventListener("enter",this.setCameraControl.bind(this)),t instanceof u&&(t.addEventListener("enter-fade-start",this.showVideoWidget.bind(this)),t.addEventListener("leave",function(){this.panorama instanceof u||this.hideVideoWidget.call(this)}.bind(this)))},setCameraControl:function(){this.OrbitControls.target.copy(this.panorama.position)},getControl:function(){return this.control},getScene:function(){return this.scene},getCamera:function(){return this.camera},getRenderer:function(){return this.renderer},getContainer:function(){return this.container},getControlId:function(){return this.control.id},getNextControlId:function(){return this.controls[this.getNextControlIndex()].id},getNextControlIndex:function(){var t=this.controls,e=t.indexOf(this.control)+1;return e>=t.length?0:e},setCameraFov:function(t){this.camera.fov=t,this.camera.updateProjectionMatrix()},getRaycastViewCenter:function(){var t=new q.Raycaster;return t.setFromCamera(new q.Vector2(0,0),this.camera),0<(t=t.intersectObject(this.panorama)).length?t[0].point:new q.Vector3(0,0,-1)},enableControl:function(t){t=0<=t&&t<this.controls.length?t:0,this.control.enabled=!1,this.control=this.controls[t],this.control.enabled=!0,this.control.update(),this.setControlCenter(this.getRaycastViewCenter()),this.activateWidgetItem(t,void 0),this.onChange()},disableControl:function(){this.control.enabled=!1},toggleNextControl:function(){this.enableControl(this.getNextControlIndex())},getScreenVector:function(t){t=t.clone();var e=this.container.clientWidth/2,i=this.container.clientHeight/2;return t.project(this.camera),t.x=t.x*e+e,t.y=-t.y*i+i,t.z=0,t},checkSpriteInViewport:function(t){return this.camera.matrixWorldInverse.getInverse(this.camera.matrixWorld),this.cameraViewProjectionMatrix.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),this.cameraFrustum.setFromMatrix(this.cameraViewProjectionMatrix),t.visible&&this.cameraFrustum.intersectsSprite(t)},reverseDraggingDirection:function(){this.OrbitControls.rotateSpeed*=-1,this.OrbitControls.momentumScalingFactor*=-1},addReticle:function(t,e){var i=new r(16777215,!0,this.options.dwellTime);return i.hide(),t.add(i),e.add(t),i},rotateControlLeft:function(t){this.control.rotateLeft(t)},rotateControlUp:function(t){this.control.rotateUp(t)},rotateOrbitControl:function(t,e){this.rotateControlLeft(t),this.rotateControlUp(e)},calculateCameraDirectionDelta:function(t){var e=this.camera.getWorldDirection(new q.Vector3),i=e.clone(),n=this.panorama.getWorldPosition(new q.Vector3).sub(this.camera.getWorldPosition(new q.Vector3));(t=t.clone()).add(n).normalize();var r=t.clone();return e.y=0,t.y=0,n=(n=(n=Math.atan2(t.z,t.x)-Math.atan2(e.z,e.x))>Math.PI?n-2*Math.PI:n)<-Math.PI?n+2*Math.PI:n,e=Math.abs(i.angleTo(e)+(i.y*r.y<=0?r.angleTo(t):-r.angleTo(t))),{left:n,up:e*=r.y<i.y?1:-1}},setControlCenter:function(t){t=this.calculateCameraDirectionDelta(t),this.rotateOrbitControl(t.left,t.up)},tweenControlCenter:function(t,e,i){t instanceof Array&&(e=(t=t[0])[1],i=t[2]),e=void 0!==e?e:1e3,i=i||I.Easing.Exponential.Out;var n=this.calculateCameraDirectionDelta(t);t=n.left,n=n.up;var r=this.rotateControlLeft.bind(this),o=this.rotateControlUp.bind(this),a={left:0,up:0},s=0,c=0;this.tweenLeftAnimation.stop(),this.tweenUpAnimation.stop(),this.tweenLeftAnimation=new I.Tween(a).to({left:t},e).easing(i).onUpdate(function(t){r(t.left-s),s=t.left}).start(),this.tweenUpAnimation=new I.Tween(a).to({up:n},e).easing(i).onUpdate(function(t){o(t.up-c),c=t.up}).start()},tweenControlCenterByObject:function(t,e,i){this.tweenControlCenter(t.getWorldPosition(new q.Vector3),e,i)},onWindowResize:function(t,e){var i,n,r=this.container.classList.contains("panolens-container")||this.container.isFullscreen;void 0!==t&&void 0!==e?(i=t,n=e,this.container._width=t,this.container._height=e):(t=(e=/(android)/i.test(window.navigator.userAgent))?Math.min(document.documentElement.clientWidth,window.innerWidth||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0),e=e?Math.min(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientHeight,window.innerHeight||0),i=r?t:this.container.clientWidth,n=r?e:this.container.clientHeight,this.container._width=i,this.container._height=n),this.camera.aspect=i/n,this.camera.updateProjectionMatrix(),this.renderer.setSize(i,n),(this.options.enableReticle||this.tempEnableReticle)&&this.updateReticleEvent(),this.dispatchEvent({type:"window-resize",width:i,height:n}),this.scene.traverse(function(t){t.dispatchEvent&&t.dispatchEvent({type:"window-resize",width:i,height:n})})},addOutputElement:function(){var t=document.createElement("div");t.style.position="absolute",t.style.right="10px",t.style.top="10px",t.style.color="#fff",this.container.appendChild(t),this.outputDivElement=t},outputPosition:function(){var t=this.raycaster.intersectObject(this.panorama,!0);if(0<t.length){t=t[0].point.clone();var e=this.panorama.getWorldPosition(new q.Vector3);if(t.sub(e),e=t.x.toFixed(2)+", "+t.y.toFixed(2)+", "+t.z.toFixed(2),0!==t.length())switch(this.options.output){case"console":console.info(e);break;case"overlay":this.outputDivElement.textContent=e}}},onMouseDown:function(t){t.preventDefault(),this.userMouse.x=0<=t.clientX?t.clientX:t.touches[0].clientX,this.userMouse.y=0<=t.clientY?t.clientY:t.touches[0].clientY,this.userMouse.type="mousedown",this.onTap(t)},onMouseMove:function(t){t.preventDefault(),this.userMouse.type="mousemove",this.onTap(t)},onMouseUp:function(t){this.userMouse.type="mouseup";var e,i,n=this.userMouse.x>=t.clientX-this.options.clickTolerance&&this.userMouse.x<=t.clientX+this.options.clickTolerance&&this.userMouse.y>=t.clientY-this.options.clickTolerance&&this.userMouse.y<=t.clientY+this.options.clickTolerance||t.changedTouches&&this.userMouse.x>=t.changedTouches[0].clientX-this.options.clickTolerance&&this.userMouse.x<=t.changedTouches[0].clientX+this.options.clickTolerance&&this.userMouse.y>=t.changedTouches[0].clientY-this.options.clickTolerance&&this.userMouse.y<=t.changedTouches[0].clientY+this.options.clickTolerance?"click":void 0;t&&t.target&&!t.target.classList.contains("panolens-canvas")||(t.preventDefault(),t=t.changedTouches&&1===t.changedTouches.length?this.onTap({clientX:t.changedTouches[0].clientX,clientY:t.changedTouches[0].clientY},n):this.onTap(t,n),this.userMouse.type="none",t||"click"!==n||(t=(n=this.options).autoHideControlBar,e=this.panorama,i=this.toggleControlBar,n.autoHideInfospot&&e&&e.toggleInfospotVisibility(),t&&i()))},onTap:function(t,e){var i=this.container.getBoundingClientRect(),n=i.top,r=this.container,o=r.clientHeight;if(this.raycasterPoint.x=(t.clientX-i.left)/r.clientWidth*2-1,this.raycasterPoint.y=-(t.clientY-n)/o*2+1,this.raycaster.setFromCamera(this.raycasterPoint,this.camera),this.panorama){if(("mousedown"!==t.type&&this.touchSupported||this.outputEnabled)&&this.outputPosition(),i=this.raycaster.intersectObjects(this.panorama.children,!0),n=this.getConvertedIntersect(i),r=0<i.length?i[0].object:void 0,"mouseup"===this.userMouse.type&&(n&&this.pressEntityObject===n&&this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressstop-entity",mouseEvent:t}),this.pressEntityObject=void 0),"mouseup"===this.userMouse.type&&(r&&this.pressObject===r&&this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressstop",mouseEvent:t}),this.pressObject=void 0),"click"===e?(this.panorama.dispatchEvent({type:"click",intersects:i,mouseEvent:t}),n&&n.dispatchEvent&&n.dispatchEvent({type:"click-entity",mouseEvent:t}),r&&r.dispatchEvent&&r.dispatchEvent({type:"click",mouseEvent:t})):(this.panorama.dispatchEvent({type:"hover",intersects:i,mouseEvent:t}),(this.hoverObject&&0<i.length&&this.hoverObject!==n||this.hoverObject&&0===i.length)&&(this.hoverObject.dispatchEvent&&(this.hoverObject.dispatchEvent({type:"hoverleave",mouseEvent:t}),this.reticle.end()),this.hoverObject=void 0),n&&0<i.length&&(this.hoverObject!==n&&(this.hoverObject=n,this.hoverObject.dispatchEvent&&(this.hoverObject.dispatchEvent({type:"hoverenter",mouseEvent:t}),(this.options.autoReticleSelect&&this.options.enableReticle||this.tempEnableReticle)&&this.reticle.start(this.onTap.bind(this,t,"click")))),"mousedown"===this.userMouse.type&&this.pressEntityObject!=n&&(this.pressEntityObject=n,this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressstart-entity",mouseEvent:t})),"mousedown"===this.userMouse.type&&this.pressObject!=r&&(this.pressObject=r,this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressstart",mouseEvent:t})),"mousemove"===this.userMouse.type||this.options.enableReticle)&&(r&&r.dispatchEvent&&r.dispatchEvent({type:"hover",mouseEvent:t}),this.pressEntityObject&&this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressmove-entity",mouseEvent:t}),this.pressObject&&this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressmove",mouseEvent:t})),!n&&this.pressEntityObject&&this.pressEntityObject.dispatchEvent&&(this.pressEntityObject.dispatchEvent({type:"pressstop-entity",mouseEvent:t}),this.pressEntityObject=void 0),!r&&this.pressObject&&this.pressObject.dispatchEvent&&(this.pressObject.dispatchEvent({type:"pressstop",mouseEvent:t}),this.pressObject=void 0)),r&&r instanceof a){if(this.infospot=r,"click"===e)return!0}else this.infospot&&this.hideInfospot();this.options.autoRotate&&"mousemove"!==this.userMouse.type&&(clearTimeout(this.autoRotateRequestId),this.control===this.OrbitControls&&(this.OrbitControls.autoRotate=!1,this.autoRotateRequestId=window.setTimeout(this.enableAutoRate.bind(this),this.options.autoRotateActivationDuration)))}},getConvertedIntersect:function(t){for(var e,i=0;i<t.length;i++)if(0<=t[i].distance&&t[i].object&&!t[i].object.passThrough&&(!t[i].object.entity||!t[i].object.entity.passThrough)){e=t[i].object.entity&&!t[i].object.entity.passThrough?t[i].object.entity:t[i].object;break}return e},hideInfospot:function(){this.infospot&&(this.infospot.onHoverEnd(),this.infospot=void 0)},toggleControlBar:function(){var t=this.widget;t&&t.dispatchEvent({type:"control-bar-toggle"})},onKeyDown:function(t){this.options.output&&"none"!==this.options.output&&"Control"===t.key&&(this.outputEnabled=!0)},onKeyUp:function(){this.outputEnabled=!1},update:function(){I.update(),this.updateCallbacks.forEach(function(t){t()}),this.control.update(),this.scene.traverse(function(t){var e;t instanceof a&&t.element&&(this.hoverObject===t||"none"!==t.element.style.display||t.element.left&&"none"!==t.element.left.style.display||t.element.right&&"none"!==t.element.right.style.display)&&(this.checkSpriteInViewport(t)?(e=this.getScreenVector(t.getWorldPosition(new q.Vector3)),t.translateElement(e.x,e.y)):t.onDismiss())}.bind(this))},render:function(){this.mode===S.CARDBOARD||this.mode===S.STEREO?(this.renderer.clear(),this.effect.render(this.scene,this.camera,this.panorama),this.effect.render(this.sceneReticle,this.camera)):(this.renderer.clear(),this.renderer.render(this.scene,this.camera),this.renderer.clearDepth(),this.renderer.render(this.sceneReticle,this.camera))},animate:function(){this.requestAnimationId=window.requestAnimationFrame(this.animate.bind(this)),this.onChange()},onChange:function(){this.update(),this.render()},registerMouseAndTouchEvents:function(){var t={passive:!1};this.container.addEventListener("mousedown",this.handlerMouseDown,t),this.container.addEventListener("mousemove",this.handlerMouseMove,t),this.container.addEventListener("mouseup",this.handlerMouseUp,t),this.container.addEventListener("touchstart",this.handlerMouseDown,t),this.container.addEventListener("touchend",this.handlerMouseUp,t)},unregisterMouseAndTouchEvents:function(){this.container.removeEventListener("mousedown",this.handlerMouseDown,!1),this.container.removeEventListener("mousemove",this.handlerMouseMove,!1),this.container.removeEventListener("mouseup",this.handlerMouseUp,!1),this.container.removeEventListener("touchstart",this.handlerMouseDown,!1),this.container.removeEventListener("touchend",this.handlerMouseUp,!1)},registerReticleEvent:function(){this.addUpdateCallback(this.handlerTap)},unregisterReticleEvent:function(){this.removeUpdateCallback(this.handlerTap)},updateReticleEvent:function(){var t=this.container.clientWidth/2+this.container.offsetLeft,e=this.container.clientHeight/2;this.removeUpdateCallback(this.handlerTap),this.handlerTap=this.onTap.bind(this,{clientX:t,clientY:e}),this.addUpdateCallback(this.handlerTap)},registerEventListeners:function(){window.addEventListener("resize",this.handlerWindowResize,!0),window.addEventListener("keydown",this.handlerKeyDown,!0),window.addEventListener("keyup",this.handlerKeyUp,!0)},unregisterEventListeners:function(){window.removeEventListener("resize",this.handlerWindowResize,!0),window.removeEventListener("keydown",this.handlerKeyDown,!0),window.removeEventListener("keyup",this.handlerKeyUp,!0)},dispose:function(){this.disableAutoRate(),this.tweenLeftAnimation.stop(),this.tweenUpAnimation.stop(),this.unregisterEventListeners(),function t(e){for(var i=e.children.length-1;0<=i;i--)t(e.children[i]),e.remove(e.children[i]);e instanceof o||e instanceof a?e.dispose():e.dispatchEvent&&e.dispatchEvent("dispose")}(this.scene),this.widget&&(this.widget.dispose(),this.widget=null),q.Cache&&q.Cache.enabled&&q.Cache.clear()},destroy:function(){this.dispose(),this.render(),window.cancelAnimationFrame(this.requestAnimationId)},onPanoramaDispose:function(t){t instanceof u&&this.hideVideoWidget(),t===this.panorama&&(this.panorama=null)},loadAsyncRequest:function(t,e){e=void 0===e?function(){}:e;var i=new window.XMLHttpRequest;i.onloadend=function(t){e(t)},i.open("GET",t,!0),i.send(null)},addViewIndicator:function(){var i=this;this.loadAsyncRequest(T.ViewIndicator,function(t){var e;0!==t.loaded&&((t=t.target.responseXML.documentElement).style.width=i.viewIndicatorSize+"px",t.style.height=i.viewIndicatorSize+"px",t.style.position="absolute",t.style.top="10px",t.style.left="10px",t.style.opacity="0.5",t.style.cursor="pointer",t.id="panolens-view-indicator-container",i.container.appendChild(t),e=t.querySelector("#indicator"),i.addUpdateCallback(function(){i.radius=.225*i.viewIndicatorSize,i.currentPanoAngle=i.camera.rotation.y-q.Math.degToRad(90),i.fovAngle=q.Math.degToRad(i.camera.fov),i.leftAngle=-i.currentPanoAngle-i.fovAngle/2,i.rightAngle=-i.currentPanoAngle+i.fovAngle/2,i.leftX=i.radius*Math.cos(i.leftAngle),i.leftY=i.radius*Math.sin(i.leftAngle),i.rightX=i.radius*Math.cos(i.rightAngle),i.rightY=i.radius*Math.sin(i.rightAngle),i.indicatorD="M "+i.leftX+" "+i.leftY+" A "+i.radius+" "+i.radius+" 0 0 1 "+i.rightX+" "+i.rightY,i.leftX&&i.leftY&&i.rightX&&i.rightY&&i.radius&&e.setAttribute("d",i.indicatorD)}),t.addEventListener("mouseenter",function(){this.style.opacity="1"}),t.addEventListener("mouseleave",function(){this.style.opacity="0.5"}))})},appendControlItem:function(t){var e=this.widget.createCustomItem(t);return"video"===t.group?this.widget.videoElement.appendChild(e):this.widget.barElement.appendChild(e),e},clearAllCache:function(){q.Cache.clear()}}),"105"!=q.REVISION&&console.warn("three.js version is not matched. Please consider use the target revision 105"),window.TWEEN=I,t.BasicPanorama=h,t.CONTROLS=_,t.CameraPanorama=g,t.CubePanorama=l,t.CubeTextureLoader=P,t.DataImage=T,t.EmptyPanorama=c,t.GoogleStreetviewPanorama=p,t.ImageLittlePlanet=m,t.ImageLoader=C,t.ImagePanorama=s,t.Infospot=a,t.LittlePlanet=f,t.MODES=S,t.Media=e,t.Panorama=o,t.REVISION="11",t.Reticle=r,t.STEREOFORMAT=A,t.Stereo=n,t.StereoImagePanorama=v,t.StereoVideoPanorama=y,t.THREE_REVISION="105",t.THREE_VERSION=M,t.TextureLoader=L,t.VERSION="0.11.0",t.VideoPanorama=u,t.Viewer=E,t.Widget=i,Object.defineProperty(t,"__esModule",{value:!0})});